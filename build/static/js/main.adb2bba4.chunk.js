(this["webpackJsonpVeto-react"]=this["webpackJsonpVeto-react"]||[]).push([[0],{1001:function(e,n,c){"use strict";c.r(n);var r,a=c(2),i=c.n(a),s=(c(522),c(71)),d=c.n(s),l=function(e){e&&e instanceof Function&&c.e(3).then(c.bind(null,1067)).then((function(t){var n=t.getCLS,c=t.getFID,r=t.getFCP,a=t.getLCP,i=t.getTTFB;n(e),c(e),r(e),a(e),i(e)}))},o=c(10),u=c(24),j=c(56),b=c(119),m=c.n(b),O=c(34),h=c(40),x=c(72),v=c(74),p=c(4),f=c(8),g="ADMIN",C="VENDEURLV1",N="VENDEURL2",y={canShowDashboard:"can-view-dashboard",canShowFactureProducts:"can-show-facture-products",canShowFactures:"can-show-factures",canShowProducts:"can-show-products",canShowDepot:"can-show-depot",canShowBonDeSortie:"can-show-bon-de-sortie",canShowHistoriqueDeSortie:"can-show-historique-de-sortie",canShowCredit:"can-show-credit",canShowVaccinateur:"can-show-vaccinateur",canShowMagasin:"can-show-magasin",canShowDepotVersMagasin:"can-show-depot-vers-magasin",canHistoriqueDeDM:"can-show-historique-de-dm",canShowCorrection:"can-show-correction",canAddCorrection:"can-add-correction",canShowHistoriqueDeCorrection:"can-show-historique-de-correction",canShowVente:"can-show-vente",canShowEffectuerUneVente:"can-show-effectuer-une-vente",canShowEtatDeStockMagasin:"can-show-etat-de-stock-magasin",canShowHistoriqueDeVenteDuMagasin:"can-show-historique-de-vente-du-magasin",canShowVenteCredit:"can-show-vente-credit",canShowParameter:"can-show-parameter",canShowCategory:"can-show-category",canShowFournisseur:"can-show-fournisseur",canShowDemandeurCredit:"can-show-demandeur-credit",canShowVaccinateurs:"can-show-vaccinateurs",canShowDetailFactures:"can-show-detail-factures",canShowEditFacture:"can-show-edit-facture",canShowAddFacture:"can-show-add-facture",canShowDeleteFacture:"can-show-delete-facture",canShowDetailProduit:"can-show-detail-produit",canShowEditProduit:"can-show-edit-produit",canShowAddProduit:"can-show-add-produit",canShowDeleteProduit:"can-show-delete-produit",canShowDetailCreditDepot:"can-show-detail-credit-depot",canShowEditCreditDepot:"can-show-edit-credit-depot",canShowAddCreditDepot:"can-show-add-credit-depot",canShowDeleteCreditDepot:"can-show-delete-credit-depot",canShowDetailVaccinateurCreditDepot:"can-show-detail-vaccinateur-credit-depot",canShowEditVaccinateurCreditDepot:"can-show-edit-vaccinateur-credit-depot",canShowAddVaccinateurCreditDepot:"can-show-add-vaccinateur-credit-depot",canShowDeleteVaccinateurCreditDepot:"can-show-delete-vaccinateur-credit-depot",canShowDetailHistoricDeSortieDepot:"can-show-detail-historic-de-sortie-depot",canShowEditHistoricDeSortieDepot:"can-show-edit-historic-de-sortie-depot",canShowAddHistoricDeSortieDepot:"can-show-add-historic-de-sortie-depot",canShowDeleteHistoricDeSortieDepot:"can-show-delete-historic-de-sortie-depot",canCreateCategory:"can-create-category",canEditCategory:"can-edit-category",canDeleteCategory:"can-delete-category",canViewCategory:"can-view-category",canCreateEmprunter:"can-create-emprunter",canEditEmprunter:"can-edit-emprunter",canDeleteEmprunter:"can-delete-emprunter",canViewEmprunter:"can-view-emprunter",canCreateFournisseurs:"can-create-fournisseurs",canEditFournisseurs:"can-edit-fournisseurs",canDeleteFournisseurs:"can-delete-fournisseurs",canViewFournisseurs:"can-view-fournisseurs",canCreateVaccinateur:"can-create-vaccinateur",canEditVaccinateur:"can-edit-vaccinateur",canDeleteVaccinateur:"can-delete-vaccinateur",canViewVaccinateur:"can-view-vaccinateur",canCreate:"can-create",canEdit:"can-edit",canDelete:"can-delete",canView:"can-view"},q=(r={},Object(f.a)(r,g,[y.canShowDashboard,y.canShowFactureProducts,y.canShowFactures,y.canShowProducts,y.canShowDepot,y.canShowBonDeSortie,y.canShowHistoriqueDeSortie,y.canShowCredit,y.canShowVaccinateur,y.canShowMagasin,y.canShowDepotVersMagasin,y.canAddCorrection,y.canShowVente,y.canShowEffectuerUneVente,y.canShowEtatDeStockMagasin,y.canShowHistoriqueDeVenteDuMagasin,y.canShowVenteCredit,y.canShowParameter,y.canShowCategory,y.canShowFournisseur,y.canShowDemandeurCredit,y.canShowVaccinateurs,y.canShowDetailFactures,y.canShowEditFacture,y.canShowAddFacture,y.canShowDeleteFacture,y.canShowDetailProduit,y.canShowEditProduit,y.canShowAddProduit,y.canShowDeleteProduit,y.canShowDetailCreditDepot,y.canShowEditCreditDepot,y.canShowAddCreditDepot,y.canShowDeleteCreditDepot,y.canShowDetailHistoricDeSortieDepot,y.canShowEditHistoricDeSortieDepot,y.canShowAddHistoricDeSortieDepot,y.canShowDeleteHistoricDeSortieDepot,y.canShowDetailVaccinateur,y.canShowEditVaccinateur,y.canShowAddVaccinateur,y.canShowDeleteVaccinateur,y.canShowDetailVaccinateurCreditDepot,y.canShowEditVaccinateurCreditDepot,y.canShowAddVaccinateurCreditDepot,y.canShowDeleteVaccinateurCreditDepot,y.canCreateCategory,y.canEditCategory,y.canDeleteCategory,y.canCreateFournisseurs,y.canEditFournisseurs,y.canDeleteFournisseurs,y.canCreateEmprunter,y.canEditEmprunter,y.canDeleteEmprunter,y.canCreateVaccinateur,y.canEditVaccinateur,y.canDeleteVaccinateur,y.canHistoriqueDeDM,y.canShowCorrection,y.canAddCorrection,y.canShowHistoriqueDeCorrection]),Object(f.a)(r,C,[]),Object(f.a)(r,N,[]),r),w=c(1);function S(e){var t=e.children,n=e.scopes,c=function(e){var t=e.permissions,n=e.scopes,c={};return n.forEach((function(e){c[e]=!0})),t.some((function(e){return c[e]}))}({permissions:q[g],scopes:void 0===n?[]:n});return c?Object(w.jsx)(w.Fragment,{children:t}):Object(w.jsx)(w.Fragment,{})}var A=function(e){var t=e.title,n=e.route,c=e.scopes,r=void 0===c?[]:c,a=Object(u.h)().pathname==n;return Object(w.jsx)(S,{scopes:r,children:Object(w.jsx)("li",{class:"nav-item",children:Object(w.jsxs)(o.b,{as:o.c,to:n,class:"text-white nav-link ".concat(a?"active":""),children:[Object(w.jsx)("i",{class:"far fa-circle nav-icon"}),Object(w.jsx)("p",{children:t})]})})})},E=function(e){var t=e.children,n=e.title,c=e.scopes,r=void 0===c?[]:c,i=Object(a.useState)(!1),s=Object(p.a)(i,2),d=s[0];s[1];return Object(w.jsx)(S,{scopes:r,children:Object(w.jsxs)("li",{as:o.c,class:"nav-item ".concat(d?"menu-is-opening":null," menu-open"),children:[Object(w.jsxs)("a",{href:"#",class:"nav-link",children:[Object(w.jsx)("i",{class:"nav-icon fas fa-tachometer-alt"}),Object(w.jsxs)("p",{children:[n,Object(w.jsx)("i",{className:"right fas fa-angle-left"})]})]}),Object(w.jsx)("ul",{className:"nav nav-treeview",style:{display:"block"},children:t})]})})};var P="/tdb-depot-magasin",V="/tdb-vente-cbv",D="/tdb-facture",F="/create-product",R="/products",M="/perimes",B="/rupture",T="/credit/normal",k="/credit/vaccinateur",_="/direct",I="/parametres",Q="/product/fournisseur",L="/product/category",H="/entree",U="/sortie",Y="/bon/sortie",K="/nouvelle/facture",z="/list/approv",G="/signin",W="/signup",X="/admin",J="/historique/sortie/cva",Z="/historique/vente/vendeur/:type",$="/historique/vente/admin/vendeur",ee="/etat/stock/magasin",te="/corrections",ne="/historique/corrections",ce="/fournisseurs/list",re="/add-fournisseur",ae="/categories/list",ie="/add-categories",se="/emprunteurs/list",de="/add-emprunteurs",le="/vaccinateurs/list",oe="/add-vaccinateurs",ue="/historique-admin/vente/vendeur/:type",je=function(e){Object(x.a)(n,e);var t=Object(v.a)(n);function n(){return Object(O.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){var e=this.props,t=e.children,n=(e.navigation,e.title),c=(e.titleShort,this.props.searchbarFilter,this.props.homeTo);return t||(t=[Object(w.jsx)("div",{children:"No content"})]),t.length||(t=[t]),n.length||(n=[n]),Object(w.jsxs)("div",{class:"wrapper",children:[Object(w.jsx)("div",{className:"bg-dark m-0  p-2  text-center",children:Object(w.jsx)("h4",{className:"m-0 p-2 text-white",children:"CABINET VETERINAIRE AMBALAVAO"})}),Object(w.jsxs)("aside",{className:"main-sidebar sidebar-dark-primary",style:{maxHeight:"100%",overflow:"auto"},children:[Object(w.jsx)(o.b,{to:c,className:"brand-link border-0",children:Object(w.jsx)("span",{className:"ml-4 brand-text font-weight-light text-center text-uppercase",children:n})}),Object(w.jsx)("div",{class:"sidebar position-relative",children:Object(w.jsx)("nav",{class:"mt-2",children:Object(w.jsxs)("ul",{class:"nav nav-pills nav-sidebar flex-column","data-widget":"treeview",role:"menu","data-accordion":"false",children:[Object(w.jsx)(A,{title:"Tableau de bord",route:"/",scopes:[y.canShowDashboard]}),Object(w.jsxs)(E,{title:"Factures && Produits",scopes:[y.canShowFactureProducts],children:[Object(w.jsx)(A,{title:"Factures",route:z,scopes:[y.canShowFactures]}),Object(w.jsx)(A,{title:"Produits",route:R,scopes:[y.canShowProducts]})]}),Object(w.jsxs)(E,{title:"D\xe9pot",scopes:[y.canShowDepot],children:[Object(w.jsx)(A,{title:"Bon de sortie",route:Y,scopes:[y.canShowBonDeSortie]}),Object(w.jsx)(A,{title:"Historique de sortie",route:U,scopes:[y.canShowHistoriqueDeSortie]}),Object(w.jsx)(A,{title:"Credit",route:T,scopes:[y.canShowCredit]}),Object(w.jsx)(A,{title:"Vaccinateur",route:k,scopes:[y.canShowVaccinateur]})]}),Object(w.jsxs)(E,{title:"Magasin",scopes:[y.canShowMagasin],children:[Object(w.jsx)(A,{title:"Depot vers Magasin",route:X,scopes:[y.canShowDepotVersMagasin]}),Object(w.jsx)(A,{title:"Historique de 'D\xe9p\xf4t vers Magasin'",route:J,scopes:[y.canHistoriqueDeDM]})]}),Object(w.jsxs)(E,{title:"Correction",scopes:[y.canShowCorrection],children:[Object(w.jsx)(A,{title:"Ajouter une correction",route:te,scopes:[y.canAddCorrection]}),Object(w.jsx)(A,{title:"Historique de correction",route:ne,scopes:[y.canShowHistoriqueDeCorrection]})]}),Object(w.jsxs)(E,{title:"Vente",scopes:[y.canShowVente],children:[Object(w.jsx)(A,{title:"Effectuer une vente",route:"/vendre/in/admin",scopes:[y.canShowEffectuerUneVente]}),Object(w.jsx)(A,{title:"Etat de stock magasin",route:ee,scopes:[y.canShowEtatDeStockMagasin]}),Object(w.jsx)(A,{title:"Historique de vente du magasin",route:"/historique-admin/vente/vendeur/vente-cva",scopes:[y.canShowHistoriqueDeVenteDuMagasin]}),Object(w.jsx)(A,{title:"Cr\xe9dit",route:"/historique-admin/vente/vendeur/credit-cva",scopes:[y.canShowVenteCredit]})]}),Object(w.jsxs)(E,{title:"Parametres",scopes:[y.canShowParameter],children:[Object(w.jsx)(A,{title:"Categories",route:ae,scopes:[y.canShowCategory]}),Object(w.jsx)(A,{title:"Fournisseurs",route:ce,scopes:[y.canShowFournisseur]}),Object(w.jsx)(A,{title:"Demandeurs de credit",route:se,scopes:[y.canShowDemandeurCredit]}),Object(w.jsx)(A,{title:"Vaccinateurs",route:le,scopes:[y.canShowVaccinateur]})]})]})})})]}),Object(w.jsx)("div",{children:t})]})}}]),n}(i.a.PureComponent);je.defaultProps={children:null,title:["Admin","LTE"],browserTitle:null,theme:"blue",footer:null,sidebar:void 0,homeTo:"/",searchbarFilter:!1};var be=je,me=c(12),Oe=(c(550),c.p,c(759),c(17)),he=c.n(Oe);c(1064);var xe=c(3),ve=c(73),pe=c.n(ve);function fe(e){var t=e.children,n=e.title,c=Object(u.g)();return Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)("div",{children:[Object(w.jsx)("div",{class:"content-header p-2 shadow-sm bg-white",children:Object(w.jsx)("div",{class:"container-fluid",children:Object(w.jsxs)("div",{class:"row",children:[Object(w.jsx)("div",{class:"col-sm-6",children:Object(w.jsx)("h4",{class:"mt-2 text-uppercase",children:n})}),Object(w.jsx)("div",{class:"col-sm-6",children:Object(w.jsxs)("ol",{class:"breadcrumb float-sm-right",children:[Object(w.jsx)("li",{class:"breadcrumb-item",children:Object(w.jsx)(o.b,{to:"/",children:"Accueil"})}),t]})})]})})}),Object(w.jsx)("div",{className:"mb-1",children:Object(w.jsxs)("button",{type:"button",onClick:function(){return c.goBack()},className:"btn btn-link",children:["<<"," Revenir en arriere"]})})]})})}var ge=i.a.memo(fe,pe.a);function Ce(e){var t=e.title;return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)("li",{class:"breadcrumb-item active",children:t})})}var Ne=i.a.memo(Ce,pe.a);function ye(e){var t=e.children;return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)("div",{class:"content-wrapper",children:t})})}var qe=i.a.memo(ye,pe.a);function we(e){var t=e.children;return Object(w.jsx)("section",{class:"content",children:Object(w.jsx)("div",{class:"container-fluid",children:t})})}var Se=i.a.memo(we),Ae=(c(253),c(120)),Ee=c.n(Ae),Pe=c(26);c(514);var Ve=function(e){var t=new Date(e),n=t.getDate(),c=t.getMonth(),r=t.getFullYear();return" ".concat(n," ").concat(["Janvier","Fevrier","Mars","Avril","Mai","Juin","Juillet","Ao\xfbt","Septembre","Octobre","Novembre","Decembre"][c]," ").concat(r)},De=function(e){return new Intl.NumberFormat("fr-MG",{style:"currency",currency:"MGA"}).format(e)};function Fe(e){return e.toString().replace(/\s/g,"").toLowerCase()}var Re=function(e,t){if(Fe(e).includes(Fe(t)))return!0};var Me=function(e){var t=e.date,n=new Date(t).toLocaleString("fr-FR",{weekday:"short"}),c=new Date(t).getDate();return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)("td",{style:{height:"100%"},className:"sam."==n?" bg-warning text-white text-center mr-2":"bg-dark text-center mr-2",children:c})})},Be=function(e){var t=e.flat,n=(e.gr,e.quantityb,e.quantityc,e.quantitycond,e.id),c=t.filter((function(e){return e.id==n})),r=void 0!=c[c.length-1]?c[c.length-1]:{},a=(r.hasOwnProperty("id")&&r.quantityBruteCVA,r.hasOwnProperty("id")&&r.quantityCCCVA,0),i=0,s=0;c?(a=c.map((function(e){return 1*e.quantityParProduct})).reduce((function(e,t){return e+t}),0),i=c.map((function(e){return e.qttByCC})).reduce((function(e,t){return e+t}),0),s=c.map((function(e){return e.qttbylitre})).reduce((function(e,t){return e+t}),0)):(a=0,i=0,s=0);var d=c.map((function(e){return e.prixVente}));return Object(w.jsx)("td",{className:"text-center p-1",title:"prix de vente:"+d[0]!=void 0?d[0]:"",children:Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{className:0==c.length?"text-center p-1":"text-center bg-secondary p-1 text-white",children:0!=s?s:"-"}),Object(w.jsx)("td",{className:0==c.length?"text-center p-1":"text-center bg-primary p-1 text-white",children:0!=a?a:"-"}),Object(w.jsx)("td",{className:0==c.length?"text-center  p-1":"text-center  bg-warning p-1",children:0!=i?i:"-"})]})})},Te=function(e,t,n,c){return e.filter((function(e){var r=new Date(e[t]);return he()(r).isBetween(n,c,"days","[]")}))},ke=function(e,t){var n;return Object(me.a)(new Set((n=[]).concat.apply(n,Object(me.a)(e.map((function(e){return e[t]}))))))},_e=c(7),Ie=c(58),Qe=c.n(Ie),Le=c(157),He=c(792),Ue=c(795);function Ye(e,t,n,c){var r=He(e).toUpperCase(),a=n.toUpperCase(),i=r+"_"+a+"_START",s=r+"_"+a+"_SUCCESS",d=r+"_"+a+"_ERROR",l=n+"Start",o=n+"Success",u=n+"Error";t[i]=i,t[s]=s,t[d]=d,c.addAlias&&(t[l]=i,t[o]=s,t[u]=d)}var Ke=function(e,t){if(null==e)throw new Error("Expected resource");if(null==(t=t||{}).addAlias&&(t.addAlias=!0),""==(e=Ue(e)))throw new Error("Expected resource");var n={};return Ye(e,n,"get",t),Ye(e,n,"fetch",t),Ye(e,n,"create",t),Ye(e,n,"update",t),Ye(e,n,"delete",t),n},ze=c(154);function Ge(e,t){return e.resourceName+"."+t}var We=function(e,t,n){var c=Ge(e,t);if(ze(Array,n))throw new TypeError(c+": Expected record not to be an array")};var Xe=function(e,t){if(null==e)throw new Error("actionCreatorsFor: Expected resourceName");t=t||function(e){return{key:"id",resourceName:e}}(e),t=Qe()(t,{resourceName:e});var n=Ke(e);function c(e,t){Le(null!=t,"Expected error in "+e)}function r(e,n){Le(null!=n,"Expected record in "+e),We(t,"createStart",n)}return{getStart:function(e){return{data:e,type:n.getStart}},getSuccess:function(e,t){return Le(null!=e,"Expected record in getSuccess"),{data:t,records:e,type:n.getSuccess}},getError:function(e,t){return c("getError",e),{data:t,error:e,type:n.getError}},fetchStart:function(e){return{data:e,type:n.fetchStart}},fetchSuccess:function(e,t){return function(e,t){Le(null!=t,"Expected records "+e)}("fetchSuccess",e),{data:t,records:e,type:n.fetchSuccess}},fetchError:function(e,t){return c("fetchError",e),{data:t,error:e,type:n.fetchError}},createStart:function(e,t){return r("createStart",e),{data:t,record:e,type:n.createStart}},createSuccess:function(e,t,c){return r("createSuccess",e),{cid:t,data:c,record:e,type:n.createSuccess}},createError:function(e,t,a){var i="createError";return c(i,e),r(i,t),{data:a,error:e,record:t,type:n.createError}},updateStart:function(e,t){return r("updateStart",e),{data:t,record:e,type:n.updateStart}},updateSuccess:function(e,t){return r("updateSuccess",e),{data:t,record:e,type:n.updateSuccess}},updateError:function(e,t,a){var i="updateError";return c(i,e),r(i,t),{data:a,error:e,record:t,type:n.updateError}},deleteStart:function(e,t){return r("deleteStart",e),{data:t,record:e,type:n.deleteStart}},deleteSuccess:function(e,t){return r("deleteSuccess",e),{data:t,record:e,type:n.deleteSuccess}},deleteError:function(e,t,a){var i="deleteError";return c(i,e),r(i,t),{data:a,error:e,record:t,type:n.deleteError}}}},Je={DEFAULT_KEY:"id",STORE_LIST:"STORE_LIST",STORE_MAP:"STORE_MAP",REDUCER_NAMES:{CREATE_ERROR:"createError",CREATE_START:"createStart",CREATE_SUCCESS:"createSuccess",DELETE_ERROR:"deleteError",DELETE_START:"deleteStart",DELETE_SUCCESS:"deleteSuccess",FETCH_SUCCESS:"fetchSuccess",GET_SUCCESS:"getSuccess",UPDATE_ERROR:"updateError",UPDATE_START:"updateStart",UPDATE_SUCCESS:"updateSuccess"},SPECIAL_KEYS:{BUSY:"busy",CLIENT_GENERATED_ID:"_cid",DELETED:"deleted",PENDING_CREATE:"pendingCreate",PENDING_UPDATE:"pendingUpdate"}};var Ze=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,c=arguments.length>3?arguments[3]:void 0;if(null==e)throw new Error("reducersFor: Expected resourceName");var r={key:Je.DEFAULT_KEY,resourceName:e},a=Ie(r,t);return function(t,r){if(t=t||n,null==r)throw new Error(e+" reducers: Expected action");var i=Ke(e),s=r.record;switch(r.type){case i.fetchSuccess:return c.fetchSuccess(a,t,r.records,n,r.data&&r.data.replace);case i.getSuccess:return c.getSuccess(a,t,r.records,n,r.data&&r.data.replace);case i.createStart:return c.createStart(a,t,s);case i.createSuccess:return c.createSuccess(a,t,s,r.cid);case i.createError:return c.createError(a,t,s);case i.updateStart:return c.updateStart(a,t,s);case i.updateSuccess:return c.updateSuccess(a,t,s);case i.updateError:return c.updateError(a,t,s);case i.deleteStart:return c.deleteStart(a,t,s);case i.deleteSuccess:return c.deleteSuccess(a,t,s);case i.deleteError:return c.deleteError(a,t,s);default:return t}}};function $e(e,t){var n=t.config;if(!n.resourceName)throw new Error("Expected config.resourceName");var c=Ge(n,e.reducerName);if(!n.key)throw new Error(c+": Expected config.key");if(!t.record)throw new Error(c+": Expected record/s");t.assertValidStore(c,t.current),e.canBeArray||We(t.config,e.reducerName,t.record)}var et=c(187);function tt(e,t,n){var c=e.key;return et((function(e){var t=e[c];return n[c]===t}),t)}function nt(e){return ze(Array,e)?e:[e]}var ct={assert:function(e,t){if(!ze(Array,t))throw new Error(e+": Expected current to be an array")},remove:tt,merge:function(e,t,n){t=nt(t);var c={},r={},a=e.slice(0);return e.forEach((function(e,t){var a=e[n];if(null==a)throw new Error("Expected record to have "+n);c[a]=e,r[a]=t})),t.forEach((function(e){var t=e[n];c[t]?a[r[t]]=e:(r[t]=a.length,a.push(e)),c[t]=e})),a}};function rt(e,t,n,c){$e(e,{assertValidStore:ct.assert,config:t,current:n,record:c})}var at={reducerName:Je.REDUCER_NAMES.CREATE_ERROR,canBeArray:!1};function it(e){var t,n=(t={},Object(f.a)(t,Je.SPECIAL_KEYS.BUSY,!0),Object(f.a)(t,Je.SPECIAL_KEYS.PENDING_CREATE,!0),t);return Ie(e,n)}var st={reducerName:Je.REDUCER_NAMES.CREATE_START,canBeArray:!1};var dt={reducerName:Je.REDUCER_NAMES.CREATE_SUCCESS,canBeArray:!1};var lt=c(188),ot=c(487);function ut(e,t,n){return ot((function(e){return e[t]===n}),e)}var jt={reducerName:Je.REDUCER_NAMES.DELETE_ERROR,canBeArray:!1};function bt(e){var t,n=(t={},Object(f.a)(t,Je.SPECIAL_KEYS.DELETED,!0),Object(f.a)(t,Je.SPECIAL_KEYS.BUSY,!0),t);return Ie(e,n)}var mt={reducerName:Je.REDUCER_NAMES.DELETE_START,canBeArray:!1};var Ot={reducerName:Je.REDUCER_NAMES.DELETE_SUCCESS,canBeArray:!1};var ht=c(488),xt=c(489),vt=function(e,t,n){var c=ht(e.key);if(!xt(c,n))throw new Error(t+": Expected all records to have a value for the store's key `"+e.key+"`")},pt=Je.REDUCER_NAMES.FETCH_SUCCESS,ft={reducerName:pt,canBeArray:!0};var gt={reducerName:Je.REDUCER_NAMES.GET_SUCCESS,canBeArray:!0};var Ct=c(274);function Nt(e){return Ct(Je.SPECIAL_KEYS.BUSY,e)}var yt={reducerName:Je.REDUCER_NAMES.UPDATE_ERROR,canBeArray:!1};function qt(e){var t,n=(t={},Object(f.a)(t,Je.SPECIAL_KEYS.BUSY,!0),Object(f.a)(t,Je.SPECIAL_KEYS.PENDING_UPDATE,!0),t);return Ie(e,n)}var wt={reducerName:Je.REDUCER_NAMES.UPDATE_START,canBeArray:!1};var St={reducerName:Je.REDUCER_NAMES.UPDATE_SUCCESS,canBeArray:!1};var At={createError:function(e,t,n){return rt(at,e,t,n),tt(e,t,n)},createStart:function(e,t,n){return rt(st,e,t,n),it(n),t},createSuccess:function(e,t,n,c){rt(dt,e,t,n);var r=e.key,a=!1,i=t.map((function(e){var t=e[r];if(null==t)throw new Error("Expected record to have "+r);return t===n[r]||null!=c&&c===t?(a=!0,n):e}));return a||(i=i.concat([n])),i},deleteError:function(e,t,n){rt(jt,e,t,n);var c=e.key,r=ut(t,c,n[c]);return r=lt(["deleted","busy"],r),ct.merge(t,r,c)},deleteStart:function(e,t,n){rt(mt,e,t,n);var c=e.key,r=ut(t,c,n[c]);return r=bt(r),ct.merge(t,r,c)},deleteSuccess:function(e,t,n){rt(Ot,e,t,n);var c=e.key,r=n[c];return et((function(e){return r==e[c]}),t)},fetchSuccess:function(e,t,n,c){var r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return rt(ft,e,t,n),n=nt(n),vt(e,pt,n),ct.merge(r?c:t,n,e.key)},updateError:function(e,t,n){rt(yt,e,t,n);var c=e.key,r=ut(t,c,n[c]);return null==r?t:(r=Nt(r),ct.merge(t,r,c))},updateStart:function(e,t,n){rt(wt,e,t,n);var c=[qt(n)];return ct.merge(t,c,e.key)},updateSuccess:function(e,t,n){return rt(St,e,t,n),ct.merge(t,n,e.key)},getSuccess:function(e,t,n,c){return rt(gt,e,t,n),n=nt(n)}};var Et={reducersFor:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,c=Ie(At,n);return Ze(e,t,[],c)}};var Pt={assert:function(e,t){if(!ze(Object,t))throw new Error(e+": Expected current to be an object")},merge:function(e,t,n){var c=n[e.key];return Ie(t,Object(f.a)({},c,n))},remove:function(e,t,n){var c=n[e.key];return lt([c],t)}};function Vt(e,t,n,c){$e(e,{assertValidStore:Pt.assert,config:t,current:n,record:c})}var Dt={reducerName:Je.REDUCER_NAMES.CREATE_ERROR,canBeArray:!1};var Ft={reducerName:Je.REDUCER_NAMES.CREATE_START,canBeArray:!1};var Rt=c(490),Mt=c(491),Bt={reducerName:Je.REDUCER_NAMES.CREATE_SUCCESS,canBeArray:!1};var Tt={reducerName:Je.REDUCER_NAMES.DELETE_ERROR,canBeArray:!1};var kt={reducerName:Je.REDUCER_NAMES.DELETE_START,canBeArray:!1};var _t={reducerName:Je.REDUCER_NAMES.DELETE_SUCCESS,canBeArray:!1};var It=c(355),Qt=c(265),Lt={reducerName:Je.REDUCER_NAMES.GET_SUCCESS,canBeArray:!0};var Ht=Je.REDUCER_NAMES.FETCH_SUCCESS,Ut={reducerName:Ht,canBeArray:!0};var Yt={reducerName:Je.REDUCER_NAMES.UPDATE_ERROR,canBeArray:!1};var Kt={reducerName:Je.REDUCER_NAMES.UPDATE_START,canBeArray:!1};var zt={reducerName:Je.REDUCER_NAMES.UPDATE_SUCCESS,canBeArray:!1};var Gt={createError:function(e,t,n){return Vt(Dt,e,t,n),Pt.remove(e,t,n)},createStart:function(e,t,n){return Vt(Ft,e,t,n),it(n),t},createSuccess:function(e,t,n,c){Vt(Bt,e,t,n);var r=n[e.key],a=Rt(r),i=Ct(c,t);return Mt(a,n,i)},deleteError:function(e,t,n){Vt(Tt,e,t,n);var c=n[e.key],r=t[c];return null==r?t:(r=lt(["deleted","busy"],r),Ie(t,Object(f.a)({},c,r)))},deleteStart:function(e,t,n){Vt(kt,e,t,n);var c=t[n[e.key]];return null==c?t:(c=bt(c),Pt.merge(e,t,c))},deleteSuccess:function(e,t,n){Vt(_t,e,t,n);var c=e.key,r=n[c];return et((function(e){return r==e[c]}),t)},fetchSuccess:function(e,t,n,c){var r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];Vt(Ut,e,t,n),n=nt(n),vt(e,Ht,n);var a=It(Qt(e.key),n);return Ie(r?c:t,a)},getSuccess:function(e,t,n,c){return Vt(Lt,e,t,n),n=nt(n)},updateError:function(e,t,n){Vt(Yt,e,t,n);var c=t[n[e.key]];return null==c?t:(c=Nt(c),Pt.merge(e,t,c))},updateStart:function(e,t,n){Vt(Kt,e,t,n);var c=qt(n);return Pt.merge(e,t,c)},updateSuccess:function(e,t,n){return Vt(zt,e,t,n),Pt.merge(e,t,n)}};var Wt={reducersFor:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,c=Ie(Gt,n);return Ze(e,t,{},c)}},Xt={actionCreatorsFor:Xe,actionTypesFor:Ke,constants:Je,List:Et,Map:Wt},Jt=c(176),Zt=c.n(Jt),$t=c(492),en=c(46),tn=c.n(en),nn=c(292),cn=(Object(j.a)(),Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).API_URL,function(){return{Accept:"application/json","Content-Type":"application/json; charset=UTF-8","x-access-token":localStorage.getItem("user-veto")}}),rn={code:"INTERNAL_ERROR",message:"Quelque chose s'est mal pass\xe9. Veuillez v\xe9rifier votre connexion Internet ou contacter notre support.",status:503,data:{}},an=m.a;an.interceptors.response.use((function(e){return tn.a.isUndefined(e)?[]:e}),(function(e){e.response.status}));var sn=function(e,t,n,c){var r=new Promise((function(n,r){var a=c;an({url:"".concat(t),method:e,headers:cn(),params:"get"==e?c:void 0,data:"get"!==e?a:void 0}).then((function(e){console.log("response"),tn.a.isUndefined(e)?n([]):n(e.data)}),(function(e){var t,n,c,a,i;if(console.log("error"),null===e||void 0===e?void 0:e.response){if(null===e||void 0===e||null===(t=e.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.error)r(null===e||void 0===e||null===(a=e.response)||void 0===a||null===(i=a.data)||void 0===i?void 0:i.error);else if(null===e||void 0===e||null===(c=e.response.data)||void 0===c?void 0:c.errors){var s;r(null===e||void 0===e||null===(s=e.response.data)||void 0===s?void 0:s.errors)}}else r(rn)}))}),5e3);return nn.b.promise(r,{error:"Une erreur s'est produite... \ud83e\udd2f"}),r},dn=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return sn.apply(void 0,["get"].concat(t))},ln=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return sn.apply(void 0,["post"].concat(t))},on=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return sn.apply(void 0,["put"].concat(t))},un=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return sn.apply(void 0,["delete"].concat(t))},jn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t?e[t]||e[Object($t.singular)(t)]:e;return Zt.a.camelizeKeys(n)},bn=function(e,t,n,c,r){return Object(_e.a)(Object(_e.a)({},e),{},{records:(a=e.records,Object(en.isArray)(a)?a:[a]),receivedAt:new Date,success:r||"",totalItems:t,totalPages:n,currentPage:c});var a},mn=function(e){return Object(_e.a)(Object(_e.a)({},e),{},{records:e.records,receivedAt:new Date})},On=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=arguments.length>4?arguments[4]:void 0,a=arguments.length>5?arguments[5]:void 0;return function(i){var s=Xt.actionCreatorsFor(e),d=n.path||Zt.a.decamelize(e),l=n.replace?{replace:n.replace}:void 0,o=n.url||Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).API_URL||"http://localhost:8100/api";return i(s.getStart()),dn("".concat(o,"/").concat(d,"/").concat(t),!1,c,n).then((function(e){i(mn(s.getSuccess(jn(e),l))),r&&r(jn(e))})).catch((function(e){e.response?(a&&a(e.response),i(s.getError(null===e||void 0===e?void 0:e.response.data.error))):(a&&a(e),i(s.getError(e)))}))}},hn=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},c=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0;return function(a){var i=Xt.actionCreatorsFor(e),s=t.path||Zt.a.decamelize(e),d=t.replace?{replace:t.replace}:void 0,l=t.url||Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).API_URL||"http://localhost:8100/api";return a(i.fetchStart()),dn("".concat(l,"/").concat(s),!1,n,t).then((function(e){if(e.hasOwnProperty("data")){var t=e.data;a(bn(i.fetchSuccess(jn(t,"rows"),d),t.totalItems,t.totalPages,t.currentPage)),c&&c(jn(t,"rows"))}else e.hasOwnProperty("rows")?(a(bn(i.fetchSuccess(jn(e,"rows"),d),e.totalItems,e.totalPages,e.currentPage)),c&&c(jn(e,"rows"))):(a(bn(i.fetchSuccess(jn(e),d),null,null,null)),c&&c(jn(e)))})).catch((function(e){e.response?(r&&r(e.response),a(i.fetchError(null===e||void 0===e?void 0:e.response.data.error))):(r&&r(e),a(i.fetchError(e)))}))}},xn=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{hasFile:!1},c=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0;return function(a){var i=Xt.actionCreatorsFor(e),s=n.path||Zt.a.decamelize(e),d=n.url||Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).API_URL||"http://localhost:8100/api";return a(i.createStart(t)),ln("".concat(d,"/").concat(s),n.hasFile,t,{replace:!0}).then((function(e){a(i.createSuccess(t,e.id,e)),c&&c(t)})).catch((function(e){var n,c;e?(a(i.createError(e,t)),r&&r(e)):e.message?(a(i.createError(e,t)),r&&r(e.message)):(null===e||void 0===e||null===(n=e.response)||void 0===n||null===(c=n.data)||void 0===c?void 0:c.message)&&(r&&r(null===e||void 0===e?void 0:e.response.data.message),a(i.createError(null===e||void 0===e?void 0:e.response.data.message,t)))}))}},vn=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{hasFile:!1},c=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0;return function(a){var i=Xt.actionCreatorsFor(e),s=n.path||[Zt.a.decamelize(e),t.id].join("/"),d=n.url||Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).API_URL||"http://localhost:8100/api";return a(i.updateStart(t)),on("".concat(d,"/").concat(s),n.hasFile,t,n).then((function(e){a(i.updateSuccess(t,t.id,{receivedAt:new Date})),c&&c(t)})).catch((function(e){var n,c;e?(a(i.updateError(e,t)),r&&r(e)):e.message?(a(i.updateError(e,t)),r&&r(e.message)):(null===e||void 0===e||null===(n=e.response)||void 0===n||null===(c=n.data)||void 0===c?void 0:c.message)&&(a(i.updateError(null===e||void 0===e?void 0:e.response.data.message,t)),r&&r(null===e||void 0===e?void 0:e.response.data.message))}))}},pn=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},c=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0;return function(a){var i=Xt.actionCreatorsFor(e),s=n.path||[Zt.a.decamelize(e),t.id].join("/"),d=n.url||Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).API_URL||"http://localhost:8100/api";return a(i.deleteStart(t)),un("".concat(d,"/").concat(s),!1,t,n).then((function(){a(i.deleteSuccess(t,{receivedAt:new Date})),c&&c(t)})).catch((function(e){a(i.deleteError(e,t)),r&&r(e)}))}},fn=c(110),gn={isFetching:!1,lastUpdatedAt:null,error:null,success:null},Cn=function(e){var t=Xt.actionTypesFor(e);return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:gn,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case t.createStart:return{isLoading:!0,error:null,success:"",data:n.data};case t.createError:return{isLoading:!1,error:n.error,success:n.success,data:n.data};case t.createSuccess:return Object(_e.a)(Object(_e.a)({},n.payload),{},{isLoading:!1,error:null,success:n.success,lastUpdatedAt:n.receivedAt,data:n.data});case t.createFailed:return Object(_e.a)(Object(_e.a)({},n.payload),{},{isLoading:!1,error:n.error,success:"",data:n.data});case t.updateStart:return Object(_e.a)(Object(_e.a)({},e),{},{isLoading:!0,error:null,success:"",data:n.data});case t.updateError:return{isLoading:!1,error:n.error,success:"",data:n.data};case t.updateSuccess:return Object(_e.a)(Object(_e.a)({},e),{},{isLoading:!1,error:null,success:n.success,lastUpdatedAt:n.receivedAt,data:n.data});case t.updateFailed:return Object(_e.a)(Object(_e.a)({},e),{},{isLoading:!1,error:n.error,success:n.success,data:n.data});case t.destroyStart:return Object(_e.a)(Object(_e.a)({},e),{},{isLoading:!0,error:null,success:"",data:n.data});case t.destroySuccess:return Object(_e.a)(Object(_e.a)({},e),{},{isLoading:!1,error:null,success:n.success,lastUpdatedAt:n.receivedAt,data:n.data});case t.deleteError:return{isLoading:!1,error:n.error,success:"",data:n.data};case t.destroyFailed:return Object(_e.a)(Object(_e.a)({},e),{},{isLoading:!1,error:n.error,success:"",data:n.data});case t.getStart:return Object(_e.a)(Object(_e.a)({},e),{},{isLoading:!0,didInvalidate:!1,isFetching:!0,error:null,success:"",data:n.data});case t.getSuccess:return Object(_e.a)(Object(_e.a)({},e),{},{isFetching:!1});case t.getError:return Object(_e.a)(Object(_e.a)({},e),{},{isFetching:!1,error:n.error});case t.fetchStart:return Object(_e.a)(Object(_e.a)({},e),{},{isFetching:!0,error:null,success:"",data:n.data});case t.fetchSuccess:return Object(_e.a)(Object(_e.a)({},e),{},{isFetching:!1,success:n.success,totalPages:n.totalPages,totalItems:n.totalItems,currentPage:n.currentPage,lastUpdatedAt:n.receivedAt,error:null,data:n.data});case t.fetchError:return Object(_e.a)(Object(_e.a)({},e),{},{isFetching:!1,isLoading:!1,error:n.error,data:n.data});default:return Object(_e.a)({},e)}}},Nn=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=arguments.length>1?arguments[1]:void 0;return Xt.Map.reducersFor(e,t)(n,c)}},yn=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(fn.b)({items:Nn(e,t),meta:Cn(e,t)})};function qn(e,t){return{get:function(t){return On(e,t,{replace:!0})},getWithPath:function(t,n){return On(e,t,{path:n,replace:!0})},create:function(t,n){return xn(e,t,n)},update:function(t,n){return vn(e,t,n)},destroy:function(t,n){return pn(e,t,n)},fetch:function(t,n){return hn(e,t,n)},createTransaction:function(t,n){return xn(e,t,{path:n})},updateTransaction:function(t,n){return vn(e,t,{path:n})},deleteTransaction:function(t,n){return pn(e,t,{path:n})}}}function wn(e){return{value:function(t){return t[e].items?Object(en.values)(t[e].items):[]},item:function(t){return t[e].items?t[e].items:[]},meta:function(t){return t[e].meta}}}var Sn=function(e,t,n){return hn("commandes",{path:"/get-tdb-commande?type=".concat(e,"&deb=").concat(t,"&fin=").concat(n),replace:!0})},An=function(e,t,n){return hn("commandes",{path:"/vente-cva?deb=".concat(e,"&fin=").concat(t,"&type=").concat(n),replace:!0})},En=function(){return Object(w.jsx)("td",{className:"text-center p-1",children:Object(w.jsxs)("div",{children:[Object(w.jsx)("span",{className:"text-center  p-1",children:"-"}),Object(w.jsx)("span",{className:"text-center  p-1",children:"-"})]})})},Pn=function(){var e=Object(u.h)(),t=function(t){return e.pathname==t};return Object(w.jsxs)("div",{className:"d-flex justify-content-center align-items-center",children:[Object(w.jsx)(o.b,{className:"btn btn-".concat(t("/")?"success":"default"," text-uppercase mr-2"),to:"/",children:"Journal Vente du magasin"}),Object(w.jsx)(o.b,{className:"btn btn-".concat(t(D)?"success":"default"," text-uppercase mr-2"),to:D,children:"Journal de facturation"}),Object(w.jsx)(o.b,{className:"btn btn-".concat(t(V)?"success":"default"," text-uppercase mr-2"),to:V,children:"Journal de Vente CBV"}),Object(w.jsx)(o.b,{className:"btn btn-".concat(t(P)?"success":"default"," text-uppercase mr-2"),to:P,children:"Journal de Depot vers magasin"})]})};var Vn=function(){var e=he()().isoWeekday(1).startOf("week"),t=he()().endOf("week"),n=Object(a.useState)([]),c=Object(p.a)(n,2),r=c[0],i=c[1],s=Object(a.useState)([]),d=Object(p.a)(s,2),l=(d[0],d[1]),o=Object(a.useState)(e),u=Object(p.a)(o,2),j=u[0],b=u[1],m=Object(a.useState)(t),O=Object(p.a)(m,2),h=O[0],x=O[1],v=Object(a.useState)([e,t]),f=Object(p.a)(v,2),g=f[0],C=f[1],N=Object(a.useState)([]),y=Object(p.a)(N,2),q=y[0],S=y[1],A=Object(a.useState)([]),E=Object(p.a)(A,2),P=(E[0],E[1],Object(xe.d)(wn("commandes").value)),V=Object(xe.d)(wn("commandes").meta),D=Object(xe.c)();Object(a.useEffect)((function(){null!==g?(g[0]&&b(g[0]),g[0]&&x(g[1])):(b(e),x(t))}),[g]),Object(a.useEffect)((function(){j&&h&&(i(function(e,t){for(var n=e.clone(),c=[];n.isSameOrBefore(t);)c.push(n.format("YYYY-MM-DD")),n.add(1,"days");return c}(he()(j),he()(h))),l(function(e,t){for(var n=[];t.diff(e,"months")>=0;)n.push(e.format("MMMM YYYY")),e.add(1,"month");return n}(he()(j),he()(h))),D(Sn("vente-cva",j,h)))}),[j,h]),Object(a.useEffect)((function(){V.isFetching||S(Te(P,"dateCom",j,h))}),[V]);var F,R,M=ke(q,"contenu").reduce((function(e,t){var n=t.id,c=t.name,r=t.type,a=t.category,i=t.fournisseur,s=t.quantityParProduct,d=t.quantityBruteCVA,l=t.quantityCCCVA,o=t.qttByCC,u=t.qttbylitre,j=e.find((function(e){return e.id===n}));return j?(j.quantityParProduct=parseInt(j.quantityParProduct)+parseInt(s),j.qttByCC=parseInt(j.qttByCC)+parseInt(o),j.qttbylitre=parseInt(j.qttbylitre)+parseInt(u)):e.push({id:n,name:c,type:r,category:a,fournisseur:i,quantityBruteCVA:d,quantityCCCVA:l,quantityParProduct:s,qttByCC:o,qttbylitre:u}),e}),[]).sort((function(e,t){return e.id>t.id})),B=function(e,t){var n;return Object(me.a)(new Set((n=[]).concat.apply(n,Object(me.a)(e.map((function(e){return e[t]}))))))},T=(F="dateCom",q.reduce((function(e,t){return R?(e[t[F][R]]=e[t[F][R]]||[]).push(t):(e[t[F]]=e[t[F]]||[]).push(t),e}),{}));return Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)(qe,{children:[Object(w.jsx)(ge,{title:"Journal de vente du magasin",children:Object(w.jsx)(Ne,{title:"Journal de vente du magasin"})}),Object(w.jsxs)(Se,{children:[Object(w.jsx)(Pn,{}),Object(w.jsxs)("div",{className:"date-range",children:[Object(w.jsxs)("div",{className:"d-flex justify-content-between my-3",children:[Object(w.jsxs)("div",{children:[j&&h&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsxs)("h2",{class:"text-uppercase my-1",children:["Journal de vente du magasin"," "]}),Object(w.jsxs)("span",{children:["Du: ",Ve(j)," Au ",Ve(h)]})]})," "]}),Object(w.jsx)("div",{children:Object(w.jsx)(Ee.a,{locale:"fr-FR",onChange:C,value:g})})]}),Object(w.jsxs)("div",{className:"bg-white py-3 px-2 mb-2",children:[Object(w.jsxs)("div",{children:[Object(w.jsx)("span",{className:"bg-secondary px-2",style:{width:5,height:5}}),Object(w.jsx)("span",{className:" ml-2",children:": Quantit\xe9 de commande en litre (special pour les PHYTO)"})]}),Object(w.jsxs)("div",{children:[Object(w.jsx)("span",{className:"bg-primary px-2",style:{width:5,height:5}}),Object(w.jsx)("span",{className:" ml-2",children:": Quantit\xe9 de commande en (FLACON,BOLUS,UNITE,SACHET)"})]}),Object(w.jsxs)("div",{children:[Object(w.jsx)("span",{className:"bg-warning px-2",style:{width:5,height:5}}),Object(w.jsx)("span",{className:" ml-2",children:": Quantit\xe9 de vente en ML"})]})]}),Object(w.jsx)("div",{className:"table-responsive",children:Object(w.jsxs)("table",{class:"table",children:[Object(w.jsxs)("tr",{className:"sticky-this",children:[Object(w.jsx)("td",{children:"Produit"}),r.map((function(e){return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(Me,{date:e})})})),Object(w.jsx)("td",{className:"bg-thead text-uppercase text-center",children:"Total"}),Object(w.jsx)("td",{className:"bg-thead text-uppercase text-center",children:"Total ML"})]}),M.map((function(e){return Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)("tr",{class:"bg-white",children:[Object(w.jsx)("td",{className:"bg-thead",children:e.name}),r.map((function(t){return Object(w.jsx)(w.Fragment,{children:void 0!=T[t]?Object(w.jsx)(Be,{flat:B(T[t],"contenu"),gr:t,quantityb:e.quantityBruteCVA,quantityc:e.quantityCCCVA,quantitycond:e.condval,id:e.id}):Object(w.jsx)(En,{})})})),Object(w.jsx)("td",{className:"text-center",children:e.quantityParProduct}),Object(w.jsx)("td",{className:"text-center",children:e.qttByCC})]})})})),0==M.length&&Object(w.jsx)("tr",{children:Object(w.jsx)("td",{className:"text-center",colSpan:r.length+3,children:"Aucune enregistrement trouv\xe9"})})]})})]})]})]})})},Dn=c(136),Fn=c.n(Dn),Rn=c(226),Mn="REGISTER_SUCCESS",Bn="REGISTER_FAIL",Tn="LOGIN_SUCCESS",kn="LOGIN_FAIL",_n="LOGOUT",In="UPDATE_STOCK_REQUEST_SUCCESS",Qn="UPDATE_STOCK_REQUEST_FAIL",Ln=function(e){var t=e.product,n=Object(a.useState)(!1),c=Object(p.a)(n,2),r=c[0],i=c[1],s=Object(xe.d)(wn("commandes").meta),d=Object(xe.c)(),l=Object(a.useState)(1),o=Object(p.a)(l,2),u=o[0],j=o[1];Object(a.useEffect)((function(){d(qn("commandes").fetch())}),[]);return Object(w.jsxs)("tr",{className:"product-card ".concat(t.id?"":"product-loading"),style:{border:t&&r?"1px solid #a6a5a5":"",boxShadow:t&&r?"0 10px 15px rgba(0, 0, 0, .07)":"none"},children:[Object(w.jsx)("td",{children:t.name}),Object(w.jsx)("td",{children:t.quantityBrute+u}),Object(w.jsx)("td",{className:"d-flex justify-content-center align-items-center",children:Object(w.jsxs)("div",{class:"input-group inline-group",children:[Object(w.jsx)("div",{class:"input-group-prepend",children:Object(w.jsx)("button",{class:"btn btn-sm btn-dark btn-minus",onClick:function(){u>0&&j(u-1)},children:"-"})}),Object(w.jsx)("input",{class:"form-control quantity text-center  p-0",min:"0",name:"quantity",value:u,type:"number"}),Object(w.jsx)("div",{class:"input-group-append",children:Object(w.jsx)("button",{class:"btn btn-sm btn-dark btn-plus mr-2",onClick:function(){return j(u+1)},children:"+"})}),Object(w.jsx)("div",{class:"input-group-append ml-2"})]})}),Object(w.jsx)("td",{children:t.id&&Object(w.jsx)("button",{className:"btn btn-success  btn-sm",onClick:function(){d(function(e,t,n){return function(){var c=Object(Rn.a)(Fn.a.mark((function c(r){var a;return Fn.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,c.next=3,m.a.post("http://localhost:8100/api/update-product",{productId:e,newStockBrute:t,newStockCC:n});case 3:a=c.sent,r({type:In,payload:a.data}),c.next=10;break;case 7:c.prev=7,c.t0=c.catch(0),r({type:Qn,payload:c.t0});case 10:case"end":return c.stop()}}),c,null,[[0,7]])})));return function(e){return c.apply(this,arguments)}}()}(t.id,u,0)),d(qn("commandes").create({id:s.nextId,contenu:[t],type:"approv",sorte:"entree",vaccinateurId:null,qtteBrute:u,qtteCC:0,status:!0,emprunterId:null,dateCom:new Date})),i(!0)},children:"Modifier le stock"})})]})};function Hn(){var e=Object(xe.d)(wn("products").value),t=Object(xe.c)();return Object(a.useEffect)((function(){t(qn("products").fetch())}),[]),Object(w.jsxs)(qe,{children:[Object(w.jsx)(ge,{title:"Approvisionnement",children:Object(w.jsx)(Ne,{title:"Approvisionnement"})}),Object(w.jsx)(Se,{children:Object(w.jsxs)("table",{className:"table table-bordered table-striped",children:[Object(w.jsx)("thead",{children:Object(w.jsxs)("tr",{className:"text-center",children:[Object(w.jsx)("th",{children:"Nom de l'article"}),Object(w.jsx)("th",{style:{width:"15%"},children:"Qte"}),Object(w.jsx)("th",{style:{width:"15%"},children:"Nouvel"}),Object(w.jsx)("th",{style:{width:"20%"},children:"Actions"})]})}),Object(w.jsx)("tbody",{children:e.map((function(e){return Object(w.jsx)(Ln,{product:e})}))})]})})]})}var Un=c(175),Yn=c(1028),Kn=["icon","className","filter","setData","name","value","data","placeholder","changeValue","invalid"],zn=Object(a.forwardRef)((function(e,t){var n=e.icon,c=e.className,r=e.filter,s=(e.setData,e.name),d=e.value,l=e.data,o=void 0===l?0:l,u=e.placeholder,j=e.changeValue,b=e.invalid,m=(Object(Pe.a)(e,Kn),i.a.useCallback((function(e){r&&!r.test(e.target.value)||Object(en.isFunction)(j)&&j(e.target.value,e)}),[s]));return Object(a.useEffect)((function(){o&&j(o)}),[o]),Object(w.jsxs)("div",{className:c,children:[n&&Object(w.jsx)("i",{className:"fa fa-".concat(n)}),Object(w.jsx)(Yn.a,{bg:"gray.100",boxShadow:"sm",isInvalid:b,color:"gray.700",placeholder:u,ref:t,defaultValue:d,onBlur:m})]})})),Gn=c(282),Wn=c(1058),Xn=c(1030),Jn=["name","className","options","radioValue","valueKey","direction","filter","setData","changeValue","setRadio"],Zn=Object(a.forwardRef)((function(e,t){e.name;var n=e.className,c=e.options,r=e.radioValue,s=e.valueKey,d=e.direction,l=(e.filter,e.setData),o=e.changeValue,u=e.setRadio,j=Object(Pe.a)(e,Jn),b=Object(a.useState)(r),m=Object(p.a)(b,2),O=m[0],h=m[1],x=i.a.useState("".concat(O)),v=Object(p.a)(x,2),f=v[0],g=v[1];return i.a.useLayoutEffect((function(){o(f),l&&(l(f),h(f))}),[f]),i.a.useLayoutEffect((function(){u&&u(O)}),[O]),Object(w.jsx)(Gn.a,{onChange:g,defaultValue:"".concat(O),className:n,children:Object(w.jsx)(Wn.b,{spacing:4,direction:d,children:c.map((function(e){return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(Xn.a,Object(_e.a)(Object(_e.a)({name:"".concat(e.id),isChecked:e.id==O},j),{},{value:"".concat(e.id),ref:t,children:e[s]}))})}))})})})),$n=c(1031),ec=c(277),tc=["name","className","invalid","options","selectValue","valueKey","filter","isNumeric","emptyValue","setData","changeValue"],nc=Object(a.forwardRef)((function(e,t){var n=e.name,c=e.className,r=e.invalid,a=e.options,i=e.selectValue,s=e.valueKey,d=e.filter,l=e.isNumeric,o=void 0===l||l,u=e.emptyValue,j=void 0===u||u,b=e.setData,m=e.changeValue,O=Object(Pe.a)(e,tc);return Object(w.jsx)("div",{className:c,children:Object(w.jsxs)($n.a,Object(_e.a)(Object(_e.a)({},O),{},{bg:"gray.200",boxShadow:"sm",defaultValue:"".concat(i),isRequired:!0,name:n,isInvalid:r,onChange:function(e){d&&!d.test(e.target.value)||(Object(ec.a)(m)&&m(o?Number(e.target.value):e.target.value,e),b&&b(o?Number(e.target.value):e.target.value))},ref:t,children:[j&&Object(w.jsx)("option",{value:"",children:"Selectionner"}),null===a||void 0===a?void 0:a.map((function(e){return Object(w.jsx)("option",{defaultChecked:"".concat(i),value:"".concat(s?e.id:e),children:s?e[s]:e})}))]}))})})),cc=c(1032),rc=["icon","className","filter","setData","placeholder","changeValue","invalid"],ac=Object(a.forwardRef)((function(e,t){e.icon;var n=e.className,c=e.filter,r=e.setData,a=e.placeholder,i=e.changeValue,s=e.invalid,d=Object(Pe.a)(e,rc);return Object(w.jsx)("div",{className:n,children:Object(w.jsx)(cc.a,Object(_e.a)(Object(_e.a)({bg:"gray.200",boxShadow:"sm",isInvalid:s,placeholder:a},d),{},{onChange:function(e){c&&!c.test(e.target.value)||(Object(ec.a)(i)&&i(e.target.value,e),r&&r(e.target.value))},ref:t}))})})),ic=c(194),sc=c(1037),dc=c(169),lc=c(35),oc=c(1059),uc=c(1033),jc=c(1036),bc=c(498),mc=c.n(bc),Oc=(c(833),["icon","className","filter","setData","tags","options","changeValue","invalid"]),hc=Object(a.forwardRef)((function(e,t){var n=e.icon,c=e.className,r=(e.filter,e.setData),i=e.tags,s=e.options,d=e.changeValue,l=(e.invalid,Object(Pe.a)(e,Oc),Object(a.useState)(!1)),o=Object(p.a)(l,2),u=o[0],j=o[1],b=Object(a.useState)(i||[]),m=Object(p.a)(b,2),O=m[0],h=m[1],x=Object(a.useCallback)((function(e){h(O.filter((function(t,n){return n!==e}))),j(!0)}),[O]);Object(a.useLayoutEffect)((function(){u&&d(O),r&&r(O),j(!1)}),[u]);var v=Object(a.useCallback)((function(e){h([].concat(Object(me.a)(O),[e])),j(!0)}),[O]);return Object(w.jsxs)("div",{className:c,children:[n&&Object(w.jsx)("i",{className:"fa fa-".concat(n)}),Object(w.jsx)(mc.a,{as:Yn.a,ref:t,tags:O,suggestions:s,onDelete:x,onAddition:v})]})})),xc=["icon","className","filter","setData","name","placeholder","changeValue","invalid"],vc=Object(a.forwardRef)((function(e,t){var n=e.icon,c=e.className,r=e.filter,a=(e.setData,e.name),s=e.placeholder,d=e.changeValue,l=e.invalid,o=(Object(Pe.a)(e,xc),i.a.useCallback((function(e){r&&!r.test(e.target.value)||Object(en.isFunction)(d)&&d(e.target.value,e)}),[a]));return Object(w.jsxs)("div",{className:c,children:[n&&Object(w.jsx)("i",{className:"fa fa-".concat(n)}),Object(w.jsx)(Yn.a,{bg:"gray.100",type:"date",boxShadow:"sm",locale:"fr-FR",isInvalid:l,color:"gray.700",placeholder:s,ref:t,onBlur:o})]})})),pc=["name","className","invalid","isFieldArray","options","selectValue","valueKey","filter","setData","objectKey","index","inArray","changeValue","model","debug","array"],fc=Object(a.forwardRef)((function(e,t){var n=e.name,c=e.className,r=e.invalid,i=e.isFieldArray,s=void 0===i||i,d=e.options,l=e.selectValue,o=e.valueKey,u=e.filter,j=e.setData,b=(e.objectKey,e.index,e.inArray,e.changeValue),m=(e.model,e.debug,e.array,Object(Pe.a)(e,pc)),O=Object(a.useState)(l),h=Object(p.a)(O,2),x=(h[0],h[1]);return Object(w.jsx)("div",{className:c,children:Object(w.jsxs)($n.a,Object(_e.a)(Object(_e.a)({},m),{},{bg:"gray.200",boxShadow:"sm",defaultValue:"".concat(l),isRequired:!0,name:n,isInvalid:r,onChange:function(e){u&&!u.test(e.target.value)||(Object(ec.a)(b)&&s&&b(Number(e.target.value,e)),j&&j(Number(e.target.value)),x(Number(e.target.value)))},ref:t,children:[Object(w.jsx)("option",{value:"",children:"Selectionner"}),d.map((function(e){return Object(w.jsx)("option",{defaultChecked:"".concat(l),value:"".concat(e.id),children:o?e[o]:e})}))]}))})})),gc=c(513),Cc=["name","className","options","radioValue","valueKey","direction","inArray","filter","setData","changeValue","setRadio","masterKey","filtrable","callback"],Nc=Object(a.forwardRef)((function(e,t){var n=e.name,c=e.className,r=e.options,s=e.radioValue,d=e.valueKey,l=e.direction,o=(e.inArray,e.filter,e.setData,e.changeValue),u=e.setRadio,j=e.masterKey,b=e.filtrable,m=e.callback,O=void 0===m?null:m,h=Object(Pe.a)(e,Cc),x=Object(a.useState)(s),v=Object(p.a)(x,2),f=v[0],g=(v[1],i.a.useState("".concat(f))),C=Object(p.a)(g,2),N=C[0],y=C[1],q=Object(xe.c)();return i.a.useEffect((function(){o(j?r.find((function(e){return e[j].id==N})):r.find((function(e){return e.id==N})))}),[N]),i.a.useLayoutEffect((function(){u&&u(f)}),[f]),Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(Gn.a,{onChange:y,name:n,defaultValue:"".concat(f),className:c,children:Object(w.jsx)(Wn.b,{spacing:4,direction:l,children:r.map((function(e){return Object(w.jsx)(w.Fragment,{children:j?Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(Xn.a,Object(_e.a)(Object(_e.a)({},h),{},{value:"".concat(e[j].id),ref:t,children:e[j][d]})),1==b&&Object(w.jsx)(gc.a,{variant:"solid",onClick:function(){return q(O(e[j].id))},colorScheme:"yellow",size:"xs",children:"Annuler"})]}):Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(Xn.a,Object(_e.a)(Object(_e.a)({},h),{},{value:"".concat(e.id),ref:t,children:e[d]})),1==b&&Object(w.jsx)(gc.a,{variant:"solid",onClick:function(){return q(O(e.id))},colorScheme:"yellow",size:"xs",children:"Annuler"})]})})}))})})})})),yc=c(497),qc=c(495),wc=["name","className","options","radioValue","valueKey","direction","inArray","filter","setData","changeValue","setRadio","filtrable"];function Sc(e){var t=Object(yc.a)(e),n=t.getInputProps,c=t.getCheckboxProps,r=n(),a=c();return Object(w.jsxs)(uc.a,{as:"label",children:[Object(w.jsx)("input",Object(_e.a)({},r)),Object(w.jsx)(uc.a,Object(_e.a)(Object(_e.a)({},a),{},{cursor:"pointer",borderWidth:"1px",borderRadius:"md",boxShadow:"md",_checked:{bg:"teal.600",color:"white",borderColor:"teal.600"},_focus:{boxShadow:"outline"},px:5,py:3,children:e.children}))]})}var Ac=Object(a.forwardRef)((function(e,t){var n=e.name,c=(e.className,e.options),r=e.radioValue,s=(e.valueKey,e.direction,e.inArray,e.filter,e.setData),d=e.changeValue,l=e.setRadio,o=(e.filtrable,Object(Pe.a)(e,wc),Object(a.useState)(r)),u=Object(p.a)(o,2),j=u[0],b=u[1],m=i.a.useState("".concat(j)),O=Object(p.a)(m,2),h=O[0];O[1];i.a.useEffect((function(){d(c.find((function(e){return e.id==h}))),s&&(s(h),b(h))}),[h]),i.a.useLayoutEffect((function(){l&&l(j)}),[j]);var x=Object(qc.a)({name:n,defaultValue:1,onChange:function(e){console.log("hiii",e)}}),v=x.getRootProps,f=x.getRadioProps,g=v();return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(Wn.a,Object(_e.a)(Object(_e.a)({},g),{},{children:c.map((function(e){var t=e.id,n=f({id:t});return Object(w.jsx)(Sc,Object(_e.a)(Object(_e.a)({},n),{},{children:t}),t)}))}))})})),Ec=["icon","className","filter","setData","name","value","placeholder","changeValue","invalid"],Pc=Object(a.forwardRef)((function(e,t){var n=e.icon,c=e.className,r=e.filter,a=(e.setData,e.name),s=e.value,d=e.placeholder,l=e.changeValue,o=e.invalid,u=(Object(Pe.a)(e,Ec),i.a.useCallback((function(e){r&&!r.test(e.target.value)||Object(en.isFunction)(l)&&l(e.target.value,e)}),[a]));return Object(w.jsxs)("div",{className:c,children:[n&&Object(w.jsx)("i",{className:"fa fa-".concat(n)}),Object(w.jsx)(Yn.a,{bg:"gray.100",boxShadow:"sm",type:"password",isInvalid:o,color:"gray.700",placeholder:d,ref:t,defaultValue:s,onBlur:u})]})})),Vc=c(1055),Dc=["icon","className","filter","setData","name","value","label","placeholder","changeValue","invalid"],Fc=Object(a.forwardRef)((function(e,t){var n=e.icon,c=e.className,r=e.filter,a=(e.setData,e.name),s=e.value,d=e.label,l=(e.placeholder,e.changeValue),o=(e.invalid,Object(Pe.a)(e,Dc),i.a.useCallback((function(e){r&&!r.test(e.target.value)||Object(en.isFunction)(l)&&l(e.target.value,e)}),[a]));return Object(w.jsxs)("div",{className:c,children:[n&&Object(w.jsx)("i",{className:"fa fa-".concat(n)}),Object(w.jsx)(Vc.a,{colorScheme:"teal",ref:t,defaultValue:s,onChange:o,name:a,defaultIsChecked:!0,children:d})]})})),Rc=c(1053),Mc=["icon","className","filter","setData","name","value","data","min","placeholder","changeValue","invalid"],Bc=Object(a.forwardRef)((function(e,t){var n=e.icon,c=e.className,r=e.filter,s=(e.setData,e.name),d=e.value,l=e.data,o=void 0===l?0:l,u=e.min,j=void 0===u?0:u,b=(e.placeholder,e.changeValue),m=e.invalid,O=(Object(Pe.a)(e,Mc),i.a.useCallback((function(e){r&&!r.test(e)||Object(en.isFunction)(b)&&b(Number(e))}),[s]));return Object(a.useEffect)((function(){o&&b(Number(o))}),[o]),Object(w.jsxs)("div",{className:c,children:[n&&Object(w.jsx)("i",{className:"fa fa-".concat(n)}),Object(w.jsx)(Rc.c,{inputMode:"numeric",bg:"gray.100",boxShadow:"sm",color:"gray.700",isInvalid:m,name:s,ref:t,step:1,onChange:O,min:j,defaultValue:d,children:Object(w.jsx)(Rc.d,{})})]})})),Tc=["className","label","labelSize","labelWeight","tip","info","isBool","options","optional","error","name","half"],kc=function(e){return function(t){t.className;var n=t.label,c=t.labelSize,r=void 0===c?"13px":c,i=t.labelWeight,s=void 0===i?"400":i,d=t.tip,l=t.info,o=t.isBool,u=void 0!==o&&o,j=t.options,b=t.optional,m=t.error,O=t.name,h=t.half,x=void 0!==h&&h,v=Object(Pe.a)(t,Tc),f=Object(a.useState)(""),g=Object(p.a)(f,2),C=g[0],N=g[1];return Object(a.useEffect)((function(){N(n)}),[n]),Object(w.jsx)(uc.a,{style:{width:x?"50%":"100%"},children:Object(w.jsxs)(ic.a,{isInvalid:!!m,children:[Object(w.jsx)(jc.a,{justifyContent:"flex-start",alignItems:"center",children:!u&&Object(w.jsx)(w.Fragment,{children:C&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(sc.a,{fontSize:r,fontWeight:s,mb:1,mr:1,color:"muted.400",htmlFor:n,children:C}),d&&Object(w.jsx)(oc.a,{placement:"bottom-end",label:d,bg:"gray.800","aria-label":"Guide d'utilisation",children:Object(w.jsx)(dc.b,{fontSize:"11px",color:"gray"})}),b&&Object(w.jsxs)(lc.a.small,{color:"blue.700",children:["("," facultatif ",")"]})]})})}),Object(w.jsx)(e,Object(_e.a)({invalid:!!m,options:j,name:O,label:n},v)),l&&Object(w.jsx)(lc.a.small,{my:4,color:"muted.500",fontStyle:"italic",fontWeight:"medium",children:l}),m&&Object(w.jsx)("p",{style:{color:"red"},children:m})]})})}},_c={Input:kc(zn),Number:kc(Bc),Radio:kc(Zn),Select:kc(nc),Textarea:kc(ac),Tag:kc(hc),SelectObject:kc(fc),RadioObject:kc(Nc),RadioProduct:kc(Ac),Date:kc(vc),Password:kc(Pc),Checkbox:kc(Fc)},Ic=["validate","validations","children"],Qc=["name","validate"],Lc=function(e){e.validate;var t=e.validations,n=(e.children,Object(Pe.a)(e,Ic));return Object(w.jsx)(Un.d,Object(_e.a)(Object(_e.a)({},n),{},{enableReinitialize:!0,validationSchema:t,validateOnChange:!1,validateOnBlur:!1}))};Lc.Element=function(e){return Object(w.jsx)(Un.c,Object(_e.a)({noValidate:!0},e))},Lc.Field=Object(en.mapValues)(_c,(function(e){return function(t){var n=t.name,c=t.validate,r=Object(Pe.a)(t,Qc);return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(Un.a,{name:n,validate:c,children:function(t){var c=t.field,a=t.form,i=a.touched,s=a.errors,d=a.setFieldValue;return Object(w.jsx)(e,Object(_e.a)(Object(_e.a)(Object(_e.a)({},c),r),{},{name:n,mb:2,error:Object(en.get)(i,n)&&Object(en.get)(s,n),changeValue:function(e){return d(n,e)}}))}})})}})),Lc.initialValues=function(e,t){return t((function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",c=Object(en.get)(e,t);return void 0===c||null===c?n:c}))};var Hc=Lc,Uc=function(){Object(u.i)().id;var e=Object(xe.d)(wn("fournisseurs").value),t=Object(xe.d)(wn("categories").value),n=(Object(xe.d)(wn("products").meta),Object(xe.c)());Object(u.g)();return Object(a.useEffect)((function(){n(qn("fournisseurs").fetch()),n(qn("categories").fetch()),n(qn("products").fetch())}),[]),Object(w.jsxs)(qe,{children:[Object(w.jsx)(ge,{title:"Ajouter un produit",children:Object(w.jsx)(Ne,{title:"Ajouter un produit"})}),Object(w.jsx)(Se,{children:Object(w.jsx)(Hc,{id:"add-form-product",enableReinitialize:!0,initialValues:{},validations:{},onSubmit:function(e,t){console.log(e)},children:Object(w.jsx)(Hc.Element,{children:Object(w.jsxs)("div",{className:"row",children:[Object(w.jsx)("div",{className:"col-lg-6",children:Object(w.jsxs)("div",{className:"card",children:[Object(w.jsx)("div",{className:"card-header bg-dark text-white",children:Object(w.jsx)("h5",{children:"Information g\xe9n\xe9rale"})}),Object(w.jsxs)("div",{className:"card-body",children:[Object(w.jsx)(Hc.Field.Select,{name:"categoryId",label:"Categorie",valueKey:"name",options:t}),Object(w.jsx)(Hc.Field.Select,{name:"fournisseurId",label:"Fournisseur",valueKey:"name",options:e}),Object(w.jsx)(Hc.Field.Input,{name:"name",label:"D\xe9signation",placeholder:"D\xe9signation"}),Object(w.jsx)(Hc.Field.Radio,{radioValue:"1",valueKey:"name",label:"Type d'article",name:"type",options:[{id:"BOLUS",name:"BOLUS"},{id:"FLACON",name:"FLACON"},{id:"UNITE",name:"UNITE"},{id:"SACHET",name:"SACHET"}],direction:"row"}),Object(w.jsx)(Hc.Field.Input,{name:"prixFournisseur",label:"prix unitaire",placeholder:"prix unitaire"}),Object(w.jsx)(Hc.Field.Input,{name:"quantity",label:"Quantit\xe9",placeholder:"Quantit\xe9"}),Object(w.jsx)(Hc.Field.Input,{type:"date",name:"datePer",label:"date de peremption",placeholder:"date de peremption"})]})]})}),Object(w.jsxs)("div",{className:"col-lg-6",children:[Object(w.jsxs)("div",{className:"card",children:[Object(w.jsx)("div",{className:"card-header bg-dark text-white",children:Object(w.jsx)("h5",{children:"Vente"})}),Object(w.jsxs)("div",{className:"card-body",children:[Object(w.jsx)(Hc.Field.Input,{name:"prixVente",label:"Prix de vente",placeholder:"prix de vente"}),Object(w.jsx)(Hc.Field.Input,{name:"prixVaccinateur",label:"Prix du vaccinateur",placeholder:"prix du vaccinateur"}),Object(w.jsx)(Hc.Field.Input,{name:"prixParCC",label:"Prix de Vente en ml",placeholder:"Prix de Vente en ml"})]})]}),Object(w.jsx)("button",{className:"btn btn-green  btn-sm ",type:"submit",children:"Ajouter"})]})]})})})})]})},Yc=c(192),Kc=c(33),zc=c(1065),Gc=function(){var e,t,n,c,r,a,s,d,l=Object(u.i)().id,o=Object(xe.c)(),j=Object(xe.d)(wn("approvis").value);return i.a.useEffect((function(){o(qn("approvis").get(l))}),[l]),Object(w.jsxs)(qe,{children:[Object(w.jsx)(ge,{title:"D\xe9tail du facture",children:Object(w.jsx)(Ne,{title:"Detail de facture"})}),Object(w.jsx)(Se,{children:Object(w.jsx)("div",{className:"bg-white p-2",children:Object(w.jsxs)(zc.a,{children:[Object(w.jsxs)(zc.a.Header,{className:"d-flex justify-content-between align-items-center bg-dark text-white",children:["D\xe9tail du facture (",Ve(null===(e=j[0])||void 0===e?void 0:e.dateApprov),")"]}),Object(w.jsxs)(zc.a.Body,{children:[Object(w.jsx)("p",{children:"Arr\xeat\xe9 \xe0 la somme de "}),Object(w.jsx)("p",{className:"text-uppercase my-2",children:Object(w.jsxs)("strong",{children:[Object(Yc.NumberToLetter)(null===(t=j[0])||void 0===t?void 0:t.total)," ARIARY"]})}),Object(w.jsxs)("tr",{children:[Object(w.jsxs)("td",{children:[Object(w.jsx)("strong",{children:"Date Echeance"})," :"," ",Ve(null===(n=j[0])||void 0===n?void 0:n.dateEcheance)]})," "]}),Object(w.jsxs)("td",{className:"mb-1",children:[Object(w.jsx)("h3",{children:"Remarque"}),Object(w.jsx)("p",{class:"text-info",children:null===(c=j[0])||void 0===c?void 0:c.remarque})]}),Object(w.jsx)("br",{}),Object(w.jsxs)("h3",{children:[" ",Object(w.jsx)("strong",{children:"ARTICLES"})]}),null===(r=j[0])||void 0===r?void 0:r.contenu.map((function(e){return Object(w.jsxs)("div",{className:"border mb-3 p-3",children:[Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:"Nom de l'article:"}),Object(w.jsx)("td",{children:null===e||void 0===e?void 0:e.name})]}),Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:"Quantit\xe9:"}),Object(w.jsx)("td",{children:null===e||void 0===e?void 0:e.quantityParProduct})]}),Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:"Prix unitaire:"}),Object(w.jsx)("td",{children:Object(w.jsx)(Kc.a,{value:null===e||void 0===e?void 0:e.prixFournisseur,displayType:"text",thousandSeparator:!0,suffix:"Ar",renderText:function(e,t){return Object(w.jsx)("div",Object(_e.a)(Object(_e.a)({},t),{},{children:e}))}})})]})]})})),Object(w.jsx)("tr",{children:Object(w.jsxs)("td",{children:[Object(w.jsx)("strong",{children:"Remise :"})," ",null===(a=j[0])||void 0===a?void 0:a.remise," Ar"]})}),Object(w.jsx)("tr",{children:Object(w.jsxs)("td",{class:"text-uppercase",children:[Object(w.jsx)("strong",{children:"Paiement en :"}),null===(s=j[0])||void 0===s?void 0:s.typePaye]})}),Object(w.jsx)("tr",{children:Object(w.jsxs)("td",{class:"text-uppercase",children:[Object(w.jsx)("strong",{children:"Total:"}),Object(w.jsx)(Kc.a,{value:null===(d=j[0])||void 0===d?void 0:d.total,displayType:"text",thousandSeparator:!0,suffix:"Ar",renderText:function(e,t){return Object(w.jsx)("div",Object(_e.a)(Object(_e.a)({},t),{},{children:e}))}})]})})," "]})]})})})]})},Wc=c(177);function Xc(e){var t=e.column,n=t.filterValue,c=t.preFilteredRows,r=t.setFilter;c.length;return Object(w.jsx)("input",{className:"form-control",value:n||"",onChange:function(e){r(e.target.value||void 0)},placeholder:"Rechercher..."})}function Jc(e){var t=e.preGlobalFilteredRows,n=e.globalFilter,c=e.setGlobalFilter,r=(t.length,i.a.useState(n)),a=Object(p.a)(r,2),s=a[0],d=a[1],l=Object(Wc.useAsyncDebounce)((function(e){c(e||void 0)}),200);return Object(w.jsx)("div",{w:200,children:Object(w.jsx)("input",{className:"form-control",value:s||"",onChange:function(e){d(e.target.value),l(e.target.value)},placeholder:"Rechercher ..."})})}function Zc(e){var t=e.columns,n=e.data,c=void 0===n?[]:n,r=e.scopes,a=void 0===r?[]:r,i=e.meta,s=e.addUrl,d=e.urlName,l=e.footer,o=e.tip,u=void 0===o?"":o,j=e.filter,b=void 0===j||j,m=e.paginate,O=void 0===m||m,h=e.guide;return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)($c,{columns:t,data:i.isFetching?[]:c,meta:i,scopes:a,addUrl:s,urlName:d,footer:l,tip:u,filter:b,paginate:O,guide:h})})}function $c(e){var t=e.columns,n=e.data,c=void 0===n?[]:n,r=e.scopes,a=void 0===r?[]:r,s=e.meta,d=e.addUrl,l=e.urlName,u=e.footer,j=e.tip,b=void 0===j?"":j,m=e.filter,O=void 0===m||m,h=e.paginate,x=void 0===h||h,v=e.guide,p=t.length,f=i.a.useMemo((function(){return{Filter:Xc}}),[]),g=Object(Wc.useTable)({columns:t,data:c,defaultColumn:f,initialState:{pageIndex:0,pageSize:10}},Wc.useFilters,Wc.useGlobalFilter,Wc.useSortBy,Wc.usePagination),C=g.getTableProps,N=g.getTableBodyProps,y=g.headerGroups,q=(g.rows,g.prepareRow),A=g.preGlobalFilteredRows,E=g.setGlobalFilter,P=g.page,V=g.canPreviousPage,D=g.canNextPage,F=g.pageOptions,R=(g.pageCount,g.gotoPage),M=g.nextPage,B=g.previousPage,T=g.setPageSize,k=g.state,_=k.pageIndex,I=k.pageSize,Q=k.globalFilter;return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsxs)("div",{className:"d-flex my-2 justify-content-between align-items-center",children:[O&&Object(w.jsx)(Jc,{preGlobalFilteredRows:A,globalFilter:Q,setGlobalFilter:E}),Object(w.jsx)("div",{children:d&&l&&Object(w.jsx)(S,{scopes:a,children:Object(w.jsx)(o.b,{className:"btn btn-sm btn-green",variant:"solid",to:d,children:l})})})]}),b&&Object(w.jsx)("h3",{children:b}),Object(w.jsxs)("table",Object(_e.a)(Object(_e.a)({},C()),{},{className:"table table-bordered striped",children:[Object(w.jsx)("thead",{className:"bg-thead ",children:y.map((function(e){return Object(w.jsx)("tr",Object(_e.a)(Object(_e.a)({},e.getHeaderGroupProps()),{},{children:e.headers.map((function(e){return Object(w.jsxs)("th",Object(_e.a)(Object(_e.a)({},e.getHeaderProps(e.getSortByToggleProps())),{},{isNumeric:e.isNumeric,children:[e.render("Header"),Object(w.jsx)("span",{children:e.isSorted?e.isSortedDesc?" \ud83d\udd3d":" \ud83d\udd3c":""})]}))}))}))}))}),Object(w.jsx)("tbody",Object(_e.a)(Object(_e.a)({},N()),{},{children:s.isFetching?Object(w.jsx)("td",{colSpan:p,className:"text-center",children:Object(w.jsx)("p",{children:"Chargement des donn\xe9es en cours ...."})}):Object(w.jsxs)(w.Fragment,{children:[0==P.length&&Object(w.jsx)("tr",{children:Object(w.jsx)("td",{colSpan:p,style:v?{textAlign:"left"}:{textAlign:"center"},children:v?Object(w.jsxs)("div",{style:{width:"100%",color:"blue.700",backgroundColor:"gray.200",padding:"10px"},children:[Object(w.jsx)("h3",{className:"py-3",children:b}),v]}):"Aucune enregistrement \xe0 afficher"})}),P.map((function(e){return q(e),Object(w.jsx)("tr",Object(_e.a)(Object(_e.a)({p:0},e.getRowProps()),{},{children:e.cells.map((function(e){return Object(w.jsx)("td",Object(_e.a)(Object(_e.a)({fontSize:"11px"},e.getCellProps()),{},{isNumeric:e.column.isNumeric,children:e.render("Cell")}))}))}))}))]})})),u&&Object(w.jsx)("tfoot",{bg:"blue.900",children:Object(w.jsx)("tr",{children:Object(w.jsx)("td",{colSpan:p,color:"white",children:u})})})]})),x&&Object(w.jsxs)("div",{className:"d-flex  justify-content-between align-items-center py-3",children:[Object(w.jsx)("div",{style:{width:"200px"},children:Object(w.jsxs)("div",{className:"d-flex justify-content-center align-items-center",children:[Object(w.jsx)("input",{className:"form-control  mr-2",type:"number",placeholder:"Page",value:_+1,onChange:function(e){var t=e.target.value?Number(e.target.value)-1:0;R(t)}}),Object(w.jsx)("select",{className:"form-control",value:I,onChange:function(e){T(Number(e.target.value))},size:"sm",children:[5,10,20,30,40,50,100,150,250].map((function(e){return Object(w.jsx)("option",{value:e,children:e},e)}))})]})}),Object(w.jsx)("div",{children:Object(w.jsxs)(w.Fragment,{children:["Page"," ",Object(w.jsxs)("strong",{children:[_>0?_+1:1," sur ",F.length]})," "]})}),Object(w.jsx)("div",{className:"mb-6",children:Object(w.jsxs)("div",{children:[Object(w.jsxs)("button",{className:"mr-2 btn btn-sm btn-green",onClick:function(){return B()},disabled:!V,children:["<<"," Pr\xe9cedent"]}),Object(w.jsxs)("button",{className:"mr-2 btn btn-sm btn-green",onClick:function(){return M()},disabled:!D,children:["Suivant ",">>"]})]})})]})]})}var er=function(e){var t=e.model,n=e.entity,c=Object(xe.c)();return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)("button",{className:"btn btn-danger btn-sm",onClick:function(e){e.preventDefault(),window.confirm("Vous voulez vraiment supprimer ce facture ?")&&c(qn(t).deleteTransaction(n,"/delete-facture"))},children:"Supprimer"})})};function tr(){var e=he()().isoWeekday(1).startOf("week"),t=he()().endOf("week"),n=Object(a.useState)(e),c=Object(p.a)(n,2),r=c[0],s=c[1],d=Object(a.useState)(t),l=Object(p.a)(d,2),u=l[0],j=l[1],b=Object(a.useState)([e,t]),m=Object(p.a)(b,2),O=m[0],h=m[1],x=(Object(a.useRef)(null),Object(a.useRef)(null),Object(xe.d)(wn("approvis").value)),v=Object(xe.d)(wn("approvis").meta),f=Object(xe.c)();Object(a.useEffect)((function(){f(qn("approvis").fetch())}),[]),Object(a.useEffect)((function(){null!==O?(O[0]&&s(O[0]),O[1]&&j(O[1])):(s(e),j(t))}),[O]),Object(a.useEffect)((function(){f(function(e,t){return hn("approvis",{path:"/get-approv-by-date?deb=".concat(e,"&fin=").concat(t),replace:!0})}(r,u))}),[r,u]);var g=i.a.useMemo((function(){return[{Header:"#",accessor:"id"},{Header:"Produit",Cell:function(e){var t,n;return Object(w.jsx)("div",{style:{width:"200px"},children:null===(t=e.row.original)||void 0===t||null===(n=t.contenu)||void 0===n?void 0:n.map((function(e){return Object(w.jsxs)("span",{children:[e.name,","]})}))})}},{Header:"Date du facture",Cell:function(e){var t;return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)("span",{className:"badge badge-primary",children:Ve(null===(t=e.row.original)||void 0===t?void 0:t.dateApprov)})})}},{Header:"Date echeance",Cell:function(e){var t;return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)("span",{className:"badge badge-warning",children:Ve(null===(t=e.row.original)||void 0===t?void 0:t.dateEcheance)})})}},{Header:"Mode de paiement",accessor:"typePaye"},{Header:"Total",Cell:function(e){var t;return Object(w.jsx)("div",{children:De(null===(t=e.row.original)||void 0===t?void 0:t.total)})}},{Header:"Actions",Cell:function(e){var t,n;return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(S,{scopes:[y.canShowDetailFactures],children:Object(w.jsx)(o.b,{to:"/approvis/detail/".concat(null===(t=e.row.original)||void 0===t?void 0:t.id),className:"btn btn-green btn-sm mr-2",children:"D\xe9tails"})}),Object(w.jsx)(S,{scopes:[y.canShowEditFacture],children:Object(w.jsx)(o.b,{to:"/editer/facture/".concat(null===(n=e.row.original)||void 0===n?void 0:n.id),className:"btn btn-warning btn-sm mr-2",children:"Editer"})}),Object(w.jsx)(S,{scopes:[y.canShowDeleteFacture],children:Object(w.jsx)(er,{model:"approvis",entity:e.row.original})})]})}}]}),[]);return Object(w.jsxs)(qe,{children:[Object(w.jsx)(ge,{title:"Factures",children:Object(w.jsx)(Ne,{title:"Factures"})}),Object(w.jsxs)(Se,{children:[Object(w.jsxs)("div",{className:"row",children:[Object(w.jsx)("div",{className:"col-lg-6",children:Object(w.jsxs)("div",{children:[Object(w.jsx)("h3",{className:"text-uppercase",children:"Factures"}),Object(w.jsx)("p",{children:"".concat(Ve(r)," ->  ").concat(Ve(u))})]})}),Object(w.jsx)("div",{className:"col-lg-6 text-right",children:Object(w.jsx)(Ee.a,{locale:"fr-FR",onChange:h,value:O})})," "]}),Object(w.jsx)(Zc,{filter:!1,scopes:[y.canShowAddFacture],data:x.sort((function(e,t){return t.id-e.id})),meta:v,columns:g,addUrl:K,urlName:"Ajouter un facture"})]})]})}var nr=function(){return Object(w.jsxs)(qe,{children:[Object(w.jsx)(ge,{title:"Sortie",children:Object(w.jsx)(Ne,{title:"Sortie"})}),Object(w.jsx)(Se,{})]})},cr=c(1066),rr=c(1039),ar=c(1040),ir="SET_BASKET_ITEMS",sr="ADD_TO_BASKET",dr="REMOVE_FROM_BASKET",lr="CLEAR_BASKET",or="ADD_QTY_ITEM",ur="MINUS_QTY_ITEM",jr="ADD_QTY_PORTION_ITEM",br="MINUS_QTY_PORTION_ITEM",mr="SET_CHECKOUT_SHIPPING_DETAILS",Or="SET_CHECKOUT_PAYMENT_DETAILS",hr="RESET_CHECKOUT",xr=c(1041);function vr(e){return e.toString().replace(/\s/g,"").toLowerCase()}function pr(e){var t,n,c;for(c in t=Array.isArray(e)?[]:{},e)n=e[c],t[c]="object"===typeof n?pr(n):n;return t}var fr=function(e,t){return pr(e).filter((function(e){return""==t||vr(e.name).includes(vr(t))}))};var gr=c(62),Cr=c.n(gr);var Nr=function(e){var t=e.model,n=e.entity,c=Object(xe.c)(),r=Object(u.g)();return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)("button",{className:"btn btn-danger btn-sm",onClick:function(e){e.preventDefault(),window.confirm("Vous voulez vraiment supprimer ce commande ?")&&(c(qn(t).deleteTransaction(n,"/delete-from-depot")),r.goBack())},children:"Supprimer"})})};var yr=function(e){var t=he()().isoWeekday(1).startOf("week"),n=he()().endOf("week"),c=Object(a.useState)(t),r=Object(p.a)(c,2),s=r[0],d=r[1],l=Object(a.useState)(n),u=Object(p.a)(l,2),j=u[0],b=u[1],m=Object(a.useState)([t,n]),O=Object(p.a)(m,2),h=O[0],x=O[1],v=Object(xe.d)(wn("commandes").value),f=Object(xe.d)(wn("commandes").meta),g=Object(xe.c)();Object(a.useEffect)((function(){null!==h?(h[0]&&d(h[0]),h[1]&&b(h[1])):(d(t),b(n))}),[h]);var C=function(e){if(void 0==e||0===(null===e||void 0===e?void 0:e.length))return 0;var t=0;return e.forEach((function(e){t+=e.prixVente*e.quantityParProductDepot})),t};Object(a.useEffect)((function(){g(function(e,t){return hn("commandes",{path:"/credit?deb=".concat(e,"&fin=").concat(t),replace:!0})}(s,j))}),[s,j]);var N=i.a.useMemo((function(){return[{Header:"Date de credit",Cell:function(e){var t;return Object(w.jsx)(w.Fragment,{children:Ve(null===(t=e.row.original)||void 0===t?void 0:t.dateCom)})}},{Header:"Produits",Cell:function(e){var t,n,c,r;return Object(w.jsxs)("div",{style:{width:"350px"},children:[1==(null===(t=e.row.original)||void 0===t?void 0:t.isdeleted)&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("div",{className:"badge badge-danger",children:"Supprim\xe9"}),Object(w.jsxs)("div",{className:"text text-danger",children:["Date de suppression :"," ",Ve(null===(n=e.row.original)||void 0===n?void 0:n.deletedat)]})]}),null===(c=e.row.original)||void 0===c||null===(r=c.contenu)||void 0===r?void 0:r.map((function(t){var n,c;return Object(w.jsxs)("span",{children:[Object(w.jsx)("span",{style:{background:"white",color:1==(null===(n=e.row.original)||void 0===n?void 0:n.isdeleted)?"red":"inherit",padding:2},children:t.name}),Object(w.jsxs)("span",{style:{color:1==(null===(c=e.row.original)||void 0===c?void 0:c.isdeleted)?"red":"inherit"},children:[" "," || "]})]})}))]})}},{Header:"Status",Cell:function(e){var t;return Object(w.jsx)("div",{children:1==(null===(t=e.row.original)||void 0===t?void 0:t.status)?Object(w.jsx)("h3",{className:"badge badge-success",children:"pay\xe9"}):Object(w.jsx)("h3",{className:"badge badge-danger",children:"non pay\xe9"})})}},{Header:"Nom de la personne",accessor:"emprunter.name"},{Header:"Contact",accessor:"emprunter.contact"},{Header:"Total",Cell:function(e){var t;return Object(w.jsx)("div",{children:De(C(null===(t=e.row.original)||void 0===t?void 0:t.contenu))})}},{Header:"Actions",Cell:function(e){var t,n,c;return 1==(null===(t=e.row.original)||void 0===t?void 0:t.isdeleted)?null:Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(S,{scopes:[y.canShowDetailCreditDepot],children:Object(w.jsx)(o.b,{to:"/detail/".concat(null===(n=e.row.original)||void 0===n?void 0:n.id),className:"btn btn-green btn-sm mr-2",children:"D\xe9tails"})}),Object(w.jsx)(S,{scopes:[y.canShowEditCreditDepot],children:Object(w.jsx)(o.b,{to:"/editer/commande/".concat(null===(c=e.row.original)||void 0===c?void 0:c.id),className:"btn btn-warning btn-sm mr-2",children:"Editer"})}),Object(w.jsx)(S,{scopes:[y.canShowDeleteCreditDepot],children:Object(w.jsx)(Nr,{model:"fromdepots",entity:e.row.original})})]})}}]}),[]);return Object(w.jsxs)(qe,{children:[Object(w.jsx)(ge,{title:"Cr\xe9dit",children:Object(w.jsx)(Ne,{title:"Cr\xe9dit"})}),Object(w.jsxs)(Se,{children:[Object(w.jsxs)("div",{className:"row",children:[Object(w.jsx)("div",{className:"col-lg-6",children:Object(w.jsxs)("div",{children:[Object(w.jsx)("h3",{className:"text-uppercase",children:"Credit"}),Object(w.jsx)("p",{children:"".concat(Ve(s)," ->  ").concat(Ve(j))})]})}),Object(w.jsx)("div",{className:"col-lg-6 text-right",children:Object(w.jsx)(Cr.a,{locale:"fr-FR",onChange:x,value:h})})," "]}),Object(w.jsx)(Zc,{data:v.sort((function(e,t){return t.id-e.id})),meta:f,columns:N})]})]})};var qr=function(e){var t=he()().isoWeekday(1).startOf("week"),n=he()().endOf("week"),c=Object(a.useState)(t),r=Object(p.a)(c,2),s=r[0],d=r[1],l=Object(a.useState)(n),u=Object(p.a)(l,2),j=u[0],b=u[1],m=Object(a.useState)([t,n]),O=Object(p.a)(m,2),h=O[0],x=O[1],v=Object(xe.d)(wn("commandes").value),f=Object(xe.d)(wn("commandes").meta),g=Object(xe.c)();Object(a.useEffect)((function(){null!==h?(h[0]&&d(h[0]),h[1]&&b(h[1])):(d(t),b(n))}),[h]);var C=function(e){if(!e||0===(null===e||void 0===e?void 0:e.length))return 0;var t=0;return e.forEach((function(e){t+=e.prixVente*e.quantityParProductDepot})),t},N=function(e){if(!e||0===(null===e||void 0===e?void 0:e.length))return 0;var t=0;return e.forEach((function(e){t+=1*e.quantityParProductDepot})),t};Object(a.useEffect)((function(){g(hn("commandes",{path:"/credit-vaccinateur",replace:!0}))}),[s,j]);var q=i.a.useMemo((function(){return[{Header:"Date du credit",Cell:function(e){var t;return Object(w.jsx)(w.Fragment,{children:Ve(null===(t=e.row.original)||void 0===t?void 0:t.dateCom)})}},{Header:"Produits",Cell:function(e){var t,n;return Object(w.jsx)("div",{style:{width:"100px"},children:null===(t=e.row.original)||void 0===t||null===(n=t.contenu)||void 0===n?void 0:n.map((function(e){return Object(w.jsxs)("span",{children:[e.name,","]})}))})}},{Header:"Status",Cell:function(e){var t;return Object(w.jsx)("div",{children:1==(null===(t=e.row.original)||void 0===t?void 0:t.status)?Object(w.jsx)("h3",{className:"badge badge-success",children:"pay\xe9"}):Object(w.jsx)("h3",{className:"badge badge-danger",children:"non pay\xe9"})})}},{Header:"Nom du vaccinateur",accessor:"vaccinateur.name"},{Header:"Contact du vaccinateur",accessor:"vaccinateur.contact"},{Header:"Quantit\xe9",Cell:function(e){var t;return Object(w.jsx)("div",{children:N(null===(t=e.row.original)||void 0===t?void 0:t.contenu)})}},{Header:"Total",Cell:function(e){var t;return Object(w.jsx)("div",{children:De(C(null===(t=e.row.original)||void 0===t?void 0:t.contenu))})}},{Header:"Actions",Cell:function(e){var t,n;return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(S,{scopes:[y.canShowDetailVaccinateurCreditDepot],children:Object(w.jsx)(o.b,{to:"/detail/".concat(null===(t=e.row.original)||void 0===t?void 0:t.id),className:"btn btn-green btn-sm mr-2",children:"D\xe9tails"})}),Object(w.jsx)(S,{scopes:[y.canShowDetailVaccinateurCreditDepot],children:Object(w.jsx)(o.b,{to:"/editer/commande/".concat(null===(n=e.row.original)||void 0===n?void 0:n.id),className:"btn btn-warning btn-sm mr-2",children:"Editer"})}),Object(w.jsxs)(S,{scopes:[y.canShowDeleteVaccinateurCreditDepot],children:[Object(w.jsx)(Nr,{model:"fromdepots",entity:e.row.original})," "]})]})}}]}),[]);return Object(w.jsxs)(qe,{children:[Object(w.jsx)(ge,{title:"Cr\xe9dit  pour les vaccinateurs",children:Object(w.jsx)(Ne,{title:"Cr\xe9dit  pour les vaccinateurs"})}),Object(w.jsxs)(Se,{children:[Object(w.jsxs)("div",{className:"row",children:[Object(w.jsx)("div",{className:"col-lg-6",children:Object(w.jsxs)("div",{children:[Object(w.jsx)("h3",{className:"text-uppercase",children:"Credit pour les vaccinateurs"}),Object(w.jsx)("p",{children:"".concat(Ve(s)," ->  ").concat(Ve(j))})]})}),Object(w.jsx)("div",{className:"col-lg-6 text-right",children:Object(w.jsx)(Cr.a,{locale:"fr-FR",onChange:x,value:h})})," "]}),Object(w.jsx)(Zc,{data:v.sort((function(e,t){return t.id-e.id})),meta:f,columns:q})]})]})},wr=function(e){if(!e||0===(null===e||void 0===e?void 0:e.length))return 0;var t=0;return e.forEach((function(e){t+=e.prixVente*e.quantityParProductDepot*1})),t};var Sr=Object(u.j)((function(e){var t,n,c,r,i,s,d,l,o,j,b,m,O,h=Object(u.g)(),x=Object(u.i)().id,v=Object(xe.d)(wn("commandes").value),p=Object(xe.c)();return Object(a.useEffect)((function(){p(qn("commandes").get(x))}),[x]),Object(w.jsxs)(qe,{children:[Object(w.jsx)(ge,{title:"D\xe9tail de sortie ou entr\xe9e",children:Object(w.jsx)(Ne,{title:"D\xe9tail de sortie ou entr\xe9e"})}),Object(w.jsxs)(Se,{children:[Object(w.jsxs)("div",{className:"badge badge-info my-2",children:["vente-depot-credit"==(null===(t=v[0])||void 0===t?void 0:t.type)&&Object(w.jsx)("h3",{children:"Credit"}),"vente-depot-vaccinateur"==(null===(n=v[0])||void 0===n?void 0:n.type)&&Object(w.jsx)("h3",{children:"Credit pour vaccinateur"}),"direct"==(null===(c=v[0])||void 0===c?void 0:c.type)&&Object(w.jsx)("h3",{children:"Direct"})]}),"vente-depot-vaccinateur"==(null===(r=v[0])||void 0===r?void 0:r.type)&&Object(w.jsx)("div",{className:"border pl-3 py-3 bg-white",children:Object(w.jsxs)(w.Fragment,{children:[Object(w.jsxs)("h3",{className:"my-2",children:[" ","Nom du vaccinateur : ",null===(i=v[0])||void 0===i?void 0:i.vaccinateur.name]}),Object(w.jsxs)("h5",{children:["Contact : ",null===(s=v[0])||void 0===s?void 0:s.vaccinateur.contact]})]})}),"vente-depot-credit"==(null===(d=v[0])||void 0===d?void 0:d.type)&&Object(w.jsx)("div",{className:"border pl-3 py-3 bg-white",children:Object(w.jsxs)(w.Fragment,{children:[Object(w.jsxs)("h3",{className:"my-2",children:["Nom:",null===(l=v[0])||void 0===l?void 0:l.emprunter.name]}),Object(w.jsxs)("h5",{children:["Contact: ",null===(o=v[0])||void 0===o?void 0:o.emprunter.contact]})]})}),v.length>0&&Object(w.jsxs)("div",{className:"d-flex justify-content-between",children:[Object(w.jsxs)("p",{className:"text-uppercase",children:["Commande du : ",Ve(null===(j=v[0])||void 0===j?void 0:j.dateCom)]}),1==(null===(b=v[0])||void 0===b?void 0:b.status)?Object(w.jsx)("p",{className:"btn btn-sm btn-green my-2 mt-4",children:"pay\xe9"}):Object(w.jsx)("button",{className:"btn btn-sm btn-warning my-3",onClick:function(){var e;p(function(e){return hn("commandes",{path:"/set-payer-commande?cId=".concat(e),replace:!0})}(null===(e=v[0])||void 0===e?void 0:e.id)),h.goBack()},children:"Marquer comme pay\xe9"})]}),Object(w.jsxs)("table",{className:"table table-bordered ",children:[Object(w.jsxs)("tr",{className:"bg-thead",children:[Object(w.jsx)("td",{children:"Nom de l'article"}),Object(w.jsx)("td",{children:"Quantit\xe9"}),Object(w.jsx)("td",{children:"Sous total"})]}),v.length>0&&(null===(m=v[0])||void 0===m?void 0:m.contenu.map((function(e){return Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{style:{width:"40%"},children:e.name}),Object(w.jsxs)("td",{className:"d-flex align-items-center",children:[De(e.prixVente),"(","x"," ",e.quantityParProductDepot,")"]}),Object(w.jsx)("td",{children:De(e.prixVente*e.quantityParProductDepot)})]})})))]}),Object(w.jsxs)("div",{className:"d-flex justify-content-end",children:[Object(w.jsx)("strong",{children:"Total"}),":",De(wr(null===(O=v[0])||void 0===O?void 0:O.contenu))]})]})]})})),Ar=function(e){if(!e||0===(null===e||void 0===e?void 0:e.length))return 0;var t=0;return e.forEach((function(e){t+=e.prixVente*e.quantityParProductDepot*1})),t};var Er=Object(u.j)((function(e){Object(u.h)();var t,n,c,r,i,s,d,l,o,j,b,m,O=Object(u.i)().id,h=Object(xe.d)(wn("commandes").value),x=Object(xe.c)();return Object(a.useEffect)((function(){x(qn("commandes").get(O))}),[O]),Object(w.jsxs)(qe,{children:[Object(w.jsx)(ge,{title:"D\xe9tail de sortie ou entr\xe9e",children:Object(w.jsx)(Ne,{title:"D\xe9tail de sortie ou entr\xe9e"})}),Object(w.jsxs)(Se,{children:[Object(w.jsxs)("p",{children:["credit"==(null===(t=h[0])||void 0===t?void 0:t.type)&&Object(w.jsx)("p",{children:"Credit"}),"vaccinateur"==(null===(n=h[0])||void 0===n?void 0:n.type)&&Object(w.jsx)("p",{children:"Sortie vaccinateur"}),"direct"==(null===(c=h[0])||void 0===c?void 0:c.type)&&Object(w.jsx)("p",{children:"Sortie Magasion"})]}),"vaccinateur"==(null===(r=h[0])||void 0===r?void 0:r.type)&&Object(w.jsx)("div",{className:"border",children:Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("h3",{children:null===(i=h[0])||void 0===i?void 0:i.vaccinateur.name}),Object(w.jsx)("h5",{children:null===(s=h[0])||void 0===s?void 0:s.vaccinateur.contact})]})}),"credit"==(null===(d=h[0])||void 0===d?void 0:d.type)&&Object(w.jsx)("div",{className:"border",children:Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("h3",{children:null===(l=h[0])||void 0===l?void 0:l.emprunter.name}),Object(w.jsx)("h5",{children:null===(o=h[0])||void 0===o?void 0:o.emprunter.contact})]})}),h.length>0&&Object(w.jsx)("div",{className:"d-flex justify-content-between",children:Object(w.jsxs)("p",{className:"text-uppercase",children:["Commande du : ",Ve(null===(j=h[0])||void 0===j?void 0:j.dateCom)]})}),Object(w.jsxs)("table",{className:"table table-bordered ",children:[Object(w.jsxs)("tr",{className:"bg-thead",children:[Object(w.jsx)("td",{children:"Nom de l'article"}),Object(w.jsx)("td",{children:"Quantit\xe9"}),Object(w.jsx)("td",{children:"Sous total"})]}),h.length>0&&(null===(b=h[0])||void 0===b?void 0:b.contenu.map((function(e){return Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{style:{width:"40%"},children:e.name}),Object(w.jsxs)("td",{className:"d-flex align-items-center",children:[De(e.prixVente),"(","x"," ",e.quantityParProductDepot,")"]}),Object(w.jsx)("td",{children:De(e.prixVente*e.quantityParProductDepot)})]})})))]}),Object(w.jsxs)("div",{className:"d-flex justify-content-end",children:[Object(w.jsx)("strong",{children:"Total"}),":",De(Ar(null===(m=h[0])||void 0===m?void 0:m.contenu))]})]})]})}));var Pr=function(e){var t=Object(xe.d)(wn("commandes").value),n=Object(xe.c)();Object(a.useEffect)((function(){n(hn("commandes",{path:"/direct",replace:!0}))}),[]);var c=function(e){if(!e||0===(null===e||void 0===e?void 0:e.length))return 0;var t=0;return e.forEach((function(e){t+=e.prixVente})),t.toFixed(2)};return Object(w.jsxs)(qe,{children:[Object(w.jsx)(ge,{title:"Sortie pour le magasin",children:Object(w.jsx)(Ne,{title:"Sortie pour le magasin"})}),Object(w.jsx)(Se,{children:Object(w.jsxs)("table",{className:"table table-bordered table-striped",children:[Object(w.jsx)("thead",{children:Object(w.jsxs)("tr",{children:[Object(w.jsx)("th",{children:"Date de commande"}),Object(w.jsx)("th",{children:"Nb"}),Object(w.jsx)("th",{children:"Montant"}),Object(w.jsx)("th",{children:"Actions"})]})}),Object(w.jsx)("tbody",{children:t.map((function(e){var t;return Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:null===e||void 0===e?void 0:e.createdAt}),Object(w.jsx)("td",{children:null===e||void 0===e||null===(t=e.contenu)||void 0===t?void 0:t.length}),Object(w.jsx)("td",{children:c(null===e||void 0===e?void 0:e.contenu)}),Object(w.jsx)("td",{className:"d-flex justify-content-around",children:Object(w.jsx)(o.b,{className:"btn btn-sm  btn-green",to:"detail/".concat(e.id),children:"Detail"})})]})}))})]})})]})},Vr=function(){var e=Object(a.useState)(new Date),t=Object(p.a)(e,2),n=t[0],c=t[1],r=Object(a.useState)(new Date),i=Object(p.a)(r,2),s=i[0],d=i[1],l=Object(a.useRef)(null),u=Object(a.useRef)(null),j=Object(xe.d)(wn("commandes").value),b=Object(xe.c)();Object(a.useEffect)((function(){b(function(e,t){return hn("commandes",{path:"/journal?deb=".concat(e,"&fin=").concat(t),replace:!0})}(n,s))}),[n,s]);var m=function(e){return e&&0!==(null===e||void 0===e?void 0:e.length)?e.reduce((function(e,t){return e+t}),0):0},O=function(e){return m(e.map((function(e){return e.prixVente*e.quantityParProduct})))+m(e.map((function(e){return e.prixParCC*e.qttByCC})))};return Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)(qe,{children:[Object(w.jsx)(ge,{title:"Journal de sortie",children:Object(w.jsx)(Ne,{title:"Journal de sortie"})}),Object(w.jsxs)(Se,{children:[Object(w.jsxs)("div",{className:"row",children:[Object(w.jsx)("div",{className:"col-lg-8"}),Object(w.jsxs)("div",{className:"col-lg-4",children:[Object(w.jsxs)("div",{className:"d-flex align-items-center mb-3",children:[Object(w.jsx)("input",{type:"date",name:"datedeb",ref:l,placeholder:"date debut",className:"form-control mr-2"}),Object(w.jsx)("input",{type:"date",name:"datefin",ref:u,placeholder:"date fin",className:"form-control mr-2"}),Object(w.jsx)("button",{className:"btn btn-primary",onClick:function(){""==l.current.value?c(new Date):c(l.current.value),""==u.current.value?d(new Date):d(u.current.value)},children:"Filtrer"})]})," "]})," "]}),Object(w.jsx)("div",{className:"table-responsive",children:Object(w.jsxs)("table",{className:"table",children:[Object(w.jsx)("thead",{children:Object(w.jsxs)("tr",{children:[Object(w.jsx)("th",{children:"Date "}),Object(w.jsx)("th",{children:"Type de sortie"}),Object(w.jsx)("th",{children:"Montant Total"}),Object(w.jsx)("th",{children:"Actions"})]})}),Object(w.jsx)("tbody",{children:j.map((function(e){return Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:Ve(null===e||void 0===e?void 0:e.createdAt)}),Object(w.jsx)("td",{children:Object(w.jsxs)(w.Fragment,{children:["cva"==(null===e||void 0===e?void 0:e.type)&&Object(w.jsx)("div",{className:"badge badge-info",children:"Approvisionnement du magasin"}),"vente-magasin-direct"==(null===e||void 0===e?void 0:e.type)&&Object(w.jsx)("div",{className:"badge badge-success",children:"Vente direct depuis le magasin"}),"vente-magasin-credit"==(null===e||void 0===e?void 0:e.type)&&Object(w.jsx)("div",{className:"badge badge-info",children:"credit client depuis magasin"}),"credit"==(null===e||void 0===e?void 0:e.type)&&Object(w.jsx)("div",{className:"badge badge-danger",children:"Credit personne"}),"vaccinateur"==(null===e||void 0===e?void 0:e.type)&&Object(w.jsx)("div",{className:"badge badge-warning",children:"Credit Vaccinateur"}),"direct"==(null===e||void 0===e?void 0:e.type)&&Object(w.jsx)("div",{className:"badge badge-dark",children:"Vente direct depuis le dep\xf4t"})]})}),Object(w.jsx)("td",{children:De(O(null===e||void 0===e?void 0:e.contenu))}),Object(w.jsx)("td",{children:Object(w.jsx)(o.b,{className:"btn btn-sm  btn-green",to:"/detail/".concat(e.id),children:"Afficher le detail"})})]})}))})]})}),Object(w.jsxs)("h3",{children:["Total:",De(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=e.filter((function(e){return 1!=e.isdeleted})),n=0;return j.length>0?t.map((function(e){n+=O(null===e||void 0===e?void 0:e.contenu)})):n=0,n}(j))]})]})]})})};var Dr=function(){var e,t,n=Object(xe.d)(wn("parametres").value),c=Object(xe.c)();return Object(a.useEffect)((function(){c(qn("parametres").get(1))}),[]),Object(w.jsxs)("div",{children:[Object(w.jsx)("h3",{className:"mb-2 text-bold title",children:"Parametres supplementaires"}),Object(w.jsxs)("div",{className:"card mt-2",children:[Object(w.jsx)("div",{className:"card-body",children:Object(w.jsx)(Hc,{id:"parametrage-form",enableReinitialize:!0,initialValues:{nb_mois:null===(e=n[0])||void 0===e?void 0:e.nbMois,nb_produit:null===(t=n[0])||void 0===t?void 0:t.nbProduits},validations:{},onSubmit:function(e,t){c(qn("parametres").update({id:1,nb_mois:e.nb_mois,nb_produits:e.nb_produit}))},render:function(){return Object(w.jsxs)(Hc.Element,{children:[Object(w.jsx)(Hc.Field.Input,{name:"nb_mois",label:"Nombre de mois",placeholder:"Nombre de mois",type:"number"}),Object(w.jsx)(Hc.Field.Input,{name:"nb_produit",label:"Nombre de produit",placeholder:"Nombre de produit",type:"number"}),Object(w.jsx)("button",{type:"submit",className:"btn btn-success mt-2 btn-sm",children:"Sauvegarder la modification"})]})}})})," "]})," "]})},Fr=function(){var e=Object(xe.d)(wn("products").value),t=Object(xe.d)(wn("products").meta),n=Object(xe.c)();Object(a.useEffect)((function(){n(hn("products",{path:"/perimer",replace:!0}))}),[]);var c=i.a.useMemo((function(){return[{Header:"Produit",accessor:"name"},{Header:"Quantit\xe9",accessor:"quantityBrute"},{Header:"Date de peremption",Cell:function(e){var t;return Object(w.jsx)("h3",{children:Ve(null===(t=e.row.original)||void 0===t?void 0:t.datePer)})}}]}),[]);return Object(w.jsxs)(qe,{children:[Object(w.jsx)(ge,{title:"Article perim\xe9",children:Object(w.jsx)(Ne,{title:"Article perim\xe9"})}),Object(w.jsx)(Se,{children:Object(w.jsx)(Zc,{data:e,meta:t,columns:c})})]})},Rr=c(55);function Mr(){return Rr.b().shape({name:Rr.c().required("Le champ est requis")})}var Br=c(1061);var Tr=function(e){var t=e.message;return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(Br.a,{mb:3,status:"success",variant:"top-accent",children:"string"===typeof t&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(Br.b,{}),t]})})})},kr=c(1042),_r=c(195);var Ir=function(e){var t=e.error;return Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)(Br.a,{mb:3,status:"error",variant:"top-accent",children:["object"===typeof t&&t.length>0&&Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(kr.a,{spacing:3,children:t.map((function(e,t){return Object(w.jsxs)(kr.c,{children:[Object(w.jsx)(kr.b,{as:_r.b,color:"red.500"},t),e.msg]},t)}))})}),"object"===typeof t&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(_r.c,{color:"red.500"}),t.message]}),"string"===typeof t&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(Br.b,{}),t.message]})]})})};var Qr=function(){var e=Object(xe.d)(wn("fournisseurs").value),t=Object(xe.d)(wn("categories").value),n=Object(xe.d)(wn("categories").meta),c=Object(xe.d)(wn("fournisseurs").meta),r=Object(xe.d)(wn("products").meta),i=Object(a.useState)(0),s=Object(p.a)(i,2),d=(s[0],s[1],Object(a.useState)(0)),l=Object(p.a)(d,2),o=(l[0],l[1],Object(xe.c)()),j=Object(u.g)();return Object(a.useEffect)((function(){o(qn("fournisseurs").fetch()),o(qn("categories").fetch()),o(qn("products").fetch())}),[j]),Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)(qe,{children:[Object(w.jsx)(ge,{title:"Ajouter un produit",children:Object(w.jsx)(Ne,{title:"Ajouter un produit"})}),Object(w.jsxs)(Se,{children:[""!=r.success&&null!=r.success&&Object(w.jsx)(Tr,{message:r.success}),r.error&&Object(w.jsx)(Ir,{error:r.error}),Object(w.jsx)(Hc,{id:"add-form-product",enableReinitialize:!0,initialValues:{name:"",type:"BOLUS",doseDefault:0,prixlitre:0,prixVente:0,prixFournisseur:0,prixVaccinateur:0,quantityParProduct:0,prixParCC:0,datePer:"",uniteMesure:"ml",qttByCC:0,newStockBrute:0,newStockCC:0,fournisseurId:1,qttyspecificmirror:0,quantityBruteCVA:0,categoryId:1,quantityBrute:0,quantityCCCVA:0,quantityCC:0,condml:0,condval:0,conditionnement:1,qttccpvente:0,prixqttccvente:0},validations:Mr,onSubmit:function(e,t){var n=e.name,c=e.type,r=e.doseDefault,a=e.prixVente,i=e.prixFournisseur,s=e.prixVaccinateur,d=e.prixParCC,l=(e.datePer,e.fournisseurId),u=e.categoryId,b=e.condml,m=(e.condval,e.qttccpvente),O=e.conditionnement,h=e.prixqttccvente,x=e.condsize,v=e.prixlitre;o(qn("products").create({name:n,type:c,doseDefault:r,prixVente:parseFloat(a),prixlitre:parseFloat(v),prixFournisseur:parseFloat(i),prixVaccinateur:parseFloat(s),quantityParProduct:0,quantityBruteCVA:0,quantityBrute:0,quantityCCCVA:0,quantityCC:0,prixParCC:parseFloat(d),datePer:new Date,uniteMesure:"ml",qttByCC:0,newStockBrute:0,newStockCC:0,categoryId:parseInt(u),fournisseurId:parseInt(l),condml:parseFloat(b),condsize:parseFloat(x),conditionnement:O,qttccpvente:parseFloat(m),prixqttccvente:parseInt(h),refSortie:"0",refQtSortie:0,qttByCCDepot:0,condmldepot:0,condvaldepot:0,qttccpventedepot:0,prixqttccventedepot:0,quantityParProductDepot:0,condsizedepot:0,doseRestantEnMg:0,qttbylitre:0,remise:0,condval:0,correction:0,correctionml:0,correctionl:0,correctiontml:0,correctiontl:0,correctiontype:0,qttyspecificmirror:0,remisePerProduct:1})),j.push(R)},render:function(r){var a=r.values;return Object(w.jsx)(Hc.Element,{children:Object(w.jsxs)("div",{className:"row",children:[Object(w.jsx)("div",{className:"col-lg-6",children:Object(w.jsxs)("div",{className:"card",children:[Object(w.jsx)("div",{className:"card-header bg-dark text-white",children:"Information g\xe9n\xe9rale"}),Object(w.jsxs)("div",{className:"card-body",children:[1==n.isFetching&&Object(w.jsx)("p",{children:"Recuperation des categories"}),Object(w.jsx)(Hc.Field.Select,{name:"categoryId",label:"Categorie",emptyValue:!0,valueKey:"name",disabled:n.isFetching,defaultValue:1,options:t}),1==c.isFetching&&Object(w.jsx)("p",{children:"Recuperation des fournisseurs"}),Object(w.jsx)(Hc.Field.Select,{name:"fournisseurId",label:"Fournisseur",emptyValue:!0,valueKey:"name",options:e,disabled:c.isFetching}),Object(w.jsx)(Hc.Field.Input,{name:"name",label:"D\xe9signation",placeholder:"D\xe9signation (Tikaz 1L )"}),Object(w.jsx)(Hc.Field.Select,{name:"type",label:"Type d'article",emptyValue:!1,isNumeric:!1,valueKey:"name",options:[{id:"BOLUS",name:"BOLUS"},{id:"FLACON",name:"FLACON"},{id:"UNITE",name:"UNITE"},{id:"SACHET",name:"SACHET"}]}),"FLACON"===a.type&&Object(w.jsxs)("div",{className:"ml-3",children:[Object(w.jsx)(Hc.Field.Input,{name:"doseDefault",label:"Quantit\xe9 en ml ou dose ou en litre",placeholder:"Quantit\xe9 en ml ou dose ou en litre"}),Object(w.jsx)(Hc.Field.Select,{name:"conditionnement",label:"Conditionnement",valueKey:"name",options:[{id:1,name:"Sans conditionnement"},{id:2,name:"Avec conditionnement"}]}),2==a.conditionnement&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(Hc.Field.Input,{name:"condml",defaultValue:0,label:"Conditionnement (ML)",placeholder:"Conditionnement en ML"}),Object(w.jsx)(Hc.Field.Input,{name:"condsize",defaultValue:0,label:"Diviser en combien de flacon",placeholder:"Diviser en combien de flacon"}),Object(w.jsx)(Hc.Field.Input,{name:"qttccpvente",defaultValue:0,label:"Quantit\xe9 de vente en ML",placeholder:"Quantit\xe9 de vente en ML"}),Object(w.jsx)(Hc.Field.Input,{name:"prixqttccvente",disabled:null==a.qttccpvente||""==a.qttccpvente,label:"Prix de vente equivalent \xe0 ".concat(a.qttccpvente," ML."),placeholder:"Prix de vente equivalent \xe0 ".concat(a.qttccpvente," ML.")})]})]})]})]})}),Object(w.jsxs)("div",{className:"col-lg-6",children:[Object(w.jsxs)("div",{className:"card",children:[Object(w.jsx)("div",{className:"card-header bg-dark text-white",children:"Vente"}),Object(w.jsxs)("div",{className:"card-body",children:[2==a.conditionnement&&Object(w.jsx)(Hc.Field.Input,{name:"prixlitre",label:"Prix d'un litre",placeholder:"Prix d'un litre"}),Object(w.jsx)(Hc.Field.Input,{name:"prixFournisseur",defaultValue:0,label:"prix unitaire",placeholder:"prix unitaire"}),Object(w.jsx)(Hc.Field.Input,{name:"prixVente",defaultValue:0,label:"Prix de vente",placeholder:"prix de vente"}),Object(w.jsx)(Hc.Field.Input,{name:"prixVaccinateur",defaultValue:0,label:"Prix du vaccinateur",placeholder:"prix du vaccinateur"}),Object(w.jsx)(w.Fragment,{children:"FLACON"===a.type&&Object(w.jsx)(Hc.Field.Input,{data:0!=a.qttccpvente&&""!=a.qttccpvente&&a.prixqttccvente/a.qttccpvente!="Infinity"?a.prixqttccvente/a.qttccpvente:0,name:"prixParCC",label:"Prix de vente ml",placeholder:"Prix de vente ml"})})]})]}),Object(w.jsx)("button",{className:"btn btn-green  btn-sm ",type:"submit",children:"Ajouter"}),Object(w.jsx)("button",{className:"btn btn-danger ml-2  btn-sm ",type:"reset",children:"Annuler"})]})]})})}})]})]})})};var Lr=function(){var e,t,n,c,r,i,s,d,l,j,b,m,O,h,x,v,p,f,g,C,N,y,q=Object(u.i)().id,S=Object(xe.c)(),A=Object(xe.d)(wn("products").value);return Object(a.useEffect)((function(){S(qn("products").get(q))}),[]),Object(w.jsxs)(qe,{children:[Object(w.jsx)(ge,{title:"D\xe9tail du produit",children:Object(w.jsx)(Ne,{title:"D\xe9tail du produit"})}),Object(w.jsxs)(Se,{children:[Object(w.jsx)("div",{className:"d-flex justify-content-end",children:Object(w.jsx)(o.b,{className:"btn btn-sm btn-warning mr-2 mb-2",to:"/changer/prix/".concat(q),children:"Rectification de prix"})}),2!=(null===(e=A[0])||void 0===e?void 0:e.conditionnement)||null!=(null===(t=A[0])||void 0===t?void 0:t.conditionnement)&&Object(w.jsxs)("div",{className:"card card-info",children:[Object(w.jsx)("div",{className:"card-header",children:"Conditionnement"}),Object(w.jsxs)("div",{className:"card-body",children:[Object(w.jsxs)("p",{children:["Prix d'un litre:"," ",Object(w.jsx)("span",{className:"badge badge-info",children:null===(n=A[0])||void 0===n?void 0:n.prixlitre})]}),Object(w.jsxs)("p",{children:["Conditionnement (ML):"," ",Object(w.jsx)("span",{className:"badge badge-info",children:null===(c=A[0])||void 0===c?void 0:c.condml})]}),Object(w.jsxs)("p",{children:["Division en flacon:"," ",Object(w.jsx)("span",{className:"badge badge-info",children:null===(r=A[0])||void 0===r?void 0:r.condsize})]}),Object(w.jsxs)("p",{children:["Quantit\xe9 de vente par ML:",Object(w.jsx)("span",{className:"badge badge-info",children:null===(i=A[0])||void 0===i?void 0:i.qttccpvente})]}),Object(w.jsxs)("p",{children:["Prix de vente pour ",null===(s=A[0])||void 0===s?void 0:s.qttccpvente," ML:"," ",Object(w.jsxs)("span",{className:"badge badge-info",children:[De(null===(d=A[0])||void 0===d?void 0:d.prixqttccvente)," "]})]})]})]}),Object(w.jsxs)("table",{className:"table table-striped",children:[Object(w.jsxs)("tr",{className:"bg-thead",children:[Object(w.jsx)("td",{children:Object(w.jsx)("strong",{children:"Nom de l'article:"})}),Object(w.jsxs)("td",{children:[null===(l=A[0])||void 0===l?void 0:l.name," "]})]}),Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:Object(w.jsx)("strong",{children:"Fournisseur :"})}),Object(w.jsx)("td",{children:null===(j=A[0])||void 0===j||null===(b=j.fournisseur)||void 0===b?void 0:b.name})]}),Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:Object(w.jsx)("strong",{children:"Categorie :"})}),Object(w.jsx)("td",{children:null===(m=A[0])||void 0===m||null===(O=m.category)||void 0===O?void 0:O.name})]}),Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:Object(w.jsx)("strong",{children:"Type:"})}),Object(w.jsxs)("td",{children:[null===(h=A[0])||void 0===h?void 0:h.type," "]})]}),Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:Object(w.jsx)("strong",{children:"Dose:"})}),Object(w.jsxs)("td",{children:[null===(x=A[0])||void 0===x?void 0:x.doseDefault," ML "]})]}),Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:Object(w.jsx)("strong",{children:"Prix unitaire:"})}),Object(w.jsx)("td",{children:De(null===(v=A[0])||void 0===v?void 0:v.prixFournisseur)})]}),Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:Object(w.jsx)("strong",{children:"Prix de vente:"})}),Object(w.jsx)("td",{children:De(null===(p=A[0])||void 0===p?void 0:p.prixVente)})]}),Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:Object(w.jsx)("strong",{children:"Prix pour le vaccinateur:"})}),Object(w.jsx)("td",{children:De(null===(f=A[0])||void 0===f?void 0:f.prixVaccinateur)})]}),Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:Object(w.jsx)("strong",{children:"Prix par ML:"})}),Object(w.jsx)("td",{children:0!=(null===(g=A[0])||void 0===g?void 0:g.qttccpvente)?De((null===(C=A[0])||void 0===C?void 0:C.prixParCC)*(null===(N=A[0])||void 0===N?void 0:N.qttccpvente)):De(null===(y=A[0])||void 0===y?void 0:y.prixParCC)})]})]})]})]})};var Hr=function(){var e,t,n=Object(u.i)().id,c=Object(xe.d)(wn("fournisseurs").value),r=Object(xe.d)(wn("categories").value),i=Object(xe.d)(wn("products").value),s=Object(xe.d)(wn("products").meta),d=Object(a.useState)((e={name:"",type:"",doseDefault:"",prixlitre:"",prixVente:"",prixFournisseur:"",prixVaccinateur:"",prixParCC:"",datePer:"",uniteMesure:"ml",conditionnement:"",categoryId:""},Object(f.a)(e,"datePer",""),Object(f.a)(e,"fournisseurId",""),Object(f.a)(e,"condml",""),Object(f.a)(e,"condsize",""),Object(f.a)(e,"qttccpvente",""),Object(f.a)(e,"prixqttccvente",""),e)),l=Object(p.a)(d,2),o=l[0],j=l[1],b=Object(u.g)(),m=Object(a.useState)(1),O=Object(p.a)(m,2),h=(O[0],O[1],Object(a.useState)(1)),x=Object(p.a)(h,2),v=(x[0],x[1],Object(a.useState)(0)),g=Object(p.a)(v,2),C=g[0],N=g[1],y=Object(a.useState)(0),q=Object(p.a)(y,2),S=q[0],A=q[1],E=Object(xe.c)(),P=Object(a.useState)({}),V=Object(p.a)(P,2),D=(V[0],V[1]),F=Object(a.useState)(o.type),M=Object(p.a)(F,2),B=(M[0],M[1]);return Object(a.useEffect)((function(){E(qn("products").fetch()),B(o.type),A(o.prixqttccvente),N(o.qttccpvente)}),[n]),Object(a.useEffect)((function(){s.isFetching||(j(null===i||void 0===i?void 0:i.find((function(e){return e.id==n}))),D({name:o.name}))}),[s]),Object(a.useEffect)((function(){E(qn("fournisseurs").fetch()),E(qn("categories").fetch())}),[]),Object(w.jsxs)(qe,{children:[Object(w.jsx)(ge,{title:"Editer un produit",children:Object(w.jsx)(Ne,{title:"Editer un produit"})}),Object(w.jsxs)(Se,{children:[""!=s.success&&null!=s.success&&Object(w.jsx)(Tr,{message:s.success}),i.name,s.error&&Object(w.jsx)(Ir,{error:s.error}),Object(w.jsx)(Hc,{id:"add-form-product",initialValues:(t={name:o.name,type:o.type,doseDefault:o.doseDefault,prixlitre:o.prixlitre,prixVente:o.prixVente,prixFournisseur:null===o||void 0===o?void 0:o.prixFournisseur,prixVaccinateur:o.prixVaccinateur,prixParCC:o.prixParCC,datePer:o.datePer,uniteMesure:"ml",conditionnement:o.conditionnement,categoryId:o.categoryId},Object(f.a)(t,"datePer",o.datePer),Object(f.a)(t,"fournisseurId",o.fournisseurId),Object(f.a)(t,"condml",null==o.condml?0:o.condml),Object(f.a)(t,"condsize",null==o.condsize?0:o.condsize),Object(f.a)(t,"qttccpvente",null==o.qttccpvente?0:o.qttccpvente),Object(f.a)(t,"prixqttccvente",null==o.prixqttccvente?0:o.prixqttccvente),t),validations:Mr,onSubmit:function(e,t){var n=e.name,c=e.type,r=e.doseDefault,a=e.prixlitre,i=e.prixVente,s=e.prixFournisseur,d=e.prixVaccinateur,l=e.prixParCC,u=e.datePer,j=e.fournisseurId,m=e.categoryId,O=e.condml,h=(e.condval,e.qttccpvente),x=e.prixqttccvente,v=e.conditionnement,p=e.condsize;E(qn("products").update({id:o.id,name:n,type:c,doseDefault:r,prixVente:parseFloat(i),prixFournisseur:parseFloat(s),prixVaccinateur:parseFloat(d),prixlitre:parseFloat(a),prixParCC:parseFloat(l),datePer:new Date(u),qttByCC:parseFloat(o.qttByCC),quantityBrute:parseFloat(o.quantityBrute),quantityBruteCVA:parseFloat(o.quantityBruteCVA),quantityCCCVA:parseFloat(o.quantityCCCVA),quantityCC:parseFloat(o.quantityCC),uniteMesure:"ml",condml:parseFloat(O),condsize:parseFloat(p),qttccpvente:parseFloat(h),fournisseurId:parseInt(j),categoryId:parseInt(m),conditionnement:parseInt(v),prixqttccvente:parseInt(x),updatedAt:new Date,refSortie:"0",refQtSortie:0,qttByCCDepot:0,condmldepot:0,condvaldepot:0,qttyspecificmirror:0,qttccpventedepot:0,prixqttccventedepot:0,quantityParProductDepot:0,condsizedepot:0,qttbylitre:0,remise:0,condval:0,correction:0,correctionml:0,correctionl:0,correctiontml:0,correctiontl:0,correctiontype:0})),b.push(R)},render:function(e){var t=e.values;return Object(w.jsx)(Hc.Element,{children:Object(w.jsxs)("div",{className:"row",children:[Object(w.jsx)("div",{className:"col-lg-6",children:Object(w.jsxs)("div",{className:"card",children:[Object(w.jsx)("div",{className:"card-header bg-dark text-white",children:"Information g\xe9n\xe9rale"}),Object(w.jsxs)("div",{className:"card-body",children:[Object(w.jsx)(Hc.Field.Select,{name:"categoryId",label:"Categorie",valueKey:"name",selectValue:o.categoryId,options:r}),Object(w.jsx)(Hc.Field.Select,{name:"fournisseurId",label:"Fournisseur",valueKey:"name",selectValue:o.fournisseurId,options:c}),Object(w.jsx)(Hc.Field.Input,{name:"name",value:null===t||void 0===t?void 0:t.name,label:"D\xe9signation",placeholder:"D\xe9signation"}),Object(w.jsx)(Hc.Field.Select,{name:"type",label:"Type d'article",emptyValue:!1,isNumeric:!1,valueKey:"name",options:[{id:"BOLUS",name:"BOLUS"},{id:"FLACON",name:"FLACON"},{id:"UNITE",name:"UNITE"},{id:"SACHET",name:"SACHET"}]}),"FLACON"===t.type&&Object(w.jsxs)("div",{className:"ml-3",children:[Object(w.jsx)(Hc.Field.Input,{name:"doseDefault",label:"Quantit\xe9 en ml ou dose ou litre",placeholder:"Quantit\xe9 en ml ou dose ou litre"}),Object(w.jsx)(Hc.Field.Select,{name:"conditionnement",label:"Conditionnement",valueKey:"name",emptyValue:!1,options:[{id:1,name:"Sans conditionnement"},{id:2,name:"Avec conditionnement"}]}),2==t.conditionnement&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(Hc.Field.Input,{name:"condml",label:"Conditionnement (ML)",placeholder:"Conditionnement en ML"}),Object(w.jsx)(Hc.Field.Input,{name:"condsize",label:"Diviser en combien de flacon",placeholder:"Diviser en combien de flacon"}),Object(w.jsx)(Hc.Field.Input,{name:"qttccpvente",label:"Quantit\xe9 de vente en ML",placeholder:"Quantit\xe9 de vente en ML"}),Object(w.jsx)(Hc.Field.Input,{name:"prixqttccvente",value:null===t||void 0===t?void 0:t.prixqttccvente,disabled:null==t.qttccpvente||""==t.qttccpvente,label:"Prix de vente equivalent \xe0 ".concat(t.qttccpvente," ML."),placeholder:"Prix de vente equivalent \xe0 ".concat(t.qttccpvente," ML.")})]})]})]})]})}),Object(w.jsxs)("div",{className:"col-lg-6",children:[Object(w.jsxs)("div",{className:"card",children:[Object(w.jsx)("div",{className:"card-header bg-dark text-white",children:"Vente"}),Object(w.jsxs)("div",{className:"card-body",children:[Object(w.jsx)(Hc.Field.Input,{name:"prixFournisseur",value:null===t||void 0===t?void 0:t.prixFournisseur,label:"prix unitaire",placeholder:"prix unitaire"}),2==t.conditionnement&&Object(w.jsx)(Hc.Field.Input,{name:"prixlitre",value:null===t||void 0===t?void 0:t.prixlitre,label:"Prix d'un litre",placeholder:"Prix d'un litre"}),Object(w.jsx)(Hc.Field.Input,{name:"prixVente",label:"Prix de vente",value:null===t||void 0===t?void 0:t.prixVente,placeholder:"prix de vente"}),"FLACON"===t.type&&Object(w.jsx)(Hc.Field.Input,{type:"text",data:0!=C&&""!=C&&S/C!="Infinity"?S/C:0,name:"prixParCC",label:"Prix de vente ml",placeholder:"Prix de vente ml"}),Object(w.jsx)(Hc.Field.Input,{value:null===t||void 0===t?void 0:t.prixVaccinateur,name:"prixVaccinateur",label:"Prix du vaccinateur",placeholder:"prix du vaccinateur"})]})]}),Object(w.jsx)("button",{className:"btn btn-green  btn-sm ",type:"submit",children:"Editer"}),Object(w.jsx)("button",{className:"btn btn-danger ml-2 btn-sm ",type:"reset",children:"Annuler"})]})]})})}})]})]})};c(347),c(348);var Ur=function(e){var t=e.model,n=e.entity,c=e.attribute,r=Object(xe.c)();return Object(u.g)(),Object(w.jsx)(w.Fragment,{children:Object(w.jsx)("button",{className:"btn btn-danger btn-sm",onClick:function(e){e.preventDefault(),window.confirm('Vous voulez vraiment supprimer "'.concat(n[c],'" ?'))&&r(qn(t).destroy(n))},children:"Supprimer"})})};c(1043),c(1044),c(1045),c(1038),c(118);var Yr=function(e){var t=e.route,n=e.edit,c=void 0===n?[]:n,r=e.detail,a=void 0===r?[]:r,i=e.remove,s=void 0===i?[]:i,d=e.model,l=e.modelKey,u=e.data;return Object(w.jsxs)("div",{children:[Object(w.jsx)(S,{scopes:a,children:Object(w.jsx)(o.b,{className:"btn btn-sm btn-primary mr-2",to:"/".concat(t,"/detail/").concat(u.row.original.id),children:"Detail"})}),Object(w.jsx)(S,{scopes:c,children:Object(w.jsx)(o.b,{className:"btn btn-sm btn-warning mr-2",to:"/".concat(t,"/edit/").concat(u.row.original.id),children:"Editer"})}),Object(w.jsx)(S,{scopes:s,children:Object(w.jsx)(Ur,{model:d,entity:u.row.original,attribute:l})})]})},Kr=function(){var e=Object(xe.d)(wn("products").value)||[],t=Object(xe.d)(wn("products").meta),n=(Object(a.useRef)(),Object(xe.c)());Object(u.g)();Object(a.useEffect)((function(){n(qn("products").fetch())}),[]);var c=[{Header:"Id",accessor:"id"},{Header:"Produit",accessor:"name"},{Header:"Fournisseur",Cell:function(e){var t,n,c;return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)("span",{className:"badge badge-primary",children:null!=(null===(t=e.row.original)||void 0===t?void 0:t.fournisseur)?null===(n=e.row.original)||void 0===n||null===(c=n.fournisseur)||void 0===c?void 0:c.name:""})})}},{Header:"Quantit\xe9",accessor:"quantityBrute"},{Header:"Reste en ML",accessor:"quantityCC"},{Header:"Prix unitaire",Cell:function(e){var t;return Object(w.jsx)("div",{children:De(null===(t=e.row.original)||void 0===t?void 0:t.prixFournisseur)})}},{Header:"Prix de vente",Cell:function(e){var t;return Object(w.jsx)("div",{children:De(null===(t=e.row.original)||void 0===t?void 0:t.prixVente)})}},{Header:"Prix en ML",Cell:function(e){var t,n,c,r;return Object(w.jsx)("div",{children:0!=(null===(t=e.row.original)||void 0===t?void 0:t.qttccpvente)?De((null===(n=e.row.original)||void 0===n?void 0:n.prixParCC)*(null===(c=e.row.original)||void 0===c?void 0:c.qttccpvente)):De(null===(r=e.row.original)||void 0===r?void 0:r.prixParCC)})}},{Header:"Actions",Cell:function(e){return Object(w.jsx)(Yr,{edit:[y.canShowEditProduit],detail:[y.canShowDetailProduit],remove:[y.canShowDeleteProduit],route:"product",model:"products",modelKey:"name",data:e})}}];return Object(w.jsxs)(qe,{children:[Object(w.jsx)(ge,{title:"Tous les produits",children:Object(w.jsx)(Ne,{title:"Tous les produits"})}),Object(w.jsx)(Se,{children:Object(w.jsx)(Zc,{data:e,scopes:[y.canShowAddProduit],meta:t,columns:c,addUrl:F,urlName:"Ajouter un produit"})})]})};var zr=function(){var e=Object(xe.d)(wn("products").value),t=Object(xe.d)(wn("categories").value),n=Object(xe.c)(),c=Object(a.useState)(1),r=Object(p.a)(c,2),i=r[0],s=r[1];return Object(a.useEffect)((function(){n(function(e){return hn("products",{path:"/product/category?id=".concat(e),replace:!0})}(i)),n(qn("categories").fetch())}),[i]),Object(w.jsxs)(qe,{children:[Object(w.jsx)(ge,{title:"Liste des articles par categories",children:Object(w.jsx)(Ne,{title:"Liste des articles par categories"})}),Object(w.jsxs)(Se,{children:[Object(w.jsxs)("div",{className:"row",children:[Object(w.jsx)("div",{className:"col-lg-8"}),Object(w.jsx)("div",{className:"col-lg-4",children:Object(w.jsxs)("div",{className:"d-flex align-items-center mb-3",children:[Object(w.jsx)("label",{htmlFor:"",children:"Categorie:"}),Object(w.jsx)("select",{className:"form-control",onChange:function(e){s(e.target.value)},children:t.map((function(e){return Object(w.jsx)("option",{value:e.id,children:e.name})}))})]})})]}),Object(w.jsxs)("table",{className:"table table-bordered table-striped",children:[Object(w.jsx)("thead",{className:"bg-thead",children:Object(w.jsxs)("tr",{children:[Object(w.jsx)("th",{children:"Nom"}),Object(w.jsx)("th",{children:"Prix Unitaire"}),Object(w.jsx)("th",{children:"Categorie"}),Object(w.jsx)("th",{children:"Actions"})]})}),Object(w.jsx)("tbody",{children:e.map((function(e){var t;return Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:null===e||void 0===e?void 0:e.name}),Object(w.jsx)("td",{children:De(null===e||void 0===e?void 0:e.prixFournisseur)}),Object(w.jsx)("td",{children:null===e||void 0===e||null===(t=e.category)||void 0===t?void 0:t.name}),Object(w.jsx)("td",{children:Object(w.jsx)(o.b,{className:"btn btn-sm btn-primary",to:"/product/detail/".concat(e.id),children:"Detail"})})]})}))})]})]})]})};var Gr=function(){var e=Object(xe.d)(wn("products").value),t=Object(xe.d)(wn("fournisseurs").value),n=Object(xe.c)(),c=Object(a.useState)(1),r=Object(p.a)(c,2),i=r[0],s=r[1];return Object(a.useEffect)((function(){n(function(e){return hn("products",{path:"/product/fournisseur?id=".concat(e),replace:!0})}(i)),n(qn("fournisseurs").fetch())}),[i]),Object(w.jsxs)(qe,{children:[Object(w.jsx)(ge,{title:"Liste des articles par fournisseurs",children:Object(w.jsx)(Ne,{title:"Liste des articles par fournisseurs"})}),Object(w.jsxs)(Se,{children:[Object(w.jsxs)("div",{className:"row",children:[Object(w.jsx)("div",{className:"col-lg-8"}),Object(w.jsx)("div",{className:"col-lg-4",children:Object(w.jsxs)("div",{className:"d-flex align-items-center mb-3",children:[Object(w.jsx)("label",{htmlFor:"",children:"Fournisseur:"}),Object(w.jsx)("select",{className:"form-control",onChange:function(e){s(e.target.value)},children:t.map((function(e){return Object(w.jsx)("option",{value:e.id,children:e.name})}))})]})})]}),Object(w.jsxs)("table",{className:"table table-bordered table-striped",children:[Object(w.jsx)("thead",{children:Object(w.jsxs)("tr",{children:[Object(w.jsx)("th",{children:"Nom"}),Object(w.jsx)("th",{children:"Prix"}),Object(w.jsx)("th",{children:"Fournisseur"}),Object(w.jsx)("td",{children:"Actions"})]})}),Object(w.jsx)("tbody",{children:e.map((function(e){var t;return Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:null===e||void 0===e?void 0:e.name}),Object(w.jsx)("td",{children:De(null===e||void 0===e?void 0:e.prixFournisseur)}),Object(w.jsx)("td",{children:null===e||void 0===e||null===(t=e.fournisseur)||void 0===t?void 0:t.name}),Object(w.jsx)("td",{children:Object(w.jsx)(o.b,{className:"btn btn-sm btn-primary",to:"/product/detail/".concat(e.id),children:"Detail"})})]})}))})]})]})]})},Wr=function(){var e=Object(xe.d)(wn("products").value),t=Object(xe.d)(wn("products").meta),n=Object(xe.c)();Object(a.useEffect)((function(){n(hn("products",{path:"/rupture/stock",replace:!0}))}),[]);var c=i.a.useMemo((function(){return[{Header:"Produit",accessor:"name"},{Header:"Quantit\xe9",accessor:"quantityBrute"},{Header:"Date de peremption",Cell:function(e){var t;return Object(w.jsx)("h3",{children:Ve(null===(t=e.row.original)||void 0===t?void 0:t.datePer)})}}]}),[]);return Object(w.jsxs)(qe,{children:[Object(w.jsx)(ge,{title:"Article en rupture de stock",children:Object(w.jsx)(Ne,{title:"Article en rupture de stock"})}),Object(w.jsx)(Se,{children:Object(w.jsx)(Zc,{data:e,meta:t,columns:c})})]})},Xr=c(1046);var Jr=function(){var e=Object(a.useState)(new Date),t=Object(p.a)(e,2),n=t[0],c=t[1],r=Object(a.useState)(new Date),i=Object(p.a)(r,2),s=i[0],d=i[1],l=function(e){if(!e||0===(null===e||void 0===e?void 0:e.length))return 0;var t=0;return e.forEach((function(e){t+=e.prixVente})),t},u=function(e){if(!e||0===(null===e||void 0===e?void 0:e.length))return 0;var t=0;return e.forEach((function(e){t+=e.quantityBrute})),t},j=function(e){if(!e||0===(null===e||void 0===e?void 0:e.length))return 0;var t=0;return e.forEach((function(e){t+=e.quantityCC})),t},b=Object(a.useRef)(null),m=Object(a.useRef)(null),O=Object(xe.d)(wn("commandes").value),h=Object(xe.c)();return Object(a.useEffect)((function(){h(function(e,t){return hn("commandes",{path:"/entree?deb=".concat(e,"&fin=").concat(t),replace:!0})}(n,s))}),[n,s]),Object(w.jsxs)(qe,{children:[Object(w.jsx)(ge,{title:"Factures",children:Object(w.jsx)(Ne,{title:"Factures"})}),Object(w.jsxs)(Se,{children:[Object(w.jsxs)("div",{className:"row",children:[Object(w.jsx)("div",{className:"col-lg-4 mb-2",children:Object(w.jsx)(o.b,{to:"/approv",className:"btn  btn-primary",children:" Effectuer un approvisionnement"})}),Object(w.jsx)("div",{className:"col-lg-8"})]}),Object(w.jsxs)("div",{className:"border p-3 bg-white",children:[Object(w.jsxs)("div",{className:"row mb-3",children:[Object(w.jsx)("div",{className:"col-lg-7"}),Object(w.jsx)("div",{className:"col-lg-5",children:Object(w.jsxs)("div",{className:"d-flex justify-content-around",children:[Object(w.jsx)("input",{type:"date",name:"datedeb",className:"form-control mr-3",format:"DD-MM-YYYY",ref:b,placeholder:"D\xe9but"}),Object(w.jsx)("input",{type:"date",name:"datefin",className:"form-control mr-3",ref:m,placeholder:"Fin"}),Object(w.jsx)(Xr.a,{onClick:function(){c(b.current.value),d(m.current.value)},children:"Filtrer"})]})})]}),Object(w.jsxs)("table",{className:"table table-bordered table-striped",children:[Object(w.jsx)("thead",{children:Object(w.jsxs)("tr",{children:[Object(w.jsx)("th",{children:"Date"}),Object(w.jsx)("th",{children:"Quantite Brute"}),Object(w.jsx)("th",{children:"Quantite en CC"}),Object(w.jsx)("th",{children:"Montant Total"}),Object(w.jsx)("th",{children:"Actions"})]})}),Object(w.jsx)("tbody",{children:O.map((function(e){return Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:null===e||void 0===e?void 0:e.createdAt}),Object(w.jsx)("td",{children:u(null===e||void 0===e?void 0:e.contenu)}),Object(w.jsx)("td",{children:j(null===e||void 0===e?void 0:e.contenu)}),Object(w.jsx)("td",{children:Object(w.jsx)(Kc.a,{value:l(null===e||void 0===e?void 0:e.contenu),displayType:"text",thousandSeparator:!0,suffix:"Ar",renderText:function(e,t){return Object(w.jsx)("div",Object(_e.a)(Object(_e.a)({},t),{},{children:e}))}})}),Object(w.jsx)("td",{className:"d-flex justify-content-around",children:Object(w.jsx)(o.b,{className:"btn btn-sm  btn-success",to:"detail/".concat(e.id),children:"Afficher le detail"})})]})}))})]})]})]})]})},Zr="ROLE_VENDEUR",$r=Object(j.a)(),ea=Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).SIGNUP_URL||"http://localhost:8100/api/signup",ta=Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).SIGNIN_URL||"http://localhost:8100/api/signin",na=(Object(u.j)((function(){return Object(w.jsxs)(i.a.Fragment,{children:[Object(w.jsx)("div",{className:"bg-dark m-0  p-2  text-center",children:Object(w.jsx)("h3",{className:"m-0 p-2 text-white",children:"CABINET VETERINAIRE AMBALAVAO"})}),Object(w.jsxs)("ul",{className:"list-inline d-flex m-0  p-2 justify-content-center",children:[Object(w.jsx)("li",{className:"text-white  m-0  p-2",children:Object(w.jsx)(o.b,{className:"btn  btn-sm bg-success text-white",to:"/journal",children:"Journal d'entrees et sorties"})}),Object(w.jsx)("li",{className:"text-white  m-0  p-2",children:Object(w.jsx)(o.b,{className:"btn  btn-sm bg-success text-white",to:H,children:"Entree"})}),Object(w.jsx)("li",{className:"text-white  m-0  p-2",children:Object(w.jsx)(o.b,{className:"btn  btn-sm bg-success text-white",to:U,children:"Sortie"})}),Object(w.jsx)("li",{className:"text-white m-0  p-2",children:Object(w.jsx)(o.b,{className:"btn btn-sm bg-success text-white",to:"/products",children:"Articles"})}),Object(w.jsx)("li",{className:"text-white m-0  p-2",children:Object(w.jsx)(o.b,{className:"btn bg-success btn-sm text-white",to:"/credit",children:"Credit"})}),Object(w.jsx)("li",{className:"text-white m-0  p-2",children:Object(w.jsx)(o.b,{className:"btn bg-success btn-sm text-white",to:k,children:"Credit Vaccinateur"})}),Object(w.jsx)("li",{className:"text-white m-0  p-2",children:Object(w.jsx)(o.b,{className:"btn bg-success btn-sm text-white",to:_,children:"Commande direct"})}),Object(w.jsx)("li",{className:"text-white m-0  p-2",children:Object(w.jsx)(o.b,{className:"btn bg-success btn-sm text-white",to:Q,children:"Produit par fournisseur"})}),Object(w.jsx)("li",{className:"text-white m-0  p-2",children:Object(w.jsx)(o.b,{className:"btn bg-success btn-sm text-white",to:L,children:"Produit par category"})}),Object(w.jsx)("li",{className:"text-white m-0  p-2",children:Object(w.jsx)(o.b,{className:"btn  btn-sm bg-success text-white",to:"/",children:"Bon de sortie"})}),Object(w.jsx)("li",{className:"text-white m-0  p-2",children:Object(w.jsx)(o.b,{className:"btn  btn-sm bg-success text-white",to:"/approv",children:"Article \xe0 approvisionner"})}),Object(w.jsx)("li",{className:"text-white m-0  p-2",children:Object(w.jsx)(o.b,{className:"btn  btn-sm bg-success text-white",to:"/perimes",children:"Article perim\xe9"})}),Object(w.jsx)("li",{className:"text-white m-0  p-2",children:Object(w.jsx)(o.b,{className:"btn  btn-sm bg-success text-white",to:I,children:"Parametres"})})]})]})})),"SET_APPROV_ITEMS"),ca="ADD_TO_APPROV",ra="REMOVE_FROM_APPROV",aa="CLEAR_APPROV",ia="ADD_QTY_APPROV_ITEM",sa="MINUS_QTY_APPROV_ITEM",da="ADD_NUMBER_QTY_ITEM",la="ADD_QTY_NUMBER_APPROV_ITEM",oa="ADD_REMISE_PER_PRODUCT",ua="ADD_REMISE_PER_PRODUCT_PERCENT",ja=function(){return{type:aa}},ba=function(e,t){return{type:oa,payload:{id:e,value:t}}},ma=function(e,t){var n=function(t){return!!(null===e||void 0===e?void 0:e.find((function(e){return(null===e||void 0===e?void 0:e.id)===t})))};return{approvisionnement:e,isItemOnApprov:n,addToApprov:function(e){n(e.id)?t(function(e){return{type:ra,payload:e}}(e.id)):t(function(e){return{type:ca,payload:e}}(e))}}},Oa=function(e){var t,n=e.key,c=e.product,r=e.isItemOnApprov,a=e.handleAddToApprov;return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(cr.a.Item,{children:Object(w.jsxs)(rr.a,{className:"product-card m-2 ".concat(c.id?"":"product-loading"),style:{border:c&&r(c.id)?"1px solid #a6a5a5":"",boxShadow:c&&r(c.id)?"0 10px 15px rgba(0, 0, 0, .07)":"none"},children:[Object(w.jsx)(ar.a,{xs:9,children:Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("p",{children:null===c||void 0===c?void 0:c.name}),Object(w.jsx)("div",{class:"badge badge-primary",children:null===c||void 0===c||null===(t=c.fournisseur)||void 0===t?void 0:t.name}),Object(w.jsx)("p",{children:Object(w.jsxs)("strong",{children:[" ",De(null===c||void 0===c?void 0:c.prixFournisseur)]})})]})}),Object(w.jsx)(ar.a,{xs:3,children:(null===c||void 0===c?void 0:c.id)&&Object(w.jsx)("button",{className:" ".concat(r(c.id)?"btn btn-danger btn-sm":"btn btn-green btn-sm"),onClick:function(){return a(c)},children:r(c.id)?"Retirer":"Ajouter"})})]})},n)})},ha=i.a.memo(Oa),xa=function(e){var t=e.product,n=Object(xe.c)(),c=function(e){n(function(e,t){return{type:la,payload:{id:e,value:t}}}(t.id,e))};return Object(w.jsx)("div",{className:"basket-item-control",children:Object(w.jsxs)(Rc.c,{w:28,bg:"whitesmoke",onChange:function(e){c(Number(e))},min:0,defaultValue:t.quantityParProduct,children:[Object(w.jsx)(Rc.d,{}),Object(w.jsxs)(Rc.e,{children:[Object(w.jsx)(Rc.b,{}),Object(w.jsx)(Rc.a,{})]})]})})},va=function(e){var t=e.product,n=e.isItemOnApprov,c=e.addToApprov,r=(Object(xe.c)(),!!n&&n(t.id));return Object(w.jsx)("div",{children:Object(w.jsxs)("div",{className:"d-flex justify-content-between align-items-start border   mb-2 p-2",children:[Object(w.jsx)("div",{style:{width:"65%"},children:Object(w.jsxs)("table",{border:"1",children:[Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:"Nom du produit : "}),Object(w.jsx)("td",{children:null===t||void 0===t?void 0:t.name})]}),Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:"Prix unitaire:"}),Object(w.jsx)("td",{children:De(t.prixFournisseur)})]}),Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:"Montant HT:"}),Object(w.jsx)("td",{children:De(t.prixFournisseur*t.quantityParProduct-t.remise)})]})]})}),Object(w.jsx)("div",{className:"d-flex mt-3",children:Object(w.jsx)(xa,{product:t})}),Object(w.jsx)("div",{children:r&&Object(w.jsx)("button",{onClick:function(){c&&c(t)},className:"btn btn-danger btn-xs text-right",children:"X"})})]})})},pa=function(e){return!(0==e.condml||0==e.condsize||0==e.qttccpvente||0==e.prixqttccvente)},fa=function(e){return e&&0!==(null===e||void 0===e?void 0:e.length)?e.reduce((function(e,t){return e+t}),0):0};function ga(e){var t,n,c;for(c in t=Array.isArray(e)?[]:{},e)n=e[c],t[c]="object"===typeof n?ga(n):n;return t}var Ca=function(e,t){return fa(e)-t},Na=function(e){e.setRegenerate;var t=Object(a.useState)(0),n=Object(p.a)(t,2),c=n[0],r=n[1],i=Object(a.useState)(new Date),s=Object(p.a)(i,2),d=s[0],l=s[1],o=Object(a.useState)(null),j=Object(p.a)(o,2),b=j[0],m=j[1],O=Object(a.useState)(""),h=Object(p.a)(O,2),x=h[0],v=h[1],f=Object(a.useState)("espece"),g=Object(p.a)(f,2),C=g[0],N=g[1],y=Object(xe.d)(wn("approvis").meta),q=Object(xe.c)(),S=Object(u.g)();Object(a.useEffect)((function(){q(qn("approvis").fetch())}),[]);var A=Object(xe.d)((function(e){return{approvisionnements:e.approvisionnements}})).approvisionnements,E=ma(A,q),P=E.isItemOnApprov,V=E.addToApprov,D=function(e){return ga(e).map((function(e){return e.quantityBrute+=e.quantityParProduct,e}))};return Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)(zc.a,{children:[Object(w.jsx)(zc.a.Header,{className:"d-flex justify-content-between align-items-center bg-dark text-white",children:Object(w.jsxs)("div",{children:["Factures ("," ".concat(A.length," ").concat(A.length>1?"produits":"produit"),")"]})}),Object(w.jsxs)(zc.a.Body,{children:[Object(w.jsxs)("div",{class:"form-group",children:[Object(w.jsx)("label",{children:"Date du facture :"}),Object(w.jsx)("div",{children:Object(w.jsx)("input",{type:"date",onChange:function(e){return m(e.target.value)},value:b,className:"form-control"})})]}),A.length<=0&&Object(w.jsx)("div",{class:"alert alert-success ",children:"Aucune produit !!!"}),null===A||void 0===A?void 0:A.map((function(e,t){return Object(w.jsx)(va,{product:e,isItemOnApprov:P,addToApprov:V,approvisionnement:A,dispatch:q},"".concat(null===e||void 0===e?void 0:e.id,"_").concat(t))})),A.length>0&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("div",{className:"d-flex justify-content-end align-items-center my-3 ",children:Object(w.jsxs)("table",{children:[Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:"REMISE : (en Ariary)"}),Object(w.jsx)("td",{children:Object(w.jsx)("input",{type:"number",className:"form-control",placeholder:"Remise",min:0,value:c,max:100,onChange:function(e){r(e.target.value)}})})]}),Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:"PAIEMENT LE :"}),Object(w.jsx)("td",{children:Object(w.jsx)("input",{type:"date",onChange:function(e){return l(e.target.value)},value:d,className:"form-control"})})]}),Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:"TYPE DE PAIEMENT:"}),Object(w.jsx)("td",{children:Object(w.jsxs)("select",{className:"form-control",onChange:function(e){N(e.target.value)},children:[Object(w.jsx)("option",{value:"espece",selected:!0,children:"ESPECE"}),Object(w.jsx)("option",{value:"boa",children:"CHEQUE - BOA"}),Object(w.jsx)("option",{value:"bni",children:"CHEQUE - BNI"}),Object(w.jsx)("option",{value:"MVola",children:"VIREMENT - MVola"}),Object(w.jsx)("option",{value:"OrangeMoney",children:"VIREMENT - ORANGE MONEY"})]})})]}),Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:"REMARQUE :"}),Object(w.jsx)("td",{children:Object(w.jsx)("textarea",{className:"form-control",onChange:function(e){v(e.target.value)},placeholder:"Ecriver ici quelque chose d'autre \xe0 savoir sur l'approvisionnement"})})]})]})}),Object(w.jsxs)("div",{className:"d-flex flex-column  my-3 ",children:[" ",Object(w.jsxs)("p",{className:"approvisionnement-total-amount",children:["Total HT:",Object(w.jsx)("strong",{children:Object(w.jsx)(Kc.a,{value:fa(A.map((function(e){return e.prixFournisseur*e.quantityParProduct}))),displayType:"text",thousandSeparator:!0,suffix:"Ar",renderText:function(e,t){return Object(w.jsx)("div",Object(_e.a)(Object(_e.a)({},t),{},{children:e}))}})})]}),Object(w.jsxs)("p",{className:"approvisionnement-total-amount",children:["Remise:",Object(w.jsx)("strong",{children:Object(w.jsx)(Kc.a,{value:fa(A.map((function(e){return e.prixFournisseur*e.quantityParProduct-e.remise}))),displayType:"text",thousandSeparator:!0,suffix:"Ar",renderText:function(e,t){return Object(w.jsx)("div",Object(_e.a)(Object(_e.a)({},t),{},{children:e}))}})})]}),Object(w.jsxs)("p",{className:"approvisionnement-total-amount",children:["Total avec remise :",Object(w.jsx)("strong",{children:Object(w.jsx)(Kc.a,{value:Ca(A.map((function(e){return e.prixFournisseur*e.quantityParProduct})),c),displayType:"text",thousandSeparator:!0,suffix:"Ar",renderText:function(e,t){return Object(w.jsx)("div",Object(_e.a)(Object(_e.a)({},t),{},{children:e}))}})})]}),Object(w.jsx)("p",{children:"Arr\xeat\xe9 \xe0 la somme de "}),Object(w.jsx)("p",{className:"text-uppercase",children:Object(w.jsxs)("strong",{children:[Object(Yc.NumberToLetter)(Ca(A.map((function(e){return e.prixFournisseur*e.quantityParProduct})),c))," ","ARIARY"]})})]}),Object(w.jsxs)("div",{className:"d-flex justify-content-end",children:[Object(w.jsx)("button",{className:"btn btn-green btn-sm mr-2",disabled:0===A.length,onClick:function(){q(qn("approvis").createTransaction({id:Number(y.nextId),contenu:D(A),totalht:fa(A.map((function(e){return e.prixFournisseur*e.quantityParProduct-e.remise}))),remise:c,total:Ca(A.map((function(e){return e.prixFournisseur*e.quantityParProduct-e.remise})),c),dateApprov:null==b?new Date:b,dateEcheance:d,remarque:x,typePaye:C,approvisionnements:A},"create-facture")),A.forEach((function(e){q(qn("products").update(Object(_e.a)(Object(_e.a)({},e),{},{quantityBrute:e.quantityBrute+e.quantityParProduct,quantityParProduct:0})))})),q(ja()),S.push(z),console.log(A)},type:"button",children:"Valider l'operation"}),Object(w.jsx)("button",{className:"btn btn-danger btn-sm",onClick:function(){0!==A.length&&q(ja())},type:"button",children:Object(w.jsx)("span",{children:"Annuler"})})]})]})]}),A.length>0&&Object(w.jsx)(zc.a.Footer,{className:"d-flex flex-column"})]})})};function ya(e){var t,n,c;for(c in t=Array.isArray(e)?[]:{},e)n=e[c],t[c]="object"===typeof n?ya(n):n;return t}var qa=function(e,t){return ya(e).filter((function(e){return""==t||e.fournisseurId==t}))};function wa(e){return e.toString().replace(/\s/g,"").toLowerCase()}function Sa(e){var t,n,c;for(c in t=Array.isArray(e)?[]:{},e)n=e[c],t[c]="object"===typeof n?Sa(n):n;return t}var Aa=function(e,t,n){return Sa(e).filter((function(e){return(""==t||wa(e.name).includes(wa(t)))&&(""==n||e.fournisseurId==n)}))},Ea=c(504),Pa=c.n(Ea),Va=function(){var e=Object(xe.d)((function(e){return e.approvisionnements})),t=Object(xe.d)(wn("products").value),n=Object(xe.d)(wn("products").meta),c=Object(xe.c)(),r=ma(e,c),a=r.isItemOnApprov,s=r.addToApprov,d=i.a.useState([]),l=Object(p.a)(d,2),o=l[0],u=l[1],j=i.a.useState(!1),b=Object(p.a)(j,2),m=b[0],O=b[1];i.a.useEffect((function(){return 1==m&&(c(qn("products").fetch()),O(!1)),function(){O(!1)}}),[m]),i.a.useEffect((function(){c(qn("products").fetch())}),[]),i.a.useEffect((function(){n.isFetching||u(t)}),[n]);var h=i.a.useCallback((function(e){s&&s(e)}),[s]),x=i.a.useMemo((function(){return o.map((function(e){return Object(w.jsx)(ha,{product:e,isItemOnApprov:a,handleAddToApprov:h},e.id)}))}),[o]),v=function(e){null!=e.target&&u(fr(t,e.target.value))};i.a.useMemo((function(){return Pa()(v,300)}),[v]);return Object(w.jsxs)("div",{children:[Object(w.jsx)("input",{type:"text",onKeyDown:function(e){13==e.keyCode&&v(e)},placeholder:"Taper sur entrer pour valider votre recherche",className:"form-control mb-2"}),Object(w.jsxs)("div",{style:{overflowY:"auto",height:"350px",maxHeight:"350px",overflowX:"hidden"},children:[Object(w.jsxs)(w.Fragment,{children:[x,0==o.length&&"Aucun produit trouv\xe9"]})," "]})]})},Da=i.a.memo(Va,ve.reactFastCompare),Fa=(Object(en.debounce)((function(e){console.log("request: ".concat(e))}),1e3),function(){return Object(w.jsxs)(qe,{children:[Object(w.jsx)(ge,{title:"Nouvelle facture",children:Object(w.jsx)(Ne,{title:"Nouvelle Facture"})}),Object(w.jsx)(Se,{children:Object(w.jsx)(xr.a,{children:Object(w.jsxs)(rr.a,{children:[Object(w.jsx)(ar.a,{xs:5,children:Object(w.jsx)(cr.a,{children:Object(w.jsxs)(zc.a,{children:[Object(w.jsx)(zc.a.Header,{className:"d-flex justify-content-between align-items-center bg-dark text-white",children:"Produits"}),Object(w.jsx)(zc.a.Body,{children:Object(w.jsx)(Da,{})})]})})}),Object(w.jsx)(ar.a,{xs:7,children:Object(w.jsx)(Na,{setRegenerate:[]})})]})})})]})}),Ra=i.a.memo(Fa),Ma=c(1056),Ba=c(1057);var Ta=function(){var e=Object(xe.d)(wn("categories").value),t=Object(xe.d)(wn("categories").meta),n=Object(xe.c)();i.a.useEffect((function(){n(qn("categories").fetch())}),[]);var c=[{Header:"Nom",accessor:"name"},{Header:"Actions",Cell:function(e){return Object(w.jsx)(Yr,{edit:[y.canEditCategory],detail:[y.canViewCategory],remove:[y.canDeleteCategory],route:"categories",model:"categories",modelKey:"name",data:e})}}];return Object(w.jsxs)(qe,{children:[Object(w.jsx)(ge,{title:"Categories",children:Object(w.jsx)(Ne,{title:"Categories"})}),Object(w.jsx)(Se,{children:Object(w.jsx)(Zc,{scopes:[y.canCreateCategory],data:e.sort((function(e,t){return t.id-e.id})),meta:t,columns:c,addUrl:ie,urlName:"Ajouter une categorie"})})]})};var ka=function(){var e=Object(xe.d)(wn("fournisseurs").value),t=Object(xe.d)(wn("fournisseurs").meta),n=Object(xe.c)();i.a.useEffect((function(){n(qn("fournisseurs").fetch())}),[]);var c=[{Header:"Nom",accessor:"name"},{Header:"Actions",Cell:function(e){return Object(w.jsx)(Yr,{edit:[y.canEditFournisseurs],detail:[y.canViewFournisseurs],remove:[y.canDeleteFournisseurs],route:"fournisseurs",model:"fournisseurs",modelKey:"name",data:e})}}];return Object(w.jsxs)(qe,{children:[Object(w.jsx)(ge,{title:"Fournisseurs",children:Object(w.jsx)(Ne,{title:"Fournisseurs"})}),Object(w.jsx)(Se,{children:Object(w.jsx)(Zc,{scopes:[y.canCreateFournisseurs],data:e.sort((function(e,t){return t.id-e.id})),meta:t,columns:c,addUrl:re,urlName:"Ajouter un fournisseur"})})]})};var _a=function(){var e=Object(xe.d)(wn("vaccinateurs").value),t=Object(xe.d)(wn("vaccinateurs").meta),n=Object(xe.c)();i.a.useEffect((function(){n(qn("vaccinateurs").fetch())}),[]);var c=[{Header:"Nom",accessor:"name"},{Header:"T\xe9l\xe9phone",accessor:"contact"},{Header:"Actions",Cell:function(e){return Object(w.jsx)(Yr,{edit:[y.canEditVaccinateur],detail:[y.canViewVaccinateur],remove:[y.canDeleteVaccinateur],route:"vaccinateurs",model:"vaccinateurs",modelKey:"name",data:e})}}];return Object(w.jsxs)(qe,{children:[Object(w.jsx)(ge,{title:"Vaccinateurs",children:Object(w.jsx)(Ne,{title:"Vaccinateurs"})}),Object(w.jsx)(Se,{children:Object(w.jsx)(Zc,{scopes:[y.canCreateVaccinateur],data:e.sort((function(e,t){return t.id-e.id})),meta:t,columns:c,addUrl:oe,urlName:"Ajouter un vaccinateur"})})]})};var Ia=function(){var e=Object(xe.d)(wn("emprunters").value),t=Object(xe.d)(wn("emprunters").meta),n=Object(xe.c)();i.a.useEffect((function(){n(qn("emprunters").fetch())}),[]);var c=[{Header:"Nom",accessor:"name"},{Header:"T\xe9l\xe9phone",accessor:"contact"},{Header:"Actions",Cell:function(e){return Object(w.jsx)(Yr,{edit:[y.canEditEmprunter],detail:[y.canViewEmprunter],remove:[y.canDeleteEmprunter],route:"emprunters",model:"emprunters",modelKey:"name",data:e})}}];return Object(w.jsxs)(qe,{children:[Object(w.jsx)(ge,{title:"D\xe9mandeurs de cr\xe9dit",children:Object(w.jsx)(Ne,{title:"D\xe9mandeurs de cr\xe9dit"})}),Object(w.jsx)(Se,{children:Object(w.jsx)(Zc,{scopes:[y.canCreateEmprunter],data:e.sort((function(e,t){return t.id-e.id})),meta:t,columns:c,addUrl:de,urlName:"Ajouter une personne"})})]})};var Qa=function(e){var t=Object(xe.c)(),n=Object(xe.d)(wn("categories").value),c=Object(xe.d)(wn("fournisseurs").value),r=Object(xe.d)(wn("vaccinateurs").value),i=Object(xe.d)(wn("emprunters").value),s=Object(xe.d)(wn("categories").meta),d=Object(xe.d)(wn("fournisseurs").meta),l=Object(xe.d)(wn("vaccinateurs").meta),o=Object(xe.d)(wn("emprunters").meta);return Object(a.useEffect)((function(){t(qn("fournisseurs").fetch()),t(qn("categories").fetch()),t(qn("vaccinateurs").fetch()),t(qn("emprunters").fetch())}),[]),Object(w.jsxs)(qe,{children:[Object(w.jsx)(ge,{title:"Parametres g\xe9n\xe9rales",children:Object(w.jsx)(Ne,{title:"Parametres g\xe9n\xe9rales"})}),Object(w.jsx)(Se,{children:Object(w.jsx)(Ma.a.Container,{id:"left-tabs-example",defaultActiveKey:"first",children:Object(w.jsxs)(rr.a,{children:[Object(w.jsxs)(Ba.a,{variant:"pills",className:"flex-row justify-content-center",children:[Object(w.jsx)(Ba.a.Item,{className:"border ml-2",children:Object(w.jsx)(Ba.a.Link,{eventKey:"first",className:"py-2 px-3 text-uppercase bg-white",children:"Categories de produits"})}),Object(w.jsx)(Ba.a.Item,{className:"border  ml-2",children:Object(w.jsx)(Ba.a.Link,{eventKey:"second",className:"py-2 px-3 text-uppercase  bg-white",children:"Fournisseurs"})}),Object(w.jsx)(Ba.a.Item,{className:"border  ml-2",children:Object(w.jsx)(Ba.a.Link,{eventKey:"three",className:"py-2 px-3 text-uppercase  bg-white",children:"Vaccinateurs"})}),Object(w.jsx)(Ba.a.Item,{className:"border  ml-2",children:Object(w.jsx)(Ba.a.Link,{eventKey:"four",className:"py-2 px-3 text-uppercase  bg-white",children:"Demandeur de credit"})})]}),Object(w.jsx)(ar.a,{sm:12,children:Object(w.jsxs)(Ma.a.Content,{children:[Object(w.jsx)(Ma.a.Pane,{eventKey:"first",children:Object(w.jsx)(Ta,{categories:n,meta:s})}),Object(w.jsx)(Ma.a.Pane,{eventKey:"second",children:Object(w.jsx)(ka,{fournisseurs:c,meta:d})}),Object(w.jsx)(Ma.a.Pane,{eventKey:"three",children:Object(w.jsx)(_a,{vaccinateurs:r,meta:l})}),Object(w.jsx)(Ma.a.Pane,{eventKey:"four",children:Object(w.jsx)(Ia,{emprunters:i,meta:o})})]})})]})})})]})};var La=function(){var e=he()().isoWeekday(1).startOf("week"),t=he()().endOf("week"),n=Object(a.useState)(e),c=Object(p.a)(n,2),r=c[0],s=c[1],d=Object(a.useState)(t),l=Object(p.a)(d,2),u=l[0],j=l[1],b=Object(a.useState)([e,t]),m=Object(p.a)(b,2),O=m[0],h=m[1];Object(a.useEffect)((function(){null!==O?(O[0]&&s(O[0]),O[1]&&j(O[1])):(s(e),j(t))}),[O]);var x=function(e){if(!e||0===(null===e||void 0===e?void 0:e.length))return 0;var t=0;return e.forEach((function(e){t+=e.prixVente*e.quantityParProductDepot})),t},v=function(e){if(!e||0===(null===e||void 0===e?void 0:e.length))return 0;var t=0;return e.forEach((function(e){t+=1*e.quantityParProductDepot})),t},f=Object(xe.d)(wn("commandes").value),g=Object(xe.d)(wn("commandes").meta),C=Object(xe.c)();Object(a.useEffect)((function(){C(function(e,t){return hn("commandes",{path:"/sortie?deb=".concat(e,"&fin=").concat(t),replace:!0})}(r,u))}),[r,u]);var N=i.a.useMemo((function(){return[{Header:"Date de commande",Cell:function(e){var t;return Object(w.jsx)(w.Fragment,{children:Ve(null===(t=e.row.original)||void 0===t?void 0:t.dateCom)})}},{Header:"Produits",Cell:function(e){var t,n,c,r;return Object(w.jsxs)("div",{style:{width:"350px"},children:[1==(null===(t=e.row.original)||void 0===t?void 0:t.isdeleted)&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("div",{className:"badge badge-danger",children:"Supprim\xe9"}),Object(w.jsxs)("div",{className:"text text-danger",children:["Date de suppression :"," ",Ve(null===(n=e.row.original)||void 0===n?void 0:n.deletedat)]})]}),null===(c=e.row.original)||void 0===c||null===(r=c.contenu)||void 0===r?void 0:r.map((function(t){var n,c;return Object(w.jsxs)("span",{children:[Object(w.jsx)("span",{style:{background:"white",color:1==(null===(n=e.row.original)||void 0===n?void 0:n.isdeleted)?"red":"inherit",padding:2},children:t.name}),Object(w.jsxs)("span",{style:{color:1==(null===(c=e.row.original)||void 0===c?void 0:c.isdeleted)?"red":"inherit"},children:[" "," || "]})]})}))]})}},{Header:"Quantit\xe9",Cell:function(e){var t;return Object(w.jsx)("div",{children:v(null===(t=e.row.original)||void 0===t?void 0:t.contenu)})}},{Header:"Total",Cell:function(e){var t;return Object(w.jsx)("div",{children:De(x(null===(t=e.row.original)||void 0===t?void 0:t.contenu))})}},{Header:"Actions",Cell:function(e){var t,n,c;return 1==(null===(t=e.row.original)||void 0===t?void 0:t.isdeleted)?null:Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(S,{scopes:[y.canShowDeleteHistoricDeSortieDepot],children:Object(w.jsx)(o.b,{to:"/depot/detail/".concat(null===(n=e.row.original)||void 0===n?void 0:n.id),className:"btn btn-green btn-sm mr-2",children:"D\xe9tails"})}),Object(w.jsx)(S,{scopes:[y.canShowEditHistoricDeSortieDepot],children:Object(w.jsx)(o.b,{to:"/editer/commande/".concat(null===(c=e.row.original)||void 0===c?void 0:c.id),className:"btn btn-warning btn-sm mr-2",children:"Editer"})}),Object(w.jsx)(S,{scopes:[y.canShowDeleteHistoricDeSortieDepot],children:Object(w.jsx)(Nr,{model:"fromdepots",entity:e.row.original})})]})}}]}),[]);return Object(w.jsxs)(qe,{children:[Object(w.jsx)(ge,{title:"Historique de sortie",children:Object(w.jsx)(Ne,{title:"Historique de sortie"})}),Object(w.jsxs)(Se,{children:[" ",Object(w.jsxs)("div",{className:"row",children:[Object(w.jsx)("div",{className:"col-lg-6",children:Object(w.jsxs)("div",{children:[Object(w.jsx)("h3",{className:"text-uppercase",children:"Historique de sortie"}),Object(w.jsx)("p",{children:"".concat(Ve(r)," ->  ").concat(Ve(u))})]})}),Object(w.jsx)("div",{className:"col-lg-6 text-right",children:Object(w.jsx)(Ee.a,{locale:"fr-FR",onChange:h,value:O})})," "]}),Object(w.jsx)(Zc,{filter:!1,data:f.sort((function(e,t){return t.id-e.id})),meta:g,columns:N})]})]})},Ha=i.a.createContext();function Ua(e){var t=e.model,n=e.options,c=e.children,r=Object(xe.d)(wn(t).value),a=Object(xe.d)(wn(t).meta),s=Object(xe.c)();i.a.useEffect((function(){s(qn(t).fetch(n))}),[n]);var d={data:r,meta:a};return Object(w.jsx)(Ha.Provider,{value:d,children:c})}function Ya(e){var t=e.children;return Object(w.jsx)(Ha.Consumer,{children:function(e){if(void 0===e)throw new Error("Data  must be used within a GetDataContext");return t(e)}})}var Ka="SET_FROM_DEPOT_ITEMS",za="ADD_FROM_DEPOT",Ga="REMOVE_FROM_TO_DEPOT",Wa="CLEAR_FROM_DEPOT",Xa="ADD_QTY_FROM_DEPOT_ITEM",Ja="ADD_QTY_PORTION_FROM_DEPOT_ITEM",Za="ADD_QTY_NUMBER_FROM_DEPOT_ITEM",$a="ADD_QTY_PORTION_DOSE_ITA_NEW_FROM_DEPOT_ITEM",ei="ADD_QTY_PORTION_DOSE_SOVAX_FROM_DEPOT_ITEM",ti="ADD_QTY_PORTION_PHYTO_COND_FROM_DEPOT_ITEM",ni="MINUS_QTY_PORTION_PHYTO_COND_FROM_DEPOT_ITEM",ci=function(){return{type:Wa}},ri=function(e){var t=e.product,n=(e.setRealQttCC,e.setRealQtt),c=(e.realQtt,e.realQttCC,Object(xe.c)()),r=function(e){c(function(e,t){return{type:Za,payload:{id:e,value:t}}}(t.id,e))},a=function(){return t.quantityBrute-1-1*t.quantityParProductDepot<0};return Object(w.jsx)("div",{className:"basket-item-control",children:Object(w.jsxs)(Rc.c,{inputMode:"numeric",w:28,disabled:0!=(null===t||void 0===t?void 0:t.condmldepot)&&0!=(null===t||void 0===t?void 0:t.qttccpventedepot),step:1,bg:"whitesmoke",onChange:function(e){r(Number(e)),n(Number(e)),1==a()&&alert("Le reste du stock est : "+t.quantityBrute+" < "+e+" demand\xe9")},min:0,defaultValue:null===t||void 0===t?void 0:t.quantityParProductDepot,max:(a(),1*(null===t||void 0===t?void 0:t.quantityBrute)),children:[Object(w.jsx)(Rc.d,{}),Object(w.jsxs)(Rc.e,{children:[Object(w.jsx)(Rc.b,{}),Object(w.jsx)(Rc.a,{})]})]})})},ai="SET_FROM_MAGASIN_ITEMS",ii="ADD_FROM_MAGASIN",si="REMOVE_FROM_TO_MAGASIN",di="CLEAR_FROM_MAGASIN",li="ADD_QTY_FROM_MAGASIN_ITEM",oi="ADD_QTY_PORTION_FROM_MAGASIN_ITEM",ui="ADD_QTY_NUMBER_FROM_MAGASIN_ITEM",ji="ADD_QTY_PORTION_DOSE_ITA_NEW_FROM_MAGASIN_ITEM",bi="ADD_QTY_PORTION_DOSE_SOVAX_FROM_MAGASIN_ITEM",mi="ADD_QTY_PORTION_PHYTO_COND_FROM_MAGASIN_ITEM",Oi="MINUS_QTY_PORTION_PHYTO_COND_FROM_MAGASIN_ITEM",hi="ADD_QTY_LITRE_NUMBER_FROM_MAGASIN_ITEM",xi="ADD_TO_QTT_BRUTE",vi=function(e,t){return{type:ji,payload:{id:e,value:t}}},pi=function(e,t){return{type:bi,payload:{id:e,value:t}}},fi=function(e,t){return{type:mi,payload:{id:e,value:t}}},gi=function(e,t){var n=function(t){return!!(null===e||void 0===e?void 0:e.find((function(e){return(null===e||void 0===e?void 0:e.id)===t})))};return{fromdepot:e,isItemFromDepot:n,addFromDepot:function(e){n(e.id)?t(function(e){return{type:Ga,payload:e}}(e.id)):t(function(e){return{type:za,payload:e}}(e))}}},Ci=function(e){var t=e.product,n=Object(a.useState)(null),c=Object(p.a)(n,2),r=c[0],i=c[1],s=Object(a.useState)(null),d=Object(p.a)(s,2),l=d[0],o=d[1],u=Object(xe.d)((function(e){return e.fromdepots})),j=Object(xe.c)(),b=gi(u,j),m=b.isItemFromDepot,O=b.addFromDepot,h=!!m&&m(t.id);return Object(w.jsx)("div",{children:Object(w.jsxs)("div",{className:"d-flex justify-content-between align-items-center border   mb-2 p-2",children:[Object(w.jsxs)("div",{style:{width:"45%"},children:[Object(w.jsx)("p",{className:"text-blue",children:t.name}),Object(w.jsx)("span",{className:"text-lowercase",children:Object(w.jsxs)("strong",{children:[0!=t.quantityParProductDepot&&De(pa(t)?t.prixlitre*t.quantityParProductDepot:t.prixVente*t.quantityParProductDepot),0==t.quantityParProductDepot&&0!=t.prixParCC&&Object(w.jsx)(w.Fragment,{children:null!=t.prixqttccventedepot&&0!=t.prixqttccventedepot?De(t.prixqttccventedepot):De(t.prixParCC)}),0!=t.quantityParProductDepot&&" x "+t.quantityParProductDepot+" "+t.type," ",null==t.prixqttccventedepot&&0==t.prixqttccventedepot&&Object(w.jsx)(w.Fragment,{children:0!=t.qttByCCDepot&&(0==t.quantityParProductDepot?" x ":"+")+t.qttByCCDepot+"ML"})]})})]}),Object(w.jsxs)("div",{className:"text-inline text-center",children:[Object(w.jsx)("h5",{className:"mb-1",children:t.type}),Object(w.jsx)(ri,{product:t,setRealQttCC:i,setRealQtt:o,realQtt:l,realQttCC:r})]}),Object(w.jsx)("div",{children:h&&Object(w.jsx)("button",{onClick:function(){O&&O(t)},className:"btn btn-danger btn-xs text-right",children:"X"})})]})})},Ni=function(e){return!!e.quantityBrute>0},yi=function(e){return!!e.quantityBrute<0},qi=function(e){return!!(e.qttByCCDepot>e.quantityCC)},wi=function(e){return qi(e)?e.qttByCCDepot-e.quantityCC:e.quantityCC-e.qttByCCDepot},Si=function(e){return Ni(e)?e.quantityBrute-=1:e.quantityBrute=0,e},Ai=function(e,t){return e.quantityCC=t,e},Ei=function(e){return function(e){Ni(e)?(console.log("hello ici"),qi(e)?(Si(e),Ai(e,e.doseDefault-wi(e))):function(e){return!(e.qttByCCDepot!=e.quantityCC)}(e)?Ai(e,0):Ai(e,e.quantityCC-e.qttByCCDepot)):e.quantityCC>0?Ai(e,e.quantityCC-e.qttByCCDepot):Ai(e,0)}(e),e},Pi=function(e){return!function(e){return!!e.condvaldepot>=0}(e)?Ni(e)?(Si(e),Ai(e,e.condmldepot-wi(e)),0==e.condvaldepot&&(e.condvaldepot=e.condsizedepot-1)):e.quantityCC-=e.qttByCCDepot:qi(e)?(!function(e){e.condvaldepot>0?e.condvaldepot-=1:e.quantityBrute>0?(Si(e),e.condvaldepot=e.condsizedepot-1):e.condvaldepot=0}(e),Ai(e,e.condmldepot-wi(e))):!function(e){return!!e.quantityCC>0}(e)?e.quantityCC=0:e.quantityCC-=e.qttByCCDepot,e},Vi=function(e){var t=e.product,n=e.index,c=e.state,r=e.setState,a=(e.setRealQttCC,e.setRealQtt),i=(e.realQtt,e.realQttCC,Object(xe.c)(),function(e){!function(e,t,n){var a=Object(me.a)(c);a[e]=Object(_e.a)(Object(_e.a)({},a[e]),{},Object(f.a)({},t,n)),r(a)}(n,"quantityParProductDepot",e)}),s=function(){return t.quantityCC-t.qttByCCDepot<0&&t.quantityBrute-1-1*t.quantityParProductDepot<0};return Object(w.jsx)("div",{className:"basket-item-control",children:Object(w.jsxs)(Rc.c,{inputMode:"numeric",w:28,disabled:0!=(null===t||void 0===t?void 0:t.condmldepot)&&0!=(null===t||void 0===t?void 0:t.qttccpventedepot),step:1,bg:"whitesmoke",onChange:function(e){i(Number(e)),a(Number(e)),s()&&alert("Le stock ne satisfait pas votre commande")},min:0,defaultValue:null===t||void 0===t?void 0:t.quantityParProductDepot,max:1==s()?1*(null===t||void 0===t?void 0:t.quantityBrute)-1:1*(null===t||void 0===t?void 0:t.quantityBrute),children:[Object(w.jsx)(Rc.d,{}),Object(w.jsxs)(Rc.e,{children:[Object(w.jsx)(Rc.b,{}),Object(w.jsx)(Rc.a,{})]})]})})},Di=function(e){var t=e.state,n=e.index,c=e.setState,r=e.product,i=Object(a.useState)(null),s=Object(p.a)(i,2),d=s[0],l=s[1],o=Object(a.useState)(null),u=Object(p.a)(o,2),j=u[0],b=u[1];return Object(w.jsx)("div",{children:Object(w.jsxs)("div",{className:"d-flex justify-content-between align-items-center border   mb-2 p-2",children:[Object(w.jsxs)("div",{style:{width:"45%"},children:[Object(w.jsx)("p",{className:"text-blue",children:r.name}),Object(w.jsx)("span",{className:"text-lowercase",children:Object(w.jsxs)("strong",{children:[0!=r.quantityParProductDepot&&De(pa(r)?r.prixlitre:r.prixVente),0==r.quantityParProductDepot&&0!=r.prixParCC&&Object(w.jsx)(w.Fragment,{children:null!=r.prixqttccventedepot&&0!=r.prixqttccventedepot?De(r.prixqttccventedepot):De(r.prixParCC)}),0!=r.quantityParProductDepot&&" x "+r.quantityParProductDepot+" "+r.type," ",null==r.prixqttccventedepot&&0==r.prixqttccventedepot&&Object(w.jsx)(w.Fragment,{children:0!=r.qttByCCDepot&&(0==r.quantityParProductDepot?" x ":"+")+r.qttByCCDepot+"ML"})]})})]}),Object(w.jsxs)("div",{className:"text-inline text-center",children:[Object(w.jsx)("h5",{className:"mb-1",children:r.type}),Object(w.jsx)(Vi,{index:n,state:t,setState:c,product:r,setRealQttCC:l,setRealQtt:b,realQtt:j,realQttCC:d})]})]})})},Fi=function(e){return!(0==e.condml||0==e.condsize||0==e.qttccpvente||0==e.prixqttccvente)},Ri=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,c=arguments.length>3?arguments[3]:void 0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"inc",a=0,i=0,s=0,d=0,l=0,o=0,u=!0,j=e.condml,b=e.condsize;if(console.log(t),"mcinc"==r){var m=Number(e.quantityCCCVA)+Number(t);Number(m)>=Number(j)?(a=Math.floor(m/Number(j)),d=Number(t)-Number(j)*a,e.quantityCCCVA+d>=Number(j)&&(a+=1)):e.quantityCCCVA+Number(t)>=Number(j)&&(a+=1);var O=Number(a)+Number(n);Number(O)>=Number(b)?(i=Math.floor(O/Number(b)),o=Number(O)-Number(b)*i,e.condval+o>=Number(b)&&(i+=1)):e.condval+Number(O)>=Number(b)&&(i+=1),e.quantityBruteCVA+i-c<0&&(u=!1)}else if("mdecinc"==r){Number(t)>=Number(j)?(a=Math.floor(Number(t)/Number(j)),d=Number(t)-Number(j)*a,e.quantityCCCVA-d<0&&(a+=1)):e.quantityCCCVA-Number(t)<0&&(a+=1);var h=Number(a);Number(h)>=Number(b)?(s=Math.floor(Number(h)/Number(b)),l=Number(h)-Number(b)*s,e.condval-l<0&&(s+=1)):e.condval-Number(h)<0&&(s+=1);var x=Number(n);Number(x)>=Number(b)?(i=Math.floor(x/Number(b)),o=Number(x)-Number(b)*i,e.condval+o>=Number(b)?i+=1:e.condval=Number(e.condval)+o):e.condval+Number(x)>=Number(b)&&(i+=1);var v=e.quantityBruteCVA+c+i;v-s<0&&(u=!1)}else if("decinc"==r){Number(t)>=Number(j)?(a=Math.floor(Number(t)/Number(j)),d=Number(t)-Number(j)*a,e.quantityCCCVA-d<0&&(a+=1)):e.quantityCCCVA-Number(t)<0&&(a+=1);var p=Number(a);Number(p)>=Number(b)?(s=Math.floor(Number(p)/Number(b)),l=Number(p)-Number(b)*s,e.condval-l<0&&(s+=1)):e.condval-Number(p)<0&&(s+=1);var f=Number(n);Number(f)>=Number(b)?(i=Math.floor(f/Number(b)),o=Number(f)-Number(b)*i,e.condval+o>=Number(b)&&(i+=1)):e.condval+Number(f)>=Number(b)&&(i+=1),e.quantityBruteCVA+i-(c+s)<0&&(u=!1)}else{var g=Number(e.quantityCCCVA)+Number(t);Number(g)>=Number(j)?(a=Math.floor(g/Number(j)),d=Number(t)-Number(j)*a,e.quantityCCCVA+d>=Number(j)&&(a+=1)):(e.quantityCCCVA+Number(t)>=Number(j)&&(a+=1),u=!0)}return u},Mi=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,c=arguments.length>3?arguments[3]:void 0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"dec",a=0,i=0,s=0,d=0,l=!0,o=e.condml,u=e.condsize;if("pcdec"==r){Number(t)>=Number(o)?(a=Math.floor(Number(t)/Number(o)),s=Number(t)-Number(o)*a,e.quantityCCCVA-s<0&&(a+=1)):e.quantityCCCVA-Number(t)<0&&(a+=1);var j=Number(a)+Number(n);Number(j)>=Number(u)?(i=Math.floor(Number(j)/Number(u)),d=Number(j)-Number(u)*i,e.condval-d<0&&(i+=1)):e.condval-Number(j)<0&&(i+=1),e.quantityBruteCVA+c-i<0&&(l=!1)}else if("mincdec"==r){var b=0,m=0,O=0,h=0,x=e.condml,v=e.condsize,p=Number(e.quantityCCCVA)+Number(t);Number(p)>=Number(x)?(b=Math.floor(p/Number(x)),O=Number(t)-Number(x)*b,e.quantityCCCVA+O>=Number(x)&&(b+=1)):e.quantityCCCVA+Number(t)>=Number(x)&&(b+=1);var f=Number(b);Number(f)>=Number(v)?(m=Math.floor(f/Number(v)),h=Number(f)-Number(v)*m,e.condval+h>=Number(v)&&(m+=1)):e.condval+Number(f)>=Number(v)&&(m+=1);var g=Number(n);Number(g)>=Number(v)?(i=Math.floor(Number(g)/Number(v)),d=Number(g)-Number(v)*b,e.condval-d<0&&(i+=1)):e.condval-Number(g)<0?i+=1:e.condval=e.condval-Number(g);var C=e.quantityBruteCVA+m+c;C-i&&(l=!1)}else if("incdec"==r){var N=0,y=0,q=0,w=0,S=e.condml,A=e.condsize,E=Number(e.quantityCCCVA)+Number(t);Number(E)>=Number(S)?(N=Math.floor(E/Number(S)),q=Number(t)-Number(S)*N,e.quantityCCCVA+q>=Number(S)&&(N+=1)):e.quantityCCCVA+Number(t)>=Number(S)&&(N+=1);var P=Number(N);Number(P)>=Number(A)?(y=Math.floor(P/Number(A)),w=Number(P)-Number(A)*y,e.condval+w>=Number(A)&&(y+=1)):e.condval+Number(P)>=Number(A)&&(y+=1);var V=Number(n);Number(V)>=Number(A)?(i=Math.floor(Number(V)/Number(A)),d=Number(V)-Number(A)*N,e.condval-d<0&&(i+=1)):e.condval-Number(V)<0&&(i+=1);var D=e.quantityBruteCVA+y,F=i+c;D-F<0&&(l=!1)}else{Number(t)>=Number(o)?(a=Math.floor(Number(t)/Number(o)),s=Number(t)-Number(o)*a,e.quantityCCCVA-s<0&&(a+=1)):e.quantityCCCVA-Number(t)<0&&(a+=1);var R=Number(a)+Number(n);Number(R)>=Number(u)?(i=Math.floor(Number(R)/Number(u)),d=Number(R)-Number(u)*i,e.condval-d<0&&(i+=1)):e.condval-Number(R)<0&&(i+=1);var M=i+c;e.quantityBruteCVA-M<0&&(l=!1)}return l},Bi=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"dec",r=0,a=0,i=e.doseDefault,s=!0;if("incdec"!=c){Number(t)>=Number(i)?(r=Math.floor(Number(t)/Number(i)),a=Number(t)-Number(i)*r,e.quantityCCCVA-a<0&&(r+=1)):e.quantityCCCVA-Number(t)<0&&(r+=1);var d=r+n;e.quantityBruteCVA-d<0&&(s=!1)}else{var l=Number(e.quantityCCCVA)+Number(t);Number(l)>=Number(i)?(r=Math.floor(l/Number(i)),a=Number(t)-Number(i)*r,e.quantityCCCVA+a>=Number(i)&&(r+=1)):e.quantityCCCVA+Number(t)>=Number(i)&&(r+=1),e.quantityBruteCVA+r-n<0&&(s=!1)}return s},Ti=function(e,t,n){var c=t.contenu.find((function(t){return t.id==e.id}));console.log("minitial",t);var r=!1,a=0,i=0,s=0,d=!0,l="none",o=n.quantityParProduct,u=n.qttByCC,j=n.qttbylitre;if(Fi(e)){r=!0,r=!1;var b=n.quantityParProduct,m=n.qttByCC,O=n.qttbylitre;console.log(b,m);var h=void 0!=c?null===c||void 0===c?void 0:c.quantityParProduct:n.condval,x=void 0!=c?null===c||void 0===c?void 0:c.qttByCC:n.quantityCCCVA,v=void 0!=c?null===c||void 0===c?void 0:c.qttbylitre:n.quantityBruteCVA;console.log(h,x,v),O==v&&b==h&&m==x&&(l="qttlitre == cmdqttlitre && qtt == cmdqtt && qttcc == cmdqttcc"),O==v&&b==h&&m>x&&(l="qttlitre == cmdqttlitre && qtt == cmdqtt && qttcc > cmdqttcc",0==(d=Mi(e,i=m-x,a,s))&&(u=x)),O==v&&b==h&&m<x&&(l="qttlitre == cmdqttlitre && qtt == cmdqtt && qttcc < cmdqttcc",i=x-m,d=!0),O==v&&b>h&&m==x&&(l="qttlitre == cmdqttlitre && qtt > cmdqtt && qttcc == cmdqttcc",0==(d=Mi(e,i,a=b-h,s))&&(o=h)),O==v&&b<h&&m==x&&(l="qttlitre == cmdqttlitre && qtt < cmdqtt && qttcc == cmdqttcc",a=h-b,d=!0),O==v&&b>h&&m>x&&(l="qttlitre == cmdqttlitre && qtt > cmdqtt && qttcc > cmdqttcc",0==(d=Mi(e,i=m-x,a=b-h,s))&&(u=x,o=h)),O==v&&b<h&&m<x&&(l="qttlitre == cmdqttlitre && qtt < cmdqtt && qttcc < cmdqttcc",a=h-b,i=x-m,d=!0),O==v&&b>h&&m<x&&(l="qttlitre == cmdqttlitre && qtt > cmdqtt && qttcc < cmdqttcc",0==(d=Mi(e,i=x-m,a=b-h,s,"incdec"))&&(u=x,o=h)),O==v&&b<h&&m>x&&(l="qttlitre == cmdqttlitre && qtt < cmdqtt && qttcc > cmdqttcc",0==(d=Ri(e,i=m-x,a=h-b,s,"decinc"))&&(u=x,o=h)),O>v&&b==h&&m==x&&(l="qttlitre > cmdqttlitre && qtt == cmdqtt && qttcc == cmdqttcc",0==(d=Mi(e,i,a,s=O-v))&&(j=v)),O<v&&b==h&&m==x&&(l="qttlitre < cmdqttlitre && qtt == cmdqtt && qttcc == cmdqttcc",s=v-O,d=!0),O>v&&b>h&&m>x&&(l="qttlitre > cmdqttlitre && qtt > cmdqtt && qttcc > cmdqttcc",0==(d=Mi(e,i=m-x,a=b-h,s=O-v))&&(u=x,o=h,j=v)),O>v&&b>h&&m<x&&(l="qttlitre > cmdqttlitre && qtt > cmdqtt && qttcc < cmdqttcc",0==(d=Mi(e,i=x-m,a=b-h,s=O-v,"incdec"))&&(u=x,o=h,j=v)),O>v&&b<h&&m>x&&(l="qttlitre > cmdqttlitre && qtt < cmdqtt && qttcc > cmdqttcc",0==(d=Ri(e,i=m-x,a=h-b,s=O-v,"decinc"))&&(u=x,o=h,j=v)),O>v&&b<h&&m<x&&(l="qttlitre > cmdqttlitre && qtt < cmdqtt && qttcc < cmdqttcc",0==(d=Ri(e,i=x-m,a=h-b,s=O-v,"mcinc"))&&(u=x,o=h,j=v)),O<v&&b>h&&m>x&&(l="qttlitre < cmdqttlitre && qtt > cmdqtt && qttcc > cmdqttcc",0==(d=Mi(e,i=m-x,a=b-h,s=v-O,"pcdec"))&&(u=x,o=h,j=v)),O<v&&b>h&&m<x&&(l="qttlitre < cmdqttlitre && qtt > cmdqtt && qttcc < cmdqttcc",0==(d=Mi(e,i=x-m,a=b-h,s=v-O,"mincdec"))&&(u=x,o=h,j=v)),O<v&&b<h&&m>x&&(l="qttlitre < cmdqttlitre && qtt < cmdqtt && qttcc > cmdqttcc",0==(d=Ri(e,i=m-x,a=h-b,s=v-O,"mdecinc"))&&(u=x,o=h,j=v)),O<v&&b<h&&m<x&&(l="qttlitre < cmdqttlitre && qtt < cmdqtt && qttcc < cmdqttcc",a=h-b,i=x-m,s=v-O,d=!0)}else{r=!1;var p=n.quantityParProduct,f=n.qttByCC;console.log(p,f);var g=void 0!=c?null===c||void 0===c?void 0:c.quantityParProduct:n.quantityBruteCVA,C=void 0!=c?null===c||void 0===c?void 0:c.qttByCC:n.quantityCCCVA;console.log(g,C),p>g&&f==C&&(l="qtt > cmdqtt && qttcc == cmdqttcc",a=p-g,console.log(e.quantityBruteCVA,a),e.quantityBruteCVA-a>=0?d=!0:(d=!1,o=g)),p<g&&f==C&&(l="qtt < cmdqtt && qttcc == cmdqttcc",a=g-p,d=!0),p==g&&f==C&&(l="qtt == cmdqtt && qttcc == cmdqttcc",d=!0),p==g&&f>C&&(l="qtt == cmdqtt && qttcc > cmdqttcc",d=Bi(e,i=f-C),u=C),p==g&&f<C&&(l="qtt == cmdqtt && qttcc < cmdqttcc",i=C-f,d=!0),p>g&&f<C&&(l="qtt > cmdqtt && qttcc < cmdqttcc",d=Bi(e,i=C-f,a=p-g,"incdec"),o=g,u=C),p<g&&f>C&&(l="qtt < cmdqtt && qttcc > cmdqttcc",a=g-p,i=f-C,d=!0),p<g&&f<C&&(a=g-p,i=C-f,l="qtt < cmdqtt && qttcc < cmdqttcc",d=!0),p>g&&f>C&&(l="qtt > cmdqtt && qttcc > cmdqttcc",d=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,c=0,r=0,a=e.doseDefault,i=!0;Number(t)>=Number(a)?(c=Math.floor(Number(t)/Number(a)),r=Number(t)-Number(a)*c,e.quantityCCCVA-r<0&&(c+=1)):e.quantityCCCVA-Number(t)<0&&(c+=1);var s=c+Number(n);return e.quantityBruteCVA-s<0&&(i=!1),i}(e,i=f-C,a=p-g),o=g,u=C)}return console.log("--------"+l+"---------"),{normalQtt:o,normalQttCC:u,normalQttLitre:j,isSpecific:r,isValid:d}},ki=function(e){return Fi(e)?0==e.quantityBruteCVA&&0==e.quantityCCCVA&&0==e.condval:0==e.quantityBruteCVA&&0==e.quantityCCCVA},_i=function(e){return e.filter((function(e){return Fi(t=e)?0==t.quantityParProduct&&0==t.qttByCC&&0==t.qttbylitre:0==t.quantityParProduct&&0==t.qttByCC;var t})).length>0},Ii=function(e){return e&&0!==(null===e||void 0===e?void 0:e.length)?e.reduce((function(e,t){return e+t}),0):0};function Qi(e){var t,n,c;for(c in t=Array.isArray(e)?[]:{},e)n=e[c],t[c]="object"===typeof n?Qi(n):n;return t}var Li=function(e){var t,n,c=e.state,r=(e.meta,e.setState),i=(e.products,e.commandes),s=e.disabled,d=Object(a.useState)("vente-depot"),l=Object(p.a)(d,2),o=l[0],j=l[1],b=Object(a.useState)(1),m=Object(p.a)(b,2),O=(m[0],m[1],Object(a.useState)(null)),h=Object(p.a)(O,2),x=h[0],v=h[1],g=Object(a.useState)(null),C=Object(p.a)(g,2),N=C[0],y=C[1],q=Object(u.g)(),S=Object(a.useState)([]),A=Object(p.a)(S,2),E=A[0],P=A[1],V=Object(xe.d)((function(e){return{fromdepots:e.fromdepots}})),D=V.fromdepots;Object(a.useEffect)((function(){P(null===i||void 0===i?void 0:i.contenu)}),[i]);var F=Object(xe.c)(),R=Object(xe.d)(wn("emprunters").value),M=Object(xe.d)(wn("vaccinateurs").value),B=new Date,T=Object(a.useState)(B),k=Object(p.a)(T,2),_=k[0],I=k[1];Object(a.useEffect)((function(){F(qn("emprunters").fetch())}),[]);return Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)(zc.a,{children:[Object(w.jsxs)(zc.a.Header,{className:" bg-dark py-2 text-white d-flex justify-content-between align-items-center",children:[Object(w.jsx)("div",{style:{width:"60%"},children:"BON DE SORTIE"}),Object(w.jsx)("div",{style:{width:"30%"},className:"text-right",children:Object(w.jsxs)("select",{disabled:s,className:"form-control input-sm",onChange:function(e){j(e.target.value)},children:[Object(w.jsx)("option",{value:"vente-depot",children:"Comptant"}),Object(w.jsx)("option",{value:"vente-depot-credit",children:"Credit"}),Object(w.jsx)("option",{value:"vente-depot-vaccinateur",children:"Vaccinateur"})]})})]}),Object(w.jsxs)("div",{className:"commande-vente",children:[Object(w.jsx)(zc.a.Body,{style:{padding:12,marginTop:3,marginRight:2,marginLeft:2},children:Object(w.jsxs)("div",{style:{overflowY:"auto",height:"350px",maxHeight:"350px",overflowX:"hidden"},children:[Object(w.jsxs)("div",{class:"form-group",children:[Object(w.jsx)("label",{children:"Date de sortie :"}),Object(w.jsx)("div",{children:Object(w.jsx)("input",{disabled:s,type:"date",onChange:function(e){return I(e.target.value)},value:_,className:"form-control"})})]}),"vente-depot-credit"===o&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("label",{children:"Crediteur:"}),Object(w.jsxs)("select",{disabled:s,className:"form-control",onChange:function(e){y(e.target.value)},children:[Object(w.jsx)("option",{value:""}),R.map((function(e){return Object(w.jsx)("option",{value:e.id,children:e.name})}))]})]}),"vente-depot-vaccinateur"===o&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("label",{children:"Vaccinateur:"}),Object(w.jsxs)("select",{className:"form-control",onChange:function(e){v(e.target.value)},children:[Object(w.jsx)("option",{children:"Selectionner un vaccinateur"}),M.map((function(e){return Object(w.jsx)("option",{value:e.id,children:e.name})}))]})]}),(null===c||void 0===c?void 0:c.length)<=0&&Object(w.jsx)("div",{className:"alert alert-success ",children:"Aucune enregistrement trouv\xe9"}),null===c||void 0===c?void 0:c.map((function(e,t){return Object(w.jsx)(Di,{product:e,state:c,index:t,setState:r,basket:D,dispatch:F},"".concat(null===e||void 0===e?void 0:e.id,"_").concat(t))}))]})}),(null===c||void 0===c?void 0:c.length)>0&&Object(w.jsxs)(zc.a.Footer,{className:"d-flex align-items-center justify-content-between",children:[Object(w.jsx)("div",{style:{width:"30%"},children:Object(w.jsx)("h2",{className:"p-2 text-uppercase bg-primary",children:Object(w.jsxs)("strong",{"data-test-id":"total-price-orders",children:["Total:",De(Ii(null===c||void 0===c?void 0:c.map((function(e){return Fi(e)?e.prixlitre*e.quantityParProductDepot:e.prixVente*e.quantityParProductDepot})))+Ii(null===c||void 0===c||null===(t=c.state)||void 0===t?void 0:t.map((function(e){return e.prixParCC*e.qttByCCDepot}))))]})})}),Object(w.jsx)("div",{style:{width:"70%"},children:(null===c||void 0===c?void 0:c.length)>0&&Object(w.jsxs)("div",{className:"d-flex text-right align-items-end justify-content-end",children:[Object(w.jsx)("button",(n={disabled:s,className:"btn btn-green btn-sm mr-2"},Object(f.a)(n,"disabled",0===(null===c||void 0===c?void 0:c.length)),Object(f.a)(n,"onClick",(function(){var e=function(){var e=Qi(E).filter((function(e){return!c.find((function(t){return e.id===t.id}))})),t=Qi(E).filter((function(e){return!c.find((function(t){return e.id===t.id}))}));return{exist:Qi(E).map((function(e){return c.find((function(t){return t.id==e.id}))})).filter((function(e){return null!=e})),added:t,missing:e}}(),t=e.exist,n=e.added,r=e.missing;F(qn("commandes").updateTransaction({id:null===i||void 0===i?void 0:i.id,contenu:c,type:"vente-depot",sorte:"sortie",vaccinateurId:x,status:"direct"===o,emprunterId:N,dateCom:null!=_?_:B,exist:t,added:n,missing:r},"update-from-depot")),q.push(U)})),Object(f.a)(n,"type","button"),Object(f.a)(n,"children","Valider l'operation"),n)),Object(w.jsx)("button",{disabled:s,className:"btn btn-danger btn-sm",onClick:function(){null===c||void 0===c||c.forEach((function(e){e.quantityParProductDepot=0,e.qttByCCDepot=0})),F(ci())},type:"button",children:Object(w.jsx)("span",{children:"Annuler"})})]})})]})]})]})})},Hi=function(e){var t,n=e.state,c=e.setState,r=e.product,a=(Object(xe.d)((function(e){return e.fromdepots})),Object(xe.c)(),!!(null===n||void 0===n?void 0:n.find((function(e){return(null===e||void 0===e?void 0:e.id)===r.id}))));return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(cr.a.Item,{className:"mb-2 mr-3",style:{border:"1px solid gray"},children:Object(w.jsx)("div",{className:" d-flex justify-content-between align-items-center",children:Object(w.jsxs)("div",{className:" ".concat(r.id?"":"product-loading"),style:{boxShadow:r&&a?"15px 10px 15px rgba(0, 0, 0, .07)":"none"},children:[Object(w.jsxs)("div",{children:[r.name," ",Object(w.jsx)("div",{class:"badge badge-primary",children:null===r||void 0===r||null===(t=r.fournisseur)||void 0===t?void 0:t.name}),Object(w.jsx)("br",{})]})," ",Object(w.jsx)("div",{children:(null===r||void 0===r?void 0:r.id)&&Object(w.jsx)(w.Fragment,{children:a?Object(w.jsx)("button",{disabled:0===r.quantityBrute&&(0==r.quantityCC||null==r.quantityCC),className:"btn btn-danger btn-sm",onClick:function(){return function(e){c(n.filter((function(t){return t.id!==e})))}(null===r||void 0===r?void 0:r.id)},children:"Retirer"}):Object(w.jsx)("button",{disabled:0===r.quantityBrute&&(0==r.quantityCC||null==r.quantityCC),className:"btn btn-green btn-sm",onClick:function(){c(n.some((function(e){return e.id===r.id}))?n:[r].concat(Object(me.a)(n)))},children:"Ajouter"})})})]})})})})},Ui=function(){var e=Object(u.i)().id,t=Object(a.useState)(!1),n=Object(p.a)(t,2),c=n[0],r=n[1],s=Object(xe.c)(),d=Object(xe.d)(wn("commandes").value),l=Object(xe.d)(wn("commandes").meta),o=Object(xe.d)(wn("products").value),j=Object(xe.d)(wn("products").meta),b=Object(a.useState)([]),m=Object(p.a)(b,2),O=m[0],h=m[1];i.a.useEffect((function(){s(qn("commandes").get(e))}),[e]);var x=Object(a.useState)(""),v=Object(p.a)(x,2),f=v[0],g=v[1],C=Object(a.useState)([]),N=Object(p.a)(C,2),y=N[0],q=N[1];i.a.useEffect((function(){return 1==c&&(s(qn("products").fetch()),r(!1)),function(){r(!1)}}),[c]),i.a.useEffect((function(){h(fr(o,f))}),[f]),i.a.useEffect((function(){s(qn("products").fetch())}),[]),i.a.useEffect((function(){var e;l.isFetching||q(null===(e=d[0])||void 0===e?void 0:e.contenu)}),[l]),i.a.useEffect((function(){j.isFetching||h(o)}),[j]);return Object(w.jsxs)(qe,{children:[Object(w.jsx)(ge,{title:"Editer un bon de commande",children:Object(w.jsx)(Ne,{title:"Editer un bon de commande"})}),Object(w.jsx)(Se,{children:Object(w.jsx)(xr.a,{children:Object(w.jsxs)(rr.a,{children:[Object(w.jsx)(ar.a,{xs:6,children:Object(w.jsx)(cr.a,{children:Object(w.jsxs)(zc.a,{children:[Object(w.jsx)(zc.a.Header,{className:"d-flex justify-content-between align-items-center bg-dark text-white",children:"Produits"}),Object(w.jsxs)(zc.a.Body,{children:[Object(w.jsx)("input",{type:"text",onChange:function(e){g(e.target.value)},placeholder:"Rechercher un produit",className:"form-control mb-2"}),Object(w.jsxs)("div",{style:{overflowY:"auto",height:"350px",maxHeight:"350px",overflowX:"hidden"},children:[Object(w.jsxs)(w.Fragment,{children:[O.map((function(e){return Object(w.jsx)(Hi,{state:y,setState:q,product:e})})),0==O.length&&"Aucune enregistrement trouv\xe9"]})," "]})]})]})})}),Object(w.jsx)(ar.a,{xs:6,children:Object(w.jsx)(Li,{disabled:j.isFetching,state:y,meta:l,setState:q,products:o,commandes:d[0]})})]})})})]})},Yi=function(){Object(a.useEffect)((function(){window.scrollTo(0,0)}),[])},Ki=["isAuth","role","component","path"],zi=function(e){var t=e.isAuth,n=e.role,c=e.component,r=e.path,a=Object(Pe.a)(e,Ki);return Yi(),Object(w.jsx)(u.b,Object(_e.a)(Object(_e.a)({},a),{},{render:function(e){var a=(e.location.state||{from:{pathname:"/"}}).from;return!t||n!==Zr||r!==G&&r!==W?Object(w.jsx)("div",{children:Object(w.jsx)(be,{title:"CBV AMBALAVAO",children:Object(w.jsx)(c,Object(_e.a)({},e))})}):Object(w.jsx)(u.a,{to:a})}}))};zi.defaultProps={isAuth:!1,role:Zr,path:"/"};Object(xe.b)((function(e){var t,n=e.auth;return{isAuth:null===n||void 0===n?void 0:n.isLoggedIn,role:(null===n||void 0===n||null===(t=n.user)||void 0===t?void 0:t.role)||""}}))(zi);function Gi(){return Rr.b().shape({username:Rr.c().required("Le nom d'utilisateur ne doit pas etre vide")})}var Wi=function(){var e=Object(xe.c)();Object(j.a)();return Object(w.jsx)("div",{children:Object(w.jsx)(Hc,{id:"login-form",enableReinitialize:!0,initialValues:{username:"",password:""},validations:Gi,onSubmit:function(t,n){var c=t.username,r=t.password;e(function(e){var t=e.username,n=e.password;return function(){var e=Object(Rn.a)(Fn.a.mark((function e(c){return Fn.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.post(ta,{username:t,password:n}).then((function(e){e.data.token&&localStorage.setItem("user-veto",JSON.stringify(e.data.token)),c({type:Tn,payload:{user:e.data,success:"success operation",error:null}}),$r.push("/")})).catch((function(e){var t,n;c({type:kn,payload:{success:null,error:null===e||void 0===e||null===(t=e.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.error}})}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}({username:c,password:r}))},render:function(e){e.values;return Object(w.jsx)(Hc.Element,{children:Object(w.jsx)("div",{className:"login-box",children:Object(w.jsx)("div",{className:"login-container  col-4",children:Object(w.jsxs)("div",{className:"card",children:[Object(w.jsx)("div",{className:"card-header d-flex flex-row justify-content-center bg-dark  text-white",children:Object(w.jsx)("div",{className:"card-title text-uppercase",children:"Connexion"})}),Object(w.jsxs)("div",{className:"card-body login-card-body",children:[Object(w.jsx)(Hc.Field.Input,{name:"username",label:"Nom d'utilisateur",placeholder:"Nom d'utilisateur"}),Object(w.jsx)(Hc.Field.Password,{name:"password",label:"Mot de passe",placeholder:"Mot de passe"}),Object(w.jsx)("div",{className:"d-flex flex-row justify-content-end mt-3",children:Object(w.jsx)("button",{className:"btn btn-green btn-md",type:"submit",children:"Se connecter"})})]})]})})})})}})})},Xi=i.a.createContext();function Ji(e){var t=e.children,n=Object(xe.d)((function(e){var t,n;return{user:null===(t=e.auth)||void 0===t?void 0:t.user,auth:e.auth,isLoggedIn:null===(n=e.auth)||void 0===n?void 0:n.isLoggedIn}})),c={user:n.user,auth:n.auth,isLoggedIn:n.isLoggedIn};return Object(w.jsx)(Xi.Provider,{value:c,children:t})}function Zi(e){var t=e.children;return Object(w.jsx)(Xi.Consumer,{children:function(e){if(void 0===e)throw new Error("Data  must be used within a AuthContext");return t(e)}})}var $i=function(){var e=Object(xe.c)();return Object(w.jsx)("div",{children:Object(w.jsx)(Ji,{children:Object(w.jsx)(Zi,{children:function(t){var n=t.user,c=t.isLoggedIn;return Object(w.jsxs)(w.Fragment,{children:[c&&Object(w.jsx)(u.a,{to:{pathname:"/",state:{notification:{message:"Vous vous  etes connect\xe9 avec succes",type:"success"}}}}),null!=(null===n||void 0===n?void 0:n.error)&&Object(w.jsx)("div",{children:null===n||void 0===n?void 0:n.error.message}),Object(w.jsx)("h3",{children:"creer un compte"}),Object(w.jsxs)("div",{borderTop:"4px",boxShadow:"md",bg:"white",px:8,py:3,w:400,children:[c&&Object(w.jsx)(u.a,{to:"/"}),Object(w.jsx)(Hc,{enableReinitialize:!0,initialValues:{username:"",password:"",role:"ROLE_VENDEUR"},validations:{},onSubmit:function(t,n){var c=t.username,r=t.password,a=t.role;e(function(e){var t=e.username,n=e.password,c=e.role;return function(){var e=Object(Rn.a)(Fn.a.mark((function e(r){return Fn.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m.a.post(ea,{username:t,password:n,role:c}).then((function(e){e.data.token&&localStorage.setItem("user-veto",JSON.stringify(e.data.token)),r({type:Mn,payload:{user:e.data,success:"success operation",error:null}}),$r.push("/")})).catch((function(e){r({type:Bn,payload:{user:null,success:null,error:e}})}));case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),r({type:Bn,payload:{user:null,success:null,error:e.t0}});case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}()}({username:c,password:r,role:a}))},children:Object(w.jsxs)(Hc.Element,{children:[Object(w.jsx)(Hc.Field.Input,{border:"1px",name:"username",label:"Nom d'utilisateur",placeholder:"ex: Nom d'utilisateur",mb:3}),Object(w.jsx)(Hc.Field.Input,{name:"password",label:"Mot de passe",placeholder:"Mot de passe",type:"password"}),Object(w.jsx)(Hc.Field.Select,{label:"Role",name:"role",valueKey:"name",options:[{id:"ROLE_VENDEUR",name:"VENDEUR"},{id:"ROLE_ADMIN",name:"ADMIN"},{id:"ROLE_SEMI_ADMIN",name:"ROLE_SEMI_ADMIN"}]}),Object(w.jsx)("div",{children:Object(w.jsx)("button",{color:"white",type:"submit",mt:4,children:"Se connecter"})})]})})]})]})}})})})},es=["isAuth","role","component"],ts=function(e){e.isAuth,e.role;var t=e.component,n=Object(Pe.a)(e,es);return Yi(),Object(w.jsx)(u.b,Object(_e.a)(Object(_e.a)({},n),{},{component:function(e){return Object(w.jsx)(t,Object(_e.a)({},e))}}))};ts.defaultProps={isAuth:!1,role:Zr};var ns=Object(xe.b)((function(e){var t,n=e.auth;return{isAuth:null===n||void 0===n?void 0:n.isLoggedIn,role:(null===n||void 0===n||null===(t=n.user)||void 0===t?void 0:t.role)||""}}))(ts),cs="SET_TO_MAGASIN_ITEMS",rs="ADD_TO_MAGASIN",as="REMOVE_FROM_MAGASIN",is="CLEAR_MAGASIN",ss="ADD_QTY_MAGASIN_ITEM",ds="MINUS_QTY_MAGASIN_ITEM",ls="ADD_QTY_NUMBER_MAGASIN_ITEM",os=function(){return{type:is}},us=function(e,t){var n=function(t){return!!(null===e||void 0===e?void 0:e.find((function(e){return(null===e||void 0===e?void 0:e.id)===t})))};return{tomagasin:e,isItemOnDepotToMagasin:n,addToMagasin:function(e){n(e.id)?t(function(e){return{type:as,payload:e}}(e.id)):t(function(e){return{type:rs,payload:e}}(e))}}},js=function(e){var t,n=e.product,c=Object(xe.d)((function(e){return e.tomagasins})),r=Object(xe.c)(),a=us(c,r),i=a.isItemOnDepotToMagasin,s=a.addToMagasin,d=!!i&&i(n.id);return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(cr.a.Item,{children:Object(w.jsxs)(rr.a,{className:"product-card m-2 ".concat(n.id?"":"product-loading"),style:{border:n&&d?"1px solid #a6a5a5":"",paddingTop:n&&d?"5px":"0px",boxShadow:n&&d?"0 10px 15px rgba(0, 0, 0, .07)":"none"},children:[Object(w.jsxs)(ar.a,{xs:9,children:[Object(w.jsxs)("div",{children:[n.name," "]}),Object(w.jsx)("div",{class:"badge badge-primary",children:null===n||void 0===n||null===(t=n.fournisseur)||void 0===t?void 0:t.name})]}),Object(w.jsx)(ar.a,{xs:3,children:n.id&&Object(w.jsx)("button",{disabled:n.quantityBrute<=0,className:" ".concat(d?"btn btn-danger btn-sm":"btn btn-green btn-sm"),onClick:function(){s&&s(n)},children:d?"Retirer":"Ajouter"})})]})})})},bs=function(e){var t=e.product,n=Object(xe.c)(),c=function(e){n(function(e,t){return{type:ls,payload:{id:e,value:t}}}(t.id,e))};return Object(w.jsx)("div",{className:"basket-item-control",children:Object(w.jsxs)(Rc.c,{w:28,bg:"whitesmoke",onChange:function(e){c(e)},min:0,defaultValue:t.quantityParProduct,step:1,max:t.quantityBrute,children:[Object(w.jsx)(Rc.d,{}),Object(w.jsxs)(Rc.e,{children:[Object(w.jsx)(Rc.b,{}),Object(w.jsx)(Rc.a,{})]})]})})},ms=function(e){var t=e.product,n=Object(xe.c)(),c=Object(xe.d)((function(e){return e.tomagasins})),r=us(c,n),a=r.isItemOnDepotToMagasin,i=r.addToMagasin,s=!!a&&a(t.id);return Object(w.jsx)("div",{children:Object(w.jsxs)("div",{className:"d-flex justify-content-between align-items-center border   mb-2 p-2",children:[Object(w.jsxs)("div",{style:{width:"45%"},children:[Object(w.jsx)("p",{children:t.name}),Object(w.jsx)("span",{children:Object(w.jsxs)("strong",{children:[" ",De(t.prixVente)]})})]}),Object(w.jsxs)("div",{className:"text-inline",children:[Object(w.jsxs)("small",{children:[t.type," "]}),Object(w.jsx)(bs,{product:t})]}),Object(w.jsx)("div",{children:s&&Object(w.jsx)("button",{onClick:function(){i&&i(t)},className:"btn btn-danger btn-xs text-right",children:"X"})})]})})},Os=function(){var e=Object(xe.d)((function(e){return{tomagasins:e.tomagasins}})).tomagasins,t=new Date,n=Object(a.useState)(t),c=Object(p.a)(n,2),r=c[0],i=c[1],s=Object(u.g)(),d=Object(xe.d)(wn("commandes").meta),l=(Object(xe.d)(wn("sortiedepots").meta),Object(xe.c)());Object(a.useEffect)((function(){l(os()),l(qn("commandes").fetch()),l(qn("sortiedepots").fetch())}),[]);var o;t.getDate(),t.getMonth(),t.getFullYear(),t.getHours(),t.getMinutes(),t.getSeconds();return Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)(zc.a,{children:[Object(w.jsx)(zc.a.Header,{className:"bg-dark text-white d-flex justify-content-between align-items-center",children:Object(w.jsxs)("div",{children:["Depot to Magasin ("," ".concat(e.length," ").concat(e.length>1?"articles":"article"),")"]})}),Object(w.jsxs)(zc.a.Body,{children:[Object(w.jsxs)("div",{class:"form-group",children:[Object(w.jsx)("label",{children:"Date de sortie :"}),Object(w.jsx)("div",{children:Object(w.jsx)("input",{type:"date",onChange:function(e){return i(e.target.value)},value:r,className:"form-control"})})]}),e.length<=0&&Object(w.jsx)("div",{class:"alert alert-success ",children:'Choississez un produit sur la section "Produits" puis cliquez sur "Ajouter"'}),null===e||void 0===e?void 0:e.map((function(t,n){return Object(w.jsx)(ms,{product:t,tomagasin:e,dispatch:l},"".concat(null===t||void 0===t?void 0:t.id,"_").concat(n))})),e.length>0&&Object(w.jsxs)("div",{className:"d-flex justify-content-end",children:[Object(w.jsx)("button",{className:"btn btn-green btn-sm mr-2",disabled:0===e.length,onClick:function(){l(qn("commandes").createTransaction({id:Number(d.nextId),contenu:e,type:"cva",sorte:"sortie",status:!0,dateCom:null!=r?r:t},"add-to-magasin")),l(os()),s.push(J)},type:"button",children:"Valider l'operation"}),Object(w.jsx)("button",{className:"btn btn-danger btn-sm",onClick:function(){0!==e.length&&l(os())},type:"button",children:Object(w.jsx)("span",{children:"Annuler"})})]})]}),e.length>0&&Object(w.jsx)(zc.a.Footer,{className:"d-flex justify-content-between",children:Object(w.jsx)("div",{children:Object(w.jsxs)("h3",{style:{fontSize:"14px"},children:[Object(w.jsx)("strong",{children:"Total : "}),De((o=e.map((function(e){return e.prixVente*e.quantityParProduct})),o&&0!==(null===o||void 0===o?void 0:o.length)?o.reduce((function(e,t){return e+t}),0):0))]})})})]})})},hs=function(){var e=Object(a.useState)([]),t=Object(p.a)(e,2),n=t[0],c=t[1],r=Object(a.useState)(!1),i=Object(p.a)(r,2),s=(i[0],i[1],Object(xe.d)(wn("products").value)),d=Object(xe.d)(wn("products").meta),l=Object(xe.c)(),o=Object(a.useState)(""),u=Object(p.a)(o,2),j=u[0],b=u[1];return Object(a.useEffect)((function(){l(qn("products").fetch())}),[]),Object(a.useEffect)((function(){d.isFetching||c(s)}),[d]),Object(a.useEffect)((function(){c(fr(s,j))}),[j]),Object(w.jsx)(xr.a,{children:Object(w.jsxs)(rr.a,{children:[Object(w.jsx)(ar.a,{xs:6,children:Object(w.jsxs)(zc.a,{children:[Object(w.jsx)(zc.a.Header,{className:"bg-dark p-2 text-white d-flex text-uppercase justify-content-between align-items-center",children:"Produits"}),Object(w.jsxs)(zc.a.Body,{children:[Object(w.jsxs)(cr.a,{children:[Object(w.jsx)("input",{type:"text",onChange:function(e){b(e.target.value)},placeholder:"Nom du produit",className:"form-control mb-2"}),Object(w.jsxs)("div",{style:{overflowY:"auto",height:"350px",maxHeight:"350px",overflowX:"hidden"},children:[n.map((function(e){return Object(w.jsx)(js,{product:e})})),0===s.length&&"Aucune enregistrement trouv\xe9"]})]})," "]})," "]})}),Object(w.jsx)(ar.a,{xs:6,children:Object(w.jsx)(Os,{})})]})})},xs=function(){return Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)(qe,{children:[Object(w.jsx)(ge,{title:"Depot vers magasin",children:Object(w.jsx)(Ne,{title:"Depot vers magasin"})}),Object(w.jsx)(Se,{children:Object(w.jsx)(hs,{})})]})})};var vs=function(e){var t=e.model,n=e.isDisabled,c=e.entity,r=Object(xe.c)(),a=Object(u.g)();return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)("button",{className:"btn btn-danger btn-sm",disabled:n,onClick:function(e){e.preventDefault(),window.confirm("Vous voulez vraiment supprimer le produit ?")&&(r(qn(t).deleteTransaction(c,"/delete-to-magasin")),a.goBack())},children:"Supprimer"})})},ps=function(e){for(var t=0;t<e.length;++t)return e[t].correction>0},fs=function(){var e=he()().isoWeekday(1).startOf("week"),t=he()().endOf("week"),n=Object(a.useState)(e),c=Object(p.a)(n,2),r=c[0],i=c[1],s=Object(a.useState)(t),d=Object(p.a)(s,2),l=d[0],u=d[1],j=Object(a.useState)([e,t]),b=Object(p.a)(j,2),m=b[0],O=b[1],h=(Object(a.useRef)(null),Object(a.useRef)(null),Object(xe.d)(wn("commandes").value)),x=Object(xe.d)(wn("commandes").meta),v=Object(xe.c)();Object(a.useEffect)((function(){v(function(e,t){return hn("commandes",{path:"/cva?deb=".concat(e,"&fin=").concat(t),replace:!0})}(r,l))}),[r,l]),Object(a.useEffect)((function(){null!==m?(m[0]&&i(m[0]),m[1]&&u(m[1])):(i(e),u(t))}),[m]);var f=function(e){if(!e||0===(null===e||void 0===e?void 0:e.length))return 0;var t=0;return e.forEach((function(e){t+=e.prixVente*e.quantityParProduct*1})),t},g=function(e){var t=0;return null===e||void 0===e||e.forEach((function(e){t+=1*e.quantityParProduct})),t},C=[{Header:"Date",Cell:function(e){var t;return Object(w.jsx)("div",{children:Ve(null===(t=e.row.original)||void 0===t?void 0:t.dateCom)})}},{Header:"Produits",Cell:function(e){var t,n,c,r,a,i;return Object(w.jsxs)("div",{style:{width:"350px"},children:[1==(null===(t=e.row.original)||void 0===t?void 0:t.isdeleted)&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("div",{className:"badge badge-danger",children:"Supprim\xe9"}),Object(w.jsxs)("div",{className:"text text-danger",children:["Date de suppression :"," ",Ve(null===(n=e.row.original)||void 0===n?void 0:n.deletedat)]})]}),null==(null===(c=e.row.original)||void 0===c?void 0:c.isdeleted)&&Object(w.jsx)("p",{children:ps(null===(r=e.row.original)||void 0===r?void 0:r.contenu)&&Object(w.jsx)("div",{className:"badge badge-warning",children:"Modifi\xe9"})}),null===(a=e.row.original)||void 0===a||null===(i=a.contenu)||void 0===i?void 0:i.map((function(t){var n,c;return Object(w.jsxs)("span",{children:[Object(w.jsx)("span",{style:{background:"white",color:1==(null===(n=e.row.original)||void 0===n?void 0:n.isdeleted)?"red":"inherit",padding:2},children:t.name}),Object(w.jsxs)("span",{style:{color:1==(null===(c=e.row.original)||void 0===c?void 0:c.isdeleted)?"red":"inherit"},children:[" "," || "]})]})}))]})}},{Header:"Qt\xe9",Cell:function(e){var t;return Object(w.jsx)("div",{children:g(null===(t=e.row.original)||void 0===t?void 0:t.contenu)})}},{Header:"Total",Cell:function(e){var t;return Object(w.jsx)("div",{children:De(f(null===(t=e.row.original)||void 0===t?void 0:t.contenu))})}},{Header:"Actions",Cell:function(e){var t,n,c,r=1==(null===(t=e.row.original)||void 0===t?void 0:t.isdeleted);return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(o.b,{to:"/depot/to/magasin/detail/".concat(null===(n=e.row.original)||void 0===n?void 0:n.id),className:"btn btn-green btn-sm mr-2",disabled:r,children:"D\xe9tails"}),Object(w.jsx)(o.b,{to:"/depot/to/magasin/edit/".concat(null===(c=e.row.original)||void 0===c?void 0:c.id),className:"btn btn-warning btn-sm mr-2",disabled:r,children:"Editer"}),Object(w.jsx)(vs,{model:"tomagasins",isDisabled:r,entity:e.row.original})]})}}];return Object(w.jsxs)(qe,{children:[Object(w.jsx)(ge,{title:"Historique sortie vers Magasin",children:Object(w.jsx)(Ne,{title:"Historique sortie vers Magasin"})}),Object(w.jsxs)(Se,{children:[Object(w.jsxs)("div",{className:"row",children:[Object(w.jsx)("div",{className:"col-lg-6",children:Object(w.jsxs)("div",{children:[Object(w.jsx)("h3",{className:"text-uppercase",children:"Historique de sortie vers Magasin"}),Object(w.jsx)("p",{children:"".concat(Ve(r)," ->  ").concat(Ve(l))})]})}),Object(w.jsx)("div",{className:"col-lg-6 text-right",children:Object(w.jsx)(Cr.a,{locale:"fr-FR",onChange:O,value:m})})," "]}),Object(w.jsx)(Zc,{filter:!1,data:h.sort((function(e,t){return t.id-e.id})),meta:x,columns:C})]})," "]})};var gs=function(e){var t=e.model,n=e.entity,c=Object(xe.c)();return Object(u.g)(),Object(w.jsx)(w.Fragment,{children:Object(w.jsx)("button",{className:"btn btn-danger btn-sm",onClick:function(e){e.preventDefault(),window.confirm("Vous voulez vraiment supprimer ce commande ?")&&c(qn(t).createTransaction({commande:n,original:n},"/delete-from-magasin"))},children:"Supprimer"})})},Cs="SET_SEARCH_BY_DATE",Ns="RESET_SEARCH_BY_DATE",ys=function(e,t){return{type:Cs,payload:{deb:e,fin:t}}},qs=function(e,t){return{type:Ns}},ws=new Date;function Ss(){var e=Object(a.useState)({hours:ws.getHours(),minutes:ws.getMinutes(),seconds:ws.getSeconds()}),t=Object(p.a)(e,2),n=t[0],c=t[1];return Object(a.useEffect)((function(){var e=setInterval((function(){var e=new Date;c({hours:e.getHours()<10?"0"+e.getHours():e.getHours(),minutes:e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes(),seconds:e.getSeconds()<10?"0"+e.getSeconds():e.getSeconds()})}),1e3);return function(){return clearInterval(e)}}),[]),Object(w.jsxs)("div",{className:"bg-dark py-1 px-4 text-center",children:[Object(w.jsxs)("h1",{style:{fontSize:"20px"},children:[n.hours," : ",n.minutes," : ",n.seconds]}),Object(w.jsx)("h4",{className:"bg-thead p-1",children:Ve(ws)})]})}var As=i.a.memo(Ss,ve.reactFastCompare);function Es(){var e=Object(u.h)();return console.log(e.pathname),Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("div",{className:"bg-dark text-white py-3 d-flex justify-content-center align-items-center",children:Object(w.jsx)("h1",{className:"",children:"CABINET VETERINAIRE AMBALAVAO"})}),Object(w.jsxs)("div",{className:"py-2",children:[Object(w.jsxs)("div",{class:"d-flex justify-content-between align-items-center",children:[Object(w.jsx)("div",{}),Object(w.jsx)("div",{children:Object(w.jsx)(As,{})}),Object(w.jsx)("div",{className:"bg-thead"})]}),Object(w.jsxs)("div",{class:"d-flex justify-content-center mt-2 align-items-center",children:[Object(w.jsx)(o.b,{className:"btn bg-".concat("/vendeur"==e.pathname||"/Vendeur"==e.pathname?"thead":"dark"," text-white mb-2 mr-2 btn-sm"),to:"/Vendeur",children:"Vente"}),Object(w.jsx)(o.b,{className:"btn bg-".concat("/historique/vente/vendeur/vente-cva"==e.pathname?"thead":"dark"," text-white mb-2 mr-2 btn-sm"),to:"/historique/vente/vendeur/vente-cva",children:"Historique de vente"}),Object(w.jsx)(o.b,{className:"btn bg-".concat("/stock-cva"==e.pathname?"thead":"dark"," text-white mb-2 mr-2 btn-sm"),to:"/stock-cva",children:"Stocks"}),Object(w.jsx)(o.b,{className:"btn bg-".concat("/historique/vente/vendeur/credit-cva"==e.pathname?"thead":"dark"," text-white mb-2 mr-2 btn-sm"),to:"/historique/vente/vendeur/credit-cva",children:"Credits"})]})]})]})}var Ps=function(e){for(var t=0;t<e.length;++t)return e[t].correction>0||e[t].correctionml>0},Vs=function(){var e=Object(xe.d)((function(e){return e.searchbydate})),t=Object(u.i)().type,n=Object(a.useState)([e.deb,e.fin]),c=Object(p.a)(n,2),r=c[0],s=c[1],d=(Object(a.useRef)(null),Object(a.useRef)(null),Object(xe.d)(wn("commandes").value)),l=Object(xe.d)(wn("commandes").meta),j=Object(xe.c)();Object(a.useEffect)((function(){j(An(e.deb,e.fin,t))}),[e.deb,e.fin]),Object(a.useEffect)((function(){null!==r&&r[0]&&j(ys(r[0],r[1]))}),[r]);var b=function(e){return e&&0!==(null===e||void 0===e?void 0:e.length)?e.reduce((function(e,t){return e+t}),0):0},m=function(e){return b(null===e||void 0===e?void 0:e.map((function(e){return Fi(e)?e.prixqttccvente*e.quantityParProduct*e.qttccpvente+e.prixlitre*e.qttbylitre:e.prixVente*e.quantityParProduct})))+b(null===e||void 0===e?void 0:e.map((function(e){return e.prixParCC*e.qttByCC})))},O=i.a.useMemo((function(){return[{Header:"Date",Cell:function(e){var t;return Object(w.jsx)(w.Fragment,{children:Ve(null===(t=e.row.original)||void 0===t?void 0:t.dateCom)})}},{Header:"Produits",Cell:function(e){var t,n,c,r;return Object(w.jsxs)("div",{style:{width:"350px"},children:[1==e.row.original.isdeleted&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("div",{className:"badge badge-danger",children:"Supprim\xe9"}),Object(w.jsxs)("div",{className:"text text-danger",children:["Date de suppression :"," ",Ve(e.row.original.deletedat)]})]}),null==(null===(t=e.row.original)||void 0===t?void 0:t.isdeleted)&&Object(w.jsx)("p",{children:Ps(null===(n=e.row.original)||void 0===n?void 0:n.contenu)&&Object(w.jsx)("div",{className:"badge badge-warning",children:"Modifi\xe9"})}),null===(c=e.row.original)||void 0===c||null===(r=c.contenu)||void 0===r?void 0:r.map((function(t){var n,c;return Object(w.jsxs)("span",{children:[Object(w.jsx)("span",{style:{background:"white",color:1==(null===(n=e.row.original)||void 0===n?void 0:n.isdeleted)?"red":"inherit",padding:2},children:t.name}),Object(w.jsxs)("span",{style:{color:1==(null===(c=e.row.original)||void 0===c?void 0:c.isdeleted)?"red":"inherit"},children:[" "," || "]})]})}))]})}},{Header:"Total",Cell:function(e){var t;return Object(w.jsx)("div",{children:De(m(null===(t=e.row.original)||void 0===t?void 0:t.contenu))})}},{Header:"Actions",Cell:function(e){var t,n;return Object(w.jsx)(w.Fragment,{children:!e.row.original.isdeleted&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(o.b,{to:"/detailvendeur/".concat(null===(t=e.row.original)||void 0===t?void 0:t.id),className:"btn btn-green btn-sm mr-2",children:"D\xe9tails"}),Object(w.jsx)(o.b,{to:"/vendeur-commande/".concat(null===(n=e.row.original)||void 0===n?void 0:n.id),className:"btn btn-warning btn-sm mr-2",children:"Editer"}),Object(w.jsx)(gs,{model:"fromagasins",entity:e.row.original})]})})}}]}),[]);return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)("div",{children:Object(w.jsxs)(xr.a,{children:[Object(w.jsx)(Es,{}),Object(w.jsxs)("div",{className:"row",children:[Object(w.jsx)("div",{className:"col-lg-6",children:Object(w.jsxs)("div",{children:[Object(w.jsx)("h3",{className:"text-uppercase",children:"vente-cva"==t?"Historique de vente":"CREDIT"}),Object(w.jsx)("p",{children:"".concat(Ve(e.deb)," ->  ").concat(Ve(e.fin))}),Object(w.jsx)("div",{className:"bg-thead p-3 my-2",style:{width:"30%"},children:Object(w.jsxs)("h2",{children:["Recette: ",De(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=e.filter((function(e){return 1!=e.isdeleted})),n=0;return d.length>0?t.map((function(e){n+=m(null===e||void 0===e?void 0:e.contenu)})):n=0,n}(d))]})})]})}),Object(w.jsx)("div",{className:"col-lg-6 text-right",children:Object(w.jsx)(Cr.a,{locale:"fr-FR",onChange:s,value:r})})," "]}),Object(w.jsx)(Zc,{data:d.sort((function(e,t){return t.id-e.id})),meta:l,columns:O,filter:!1})]})})})},Ds=function(e){return!(0==e.condml||0==e.condsize||0==e.qttccpvente||0==e.prixqttccvente)},Fs=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,c=arguments.length>3?arguments[3]:void 0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"inc",a=0,i=0,s=0,d=0,l=0,o=0,u=!0,j=e.condml,b=e.condsize;if(console.log(t),"mcinc"==r){var m=Number(e.quantityCCCVA)+Number(t);Number(m)>=Number(j)?(a=Math.floor(m/Number(j)),d=Number(t)-Number(j)*a,e.quantityCCCVA+d>=Number(j)&&(a+=1)):e.quantityCCCVA+Number(t)>=Number(j)&&(a+=1);var O=Number(a)+Number(n);Number(O)>=Number(b)?(i=Math.floor(O/Number(b)),o=Number(O)-Number(b)*i,e.condval+o>=Number(b)&&(i+=1)):e.condval+Number(O)>=Number(b)&&(i+=1),e.quantityBruteCVA+i-c<0&&(u=!1)}else if("mdecinc"==r){Number(t)>=Number(j)?(a=Math.floor(Number(t)/Number(j)),d=Number(t)-Number(j)*a,e.quantityCCCVA-d<0&&(a+=1)):e.quantityCCCVA-Number(t)<0&&(a+=1);var h=Number(a);Number(h)>=Number(b)?(s=Math.floor(Number(h)/Number(b)),l=Number(h)-Number(b)*s,e.condval-l<0&&(s+=1)):e.condval-Number(h)<0&&(s+=1);var x=Number(n);Number(x)>=Number(b)?(i=Math.floor(x/Number(b)),o=Number(x)-Number(b)*i,e.condval+o>=Number(b)?i+=1:e.condval=Number(e.condval)+o):e.condval+Number(x)>=Number(b)&&(i+=1);var v=e.quantityBruteCVA+c+i;v-s<0&&(u=!1)}else if("decinc"==r){Number(t)>=Number(j)?(a=Math.floor(Number(t)/Number(j)),d=Number(t)-Number(j)*a,e.quantityCCCVA-d<0&&(a+=1)):e.quantityCCCVA-Number(t)<0&&(a+=1);var p=Number(a);Number(p)>=Number(b)?(s=Math.floor(Number(p)/Number(b)),l=Number(p)-Number(b)*s,e.condval-l<0&&(s+=1)):e.condval-Number(p)<0&&(s+=1);var f=Number(n);Number(f)>=Number(b)?(i=Math.floor(f/Number(b)),o=Number(f)-Number(b)*i,e.condval+o>=Number(b)&&(i+=1)):e.condval+Number(f)>=Number(b)&&(i+=1),e.quantityBruteCVA+i-(c+s)<0&&(u=!1)}else{var g=Number(e.quantityCCCVA)+Number(t);Number(g)>=Number(j)?(a=Math.floor(g/Number(j)),d=Number(t)-Number(j)*a,e.quantityCCCVA+d>=Number(j)&&(a+=1)):(e.quantityCCCVA+Number(t)>=Number(j)&&(a+=1),u=!0)}return u},Rs=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,c=arguments.length>3?arguments[3]:void 0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"dec",a=0,i=0,s=0,d=0,l=!0,o=e.condml,u=e.condsize;if("pcdec"==r){Number(t)>=Number(o)?(a=Math.floor(Number(t)/Number(o)),s=Number(t)-Number(o)*a,e.quantityCCCVA-s<0&&(a+=1)):e.quantityCCCVA-Number(t)<0&&(a+=1);var j=Number(a)+Number(n);Number(j)>=Number(u)?(i=Math.floor(Number(j)/Number(u)),d=Number(j)-Number(u)*i,e.condval-d<0&&(i+=1)):e.condval-Number(j)<0&&(i+=1),e.quantityBruteCVA+c-i<0&&(l=!1)}else if("mincdec"==r){var b=0,m=0,O=0,h=0,x=e.condml,v=e.condsize,p=Number(e.quantityCCCVA)+Number(t);Number(p)>=Number(x)?(b=Math.floor(p/Number(x)),O=Number(t)-Number(x)*b,e.quantityCCCVA+O>=Number(x)&&(b+=1)):e.quantityCCCVA+Number(t)>=Number(x)&&(b+=1);var f=Number(b);Number(f)>=Number(v)?(m=Math.floor(f/Number(v)),h=Number(f)-Number(v)*m,e.condval+h>=Number(v)&&(m+=1)):e.condval+Number(f)>=Number(v)&&(m+=1);var g=Number(n);Number(g)>=Number(v)?(i=Math.floor(Number(g)/Number(v)),d=Number(g)-Number(v)*b,e.condval-d<0&&(i+=1)):e.condval-Number(g)<0?i+=1:e.condval=e.condval-Number(g);var C=e.quantityBruteCVA+m+c;C-i&&(l=!1)}else if("incdec"==r){var N=0,y=0,q=0,w=0,S=e.condml,A=e.condsize,E=Number(e.quantityCCCVA)+Number(t);Number(E)>=Number(S)?(N=Math.floor(E/Number(S)),q=Number(t)-Number(S)*N,e.quantityCCCVA+q>=Number(S)&&(N+=1)):e.quantityCCCVA+Number(t)>=Number(S)&&(N+=1);var P=Number(N);Number(P)>=Number(A)?(y=Math.floor(P/Number(A)),w=Number(P)-Number(A)*y,e.condval+w>=Number(A)&&(y+=1)):e.condval+Number(P)>=Number(A)&&(y+=1);var V=Number(n);Number(V)>=Number(A)?(i=Math.floor(Number(V)/Number(A)),d=Number(V)-Number(A)*N,e.condval-d<0&&(i+=1)):e.condval-Number(V)<0&&(i+=1);var D=e.quantityBruteCVA+y,F=i+c;D-F<0&&(l=!1)}else{Number(t)>=Number(o)?(a=Math.floor(Number(t)/Number(o)),s=Number(t)-Number(o)*a,e.quantityCCCVA-s<0&&(a+=1)):e.quantityCCCVA-Number(t)<0&&(a+=1);var R=Number(a)+Number(n);Number(R)>=Number(u)?(i=Math.floor(Number(R)/Number(u)),d=Number(R)-Number(u)*i,e.condval-d<0&&(i+=1)):e.condval-Number(R)<0&&(i+=1);var M=i+c;e.quantityBruteCVA-M<0&&(l=!1)}return l},Ms=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"dec",r=0,a=0,i=e.doseDefault,s=!0;if("incdec"!=c){Number(t)>=Number(i)?(r=Math.floor(Number(t)/Number(i)),a=Number(t)-Number(i)*r,e.quantityCCCVA-a<0&&(r+=1)):e.quantityCCCVA-Number(t)<0&&(r+=1);var d=r+n;e.quantityBruteCVA-d<0&&(s=!1)}else{var l=Number(e.quantityCCCVA)+Number(t);Number(l)>=Number(i)?(r=Math.floor(l/Number(i)),a=Number(t)-Number(i)*r,e.quantityCCCVA+a>=Number(i)&&(r+=1)):e.quantityCCCVA+Number(t)>=Number(i)&&(r+=1),e.quantityBruteCVA+r-n<0&&(s=!1)}return s},Bs=function(e,t,n){var c=t.contenu.find((function(t){return t.id==e.id}));console.log("minitial",t);var r=!1,a=0,i=0,s=0,d=!0,l="none",o=n.quantityParProduct,u=n.qttByCC,j=n.qttbylitre;if(Ds(e)){r=!0,r=!1;var b=n.quantityParProduct,m=n.qttByCC,O=n.qttbylitre;console.log(b,m);var h=void 0!=c?null===c||void 0===c?void 0:c.quantityParProduct:n.condval,x=void 0!=c?null===c||void 0===c?void 0:c.qttByCC:n.quantityCCCVA,v=void 0!=c?null===c||void 0===c?void 0:c.qttbylitre:n.quantityBruteCVA;console.log(h,x,v),O==v&&b==h&&m==x&&(l="qttlitre == cmdqttlitre && qtt == cmdqtt && qttcc == cmdqttcc"),O==v&&b==h&&m>x&&(l="qttlitre == cmdqttlitre && qtt == cmdqtt && qttcc > cmdqttcc",0==(d=Rs(e,i=m-x,a,s))&&(u=x)),O==v&&b==h&&m<x&&(l="qttlitre == cmdqttlitre && qtt == cmdqtt && qttcc < cmdqttcc",i=x-m,d=!0),O==v&&b>h&&m==x&&(l="qttlitre == cmdqttlitre && qtt > cmdqtt && qttcc == cmdqttcc",0==(d=Rs(e,i,a=b-h,s))&&(o=h)),O==v&&b<h&&m==x&&(l="qttlitre == cmdqttlitre && qtt < cmdqtt && qttcc == cmdqttcc",a=h-b,d=!0),O==v&&b>h&&m>x&&(l="qttlitre == cmdqttlitre && qtt > cmdqtt && qttcc > cmdqttcc",0==(d=Rs(e,i=m-x,a=b-h,s))&&(u=x,o=h)),O==v&&b<h&&m<x&&(l="qttlitre == cmdqttlitre && qtt < cmdqtt && qttcc < cmdqttcc",a=h-b,i=x-m,d=!0),O==v&&b>h&&m<x&&(l="qttlitre == cmdqttlitre && qtt > cmdqtt && qttcc < cmdqttcc",0==(d=Rs(e,i=x-m,a=b-h,s,"incdec"))&&(u=x,o=h)),O==v&&b<h&&m>x&&(l="qttlitre == cmdqttlitre && qtt < cmdqtt && qttcc > cmdqttcc",0==(d=Fs(e,i=m-x,a=h-b,s,"decinc"))&&(u=x,o=h)),O>v&&b==h&&m==x&&(l="qttlitre > cmdqttlitre && qtt == cmdqtt && qttcc == cmdqttcc",0==(d=Rs(e,i,a,s=O-v))&&(j=v)),O<v&&b==h&&m==x&&(l="qttlitre < cmdqttlitre && qtt == cmdqtt && qttcc == cmdqttcc",s=v-O,d=!0),O>v&&b>h&&m>x&&(l="qttlitre > cmdqttlitre && qtt > cmdqtt && qttcc > cmdqttcc",0==(d=Rs(e,i=m-x,a=b-h,s=O-v))&&(u=x,o=h,j=v)),O>v&&b>h&&m<x&&(l="qttlitre > cmdqttlitre && qtt > cmdqtt && qttcc < cmdqttcc",0==(d=Rs(e,i=x-m,a=b-h,s=O-v,"incdec"))&&(u=x,o=h,j=v)),O>v&&b<h&&m>x&&(l="qttlitre > cmdqttlitre && qtt < cmdqtt && qttcc > cmdqttcc",0==(d=Fs(e,i=m-x,a=h-b,s=O-v,"decinc"))&&(u=x,o=h,j=v)),O>v&&b<h&&m<x&&(l="qttlitre > cmdqttlitre && qtt < cmdqtt && qttcc < cmdqttcc",0==(d=Fs(e,i=x-m,a=h-b,s=O-v,"mcinc"))&&(u=x,o=h,j=v)),O<v&&b>h&&m>x&&(l="qttlitre < cmdqttlitre && qtt > cmdqtt && qttcc > cmdqttcc",0==(d=Rs(e,i=m-x,a=b-h,s=v-O,"pcdec"))&&(u=x,o=h,j=v)),O<v&&b>h&&m<x&&(l="qttlitre < cmdqttlitre && qtt > cmdqtt && qttcc < cmdqttcc",0==(d=Rs(e,i=x-m,a=b-h,s=v-O,"mincdec"))&&(u=x,o=h,j=v)),O<v&&b<h&&m>x&&(l="qttlitre < cmdqttlitre && qtt < cmdqtt && qttcc > cmdqttcc",0==(d=Fs(e,i=m-x,a=h-b,s=v-O,"mdecinc"))&&(u=x,o=h,j=v)),O<v&&b<h&&m<x&&(l="qttlitre < cmdqttlitre && qtt < cmdqtt && qttcc < cmdqttcc",a=h-b,i=x-m,s=v-O,d=!0)}else{r=!1;var p=n.quantityParProduct,f=n.qttByCC;console.log(p,f);var g=void 0!=c?null===c||void 0===c?void 0:c.quantityParProduct:n.quantityBruteCVA,C=void 0!=c?null===c||void 0===c?void 0:c.qttByCC:n.quantityCCCVA;console.log(g,C),p>g&&f==C&&(l="qtt > cmdqtt && qttcc == cmdqttcc",a=p-g,console.log(e.quantityBruteCVA,a),e.quantityBruteCVA-a>=0?d=!0:(d=!1,o=g)),p<g&&f==C&&(l="qtt < cmdqtt && qttcc == cmdqttcc",a=g-p,d=!0),p==g&&f==C&&(l="qtt == cmdqtt && qttcc == cmdqttcc",d=!0),p==g&&f>C&&(l="qtt == cmdqtt && qttcc > cmdqttcc",d=Ms(e,i=f-C),u=C),p==g&&f<C&&(l="qtt == cmdqtt && qttcc < cmdqttcc",i=C-f,d=!0),p>g&&f<C&&(l="qtt > cmdqtt && qttcc < cmdqttcc",d=Ms(e,i=C-f,a=p-g,"incdec"),o=g,u=C),p<g&&f>C&&(l="qtt < cmdqtt && qttcc > cmdqttcc",a=g-p,i=f-C,d=!0),p<g&&f<C&&(a=g-p,i=C-f,l="qtt < cmdqtt && qttcc < cmdqttcc",d=!0),p>g&&f>C&&(l="qtt > cmdqtt && qttcc > cmdqttcc",d=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,c=0,r=0,a=e.doseDefault,i=!0;Number(t)>=Number(a)?(c=Math.floor(Number(t)/Number(a)),r=Number(t)-Number(a)*c,e.quantityCCCVA-r<0&&(c+=1)):e.quantityCCCVA-Number(t)<0&&(c+=1);var s=c+Number(n);return e.quantityBruteCVA-s<0&&(i=!1),i}(e,i=f-C,a=p-g),o=g,u=C)}return console.log("--------"+l+"---------"),{normalQtt:o,normalQttCC:u,normalQttLitre:j,isSpecific:r,isValid:d}},Ts=function(e){return Ds(e)?0==e.quantityBruteCVA&&0==e.quantityCCCVA&&0==e.condval:0==e.quantityBruteCVA&&0==e.quantityCCCVA},ks=function(e){return e.filter((function(e){return Ds(t=e)?0==t.quantityParProduct&&0==t.qttByCC&&0==t.qttbylitre:0==t.quantityParProduct&&0==t.qttByCC;var t})).length>0};var _s=function(e){var t=e.model,n=e.entity,c=Object(xe.c)();return Object(u.g)(),Object(w.jsx)(w.Fragment,{children:Object(w.jsx)("button",{className:"btn btn-danger btn-sm",onClick:function(e){e.preventDefault(),window.confirm("Vous voulez vraiment supprimer ce commande ?")&&c(qn(t).createTransaction({commande:n,original:n},"/delete-from-magasin"))},children:"Supprimer"})})},Is=function(e){for(var t=0;t<e.length;++t)return e[t].correction>0||e[t].correctionml>0},Qs=function(){var e=Object(xe.d)((function(e){return e.searchbydate})),t=Object(u.i)().type,n=Object(a.useState)([e.deb,e.fin]),c=Object(p.a)(n,2),r=c[0],s=c[1],d=(Object(a.useRef)(null),Object(a.useRef)(null),Object(xe.d)(wn("commandes").value)),l=Object(xe.d)(wn("commandes").meta),j=Object(xe.c)();Object(a.useEffect)((function(){j(An(e.deb,e.fin,t))}),[e.deb,e.fin]),Object(a.useEffect)((function(){null!==r&&r[0]&&j(ys(r[0],r[1]))}),[r]);var b=function(e){return e&&0!==(null===e||void 0===e?void 0:e.length)?e.reduce((function(e,t){return e+t}),0):0},m=function(e){return b(null===e||void 0===e?void 0:e.map((function(e){return Ds(e)?e.prixqttccvente*e.quantityParProduct*e.qttccpvente+e.prixVente*e.qttbylitre:e.prixVente*e.quantityParProduct})))+b(null===e||void 0===e?void 0:e.map((function(e){return e.prixParCC*e.qttByCC})))},O=i.a.useMemo((function(){return[{Header:"Date",Cell:function(e){var t;return Object(w.jsx)(w.Fragment,{children:Ve(null===(t=e.row.original)||void 0===t?void 0:t.dateCom)})}},{Header:"Produits",Cell:function(e){var t,n,c,r,a,i;return Object(w.jsxs)("div",{style:{width:"350px"},children:[1==(null===(t=e.row.original)||void 0===t?void 0:t.isdeleted)&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("div",{className:"badge badge-danger",children:"Supprim\xe9"}),Object(w.jsxs)("div",{className:"text text-danger",children:["Date de suppression :"," ",Ve(null===(n=e.row.original)||void 0===n?void 0:n.deletedat)]})]}),null==(null===(c=e.row.original)||void 0===c?void 0:c.isdeleted)&&Object(w.jsx)("p",{children:Is(null===(r=e.row.original)||void 0===r?void 0:r.contenu)&&Object(w.jsx)("div",{className:"badge badge-warning",children:"Modifi\xe9"})}),null===(a=e.row.original)||void 0===a||null===(i=a.contenu)||void 0===i?void 0:i.map((function(t){var n,c;return Object(w.jsxs)("span",{children:[Object(w.jsx)("span",{style:{background:"white",color:1==(null===(n=e.row.original)||void 0===n?void 0:n.isdeleted)?"red":"inherit",padding:2},children:t.name}),Object(w.jsxs)("span",{style:{color:1==(null===(c=e.row.original)||void 0===c?void 0:c.isdeleted)?"red":"inherit"},children:[" "," || "]})]})}))]})}},{Header:"Total",Cell:function(e){var t;return Object(w.jsx)("div",{children:De(m(null===(t=e.row.original)||void 0===t?void 0:t.contenu))})}},{Header:"Actions",Cell:function(e){var t,n;return Object(w.jsx)(w.Fragment,{children:!(null===(t=e.row.original)||void 0===t?void 0:t.isdeleted)&&Object(w.jsxs)(w.Fragment,{children:[" ",Object(w.jsx)(o.b,{to:"/detailvendeuradmin/".concat(null===(n=e.row.original)||void 0===n?void 0:n.id),className:"btn btn-green btn-sm mr-2",children:"D\xe9tails"}),Object(w.jsx)(_s,{model:"fromagasins",entity:e.row.original})]})})}}]}),[]);return Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)(qe,{children:[Object(w.jsx)(ge,{title:"Historique de vente du magasin",children:Object(w.jsx)(Ne,{title:"Historique de vente du magasin"})}),Object(w.jsxs)(Se,{children:[Object(w.jsxs)("div",{className:"row",children:[Object(w.jsx)("div",{className:"col-lg-6",children:Object(w.jsxs)("div",{children:[Object(w.jsx)("h3",{className:"text-uppercase",children:"vente-cva"==t?"Historique de vente":"CREDIT"}),Object(w.jsx)("p",{children:"".concat(Ve(e.deb)," ->  ").concat(Ve(e.fin))}),Object(w.jsx)("div",{className:"bg-thead p-3 my-2",style:{width:"30%"},children:Object(w.jsxs)("h2",{children:["Recette: ",De(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=e.filter((function(e){return 1!=e.isdeleted})),n=0;return d.length>0?t.map((function(e){n+=m(null===e||void 0===e?void 0:e.contenu)})):n=0,n}(d))]})})]})}),Object(w.jsx)("div",{className:"col-lg-6 text-right",children:Object(w.jsx)(Cr.a,{locale:"fr-FR",onChange:s,value:r})})," "]}),Object(w.jsx)(Zc,{data:d.sort((function(e,t){return t.id-e.id})),meta:l,columns:O,filter:!1})]})," "]})})},Ls=function(){var e=Object(xe.d)(wn("products").value),t=Object(xe.d)(wn("products").meta),n=Object(xe.c)();Object(a.useEffect)((function(){n(qn("products").fetch())}),[]);var c=i.a.useMemo((function(){return[{Header:"Nom de l'article",accessor:"name"},{Header:"Fournisseur",Cell:function(e){var t,n;return Object(w.jsx)("div",{children:Object(w.jsx)("h3",{className:"badge badge-primary",children:null===(t=e.row.original)||void 0===t||null===(n=t.fournisseur)||void 0===n?void 0:n.name})})}},{Header:"Quantit\xe9",accessor:"quantityBruteCVA"},{Header:"Conditionnement (ML)",accessor:"condval"},{Header:"Reste en ML",accessor:"quantityCC",Cell:function(e){var t,n;return Object(w.jsx)("div",{children:null==(null===(t=e.row.original)||void 0===t?void 0:t.quantityCCCVA)?0:null===(n=e.row.original)||void 0===n?void 0:n.quantityCCCVA})}}]}));return Object(w.jsxs)(qe,{children:[Object(w.jsx)(ge,{title:"Etat de stock du Magasin",children:Object(w.jsx)(Ne,{title:"Etat de stock du Magasin"})}),Object(w.jsxs)(Se,{children:[Object(w.jsxs)("div",{className:"row",children:[Object(w.jsx)("div",{className:"col-lg-6",children:Object(w.jsx)("div",{children:Object(w.jsx)("h3",{className:"text-uppercase",children:"Etat de stock du Magasin"})})}),Object(w.jsx)("div",{className:"col-lg-6 text-right"})," "]}),Object(w.jsx)(Zc,{data:e,meta:t,columns:c})]})]})},Hs=function(e){for(var t=0;t<e.length;++t)return e[t].correction>0||e[t].correctionml>0},Us=function(){var e=he()().isoWeekday(1).startOf("week"),t=he()().endOf("week"),n=Object(a.useState)(e),c=Object(p.a)(n,2),r=c[0],s=c[1],d=Object(a.useState)(t),l=Object(p.a)(d,2),u=l[0],j=l[1],b=(Object(a.useRef)(null),Object(a.useRef)(null),Object(xe.d)(wn("commandes").value)),m=Object(xe.d)(wn("commandes").meta),O=Object(a.useState)([e,t]),h=Object(p.a)(O,2),x=h[0],v=h[1],f=Object(xe.c)();Object(a.useEffect)((function(){f(An(r,u))}),[r,u]),Object(a.useEffect)((function(){null!==x?(x[0]&&s(x[0]),x[1]&&j(x[1])):(s(e),j(t))}),[x]);var g=function(e){return e&&0!==(null===e||void 0===e?void 0:e.length)?e.reduce((function(e,t){return e+t}),0):0},C=function(e){return g(null===e||void 0===e?void 0:e.map((function(e){if(1!=e.isdeleted)return Fi(e)?e.prixqttccvente*e.quantityParProduct*e.qttccpvente+e.prixVente*e.qttbylitre:e.prixVente*e.quantityParProduct})))+g(null===e||void 0===e?void 0:e.map((function(e){return 1!=e.isdeleted&&e.prixParCC*e.qttByCC})))},N=i.a.useMemo((function(){return[{Header:"Date",Cell:function(e){var t;return Object(w.jsx)(w.Fragment,{children:Ve(null===(t=e.row.original)||void 0===t?void 0:t.dateCom)})}},{Header:"Produits",Cell:function(e){var t,n,c,r,a,i;return Object(w.jsxs)("div",{style:{width:"350px"},children:[1==(null===(t=e.row.original)||void 0===t?void 0:t.isdeleted)&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("div",{className:"badge badge-danger",children:"Supprim\xe9"}),Object(w.jsxs)("div",{className:"text text-danger",children:["Date de suppression :"," ",Ve(null===(n=e.row.original)||void 0===n?void 0:n.deletedat)]})]}),null==(null===(c=e.row.original)||void 0===c?void 0:c.isdeleted)&&Object(w.jsx)("p",{children:Hs(null===(r=e.row.original)||void 0===r?void 0:r.contenu)&&Object(w.jsx)("div",{className:"badge badge-warning",children:"Modifi\xe9"})}),null===(a=e.row.original)||void 0===a||null===(i=a.contenu)||void 0===i?void 0:i.map((function(t){var n,c;return Object(w.jsxs)("span",{children:[Object(w.jsx)("span",{style:{background:"white",color:1==(null===(n=e.row.original)||void 0===n?void 0:n.isdeleted)?"red":"inherit",padding:2},children:t.name}),Object(w.jsxs)("span",{style:{color:1==(null===(c=e.row.original)||void 0===c?void 0:c.isdeleted)?"red":"inherit"},children:[" "," || "]})]})}))]})}},{Header:"Total",Cell:function(e){var t;return Object(w.jsx)("div",{children:De(C(null===(t=e.row.original)||void 0===t?void 0:t.contenu))})}},{Header:"Actions",Cell:function(e){var t;return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(o.b,{className:"btn btn-sm  btn-green",to:"/magasin/detail/vente/".concat(null===(t=e.row.original)||void 0===t?void 0:t.id),children:"D\xe9tails"})})}}]}),[]);return Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)(qe,{children:[Object(w.jsx)(ge,{title:"Historique de vente du magasin",children:Object(w.jsx)(Ne,{title:"Historique de vente du magasin"})}),Object(w.jsxs)(Se,{children:[Object(w.jsxs)("div",{className:"row my-2",children:[Object(w.jsx)("div",{className:"col-lg-8",children:Object(w.jsxs)("div",{children:[r&&u&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("h2",{children:"Historique de vente du magasin"}),Object(w.jsxs)("span",{children:["Du: ",Ve(r)," Au ",Ve(u)]})]})," "]})}),Object(w.jsx)("div",{className:"col-lg-4 text-right",children:Object(w.jsx)("div",{children:Object(w.jsx)(Ee.a,{locale:"fr-FR",onChange:v,value:x})})})]}),Object(w.jsx)(Zc,{filter:!1,data:b,meta:m,columns:N})]})]})})},Ys=function(e){return e&&0!==(null===e||void 0===e?void 0:e.length)?e.reduce((function(e,t){return e+t}),0):0};var Ks=Object(u.j)((function(e){var t,n,c,r,i,s,d,l,j,b,m=Object(u.g)(),O=Object(u.i)().id,h=Object(xe.d)(wn("commandes").value),x=Object(xe.c)();return Object(a.useEffect)((function(){x(qn("commandes").get(O))}),[O]),Object(w.jsxs)("div",{children:[Object(w.jsx)("div",{className:"bg-dark text-white p-3 d-flex justify-content-center align-items-center",children:Object(w.jsx)("h1",{className:"",children:"CABINET VETERINAIRE AMBALAVAO"})}),Object(w.jsxs)("div",{className:"py-5 container",children:[Object(w.jsx)("div",{class:"d-flex justify-content-start",children:Object(w.jsx)("button",{class:"btn btn-primary btn-sm ",onClick:function(){return m.goBack()},children:"Revenir en arriere"})}),Object(w.jsxs)("div",{children:["credit-cva"==(null===(t=h[0])||void 0===t?void 0:t.type)&&Object(w.jsx)("div",{className:"bg-info my-3 py-2",children:Object(w.jsxs)(w.Fragment,{children:[Object(w.jsxs)("h3",{className:"p-2",children:["Nom:",null===(n=h[0])||void 0===n?void 0:n.emprunter.name]}),Object(w.jsxs)("h5",{className:"p-2",children:["Contact:",null===(c=h[0])||void 0===c?void 0:c.emprunter.contact]})]})}),h.length>0&&Object(w.jsxs)("div",{className:"d-flex justify-content-between",children:[Object(w.jsxs)("div",{className:"my-2",children:[Object(w.jsxs)("h2",{className:"my-2",children:["Date : ",Ve(null===(r=h[0])||void 0===r?void 0:r.dateCom)]}),Object(w.jsx)(o.b,{to:"/vendeur-commande/".concat(null===(i=h[0])||void 0===i?void 0:i.id),className:"btn btn-warning btn-sm mr-2",children:"Editer le commande"})]}),Object(w.jsx)("div",{className:"d-flex justify-content-end",children:Object(w.jsxs)("div",{className:"bg-thead p-1 mb-1",children:[Object(w.jsx)("strong",{children:"Recette:"}),":",Object(w.jsx)("h3",{className:"text-lg",children:De(Ys(null===(s=h[0])||void 0===s||null===(d=s.contenu)||void 0===d?void 0:d.map((function(e){return pa(e)?e.prixqttccvente*e.quantityParProduct*e.qttccpvente+e.prixlitre*e.qttbylitre:e.prixVente*e.quantityParProduct})))+Ys(null===(l=h[0])||void 0===l||null===(j=l.contenu)||void 0===j?void 0:j.map((function(e){return e.prixParCC*e.qttByCC}))))})]})})]}),Object(w.jsxs)("table",{className:"table table-bordered",children:[Object(w.jsxs)("tr",{className:"bg-thead",children:[Object(w.jsx)("td",{children:"Nom de l'article"}),Object(w.jsx)("td",{children:"Quantit\xe9"}),Object(w.jsx)("td",{children:"Sous total"})]}),h.length>0&&(null===(b=h[0])||void 0===b?void 0:b.contenu.map((function(e){return Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{style:{width:"40%"},children:e.name}),Object(w.jsxs)(w.Fragment,{children:[pa(e)&&Object(w.jsx)(w.Fragment,{children:0!=e.qttbylitre&&Object(w.jsxs)("div",{className:"d-flex align-items-center py-0 px-2",children:[Object(w.jsx)("strong",{children:"Litre :"}),De(e.prixlitre)," (","x"," ",e.qttbylitre,")"," "," = ",De(e.prixlitre*e.qttbylitre)]})}),0!=e.quantityParProduct&&Object(w.jsxs)("div",{className:"d-flex align-items-center py-0",children:[Object(w.jsxs)("strong",{className:"text-lowercase",children:[e.type,":"]}),De(e.prixVente)," (","x"," ",e.quantityParProduct,") "," = ",De(e.prixVente*e.quantityParProduct)]})]}),"FLACON"==e.type&&Object(w.jsx)(w.Fragment,{children:0!=e.qttByCC&&Object(w.jsxs)("div",{className:"d-flex align-items-center  py-0",children:[Object(w.jsx)("strong",{children:"ml:"})," ",De(e.prixParCC)," ","x"," ",0!=e.qttyspecificmirror?e.qttyspecificmirror+" Dose":e.qttByCC+" ml"," "," = "," ",De(e.prixParCC*e.qttByCC)]})}),Object(w.jsx)("td",{children:pa(e)?De(e.prixqttccvente*e.quantityParProduct*e.qttccpvente+e.prixlitre*e.qttbylitre+e.prixParCC*e.qttByCC):De(e.prixVente*e.quantityParProduct+e.prixParCC*e.qttByCC)})]})})))]})]})," "]})," "]})})),zs=function(e){return e&&0!==(null===e||void 0===e?void 0:e.length)?e.reduce((function(e,t){return e+t}),0):0};var Gs=Object(u.j)((function(e){Object(u.g)();var t,n,c,r,i,s,d,l,j,b,m=Object(u.i)().id,O=Object(xe.d)(wn("commandes").value),h=Object(xe.c)();return Object(a.useEffect)((function(){h(qn("commandes").get(m))}),[m]),Object(w.jsxs)(qe,{children:[Object(w.jsx)(ge,{title:"Detail de vente du magasin",children:Object(w.jsx)(Ne,{title:"Detail de vente du magasin"})}),Object(w.jsxs)(Se,{children:[Object(w.jsxs)("div",{className:"py-5 container",children:[Object(w.jsxs)("div",{children:["credit-cva"==(null===(t=O[0])||void 0===t?void 0:t.type)&&Object(w.jsx)("div",{className:"bg-info my-3 py-2",children:Object(w.jsxs)(w.Fragment,{children:[Object(w.jsxs)("h3",{className:"p-2",children:["Nom:",null===(n=O[0])||void 0===n?void 0:n.emprunter.name]}),Object(w.jsxs)("h5",{className:"p-2",children:["Contact:",null===(c=O[0])||void 0===c?void 0:c.emprunter.contact]})]})}),O.length>0&&Object(w.jsxs)("div",{className:"d-flex justify-content-between",children:[Object(w.jsxs)("div",{className:"my-2",children:[Object(w.jsxs)("h2",{className:"my-2",children:["Date : ",Ve(null===(r=O[0])||void 0===r?void 0:r.dateCom)]}),Object(w.jsx)(o.b,{to:"/vendeur-admin-commande/".concat(null===(i=O[0])||void 0===i?void 0:i.id),className:"btn btn-warning btn-sm mr-2",children:"Editer le commande"})]}),Object(w.jsx)("div",{className:"d-flex justify-content-end",children:Object(w.jsxs)("div",{className:"bg-thead p-1 mb-1",children:[Object(w.jsx)("strong",{children:"Recette:"}),":",Object(w.jsx)("h3",{className:"text-lg",children:De(zs(null===(s=O[0])||void 0===s||null===(d=s.contenu)||void 0===d?void 0:d.map((function(e){return pa(e)?e.prixqttccvente*e.quantityParProduct*e.qttccpvente+e.prixlitre*e.qttbylitre:e.prixVente*e.quantityParProduct})))+zs(null===(l=O[0])||void 0===l||null===(j=l.contenu)||void 0===j?void 0:j.map((function(e){return e.prixParCC*e.qttByCC}))))})]})})]}),Object(w.jsxs)("table",{className:"table table-bordered",children:[Object(w.jsxs)("tr",{className:"bg-thead",children:[Object(w.jsx)("td",{children:"Nom de l'article"}),Object(w.jsx)("td",{children:"Quantit\xe9"}),Object(w.jsx)("td",{children:"Sous total"})]}),O.length>0&&(null===(b=O[0])||void 0===b?void 0:b.contenu.map((function(e){return Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{style:{width:"40%"},children:e.name}),Object(w.jsxs)(w.Fragment,{children:[pa(e)&&Object(w.jsx)(w.Fragment,{children:0!=e.qttbylitre&&Object(w.jsxs)("div",{className:"d-flex align-items-center py-0 px-2",children:[Object(w.jsx)("strong",{children:"Litre :"}),De(e.prixlitre)," (","x"," ",e.qttbylitre,")"," "," = ",De(e.prixlitre*e.qttbylitre)]})}),0!=e.quantityParProduct&&Object(w.jsxs)("div",{className:"d-flex align-items-center py-0",children:[Object(w.jsxs)("strong",{className:"text-lowercase",children:[e.type,":"]}),De(e.prixVente)," (","x"," ",e.quantityParProduct,") "," = ",De(e.prixVente*e.quantityParProduct)]})]}),"FLACON"==e.type&&Object(w.jsx)(w.Fragment,{children:0!=e.qttByCC&&Object(w.jsxs)("div",{className:"d-flex align-items-center  py-0",children:[Object(w.jsx)("strong",{children:"ml:"})," ",De(e.prixParCC)," ","x"," ",0!=e.qttyspecificmirror?e.qttyspecificmirror+" Dose":e.qttByCC+" ml"," "," = "," ",De(e.prixParCC*e.qttByCC)]})}),Object(w.jsx)("td",{children:pa(e)?De(e.prixqttccvente*e.quantityParProduct*e.qttccpvente+e.prixVente*e.qttbylitre+e.prixParCC*e.qttByCC):De(e.prixVente*e.quantityParProduct+e.prixParCC*e.qttByCC)})]})})))]})]})," "]})," "]})]})})),Ws=(c(515),c(1047));c(1062),c(1048),c(1063),c(1052),c(505),c(1007),c(506);c(159);c(1049);var Xs=["isAuth","role","component"],Js=function(e){e.isAuth,e.role;var t=e.component,n=Object(Pe.a)(e,Xs);return Yi(),Object(w.jsx)(u.b,Object(_e.a)(Object(_e.a)({},n),{},{component:function(e){return Object(w.jsx)(be,{title:"CBV AMBALAVAO",children:Object(w.jsx)(t,Object(_e.a)({},e))})}}))};Js.defaultProps={isAuth:!1,role:Zr};var Zs=Object(xe.b)((function(e){var t,n=e.auth;return{isAuth:null===n||void 0===n?void 0:n.isLoggedIn,role:(null===n||void 0===n||null===(t=n.user)||void 0===t?void 0:t.role)||""}}))(Js),$s=function(e){var t=e.product,n=e.index,c=e.state,r=e.setState,a=(Object(xe.c)(),function(e){!function(e,t,n){var a=Object(me.a)(c);a[e]=Object(_e.a)(Object(_e.a)({},a[e]),{},Object(f.a)({},t,n)),r(a)}(n,"quantityParProduct",e)});return Object(w.jsx)("div",{className:"basket-item-control",children:Object(w.jsxs)(Rc.c,{w:28,bg:"whitesmoke",onChange:function(e){a(Number(e))},min:0,defaultValue:t.quantityParProduct,step:1,children:[Object(w.jsx)(Rc.d,{}),Object(w.jsxs)(Rc.e,{children:[Object(w.jsx)(Rc.b,{}),Object(w.jsx)(Rc.a,{})]})]})})},ed=function(e){var t=e.product,n=Object(xe.c)();return Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:"Remise : (en Ariary)"}),Object(w.jsxs)("td",{className:"d-flex",children:[" ",Object(w.jsxs)(Rc.c,{bg:"whitesmoke",onChange:function(e){!function(e){n(ba(t.id,e))}(Number(e))},min:0,defaultValue:t.remise,children:[Object(w.jsx)(Rc.d,{}),Object(w.jsxs)(Rc.e,{children:[Object(w.jsx)(Rc.b,{}),Object(w.jsx)(Rc.a,{})]})]})]})]})},td=function(e){var t=e.product,n=e.index,c=e.isItemOnApprov,r=(e.addToApprov,e.state),a=e.setState;Object(xe.c)(),!!c&&c(t.id);return Object(w.jsx)("div",{children:Object(w.jsxs)("div",{className:"d-flex justify-content-between align-items-start border   mb-2 p-2",children:[Object(w.jsx)("div",{style:{width:"65%"},children:Object(w.jsxs)("table",{border:"1",children:[Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:"Nom de l'article : "}),Object(w.jsx)("td",{children:null===t||void 0===t?void 0:t.name})]}),Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:"Prix unitaire:"}),Object(w.jsx)("td",{children:De(t.prixFournisseur)})]}),Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:"Montant HT:"}),Object(w.jsx)("td",{children:De(t.prixFournisseur*t.quantityParProduct)})]}),Object(w.jsx)(ed,{product:t})]})}),Object(w.jsx)("div",{className:"d-flex mt-3",children:Object(w.jsx)($s,{product:t,index:n,state:r,setState:a})}),Object(w.jsx)("div",{children:Object(w.jsx)("button",{onClick:function(){return function(e){a(r.filter((function(t){return t.id!==e})))}(null===t||void 0===t?void 0:t.id)},className:"btn btn-danger btn-xs text-right",children:"X"})})]})})};var nd=function(e){return e&&0!==(null===e||void 0===e?void 0:e.length)?e.reduce((function(e,t){return e+t}),0):0},cd=function(e,t){return nd(e)*t/100},rd=function(e,t){return nd(e)-cd(e,t)},ad=function(e){var t=e.state,n=e.meta,c=e.setState,r=e.approv,i=e.disabled,s=Object(a.useState)(null===t||void 0===t?void 0:t.remise),d=Object(p.a)(s,2),l=d[0],o=d[1],j=Object(a.useState)(null===t||void 0===t?void 0:t.dateEcheance),b=Object(p.a)(j,2),m=b[0],O=b[1],h=Object(a.useState)(null===t||void 0===t?void 0:t.dateApprov),x=Object(p.a)(h,2),v=x[0],f=x[1],g=Object(a.useState)(null===r||void 0===r?void 0:r.contenu),C=Object(p.a)(g,2),N=C[0],y=(C[1],Object(a.useState)(null===t||void 0===t?void 0:t.remarque)),q=Object(p.a)(y,2),S=q[0],A=q[1],E=Object(a.useState)(""),P=Object(p.a)(E,2),V=(P[0],P[1],Object(a.useState)(null===t||void 0===t?void 0:t.typePaye)),D=Object(p.a)(V,2),F=D[0],R=D[1],M=Object(xe.c)(),B=Object(u.g)();function T(e){var t,n,c;for(c in t=Array.isArray(e)?[]:{},e)n=e[c],t[c]="object"===typeof n?T(n):n;return t}return Object(w.jsxs)(w.Fragment,{children:[" ",Object(w.jsxs)(zc.a,{children:[Object(w.jsx)(zc.a.Header,{className:"d-flex justify-content-between align-items-center bg-dark text-white",children:Object(w.jsxs)("div",{children:["Approvisionenement ("," ".concat(null===t||void 0===t?void 0:t.length," ").concat((null===t||void 0===t?void 0:t.length)>1?"articles":"article"),")"]})}),Object(w.jsxs)(zc.a.Body,{style:{height:"500px",maxHeight:"500px",overflowY:"auto",overflowX:"hidden"},children:[Object(w.jsxs)("div",{class:"form-group",children:[Object(w.jsx)("label",{children:"Date de l'approvisionnement :"}),Object(w.jsx)("div",{children:Object(w.jsx)("input",{type:"date",disabled:i,onChange:function(e){return f(e.target.value)},value:v,className:"form-control"})})]}),!n.isFetching&&(null===t||void 0===t?void 0:t.length)<=0&&Object(w.jsxs)(w.Fragment,{children:[" ",Object(w.jsx)("div",{class:"alert alert-success ",children:"Aucune enregistrement trouv\xe9 !!!"})]}),n.isFetching&&Object(w.jsx)("p",{children:"Chargement en cours ..."}),null===t||void 0===t?void 0:t.map((function(e,n){return Object(w.jsx)(td,{product:e,state:t,index:n,setState:c,dispatch:M},"".concat(null===e||void 0===e?void 0:e.id,"_").concat(n))})),(null===t||void 0===t?void 0:t.length)>0&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("div",{className:"d-flex justify-content-end align-items-center my-3 ",children:Object(w.jsxs)("table",{children:[Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:"REMISE :"}),Object(w.jsx)("td",{children:Object(w.jsx)("input",{type:"number",className:"form-control",placeholder:"Remise",min:0,disabled:i,value:l,onChange:function(e){o(e.target.value)}})})]}),Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:"PAIEMENT LE :"}),Object(w.jsx)("td",{children:Object(w.jsx)("input",{type:"date",disabled:i,onChange:function(e){return O(e.target.value)},value:m,className:"form-control"})})]}),Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:"TYPE DE PAIEMENT:"}),Object(w.jsx)("td",{children:Object(w.jsxs)("select",{className:"form-control",onChange:function(e){R(e.target.value)},children:[Object(w.jsx)("option",{value:"espece",selected:!0,children:"ESPECE"}),Object(w.jsx)("option",{value:"boa",children:"CHEQUE - BOA"}),Object(w.jsx)("option",{value:"bni",children:"CHEQUE - BNI"}),Object(w.jsx)("option",{value:"MVola",children:"VIREMENT - MVola"}),Object(w.jsx)("option",{value:"OrangeMoney",children:"VIREMENT - ORANGE MONEY"})]})})]}),Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:"REMARQUE :"}),Object(w.jsx)("td",{children:Object(w.jsx)("textarea",{disabled:i,className:"form-control",onChange:function(e){A(e.target.value)},placeholder:"Ecriver ici quelque chose d'autre \xe0 savoir sur l'approvisionnement",children:S})})]})]})}),Object(w.jsxs)("div",{className:"d-flex flex-column  my-3 ",children:[" ",Object(w.jsxs)("p",{className:"approvisionnement-total-amount",children:["Total HT:",Object(w.jsx)("strong",{children:Object(w.jsx)(Kc.a,{value:nd(null===t||void 0===t?void 0:t.map((function(e){return e.prixFournisseur*e.quantityParProduct}))),displayType:"text",thousandSeparator:!0,suffix:"Ar",renderText:function(e,t){return Object(w.jsx)("div",Object(_e.a)(Object(_e.a)({},t),{},{children:e}))}})})]}),Object(w.jsxs)("p",{className:"approvisionnement-total-amount",children:["Remise:",Object(w.jsx)("strong",{children:Object(w.jsx)(Kc.a,{value:cd(null===t||void 0===t?void 0:t.map((function(e){return e.prixFournisseur*e.quantityParProduct})),l),displayType:"text",thousandSeparator:!0,suffix:"Ar",renderText:function(e,t){return Object(w.jsx)("div",Object(_e.a)(Object(_e.a)({},t),{},{children:e}))}})})]}),Object(w.jsxs)("p",{className:"approvisionnement-total-amount",children:["Total avec remise :",Object(w.jsx)("strong",{children:Object(w.jsx)(Kc.a,{value:rd(null===t||void 0===t?void 0:t.map((function(e){return e.prixFournisseur*e.quantityParProduct})),l),displayType:"text",thousandSeparator:!0,suffix:"Ar",renderText:function(e,t){return Object(w.jsx)("div",Object(_e.a)(Object(_e.a)({},t),{},{children:e}))}})})]}),Object(w.jsx)("p",{children:"Arr\xeat\xe9 \xe0 la somme de "}),Object(w.jsx)("p",{className:"text-uppercase",children:Object(w.jsxs)("strong",{children:[Object(Yc.NumberToLetter)(rd(null===t||void 0===t?void 0:t.map((function(e){return e.prixFournisseur*e.quantityParProduct})),l))," ","ARIARY"]})})]})]})]}),Object(w.jsx)(zc.a.Footer,{children:Object(w.jsxs)("div",{className:"d-flex justify-content-end",children:[Object(w.jsx)("button",{disabled:i,className:"btn btn-green btn-sm mr-2",onClick:function(){var e=function(){var e=T(N).filter((function(e){return!t.find((function(t){return e.id===t.id}))})),n=T(N).filter((function(e){return!t.find((function(t){return e.id===t.id}))}));return{exist:T(N).map((function(e){return t.find((function(t){return t.id==e.id}))})).filter((function(e){return null!=e})),added:n,missing:e}}(),n=e.exist,c=e.added,a=e.missing;M(qn("approvis").updateTransaction({id:null===r||void 0===r?void 0:r.id,contenu:t,totalht:nd(t.map((function(e){return e.prixFournisseur*e.quantityParProduct-e.remise}))),remise:l,total:rd(t.map((function(e){return e.prixFournisseur*e.quantityParProduct-e.remise})),l),dateApprov:v,dateEcheance:m,remarque:S,typePaye:F,exist:n,missing:a,added:c},"update-facture")),B.push(z)},type:"button",children:"Valider l'operation"}),Object(w.jsx)("button",{disabled:i,className:"btn btn-danger btn-sm",onClick:function(){return c(null===r||void 0===r?void 0:r.contenu)},type:"button",children:Object(w.jsx)("span",{children:"Annuler"})})]})})]})]})},id=function(e){var t,n=e.product,c=e.state,r=e.setState,a=(Object(xe.d)((function(e){return e.approvisionnements})),Object(xe.c)(),!!(null===c||void 0===c?void 0:c.find((function(e){return(null===e||void 0===e?void 0:e.id)===n.id}))));return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(cr.a.Item,{children:Object(w.jsxs)(rr.a,{className:"product-card m-2 ".concat(n.id?"":"product-loading"),style:{border:n&&a?"1px solid #a6a5a5":"",boxShadow:n&&a?"0 10px 15px rgba(0, 0, 0, .07)":"none"},children:[Object(w.jsx)(ar.a,{xs:9,children:Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("p",{children:null===n||void 0===n?void 0:n.name}),Object(w.jsx)("div",{class:"badge badge-primary",children:null===n||void 0===n||null===(t=n.fournisseur)||void 0===t?void 0:t.name}),Object(w.jsx)("p",{children:Object(w.jsxs)("strong",{children:[" ",De(null===n||void 0===n?void 0:n.prixFournisseur)]})})]})}),Object(w.jsx)(ar.a,{xs:3,children:(null===n||void 0===n?void 0:n.id)&&Object(w.jsx)(w.Fragment,{children:a?Object(w.jsx)("button",{className:"btn btn-danger btn-sm",onClick:function(){return function(e){r(c.filter((function(t){return t.id!==e})))}(null===n||void 0===n?void 0:n.id)},children:"Retirer"}):Object(w.jsx)("button",{className:"btn btn-green btn-sm",onClick:function(){r(c.some((function(e){return e.id===n.id}))?c:[n].concat(Object(me.a)(c)))},children:"Ajouter"})})})]})})})},sd=function(){var e=Object(u.i)().id,t=Object(a.useState)(!1),n=Object(p.a)(t,2),c=n[0],r=n[1],s=Object(xe.c)(),d=Object(xe.d)(wn("approvis").value),l=Object(xe.d)(wn("approvis").meta),o=Object(xe.d)(wn("products").value),j=Object(xe.d)(wn("products").meta),b=Object(a.useState)([]),m=Object(p.a)(b,2),O=m[0],h=m[1];i.a.useEffect((function(){s(qn("approvis").get(e))}),[e]);var x=Object(a.useState)(""),v=Object(p.a)(x,2),f=v[0],g=v[1],C=Object(a.useState)([]),N=Object(p.a)(C,2),y=N[0],q=N[1];Object(a.useEffect)((function(){return 1==c&&(s(qn("products").fetch()),r(!1)),function(){r(!1)}}),[c]);var S=Object(a.useState)(),A=Object(p.a)(S,2),E=A[0],P=A[1];return Object(a.useEffect)((function(){h(null!=E?Aa(o,f,E):fr(o,f))}),[f]),Object(a.useEffect)((function(){h(""!=f?Aa(o,f,E):qa(o,E))}),[E]),Object(a.useEffect)((function(){s(qn("products").fetch())}),[]),i.a.useEffect((function(){var e;l.isFetching||q(null===(e=d[0])||void 0===e?void 0:e.contenu)}),[l]),Object(a.useEffect)((function(){j.isFetching||h(o)}),[j]),console.log(e),Object(w.jsxs)(qe,{children:[Object(w.jsx)(ge,{title:"Edition de facture",children:Object(w.jsx)(Ne,{title:"Edition de facture"})}),Object(w.jsx)(Se,{children:Object(w.jsx)(xr.a,{children:Object(w.jsxs)(rr.a,{children:[Object(w.jsx)(ar.a,{xs:5,children:Object(w.jsx)(cr.a,{children:Object(w.jsxs)(zc.a,{children:[Object(w.jsx)(zc.a.Header,{className:"d-flex justify-content-between align-items-center bg-dark text-white",children:"Produits"}),Object(w.jsxs)(zc.a.Body,{children:[Object(w.jsx)("input",{type:"text",onChange:function(e){g(e.target.value)},placeholder:"Rechercher un produit",className:"form-control mb-2"}),Object(w.jsx)(Ua,{model:"fournisseurs",children:Object(w.jsx)(Ya,{children:function(e){var t=e.data;e.meta;return Object(w.jsx)("div",{className:"my-2",children:Object(w.jsxs)("select",{className:"form-control",selected:2==E,onChange:function(e){P(e.target.value)},children:[Object(w.jsx)("option",{value:"",children:"Selectionner un fournisseur"}),t.map((function(e){return Object(w.jsx)("option",{value:e.id,children:e.name})}))]})})}})}),Object(w.jsxs)("div",{style:{overflowY:"auto",height:"350px",maxHeight:"350px",overflowX:"hidden"},children:[Object(w.jsxs)(w.Fragment,{children:[O.map((function(e){return Object(w.jsx)(id,{state:y,setState:q,product:e})})),0==O.length&&"Aucune enregistrement trouv\xe9"]})," "]})]})]})})}),Object(w.jsx)(ar.a,{xs:7,children:Object(w.jsx)(ad,{disabled:1==j.isFetching,state:y,meta:l,setState:q,products:o,approv:d[0]})})]})})})]})},dd=function(e){var t,n=e.key,c=e.product,r=Object(xe.d)((function(e){return e.fromdepots})),i=Object(xe.c)(),s=gi(r,i),d=s.isItemFromDepot,l=s.addFromDepot,o=!!d&&d(c.id);Object(a.useEffect)((function(){o||(c.qttByCC=0,c.quantityParProduct=0)}),[o]);return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(cr.a.Item,{style:{width:"100%"},children:Object(w.jsxs)(rr.a,{className:" ".concat(c.id?"":"product-loading"),style:{boxShadow:c&&o?"15px 10px 15px rgba(0, 0, 0, .07)":"none"},children:[Object(w.jsx)(ar.a,{xs:9,children:Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("p",{children:null===c||void 0===c?void 0:c.name}),Object(w.jsx)("div",{class:"badge badge-primary",children:null===c||void 0===c||null===(t=c.fournisseur)||void 0===t?void 0:t.name})]})}),Object(w.jsx)(ar.a,{xs:3,children:(null===c||void 0===c?void 0:c.id)&&Object(w.jsx)("button",{disabled:0===c.quantityBrute,className:"mt-3 ".concat(o?"btn btn-danger btn-sm":"btn btn-green btn-sm"),onClick:function(){l&&l(c)},children:o?"Retirer":"Ajouter"})})]})},n)})},ld=function(e){return e&&0!==(null===e||void 0===e?void 0:e.length)?e.reduce((function(e,t){return e+t}),0):0},od=function(e){e.setRegenerate;var t=Object(a.useState)("vente-depot"),n=Object(p.a)(t,2),c=n[0],r=n[1],i=Object(a.useState)(1),s=Object(p.a)(i,2),d=(s[0],s[1],Object(a.useState)(null)),l=Object(p.a)(d,2),o=l[0],j=l[1],b=Object(a.useState)(null),m=Object(p.a)(b,2),O=m[0],h=m[1],x=Object(u.g)(),v=Object(xe.d)((function(e){return{fromdepots:e.fromdepots}})).fromdepots,f=Object(xe.c)(),g=Object(xe.d)(wn("emprunters").value),C=Object(xe.d)(wn("vaccinateurs").value),N=(Object(xe.d)(wn("commandes").meta),Object(xe.d)(wn("commandes").value),new Date),y=Object(a.useState)(N),q=Object(p.a)(y,2),S=q[0],A=q[1];Object(a.useEffect)((function(){f(ci()),f(qn("commandes").fetch()),f(qn("emprunters").fetch()),f(qn("vaccinateurs").fetch())}),[]);return Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)(zc.a,{children:[Object(w.jsxs)(zc.a.Header,{className:" bg-dark py-2 text-white d-flex justify-content-between align-items-center",children:[Object(w.jsx)("div",{style:{width:"60%"},children:"BON DE SORTIE "}),Object(w.jsx)("div",{style:{width:"30%"},className:"text-right",children:Object(w.jsxs)($n.a,{onChange:function(e){r(e.target.value)},children:[Object(w.jsx)("option",{value:"vente-depot",selected:!0,children:"Comptant"}),Object(w.jsx)("option",{value:"vente-depot-credit",children:"Credit"}),Object(w.jsx)("option",{value:"vente-depot-vaccinateur",children:"Vaccinateur"})]})})]}),Object(w.jsxs)("div",{className:"commande-vente",children:[Object(w.jsx)(zc.a.Body,{style:{padding:12,marginTop:3,marginRight:2,marginLeft:2},children:Object(w.jsxs)("div",{style:{overflowY:"auto",height:"350px",maxHeight:"350px",overflowX:"hidden"},children:[Object(w.jsxs)("div",{class:"form-group",children:[Object(w.jsx)("label",{children:"Date de sortie :"}),Object(w.jsx)("div",{children:Object(w.jsx)("input",{type:"date",onChange:function(e){return A(e.target.value)},value:S,className:"form-control"})})]}),"vente-depot-credit"===c&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("label",{children:"Nom du persone:"}),Object(w.jsxs)("select",{className:"form-control mb-2",onChange:function(e){h(e.target.value)},children:[Object(w.jsx)("option",{children:"Selectionner une personne"}),g.map((function(e){return Object(w.jsx)("option",{value:e.id,children:e.name})}))]})]}),"vente-depot-vaccinateur"===c&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("label",{children:"Nom du vaccinateur:"}),Object(w.jsxs)("select",{className:"form-control mb-2",onChange:function(e){j(e.target.value)},children:[Object(w.jsx)("option",{children:"Selectionner un vaccinateur"}),C.map((function(e){return Object(w.jsx)("option",{value:e.id,children:e.name})}))]})]}),(null===v||void 0===v?void 0:v.length)<=0&&Object(w.jsx)("div",{className:"alert alert-success",children:'Choississez un produit sur la section "Produits" puis cliquez sur "Ajouter"'}),null===v||void 0===v?void 0:v.map((function(e,t){return Object(w.jsx)(Ci,{product:e,basket:v,dispatch:f},"".concat(null===e||void 0===e?void 0:e.id,"_").concat(t))}))]})}),(null===v||void 0===v?void 0:v.length)>0&&Object(w.jsxs)(zc.a.Footer,{className:"d-flex align-items-center justify-content-between",children:[Object(w.jsx)("div",{style:{width:"30%"},children:Object(w.jsx)("h2",{className:"p-2 text-uppercase bg-primary",children:Object(w.jsxs)("strong",{"data-test-id":"total-price-orders",children:["Total:",De(ld(v.map((function(e){return Fi(e)?e.prixlitre*e.quantityParProductDepot:e.prixVente*e.quantityParProductDepot})))+ld(v.map((function(e){return e.prixParCC*e.qttByCCDepot}))))]})})}),Object(w.jsx)("div",{style:{width:"70%"},children:v.length>0&&Object(w.jsxs)("div",{className:"d-flex text-right align-items-end justify-content-end",children:[Object(w.jsx)("button",{className:"btn btn-green btn-sm mr-2",disabled:0===v.length,onClick:function(){if(null!=S&&""!=S){for(var e=0;e<v.length;++e)if(0==v[e].quantityParProductDepot)return void alert("Commande non conforme:"+v[e].name+" : 0");v.forEach((function(e){var t;delete e.busy,delete e.pendingCreate,Ni(t=e)?t.quantityBrute-=t.quantityParProductDepot:yi(t)&&(t.quantityBrute=0),0!=e.condmldepot&&0!=e.qttccpventedepot?function(e){Pi(e)}(e):Ei(e)})),f(qn("commandes").createTransaction({id:Math.floor(Date.now()/1e3),contenu:v,type:c,sorte:"sortie",vaccinateurId:o,status:"vente-depot"===c,emprunterId:O,dateCom:null!=S||""!=S?S:N},"add-from-depot")),f(ci()),"vente-depot-credit"===c?x.push(T):"vente-depot-vaccinateur"===c?x.push(k):x.push(U)}else alert("Vous avez oubli\xe9 de mettre la date de l'operation !!!")},type:"button",children:"Valider l'operation"}),Object(w.jsx)("button",{className:"btn btn-danger btn-sm",onClick:function(){v.forEach((function(e){e.quantityParProductDepot=0,e.qttByCCDepot=0})),f(ci())},type:"button",children:Object(w.jsx)("span",{children:"Annuler"})})]})})]})]})]})})},ud=function(){var e=Object(xe.d)(wn("products").value),t=Object(xe.d)(wn("products").meta),n=Object(xe.c)(),c=Object(a.useState)(""),r=Object(p.a)(c,2),i=r[0],s=r[1],d=Object(a.useState)(2),l=Object(p.a)(d,2),o=(l[0],l[1],Object(a.useState)(!1)),u=Object(p.a)(o,2),j=u[0],b=u[1],m=(Object(a.useRef)(null),Object(a.useRef)(null),Object(a.useState)([])),O=Object(p.a)(m,2),h=O[0],x=O[1],v=(Object(xe.d)(wn("commandes").value),Object(xe.d)(wn("commandes").meta),Object(a.useState)(new Date)),f=Object(p.a)(v,2),g=f[0],C=f[1],N=Object(a.useState)(new Date),y=Object(p.a)(N,2),q=y[0],S=y[1];Object(a.useEffect)((function(){n(An(g,q))}),[g,q]),Object(a.useEffect)((function(){C(new Date),S(new Date),n(qn("products").fetch())}),[]),Object(a.useEffect)((function(){return 1==j&&(n(qn("products").fetch()),b(!1)),function(){b(!1)}}),[j]),Object(a.useEffect)((function(){t.isFetching||x(e)}),[t]),Object(a.useEffect)((function(){x(fr(e,i))}),[i]);return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(xr.a,{fluid:!0,children:Object(w.jsx)("div",{className:"py-2",children:Object(w.jsxs)(rr.a,{children:[Object(w.jsx)(ar.a,{xs:6,children:Object(w.jsxs)(zc.a,{className:"mt-2",children:[Object(w.jsxs)(zc.a.Header,{className:"bg-dark p-2 text-white d-flex text-uppercase justify-content-between align-items-center",children:[Object(w.jsx)("div",{style:{width:"80%"},children:"Produits"}),Object(w.jsx)("div",{children:Object(w.jsx)("button",{className:"btn btn-green btn-sm",onClick:function(){s(""),b(!0)},children:"Mettre \xe0 jour"})})]}),Object(w.jsxs)(zc.a.Body,{children:[Object(w.jsxs)("div",{children:[Object(w.jsx)("input",{type:"text",onChange:function(e){s(e.target.value)},placeholder:"Nom du produit",className:"form-control mb-2"})," "]}),Object(w.jsx)(cr.a,{children:Object(w.jsxs)("div",{style:{overflowY:"auto",height:"350px",maxHeight:"350px",overflowX:"hidden"},children:[Object(w.jsxs)("div",{class:"d-flex justify-content-start flex-wrap",children:[h.map((function(e){return Object(w.jsx)(dd,{product:e})})),0==h.length&&"Aucune enregistrement trouv\xe9"]})," "]})})]})]})}),Object(w.jsx)(ar.a,{xs:6,children:Object(w.jsx)("div",{className:" py-2",children:Object(w.jsx)(od,{setRegenerate:b})})})]})})})})},jd=function(){return Object(w.jsxs)(qe,{children:[Object(w.jsx)(ge,{title:"Bon de sortie du d\xe9pot",children:Object(w.jsx)(Ne,{title:"Bon de sortie du d\xe9pot"})}),Object(w.jsxs)(Se,{children:[Object(w.jsxs)("div",{children:[Object(w.jsx)("button",{disabled:!0,className:"btn btn-green btn-xs ml-3 mb-2",children:"Ajouter"})," ",": ",Object(w.jsx)("span",{children:"Le produit n'a pas de stock disponible"}),Object(w.jsx)("button",{className:"btn btn-green btn-xs ml-3 mb-2",children:"Mettre \xe0 jour"})," ",": ",Object(w.jsx)("span",{children:"Mettre \xe0 jour la liste des produits"})]}),Object(w.jsx)("select",{disabled:!0,className:"  ml-3 bg-white py-2 input-xs",children:Object(w.jsx)("option",{children:"Comptant"})})," ",": ",Object(w.jsx)("span",{children:"Choix du mode sortie ( Comptant,credit,vaccinateur)"}),Object(w.jsx)(ud,{})]})]})},bd=function(e){var t=e.flat,n=(e.gr,e.id),c=t.filter((function(e){return e.id==n})),r=(void 0!=c[c.length-1]&&c[c.length-1],0);return r=c?c.map((function(e){return 1*e.quantityParProduct})).reduce((function(e,t){return e+t}),0):0,Object(w.jsx)("td",{className:"text-center p-1",children:0!=r?r:"-"})},md=function(){return Object(w.jsx)("td",{className:"text-center p-1",children:Object(w.jsx)("div",{children:Object(w.jsx)("span",{className:"text-center  p-1",children:"-"})})})},Od=function(e){var t=e.flat,n=(e.gr,e.id),c=t.filter((function(e){return e.id==n})),r=void 0!=c[c.length-1]?c[c.length-1]:{},a={bruteCva:r.hasOwnProperty("id")?r.quantityBrute:0,ccCva:r.hasOwnProperty("id")?r.quantityCC:0};return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)("td",{className:"text-center",children:0!=c.length?a.bruteCva:0})})};function hd(e){return e[e.length-1]}var xd=function(){var e=he()().isoWeekday(1).startOf("week"),t=he()().endOf("week"),n=Object(a.useState)([]),c=Object(p.a)(n,2),r=c[0],i=c[1],s=Object(a.useState)([]),d=Object(p.a)(s,2),l=(d[0],d[1]),o=Object(a.useState)(e),u=Object(p.a)(o,2),j=u[0],b=u[1],m=Object(a.useState)(t),O=Object(p.a)(m,2),h=O[0],x=O[1],v=Object(a.useState)([e,t]),f=Object(p.a)(v,2),g=f[0],C=f[1],N=Object(a.useState)([]),y=Object(p.a)(N,2),q=y[0],S=y[1],A=Object(a.useState)([]),E=Object(p.a)(A,2),P=(E[0],E[1],Object(xe.d)(wn("approvis").value)),V=Object(xe.d)(wn("approvis").meta),D=Object(xe.c)();Object(a.useEffect)((function(){null!==g?(g[0]&&b(g[0]),g[0]&&x(g[1])):(b(e),x(t))}),[g]),Object(a.useEffect)((function(){var e;j&&h&&(i(function(e,t){for(var n=e.clone(),c=[];n.isSameOrBefore(t);)c.push(n.format("YYYY-MM-DD")),n.add(1,"days");return c}(he()(j),he()(h))),l(function(e,t){for(var n=[];t.diff(e,"months")>=0;)n.push(e.format("MMMM YYYY")),e.add(1,"month");return n}(he()(j),he()(h))),D((e=h,hn("approvis",{path:"/get-approv-by-date?deb=".concat(j,"&fin=").concat(e),replace:!0}))))}),[j,h]),Object(a.useEffect)((function(){V.isFetching||S(Te(P,"dateApprov",j,h))}),[V]);var F,R,M=ke(q,"contenu").reduce((function(e,t){var n=t.id,c=t.name,r=t.type,a=t.category,i=t.fournisseur,s=t.quantityBrute,d=t.quantityCC,l=t.quantityParProduct,o=e.find((function(e){return e.id===n}));return o?o.quantityParProduct=parseInt(o.quantityParProduct)+parseInt(l):e.push({id:n,name:c,type:r,category:a,fournisseur:i,quantityBrute:s,quantityCC:d,quantityParProduct:l}),e}),[]).sort((function(e,t){return e.id>t.id})),B=function(e,t){var n;return Object(me.a)(new Set((n=[]).concat.apply(n,Object(me.a)(e.map((function(e){return e[t]}))))))},T=(F="dateApprov",q.reduce((function(e,t){return R?(e[t[F][R]]=e[t[F][R]]||[]).push(t):(e[t[F]]=e[t[F]]||[]).push(t),e}),{}));return Object(w.jsxs)(qe,{children:[Object(w.jsx)(ge,{title:"Journal de facturation",children:Object(w.jsx)(Ne,{title:"Journal de facturation"})}),Object(w.jsxs)(Se,{children:[Object(w.jsx)(Pn,{}),Object(w.jsxs)("div",{className:"date-range",children:[Object(w.jsxs)("div",{className:"d-flex justify-content-between my-3",children:[Object(w.jsxs)("div",{children:[j&&h&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("h2",{class:"text-uppercase my-1",children:"Journal de facturation "}),Object(w.jsxs)("span",{children:["Du: ",Ve(j)," Au ",Ve(h)]})]})," "]}),Object(w.jsx)("div",{children:Object(w.jsx)(Cr.a,{locale:"fr-FR",onChange:C,value:g})})]}),Object(w.jsx)("div",{className:"bg-white py-3 px-2 mb-2",children:Object(w.jsx)("div",{className:"table-responsive",children:Object(w.jsxs)("table",{class:"table",children:[Object(w.jsxs)("tr",{className:"sticky-this",children:[Object(w.jsx)("td",{children:"Produit"}),r.map((function(e){return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(Me,{date:e})})})),Object(w.jsx)("td",{className:"bg-thead text-uppercase text-center",children:"Total"}),Object(w.jsx)("td",{className:"bg-thead text-uppercase text-center",children:"Stock"})]}),M.map((function(e){return Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)("tr",{class:"bg-white",children:[Object(w.jsx)("td",{className:"bg-thead",children:e.name}),r.map((function(t){return Object(w.jsx)(w.Fragment,{children:void 0!=T[t]?Object(w.jsx)(bd,{flat:B(T[t],"contenu"),gr:t,id:e.id}):Object(w.jsx)(md,{})})})),Object(w.jsx)("td",{className:"text-center",children:e.quantityParProduct}),Object(w.jsx)(Od,{flat:B(T[hd(Object.keys(T))],"contenu"),gr:hd(Object.keys(T)),id:e.id})]})})})),0==M.length&&Object(w.jsx)("tr",{children:Object(w.jsx)("td",{className:"text-center",colSpan:r.length+3,children:"Aucune enregistrement trouv\xe9"})})]})})})," "]})]})]})},vd=function(){return Object(w.jsx)("td",{className:"text-center p-1",children:Object(w.jsx)("div",{children:Object(w.jsx)("span",{className:"text-center  p-1",children:"-"})})})},pd=function(e){var t=e.flat,n=(e.gr,e.id),c=t.filter((function(e){return e.id==n})),r=(void 0!=c[c.length-1]&&c[c.length-1],0);return r=c?c.map((function(e){return 1*e.quantityParProductDepot})).reduce((function(e,t){return e+t}),0):0,Object(w.jsx)("td",{className:"text-center p-1",children:0!=r?r:"-"})},fd=function(e){var t=e.flat,n=(e.gr,e.id),c=t.filter((function(e){return e.id==n})),r=void 0!=c[c.length-1]?c[c.length-1]:{},a={bruteCva:r.hasOwnProperty("id")?r.quantityBrute:0,ccCva:r.hasOwnProperty("id")?r.quantityCC:0};return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)("td",{className:"text-center",children:0!=c.length?a.bruteCva:0})})};function gd(e){return e[e.length-1]}var Cd=function(){var e=he()().isoWeekday(1).startOf("week"),t=he()().endOf("week"),n=Object(a.useState)([]),c=Object(p.a)(n,2),r=c[0],i=c[1],s=Object(a.useState)([]),d=Object(p.a)(s,2),l=(d[0],d[1]),o=Object(a.useState)(e),u=Object(p.a)(o,2),j=u[0],b=u[1],m=Object(a.useState)(t),O=Object(p.a)(m,2),h=O[0],x=O[1],v=Object(a.useState)([e,t]),f=Object(p.a)(v,2),g=f[0],C=f[1],N=Object(a.useState)([]),y=Object(p.a)(N,2),q=y[0],S=y[1],A=Object(a.useState)([]),E=Object(p.a)(A,2),P=(E[0],E[1],Object(xe.d)(wn("commandes").value)),V=Object(xe.d)(wn("commandes").meta),D=Object(xe.c)();Object(a.useEffect)((function(){null!==g?(g[0]&&b(g[0]),g[0]&&x(g[1])):(b(e),x(t))}),[g]),Object(a.useEffect)((function(){j&&h&&(i(function(e,t){for(var n=e.clone(),c=[];n.isSameOrBefore(t);)c.push(n.format("YYYY-MM-DD")),n.add(1,"days");return c}(he()(j),he()(h))),l(function(e,t){for(var n=[];t.diff(e,"months")>=0;)n.push(e.format("MMMM YYYY")),e.add(1,"month");return n}(he()(j),he()(h))),D(Sn("vente-depot",j,h)))}),[j,h]),Object(a.useEffect)((function(){V.isFetching||S(Te(P,"dateCom",j,h))}),[V]);var F,R,M=ke(q,"contenu").reduce((function(e,t){var n=t.id,c=t.name,r=t.type,a=t.category,i=t.fournisseur,s=t.quantityParProductDepot,d=t.quantityBruteCVA,l=t.quantityCCCVA,o=(t.qttByCC,e.find((function(e){return e.id===n})));return o?o.quantityParProductDepot=parseInt(o.quantityParProductDepot)+parseInt(s):e.push({id:n,name:c,type:r,category:a,fournisseur:i,quantityBruteCVA:d,quantityCCCVA:l,quantityParProductDepot:s}),e}),[]).sort((function(e,t){return e.id>t.id})),B=function(e,t){var n;return Object(me.a)(new Set((n=[]).concat.apply(n,Object(me.a)(e.map((function(e){return e[t]}))))))},T=(F="dateCom",q.reduce((function(e,t){return R?(e[t[F][R]]=e[t[F][R]]||[]).push(t):(e[t[F]]=e[t[F]]||[]).push(t),e}),{}));return Object(w.jsxs)(qe,{children:[Object(w.jsx)(ge,{title:"Journal de vente",children:Object(w.jsx)(Ne,{title:"Journal de vente"})}),Object(w.jsxs)(Se,{children:[Object(w.jsx)(Pn,{}),Object(w.jsxs)("div",{className:"date-range",children:[Object(w.jsxs)("div",{className:"d-flex justify-content-between my-3",children:[Object(w.jsxs)("div",{children:[j&&h&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("h2",{class:"text-uppercase my-1",children:"Journal de vente"}),Object(w.jsxs)("span",{children:["Du: ",Ve(j)," Au ",Ve(h)]})]})," "]}),Object(w.jsx)("div",{children:Object(w.jsx)(Cr.a,{locale:"fr-FR",onChange:C,value:g})})]}),Object(w.jsx)("div",{className:"table-responsive",children:Object(w.jsxs)("table",{class:"table",children:[Object(w.jsxs)("tr",{className:"sticky-this",children:[Object(w.jsx)("td",{children:"Produit"}),r.map((function(e){return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(Me,{date:e})})})),Object(w.jsx)("td",{className:"bg-thead text-uppercase text-center",children:"Total"}),Object(w.jsx)("td",{className:"bg-thead text-uppercase text-center",children:"Stock"})]}),M.map((function(e){return Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)("tr",{class:"bg-white",children:[Object(w.jsx)("td",{className:"bg-thead",children:e.name}),r.map((function(t){return Object(w.jsx)(w.Fragment,{children:void 0!=T[t]?Object(w.jsx)(pd,{flat:B(T[t],"contenu"),gr:t,id:e.id}):Object(w.jsx)(vd,{})})})),Object(w.jsx)("td",{className:"text-center",children:e.quantityParProductDepot}),Object(w.jsx)(fd,{flat:B(T[gd(Object.keys(T))],"contenu"),gr:gd(Object.keys(T)),id:e.id})]})})})),0==M.length&&Object(w.jsx)("tr",{children:Object(w.jsx)("td",{className:"text-center",colSpan:r.length+3,children:"Aucune enregistrement trouv\xe9"})})]})})]})]})]})};function Nd(e){return e[e.length-1]}var yd=function(){var e=he()().isoWeekday(1).startOf("week"),t=he()().endOf("week"),n=Object(a.useState)([]),c=Object(p.a)(n,2),r=c[0],i=c[1],s=Object(a.useState)([]),d=Object(p.a)(s,2),l=(d[0],d[1]),o=Object(a.useState)(e),u=Object(p.a)(o,2),j=u[0],b=u[1],m=Object(a.useState)(t),O=Object(p.a)(m,2),h=O[0],x=O[1],v=Object(a.useState)([e,t]),f=Object(p.a)(v,2),g=f[0],C=f[1],N=Object(a.useState)([]),y=Object(p.a)(N,2),q=y[0],S=y[1],A=Object(a.useState)([]),E=Object(p.a)(A,2),P=(E[0],E[1],Object(xe.d)(wn("commandes").value)),V=Object(xe.d)(wn("commandes").meta),D=Object(xe.c)();Object(a.useEffect)((function(){null!==g?(g[0]&&b(g[0]),g[0]&&x(g[1])):(b(e),x(t))}),[g]),Object(a.useEffect)((function(){j&&h&&(i(function(e,t){for(var n=e.clone(),c=[];n.isSameOrBefore(t);)c.push(n.format("YYYY-MM-DD")),n.add(1,"days");return c}(he()(j),he()(h))),l(function(e,t){for(var n=[];t.diff(e,"months")>=0;)n.push(e.format("MMMM YYYY")),e.add(1,"month");return n}(he()(j),he()(h))),D(Sn("cva",j,h)))}),[j,h]),Object(a.useEffect)((function(){V.isFetching||S(Te(P,"dateCom",j,h))}),[V]);var F,R,M=ke(q,"contenu").reduce((function(e,t){var n=t.id,c=t.name,r=t.type,a=t.category,i=t.fournisseur,s=t.quantityBrute,d=t.quantityCC,l=t.quantityParProduct,o=e.find((function(e){return e.id===n}));return o?o.quantityParProduct=parseInt(o.quantityParProduct)+parseInt(l):e.push({id:n,name:c,type:r,category:a,fournisseur:i,quantityBrute:s,quantityCC:d,quantityParProduct:l}),e}),[]).sort((function(e,t){return e.id>t.id})),B=function(e,t){var n;return Object(me.a)(new Set((n=[]).concat.apply(n,Object(me.a)(e.map((function(e){return e[t]}))))))},T=(F="dateCom",q.reduce((function(e,t){return R?(e[t[F][R]]=e[t[F][R]]||[]).push(t):(e[t[F]]=e[t[F]]||[]).push(t),e}),{}));return Object(w.jsxs)(qe,{children:[Object(w.jsx)(ge,{title:"Journal de dep\xf4t vers magasin",children:Object(w.jsx)(Ne,{title:"Journal de dep\xf4t vers magasin"})}),Object(w.jsxs)(Se,{children:[Object(w.jsx)(Pn,{}),Object(w.jsxs)("div",{className:"date-range",children:[Object(w.jsxs)("div",{className:"d-flex justify-content-between my-3",children:[Object(w.jsxs)("div",{children:[j&&h&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("h2",{class:"text-uppercase my-1",children:"Journal de dep\xf4t vers magasin "}),Object(w.jsxs)("span",{children:["Du: ",Ve(j)," Au ",Ve(h)]})]})," "]}),Object(w.jsx)("div",{children:Object(w.jsx)(Cr.a,{locale:"fr-FR",onChange:C,value:g})})]}),Object(w.jsx)("div",{className:"bg-white py-3 px-2 mb-2",children:Object(w.jsx)("div",{className:"table-responsive",children:Object(w.jsxs)("table",{class:"table",children:[Object(w.jsxs)("tr",{className:"sticky-this",children:[Object(w.jsx)("td",{children:"Produit"}),r.map((function(e){return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(Me,{date:e})})})),Object(w.jsx)("td",{className:"bg-thead text-uppercase text-center",children:"Total"}),Object(w.jsx)("td",{className:"bg-thead text-uppercase text-center",children:"Stock"})]}),M.map((function(e){return Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)("tr",{class:"bg-white",children:[Object(w.jsx)("td",{className:"bg-thead",children:e.name}),r.map((function(t){return Object(w.jsx)(w.Fragment,{children:void 0!=T[t]?Object(w.jsx)(bd,{flat:B(T[t],"contenu"),gr:t,id:e.id}):Object(w.jsx)(md,{})})})),Object(w.jsx)("td",{className:"text-center",children:e.quantityParProduct}),Object(w.jsx)(Od,{flat:B(T[Nd(Object.keys(T))],"contenu"),gr:Nd(Object.keys(T)),id:e.id})]})})})),0==M.length&&Object(w.jsx)("tr",{children:Object(w.jsx)("td",{className:"text-center",colSpan:r.length+3,children:"Aucune enregistrement trouv\xe9"})})]})})})," "]})]})]})},qd=function(e){if(!e||0===(null===e||void 0===e?void 0:e.length))return 0;var t=0;return e.forEach((function(e){t+=e.prixVente*e.quantityParProduct*1})),t},wd=function(e,n,c){return 1==e[t]?{text:"plus (+"+e[n]+")("+c+")",textStyle:"text text-info",date:Ve(e.datedecorrection),style:"badge badge-info"}:2==e[t]?{text:"moins (-"+e[n]+")("+c+")",textStyle:"text text-warning",date:Ve(e.datedecorrection),style:"badge badge-warning"}:3==e[t]?{text:"ajouter au commande ( + "+e[n]+"("+c+")",textStyle:"text text-success",date:Ve(e.datedecorrection),style:"badge badge-success"}:4==e[t]?{text:"supprimer du commande ( - "+e[n]+"("+c+")",textStyle:"text text-danger",date:Ve(e.datedecorrection),style:"badge badge-danger"}:void 0};var Sd=Object(u.j)((function(e){Object(u.g)();var t,n,c=Object(u.i)().id,r=Object(xe.d)(wn("commandes").value),i=Object(xe.c)();return Object(a.useEffect)((function(){i(qn("commandes").get(c))}),[c]),Object(w.jsxs)(qe,{children:[Object(w.jsx)(ge,{title:"D\xe9tail de sortie vers magasin",children:Object(w.jsx)(Ne,{title:"D\xe9tail de sortie vers magasin"})}),Object(w.jsxs)(Se,{children:[Object(w.jsxs)("table",{className:"table table-bordered ",children:[Object(w.jsxs)("tr",{className:"bg-thead",children:[Object(w.jsx)("td",{children:"Nom de l'article"}),Object(w.jsx)("td",{children:"Quantit\xe9"}),Object(w.jsx)("td",{children:"Sous total"})]}),r.length>0&&(null===(t=r[0])||void 0===t?void 0:t.contenu.map((function(e){return Object(w.jsxs)("tr",{children:[Object(w.jsxs)("td",{style:{width:"40%"},children:[Object(w.jsx)("h2",{children:e.name}),e.correction>0&&Object(w.jsx)("div",{children:Object(w.jsx)("div",{className:wd(e,"correction","correctiontype").style,children:Object(w.jsx)("p",{children:wd(e).text})})}),e.correctionml>0&&Object(w.jsx)("div",{children:Object(w.jsx)("div",{className:wd(e,"correctionml","correctiontml").style,children:Object(w.jsx)("p",{children:wd(e,"correctionml","correctiontml").text})})}),e.correctionl>0&&Object(w.jsx)("div",{children:Object(w.jsx)("div",{className:wd(e,"correctionl","correctiontl").style,children:Object(w.jsx)("p",{children:wd(e,"correctionl","correctiontl").text})})}),Object(w.jsxs)("p",{children:["Date de modification:",Ve(e.datedecorrection)]})]}),Object(w.jsxs)("td",{className:"d-flex align-items-center",children:[De(pa(e)?e.prixlitre:e.prixVente),"(","x"," ",e.quantityParProduct,")"]}),Object(w.jsx)("td",{children:De(pa(e)?e.prixlitre:e.prixVente*e.quantityParProduct)})]})})))]}),Object(w.jsxs)("div",{className:"d-flex justify-content-end",children:[Object(w.jsx)("strong",{children:"Total"}),":",De(qd(null===(n=r[0])||void 0===n?void 0:n.contenu))]})]})]})})),Ad=function(e){return e&&0!==(null===e||void 0===e?void 0:e.length)?e.reduce((function(e,t){return e+t}),0):0};var Ed=Object(u.j)((function(e){Object(u.h)();var t,n,c,r,i,s,d,l,o=Object(u.i)().id,j=Object(xe.d)(wn("commandes").value),b=Object(xe.c)();return Object(a.useEffect)((function(){b(qn("commandes").get(o))}),[o]),Object(w.jsxs)(qe,{children:[Object(w.jsx)(ge,{title:"D\xe9tail de vente du magasin",children:Object(w.jsx)(Ne,{title:"D\xe9tail de vente du magasin"})}),Object(w.jsxs)(Se,{children:[Object(w.jsxs)("div",{children:[Object(w.jsxs)("div",{children:[Object(w.jsx)("p",{children:"credit-cva"==(null===(t=j[0])||void 0===t?void 0:t.type)&&Object(w.jsx)("p",{children:"Credit"})}),"credit-cva"==(null===(n=j[0])||void 0===n?void 0:n.type)&&Object(w.jsx)("div",{className:"border",children:Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("h3",{children:null===(c=j[0])||void 0===c?void 0:c.emprunter.name}),Object(w.jsx)("h5",{children:null===(r=j[0])||void 0===r?void 0:r.emprunter.contact})]})}),j.length>0&&Object(w.jsxs)("div",{className:"d-flex justify-content-between",children:[Object(w.jsxs)("h2",{className:"my-2",children:["Date : ",Ve(null===(i=j[0])||void 0===i?void 0:i.dateCom)]}),Object(w.jsx)("div",{className:"d-flex justify-content-end",children:Object(w.jsxs)("div",{className:"bg-thead p-1 mb-1",children:[Object(w.jsx)("strong",{children:"Recette:"}),":",Object(w.jsx)("h3",{className:"text-lg",children:De(Ad(null===(s=j[0])||void 0===s?void 0:s.contenu.map((function(e){return pa(e)?e.prixlitre*e.quantityParProduct:e.prixVente*e.quantityParProduct})))+Ad(null===(d=j[0])||void 0===d?void 0:d.contenu.map((function(e){return e.prixParCC*e.qttByCC}))))})]})})]}),Object(w.jsxs)("table",{className:"table table-bordered",children:[Object(w.jsxs)("tr",{className:"bg-thead",children:[Object(w.jsx)("td",{children:"Nom de l'article"}),Object(w.jsx)("td",{children:"Quantit\xe9"}),Object(w.jsx)("td",{children:"Sous total"})]}),j.length>0&&(null===(l=j[0])||void 0===l?void 0:l.contenu.map((function(e){return Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{style:{width:"40%"},children:e.name}),Object(w.jsx)(w.Fragment,{children:0!=e.quantityParProduct&&Object(w.jsxs)("div",{className:"d-flex align-items-center py-0",children:[Object(w.jsxs)("strong",{children:[e.type,":"]}),De(e.prixVente)," (","x"," ",e.quantityParProduct,") "," = ",De(e.prixVente*e.quantityParProduct)]})}),"FLACON"==e.type&&Object(w.jsx)(w.Fragment,{children:0!=e.qttByCC&&Object(w.jsxs)("div",{className:"d-flex align-items-center  py-0",children:[Object(w.jsx)("strong",{children:"ML:"})," ",De(e.prixParCC)," ","x"," ",0!=e.qttyspecificmirror?e.qttyspecificmirror+" Dose":e.qttByCC+" Ml"," "," = "," ",De(e.prixParCC*e.qttByCC)]})}),Object(w.jsx)("td",{children:De(e.prixVente*e.quantityParProduct+e.prixParCC*e.qttByCC)})]})})))]})]})," "]})," "]})]})})),Pd=function(e){var t,n=e.state,c=e.setState,r=e.product,a=(Object(xe.c)(),!!(null===n||void 0===n?void 0:n.find((function(e){return(null===e||void 0===e?void 0:e.id)===r.id})))),s=i.a.useCallback((function(){return r.quantityBruteCVA>15&&r.quantityBruteCVA<=20?"yellow":r.quantityBruteCVA>10&&r.quantityBruteCVA<=15?"#ffdb4c":r.quantityBruteCVA>5&&r.quantityBruteCVA<=10?" orange":r.quantityBruteCVA>0&&r.quantityBruteCVA<=5?"#c44e14b8":0==r.quantityBruteCVA?"red":"green"}),[r]),d=i.a.useCallback((function(){return r.quantityCCCVA>15&&r.quantityCCCVA<=20?"yellow":r.quantityCCCVA>10&&r.quantityCCCVA<=15?"#ffdb4c":r.quantityCCCVA>5&&r.quantityCCCVA<=10?" orange":r.quantityCCCVA>0&&r.quantityCCCVA<=5?"#c44e14b8":0==r.quantityCCCVA?"red":"green"}),[r]);return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(cr.a.Item,{className:"mb-2 mr-3",style:{width:"100%",border:"1px solid gray",background:"whitesmoke",borderLeft:"10px solid ".concat(s())},children:Object(w.jsxs)("div",{className:" d-flex justify-content-between align-items-center",children:[Object(w.jsxs)("div",{className:" ".concat(r.id?"":"product-loading"),style:{boxShadow:r&&a?"15px 10px 15px rgba(0, 0, 0, .07)":"none"},children:[Object(w.jsxs)("div",{children:[Object(w.jsx)("div",{style:{width:10,height:4,background:"".concat(d())}}),Object(w.jsxs)("div",{children:[r.name," "]}),Object(w.jsx)("div",{class:"badge badge-primary",children:null===r||void 0===r||null===(t=r.fournisseur)||void 0===t?void 0:t.name}),Object(w.jsx)("br",{})]})," "]}),Object(w.jsx)("div",{children:(null===r||void 0===r?void 0:r.id)&&Object(w.jsx)(w.Fragment,{children:a?Object(w.jsx)("button",{disabled:0===r.quantityBruteCVA&&(0==r.quantityCCCVA||null==r.quantityCCCVA),className:"btn btn-danger btn-sm",onClick:function(){!function(e){c(n.filter((function(t){return t.id!==e})))}(null===r||void 0===r?void 0:r.id)},children:"Retirer"}):Object(w.jsx)("button",{disabled:0===r.quantityBruteCVA&&(0==r.quantityCCCVA||null==r.quantityCCCVA),className:"btn btn-green btn-sm",onClick:function(){c(n.some((function(e){return e.id===r.id}))?n:[r].concat(Object(me.a)(n)))},children:"Ajouter"})})})]})})})},Vd=function(e){var t=e.product,n=e.index,c=e.state,r=e.setState,a=e.setRealQtt,i=e.realQtt,s=(e.maxRealQtt,function(e){!function(e,t,n){var a=Object(me.a)(c);a[e]=Object(_e.a)(Object(_e.a)({},a[e]),{},Object(f.a)({},t,n)),r(a)}(n,"quantityParProduct",e)});return Object(w.jsx)("div",{className:"basket-item-control",children:Object(w.jsxs)(Rc.c,{inputMode:"numeric",w:28,bg:"whitesmoke",onChange:function(e){""==e?(a(null===t||void 0===t?void 0:t.quantityParProduct),s(null===t||void 0===t?void 0:t.quantityParProduct)):(a(Number(e)),s(Number(e)))},min:0,value:i,defaultValue:null===t||void 0===t?void 0:t.quantityParProduct,children:[Object(w.jsx)(Rc.d,{}),Object(w.jsxs)(Rc.e,{children:[Object(w.jsx)(Rc.b,{}),Object(w.jsx)(Rc.a,{})]})]})})},Dd=function(e){var t=e.product,n=e.setRealQttCC,c=e.realQttCC,r=e.maxRealQttCC,a=Object(xe.c)();return Object(w.jsx)("div",{className:"basket-item-control",children:Object(w.jsxs)(Rc.c,{inputMode:"decimal",w:28,step:1,bg:"whitesmoke",onChange:function(e){!function(e){a(vi(t.id,e))}(e),n(e)},min:0,value:c,defaultValue:null===t||void 0===t?void 0:t.qttByCC,max:r,children:[Object(w.jsx)(Rc.d,{}),Object(w.jsxs)(Rc.e,{children:[Object(w.jsx)(Rc.b,{}),Object(w.jsx)(Rc.a,{})]})]})})},Fd=function(e){var t=e.product,n=e.setRealQttCC,c=e.realQttCC,r=e.maxRealQttCC,a=Object(xe.c)(),i=function(e){a(fi(t.id,e))};return Object(w.jsx)("div",{className:"basket-item-control",children:Object(w.jsxs)(Rc.c,{inputMode:"decimal",w:28,bg:"whitesmoke",onChange:function(e){""==e?(i(0),n(0)):(i(Number(e)),n(Number(e)))},min:0,value:c,defaultValue:null===t||void 0===t?void 0:t.qttByCC,max:r,children:[Object(w.jsx)(Rc.d,{}),Object(w.jsxs)(Rc.e,{children:[Object(w.jsx)(Rc.b,{}),Object(w.jsx)(Rc.a,{})]})]})})},Rd=function(e){var t=e.product,n=e.setRealQttCC,c=e.maxRealQttCC,r=e.realQttCC,a=Object(xe.c)();return Object(w.jsx)("div",{className:"basket-item-control",children:Object(w.jsxs)(Rc.c,{inputMode:"numeric",w:28,step:1,bg:"whitesmoke",onChange:function(e){!function(e){a(pi(t.id,e))}(Number(e)),n(Number(e))},min:0,value:r,defaultValue:null===t||void 0===t?void 0:t.qttByCC,max:c,children:[Object(w.jsx)(Rc.d,{}),Object(w.jsxs)(Rc.e,{children:[Object(w.jsx)(Rc.b,{}),Object(w.jsx)(Rc.a,{})]})]})})},Md=function(){return{type:di}},Bd=function(e,t){return{type:ui,payload:{id:e,value:t}}},Td=function(e,t){return{type:hi,payload:{id:e,value:t}}},kd=function(e,t){return{type:oi,payload:{id:e,value:t}}},_d=function(e){var t=e.product,n=e.setRealQttCC,c=(e.maxRealQttCC,e.index),r=e.setState,a=e.state,i=e.realQttCC,s=function(e){!function(e,t,n){var c=Object(me.a)(a);c[e]=Object(_e.a)(Object(_e.a)({},c[e]),{},Object(f.a)({},t,n)),r(c)}(c,"qttByCC",e)};return Object(w.jsx)("div",{className:"basket-item-control",children:Object(w.jsxs)(Rc.c,{inputMode:"numeric",w:28,bg:"whitesmoke",onChange:function(e){""==e?(s(null===t||void 0===t?void 0:t.qttByCC),n(null===t||void 0===t?void 0:t.qttByCC)):(n(1*e),s(1*e))},min:0,value:i,children:[Object(w.jsx)(Rc.d,{}),Object(w.jsxs)(Rc.e,{children:[Object(w.jsx)(Rc.b,{}),Object(w.jsx)(Rc.a,{})]})]})})},Id=function(e){var t=e.product,n=e.setRealQttLitre,c=e.setState,r=e.state,a=e.realQttLitre,i=e.index,s=function(e){!function(e,t,n){var a=Object(me.a)(r);a[e]=Object(_e.a)(Object(_e.a)({},a[e]),{},Object(f.a)({},t,n)),c(a)}(i,"qttbylitre",e)};return Object(w.jsx)("div",{className:"basket-item-control",children:Object(w.jsxs)(Rc.c,{inputMode:"numeric",w:28,step:1,bg:"whitesmoke",min:0,value:a,defaultValue:null===t||void 0===t?void 0:t.qttbylitre,onChange:function(e){""==e?(n(null===t||void 0===t?void 0:t.qttbylitre),s(null===t||void 0===t?void 0:t.qttbylitre)):(n(Number(e)),s(Number(e)))},children:[Object(w.jsx)(Rc.d,{}),Object(w.jsxs)(Rc.e,{children:[Object(w.jsx)(Rc.b,{}),Object(w.jsx)(Rc.a,{})]})]})})},Qd=function(e){var t=e.product,n=e.state,c=e.setState,r=e.realQttCC,a=e.setRealQttCC,i=(e.maxRealQttCC,e.index),s=(Object(xe.c)(),function(e){!function(e,t,r){var a=Object(me.a)(n);a[e]=Object(_e.a)(Object(_e.a)({},a[e]),{},Object(f.a)({},t,r)),c(a)}(i,"qttByCC",e)});return Object(w.jsx)("div",{className:"basket-item-control",children:Object(w.jsxs)(Rc.c,{inputMode:"decimal",w:28,bg:"whitesmoke",onChange:function(e){""==e?(s(0),a(0)):(a(Number(e)),s(Number(e)))},min:0,value:r,defaultValue:null===t||void 0===t?void 0:t.qttByCC,children:[Object(w.jsx)(Rc.d,{}),Object(w.jsxs)(Rc.e,{children:[Object(w.jsx)(Rc.b,{}),Object(w.jsx)(Rc.a,{})]})]})})},Ld=function(e){return!(0==e.condml||0==e.condsize||0==e.qttccpvente||0==e.prixqttccvente)},Hd=function(e){return 1==e.correctiontype?{text:"plus (+"+e.correction+") et ("+e.correctionml+")",textStyle:"text text-info",date:Ve(e.datedecorrection),style:"badge badge-info"}:2==e.correctiontype?{text:"moins (-"+e.correction+")  et ("+e.correctionml+")",textStyle:"text text-warning",date:Ve(e.datedecorrection),style:"badge badge-warning"}:3==e.correctiontype?{text:"ajouter au commande ( + "+e.correction+")  et ("+e.correctionml+")",textStyle:"text text-success",date:Ve(e.datedecorrection),style:"badge badge-success"}:4==e.correctiontype?{text:"supprimer du commande ( - "+e.correction+")  et ("+e.correctionml+")",textStyle:"text text-danger",date:Ve(e.datedecorrection),style:"badge badge-danger"}:void 0},Ud=function(e){var t=e.state,n=e.index,c=e.setState,r=e.product,s=e.products,d=(Object(xe.c)(),Object(a.useState)(null===r||void 0===r?void 0:r.qttByCC)),l=Object(p.a)(d,2),o=l[0],u=l[1],j=Object(a.useState)(null===r||void 0===r?void 0:r.quantityParProduct),b=Object(p.a)(j,2),m=b[0],O=b[1],h=Object(a.useState)(null===r||void 0===r?void 0:r.qttbylitre),x=Object(p.a)(h,2),v=x[0],f=x[1],g=Object(a.useState)(2e3),C=Object(p.a)(g,2),N=C[0],y=C[1],q=Object(a.useState)(2e3),S=Object(p.a)(q,2),A=S[0],E=S[1],P=Object(a.useState)(2e3),V=Object(p.a)(P,2),D=V[0],F=V[1],R=Object(xe.d)(wn("commandes").value);return i.a.useEffect((function(){if(void 0!=s&&void 0!=t&&R.length>0){var e=null===t||void 0===t?void 0:t.find((function(e){return null===r||void 0===r?void 0:r.id})),n=Ti(s,R[0],e),c=n.normalQtt,a=n.normalQttCC,i=n.normalQttLitre,d=n.isSpecific;0==n.isValid&&(alert("stock insuffisant :("),d?(f(i),F(i),O(c),y(c),u(a),E(a)):(O(c),y(c),u(a),E(a))),console.log(v)}}),[m,o,v,s]),Object(w.jsx)("div",{children:Object(w.jsxs)("div",{className:"d-flex justify-content-between align-items-center border mt-3  mb-2 p-2",children:[Object(w.jsxs)("div",{style:{width:"45%"},children:[r.correction>0&&Object(w.jsxs)("div",{children:[Object(w.jsx)("div",{className:Hd(r).style,children:Object(w.jsx)("p",{children:Hd(r).text})}),Object(w.jsxs)("p",{className:Hd(r).textStyle,children:["Date de modification:",Hd(r).date]})]}),Object(w.jsx)("p",{className:"text-blue",children:r.name}),Ld(r)?Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("p",{className:"text-lowercase",children:Object(w.jsx)("strong",{children:0!=r.qttbylitre&&Object(w.jsx)("span",{style:{marginRight:"30px"},children:De(r.prixVente)+" x "+r.qttbylitre+" Litre(s)"})})}),Object(w.jsx)("p",{className:"text-lowercase",children:Object(w.jsx)("strong",{children:0!=r.quantityParProduct&&Object(w.jsx)("span",{style:{marginRight:"30px"},children:De(r.prixqttccvente*r.qttccpvente)+" x "+r.quantityParProduct+" "+r.type})})})]}):Object(w.jsx)("p",{className:"text-lowercase",children:Object(w.jsx)("strong",{children:0!=r.quantityParProduct&&Object(w.jsx)("span",{style:{marginRight:"30px"},children:De(r.prixVente)+" x "+r.quantityParProduct+" "+r.type})})}),Object(w.jsx)("p",{className:"text-lowercase",children:Object(w.jsx)("strong",{children:0!=r.qttByCC&&Object(w.jsx)("span",{style:{marginRight:"30px"},children:De(r.prixParCC)+" x "+r.qttByCC+" ML"})})})]}),0!==r.condml&&0!==r.qttccpvente&&Object(w.jsxs)("div",{className:"text-inline text-center mr-3",children:[Object(w.jsx)("h5",{className:"mb-1 text-uppercase",children:"Litre"}),Object(w.jsx)(Id,{product:r,setState:c,state:t,index:n,realQttLitre:v,setRealQttLitre:f,maxRealQttByLitre:D})," "]}),Object(w.jsxs)("div",{className:"d-flex  justify-content-between align-items-center ",children:[Object(w.jsxs)("div",{className:"text-center mr-2",children:[Object(w.jsx)("h5",{className:"mb-1",children:r.type}),Object(w.jsx)(Vd,{index:n,state:t,setState:c,product:r,setRealQtt:O,realQtt:m,maxRealQtt:N})]}),"FLACON"===r.type&&Object(w.jsxs)("div",{className:"text-inline text-center",children:[Object(w.jsx)("h5",{className:"mb-1",children:3==r.categoryId?"DOSE":"ML"}),Re(r.name,"ita new")&&Object(w.jsx)(Dd,{product:r,index:n,state:t,setState:c,setRealQttCC:u,realQttCC:o,maxRealQttCC:A}),Re(r.name,"sovax")&&Object(w.jsx)(Rd,{index:n,state:t,setState:c,realQttCC:o,setRealQttCC:u,product:r,maxRealQttCC:A}),0==r.condml&&0==r.qttccpvente&&!Re(r.name,"sovax")&&!Re(r.name,"ita new")&&Object(w.jsx)(_d,{index:n,realQttCC:o,setRealQttCC:u,state:t,setState:c,product:r,maxRealQttCC:A}),0!==r.condml&&0!==r.qttccpvente&&Object(w.jsx)(Qd,{product:r,state:t,realQttCC:o,setRealQttCC:u,maxRealQttCC:A,setState:c,index:n})]})]})]})})},Yd=function(e){return e&&0!==(null===e||void 0===e?void 0:e.length)?e.reduce((function(e,t){return e+t}),0):0};function Kd(e){var t,n,c;for(c in t=Array.isArray(e)?[]:{},e)n=e[c],t[c]="object"===typeof n?Kd(n):n;return t}var zd=function(e){var t=e.state,n=(e.meta,e.setState),c=e.disabled,r=e.products,i=e.commandes,s=Object(a.useState)("direct"),d=Object(p.a)(s,2),l=d[0],j=(d[1],Object(a.useState)(1)),b=Object(p.a)(j,2),m=(b[0],b[1],Object(a.useState)(null)),O=Object(p.a)(m,2),h=(O[0],O[1],Object(a.useState)(null)),x=Object(p.a)(h,2),v=(x[0],x[1]),g=Object(u.g)(),C=Object(a.useState)([]),N=Object(p.a)(C,2),y=N[0],q=N[1],S=Object(xe.d)((function(e){return{fromdepots:e.fromdepots}})),A=S.fromdepots;Object(a.useEffect)((function(){q(null===i||void 0===i?void 0:i.contenu)}),[i]);var E=Object(xe.c)(),P=Object(xe.d)(wn("emprunters").value),V=new Date,D=Object(a.useState)(V),F=Object(p.a)(D,2),R=F[0],M=F[1];Object(a.useEffect)((function(){E(qn("emprunters").fetch())}),[]);return Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)(zc.a,{children:[Object(w.jsx)(zc.a.Header,{className:" bg-dark py-3 text-white d-flex justify-content-between align-items-center",children:Object(w.jsx)("div",{style:{width:"60%"},children:"BON DE SORTIE"})}),Object(w.jsxs)("div",{className:"commande-vente",children:[Object(w.jsxs)(zc.a.Body,{style:{padding:12,marginTop:3,marginRight:2,marginLeft:2},children:[Object(w.jsx)("div",{className:"d-flex justify-content-end",children:Object(w.jsx)(o.b,{className:"btn btn-primary mb-2 btn-sm",to:Z,children:"Voir l'historique de vente"})}),Object(w.jsxs)("div",{style:{overflowY:"auto",height:"350px",maxHeight:"350px",overflowX:"hidden"},children:[Object(w.jsxs)("div",{class:"form-group",children:[Object(w.jsxs)("label",{children:["Date de sortie : ",Ve(R)]}),Object(w.jsx)("div",{children:Object(w.jsx)("input",{type:"date",disabled:c,onChange:function(e){return M(e.target.value)},value:R,className:"form-control"})})]}),"credit"===l&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("label",{children:"Crediteur:"}),Object(w.jsxs)("select",{disabled:c,className:"form-control",onChange:function(e){v(e.target.value)},children:[Object(w.jsx)("option",{value:""}),P.map((function(e){return Object(w.jsx)("option",{value:e.id,children:e.name})}))]})]}),(null===t||void 0===t?void 0:t.length)<=0&&Object(w.jsx)("div",{className:"alert alert-success ",children:"Aucune enregistrement trouv\xe9"}),null===t||void 0===t?void 0:t.sort((function(e,t){return t.quantityBruteCVA-e.quantityBruteCVA})).map((function(e,c){var a;return Object(w.jsx)(Ud,{product:e,realcommande:null===(a=i[0])||void 0===a?void 0:a.find((function(t){return t.id==e.id})),state:t,index:c,products:null===r||void 0===r?void 0:r.find((function(t){return t.id==e.id})),setState:n,basket:A,dispatch:E},"".concat(null===e||void 0===e?void 0:e.id,"_").concat(c))}))]})]}),(null===t||void 0===t?void 0:t.length)>0&&Object(w.jsxs)(zc.a.Footer,{className:"d-flex align-items-center justify-content-between",children:[Object(w.jsx)("div",{style:{width:"40%"},children:Object(w.jsx)("h2",{className:"p-2 text-uppercase bg-primary",children:Object(w.jsxs)("strong",{"data-test-id":"total-price-orders",children:["Total:",De(Yd(null===t||void 0===t?void 0:t.map((function(e){return Fi(e)?e.prixqttccvente*e.quantityParProduct*e.qttccpvente+e.prixVente*e.qttbylitre:e.prixVente*e.quantityParProduct})))+Yd(null===t||void 0===t?void 0:t.map((function(e){return e.prixParCC*e.qttByCC}))))]})})}),Object(w.jsx)("div",{style:{width:"60%"},children:(null===t||void 0===t?void 0:t.length)>0&&Object(w.jsxs)("div",{className:"d-flex text-right align-items-end justify-content-end",children:[Object(w.jsx)("button",{className:"btn btn-green btn-sm mr-2",disabled:0===(null===t||void 0===t?void 0:t.length),onClick:function(){var e,n=function(){var e=Kd(y).filter((function(e){return!t.find((function(t){return e.id===t.id}))})),n=Kd(y).filter((function(e){return!t.find((function(t){return e.id===t.id}))}));return{exist:Kd(y).map((function(e){return t.find((function(t){return t.id===e.id}))})).filter((function(e){return null!=e})),added:n,missing:e}}(),c=n.exist,r=n.added,a=n.missing;_i(t)?alert("modification non conforme,veuillez verifier"):(E(qn("commandes").updateTransaction((e={id:null===i||void 0===i?void 0:i.id,contenu:t,commande:t,type:"vente-cva",sorte:"sortie"},Object(f.a)(e,"sorte","sortie"),Object(f.a)(e,"status",!0),Object(f.a)(e,"dateCom",null!=R?R:V),Object(f.a)(e,"exist",c),Object(f.a)(e,"added",r),Object(f.a)(e,"missing",a),e),"update-from-magasin")),g.push(Z))},type:"button",children:"Valider l'operation"}),Object(w.jsx)("button",{className:"btn btn-danger btn-sm",onClick:function(){return g.goBack()},type:"button",children:Object(w.jsx)("span",{children:"Annuler"})})]})})]})]})]})})},Gd=function(){var e=Object(u.i)().id,t=Object(a.useState)(!1),n=Object(p.a)(t,2),c=n[0],r=n[1],s=Object(xe.c)(),d=Object(xe.d)(wn("commandes").value),l=Object(xe.d)(wn("commandes").meta),o=Object(xe.d)(wn("products").value),j=Object(xe.d)(wn("products").meta),b=Object(a.useState)([]),m=Object(p.a)(b,2),O=m[0],h=m[1];i.a.useEffect((function(){s(qn("commandes").get(e))}),[e]);var x=Object(a.useState)(""),v=Object(p.a)(x,2),f=v[0],g=v[1],C=Object(a.useState)([]),N=Object(p.a)(C,2),y=N[0],q=N[1];i.a.useEffect((function(){return 1==c&&(s(qn("products").fetch()),r(!1)),function(){r(!1)}}),[c]);var S=Object(a.useState)(),A=Object(p.a)(S,2);A[0],A[1];return i.a.useEffect((function(){h(fr(o,f))}),[f]),i.a.useEffect((function(){s(qn("products").fetch())}),[]),i.a.useEffect((function(){var e;l.isFetching||q(null===(e=d[0])||void 0===e?void 0:e.contenu)}),[l]),i.a.useEffect((function(){j.isFetching||h(o)}),[j]),Object(w.jsxs)("div",{children:[Object(w.jsx)("div",{className:"bg-dark text-white p-3 d-flex justify-content-center align-items-center",children:Object(w.jsx)("h1",{className:"",children:"CABINET VETERINAIRE AMBALAVAO"})}),Object(w.jsx)(xr.a,{className:"mt-3",children:Object(w.jsxs)(rr.a,{children:[Object(w.jsx)(ar.a,{xs:6,children:Object(w.jsx)(cr.a,{children:Object(w.jsxs)(zc.a,{children:[Object(w.jsx)(zc.a.Header,{className:"d-flex justify-content-between align-items-center bg-dark text-white",children:"Produits"}),Object(w.jsxs)(zc.a.Body,{children:[Object(w.jsx)("input",{type:"text",onChange:function(e){g(e.target.value)},placeholder:"Rechercher un produit",className:"form-control mb-2"}),Object(w.jsxs)("div",{style:{overflowY:"auto",height:"350px",maxHeight:"350px",overflowX:"hidden"},children:[Object(w.jsxs)(w.Fragment,{children:[O.map((function(e){return Object(w.jsx)(Pd,{state:y,realproduct:o,setState:q,product:e})})),0==O.length&&"Aucune enregistrement trouv\xe9"]})," "]})]})]})})}),Object(w.jsx)(ar.a,{xs:6,children:Object(w.jsx)(zd,{state:y,meta:l,disabled:j.isFetching,setState:q,products:o,commandes:d[0]})})]})})]})},Wd=function(e){return e&&0!==(null===e||void 0===e?void 0:e.length)?e.reduce((function(e,t){return e+t}),0):0};Object(u.j)((function(e){Object(u.h)();var t,n,c,r,i,s,d,l,o=Object(u.i)().id,j=Object(xe.d)(wn("commandes").value),b=Object(xe.c)();return Object(a.useEffect)((function(){b(qn("commandes").get(o))}),[o]),Object(w.jsxs)(qe,{children:[Object(w.jsx)(ge,{title:"D\xe9tail de vente du magasin",children:Object(w.jsx)(Ne,{title:"D\xe9tail de vente du magasin"})}),Object(w.jsxs)(Se,{children:[Object(w.jsxs)("div",{children:[Object(w.jsxs)("div",{children:[Object(w.jsx)("p",{children:"credit-cva"==(null===(t=j[0])||void 0===t?void 0:t.type)&&Object(w.jsx)("p",{children:"Credit"})}),"credit-cva"==(null===(n=j[0])||void 0===n?void 0:n.type)&&Object(w.jsx)("div",{className:"border",children:Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("h3",{children:null===(c=j[0])||void 0===c?void 0:c.emprunter.name}),Object(w.jsx)("h5",{children:null===(r=j[0])||void 0===r?void 0:r.emprunter.contact})]})}),j.length>0&&Object(w.jsxs)("div",{className:"d-flex justify-content-between",children:[Object(w.jsxs)("h2",{className:"my-2",children:["Date : ",Ve(null===(i=j[0])||void 0===i?void 0:i.dateCom)]}),Object(w.jsx)("div",{className:"d-flex justify-content-end",children:Object(w.jsxs)("div",{className:"bg-thead p-1 mb-1",children:[Object(w.jsx)("strong",{children:"Recette:"}),":",Object(w.jsx)("h3",{className:"text-lg",children:De(Wd(null===(s=j[0])||void 0===s?void 0:s.contenu.map((function(e){return pa(e)?e.prixlitre*e.quantityParProduct:e.prixVente*e.quantityParProduct})))+Wd(null===(d=j[0])||void 0===d?void 0:d.contenu.map((function(e){return e.prixParCC*e.qttByCC}))))})]})})]}),Object(w.jsxs)("table",{className:"table table-bordered",children:[Object(w.jsxs)("tr",{className:"bg-thead",children:[Object(w.jsx)("td",{children:"Nom de l'article"}),Object(w.jsx)("td",{children:"Quantit\xe9"}),Object(w.jsx)("td",{children:"Sous total"})]}),j.length>0&&(null===(l=j[0])||void 0===l?void 0:l.contenu.map((function(e){return Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{style:{width:"40%"},children:e.name}),Object(w.jsx)(w.Fragment,{children:0!=e.quantityParProduct&&Object(w.jsxs)("div",{className:"d-flex align-items-center py-0",children:[Object(w.jsxs)("strong",{children:[e.type,":"]}),De(e.prixVente)," (","x"," ",e.quantityParProduct,") "," = ",De(e.prixVente*e.quantityParProduct)]})}),"FLACON"==e.type&&Object(w.jsx)(w.Fragment,{children:0!=e.qttByCC&&Object(w.jsxs)("div",{className:"d-flex align-items-center  py-0",children:[Object(w.jsx)("strong",{children:"ML:"})," ",De(e.prixParCC)," ","x"," ",0!=e.qttyspecificmirror?e.qttyspecificmirror+" Dose":e.qttByCC+" Ml"," "," = "," ",De(e.prixParCC*e.qttByCC)]})}),Object(w.jsx)("td",{children:De(e.prixVente*e.quantityParProduct+e.prixParCC*e.qttByCC)})]})})))]})]})," "]})," "]})]})}));var Xd=function(e){var t,n=e.state,c=e.setState,r=e.product,a=(Object(xe.c)(),!!(null===n||void 0===n?void 0:n.find((function(e){return(null===e||void 0===e?void 0:e.id)===r.id})))),s=i.a.useCallback((function(){return r.quantityBruteCVA>15&&r.quantityBruteCVA<=20?"yellow":r.quantityBruteCVA>10&&r.quantityBruteCVA<=15?"#ffdb4c":r.quantityBruteCVA>5&&r.quantityBruteCVA<=10?" orange":r.quantityBruteCVA>0&&r.quantityBruteCVA<=5?"#c44e14b8":0==r.quantityBruteCVA?"red":"green"}),[r]),d=i.a.useCallback((function(){return r.quantityCCCVA>15&&r.quantityCCCVA<=20?"yellow":r.quantityCCCVA>10&&r.quantityCCCVA<=15?"#ffdb4c":r.quantityCCCVA>5&&r.quantityCCCVA<=10?" orange":r.quantityCCCVA>0&&r.quantityCCCVA<=5?"#c44e14b8":0==r.quantityCCCVA?"red":"green"}),[r]);return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(cr.a.Item,{className:"mb-2 mr-3",style:{width:"100%",border:"1px solid gray",background:"whitesmoke",borderLeft:"10px solid ".concat(s())},children:Object(w.jsxs)("div",{className:" d-flex justify-content-between align-items-center",children:[Object(w.jsxs)("div",{className:" ".concat(r.id?"":"product-loading"),style:{boxShadow:r&&a?"15px 10px 15px rgba(0, 0, 0, .07)":"none"},children:[Object(w.jsxs)("div",{children:[Object(w.jsx)("div",{style:{width:10,height:4,background:"".concat(d())}}),Object(w.jsxs)("div",{children:[r.name," "]}),Object(w.jsx)("div",{class:"badge badge-primary",children:null===r||void 0===r||null===(t=r.fournisseur)||void 0===t?void 0:t.name}),Object(w.jsx)("br",{})]})," "]}),Object(w.jsx)("div",{children:(null===r||void 0===r?void 0:r.id)&&Object(w.jsx)(w.Fragment,{children:a?Object(w.jsx)("button",{disabled:0===r.quantityBruteCVA&&(0==r.quantityCCCVA||null==r.quantityCCCVA),className:"btn btn-danger btn-sm",onClick:function(){!function(e){c(n.filter((function(t){return t.id!==e})))}(null===r||void 0===r?void 0:r.id)},children:"Retirer"}):Object(w.jsx)("button",{disabled:0===r.quantityBruteCVA&&(0==r.quantityCCCVA||null==r.quantityCCCVA),className:"btn btn-green btn-sm",onClick:function(){c(n.some((function(e){return e.id===r.id}))?n:[r].concat(Object(me.a)(n)))},children:"Ajouter"})})})]})})})},Jd=function(e){var t=e.product,n=e.index,c=e.state,r=e.setState,a=e.setRealQtt,i=e.realQtt,s=(e.maxRealQtt,function(e){!function(e,t,n){var a=Object(me.a)(c);a[e]=Object(_e.a)(Object(_e.a)({},a[e]),{},Object(f.a)({},t,n)),r(a)}(n,"quantityParProduct",e)});return Object(w.jsx)("div",{className:"basket-item-control",children:Object(w.jsxs)(Rc.c,{inputMode:"numeric",w:28,bg:"whitesmoke",onChange:function(e){""==e?(a(null===t||void 0===t?void 0:t.quantityParProduct),s(null===t||void 0===t?void 0:t.quantityParProduct)):(a(Number(e)),s(Number(e)))},min:0,value:i,defaultValue:null===t||void 0===t?void 0:t.quantityParProduct,children:[Object(w.jsx)(Rc.d,{}),Object(w.jsxs)(Rc.e,{children:[Object(w.jsx)(Rc.b,{}),Object(w.jsx)(Rc.a,{})]})]})})},Zd=function(e){var t=e.product,n=e.setRealQttCC,c=e.realQttCC,r=e.maxRealQttCC,a=Object(xe.c)();return Object(w.jsx)("div",{className:"basket-item-control",children:Object(w.jsxs)(Rc.c,{inputMode:"decimal",w:28,step:1,bg:"whitesmoke",onChange:function(e){!function(e){a(vi(t.id,e))}(e),n(e)},min:0,value:c,defaultValue:null===t||void 0===t?void 0:t.qttByCC,max:r,children:[Object(w.jsx)(Rc.d,{}),Object(w.jsxs)(Rc.e,{children:[Object(w.jsx)(Rc.b,{}),Object(w.jsx)(Rc.a,{})]})]})})},$d=function(e){var t=e.product,n=e.setRealQttCC,c=e.realQttCC,r=e.maxRealQttCC,a=Object(xe.c)(),i=function(e){a(fi(t.id,e))};return Object(w.jsx)("div",{className:"basket-item-control",children:Object(w.jsxs)(Rc.c,{inputMode:"decimal",w:28,bg:"whitesmoke",onChange:function(e){""==e?(i(0),n(0)):(i(Number(e)),n(Number(e)))},min:0,value:c,defaultValue:null===t||void 0===t?void 0:t.qttByCC,max:r,children:[Object(w.jsx)(Rc.d,{}),Object(w.jsxs)(Rc.e,{children:[Object(w.jsx)(Rc.b,{}),Object(w.jsx)(Rc.a,{})]})]})})},el=function(e){var t=e.product,n=e.setRealQttCC,c=e.maxRealQttCC,r=e.realQttCC,a=Object(xe.c)();return Object(w.jsx)("div",{className:"basket-item-control",children:Object(w.jsxs)(Rc.c,{inputMode:"numeric",w:28,step:1,bg:"whitesmoke",onChange:function(e){!function(e){a(pi(t.id,e))}(Number(e)),n(Number(e))},min:0,value:r,defaultValue:null===t||void 0===t?void 0:t.qttByCC,max:c,children:[Object(w.jsx)(Rc.d,{}),Object(w.jsxs)(Rc.e,{children:[Object(w.jsx)(Rc.b,{}),Object(w.jsx)(Rc.a,{})]})]})})},tl=function(e){var t=e.product,n=e.setRealQttCC,c=(e.maxRealQttCC,e.index),r=e.setState,a=e.state,i=e.realQttCC,s=function(e){!function(e,t,n){var c=Object(me.a)(a);c[e]=Object(_e.a)(Object(_e.a)({},c[e]),{},Object(f.a)({},t,n)),r(c)}(c,"qttByCC",e)};return Object(w.jsx)("div",{className:"basket-item-control",children:Object(w.jsxs)(Rc.c,{inputMode:"numeric",w:28,bg:"whitesmoke",onChange:function(e){""==e?(s(null===t||void 0===t?void 0:t.qttByCC),n(null===t||void 0===t?void 0:t.qttByCC)):(n(1*e),s(1*e))},min:0,value:i,children:[Object(w.jsx)(Rc.d,{}),Object(w.jsxs)(Rc.e,{children:[Object(w.jsx)(Rc.b,{}),Object(w.jsx)(Rc.a,{})]})]})})},nl=function(e){var t=e.product,n=e.setRealQttLitre,c=e.setState,r=e.state,a=e.realQttLitre,i=e.index,s=function(e){!function(e,t,n){var a=Object(me.a)(r);a[e]=Object(_e.a)(Object(_e.a)({},a[e]),{},Object(f.a)({},t,n)),c(a)}(i,"qttbylitre",e)};return Object(w.jsx)("div",{className:"basket-item-control",children:Object(w.jsxs)(Rc.c,{inputMode:"numeric",w:28,step:1,bg:"whitesmoke",min:0,value:a,defaultValue:null===t||void 0===t?void 0:t.qttbylitre,onChange:function(e){""==e?(n(null===t||void 0===t?void 0:t.qttbylitre),s(null===t||void 0===t?void 0:t.qttbylitre)):(n(Number(e)),s(Number(e)))},children:[Object(w.jsx)(Rc.d,{}),Object(w.jsxs)(Rc.e,{children:[Object(w.jsx)(Rc.b,{}),Object(w.jsx)(Rc.a,{})]})]})})},cl=function(e){var t=e.product,n=e.state,c=e.setState,r=e.realQttCC,a=e.setRealQttCC,i=(e.maxRealQttCC,e.index),s=(Object(xe.c)(),function(e){!function(e,t,r){var a=Object(me.a)(n);a[e]=Object(_e.a)(Object(_e.a)({},a[e]),{},Object(f.a)({},t,r)),c(a)}(i,"qttByCC",e)});return Object(w.jsx)("div",{className:"basket-item-control",children:Object(w.jsxs)(Rc.c,{inputMode:"decimal",w:28,bg:"whitesmoke",onChange:function(e){""==e?(s(0),a(0)):(a(Number(e)),s(Number(e)))},min:0,value:r,defaultValue:null===t||void 0===t?void 0:t.qttByCC,children:[Object(w.jsx)(Rc.d,{}),Object(w.jsxs)(Rc.e,{children:[Object(w.jsx)(Rc.b,{}),Object(w.jsx)(Rc.a,{})]})]})})},rl=function(e){return!(0==e.condml||0==e.condsize||0==e.qttccpvente||0==e.prixqttccvente)},al=function(e){return 1==e.correctiontype?{text:"plus (+"+e.correction+") et ("+e.correctionml+")",textStyle:"text text-info",date:Ve(e.datedecorrection),style:"badge badge-info"}:2==e.correctiontype?{text:"moins (-"+e.correction+")  et ("+e.correctionml+")",textStyle:"text text-warning",date:Ve(e.datedecorrection),style:"badge badge-warning"}:3==e.correctiontype?{text:"ajouter au commande ( + "+e.correction+")  et ("+e.correctionml+")",textStyle:"text text-success",date:Ve(e.datedecorrection),style:"badge badge-success"}:4==e.correctiontype?{text:"supprimer du commande ( - "+e.correction+")  et ("+e.correctionml+")",textStyle:"text text-danger",date:Ve(e.datedecorrection),style:"badge badge-danger"}:void 0},il=function(e){var t=e.state,n=e.index,c=e.setState,r=e.product,s=e.products,d=(Object(xe.c)(),Object(a.useState)(null===r||void 0===r?void 0:r.qttByCC)),l=Object(p.a)(d,2),o=l[0],u=l[1],j=Object(a.useState)(null===r||void 0===r?void 0:r.quantityParProduct),b=Object(p.a)(j,2),m=b[0],O=b[1],h=Object(a.useState)(null===r||void 0===r?void 0:r.qttbylitre),x=Object(p.a)(h,2),v=x[0],f=x[1],g=Object(a.useState)(2e3),C=Object(p.a)(g,2),N=C[0],y=C[1],q=Object(a.useState)(2e3),S=Object(p.a)(q,2),A=S[0],E=S[1],P=Object(a.useState)(2e3),V=Object(p.a)(P,2),D=V[0],F=V[1],R=Object(xe.d)(wn("commandes").value);return i.a.useEffect((function(){if(void 0!=s&&void 0!=t&&R.length>0){var e=null===t||void 0===t?void 0:t.find((function(e){return null===r||void 0===r?void 0:r.id})),n=Bs(s,R[0],e),c=n.normalQtt,a=n.normalQttCC,i=n.normalQttLitre,d=n.isSpecific;0==n.isValid&&(alert("stock insuffisant :("),d?(f(i),F(i),O(c),y(c),u(a),E(a)):(O(c),y(c),u(a),E(a))),console.log(v)}}),[m,o,v,s]),Object(w.jsx)("div",{children:Object(w.jsxs)("div",{className:"d-flex justify-content-between align-items-center border mt-3  mb-2 p-2",children:[Object(w.jsxs)("div",{style:{width:"45%"},children:[r.correction>0&&Object(w.jsxs)("div",{children:[Object(w.jsx)("div",{className:al(r).style,children:Object(w.jsx)("p",{children:al(r).text})}),Object(w.jsxs)("p",{className:al(r).textStyle,children:["Date de modification:",al(r).date]})]}),Object(w.jsx)("p",{className:"text-blue",children:r.name}),rl(r)?Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("p",{className:"text-lowercase",children:Object(w.jsx)("strong",{children:0!=r.qttbylitre&&Object(w.jsx)("span",{style:{marginRight:"30px"},children:De(r.prixVente)+" x "+r.qttbylitre+" Litre(s)"})})}),Object(w.jsx)("p",{className:"text-lowercase",children:Object(w.jsx)("strong",{children:0!=r.quantityParProduct&&Object(w.jsx)("span",{style:{marginRight:"30px"},children:De(r.prixqttccvente*r.qttccpvente)+" x "+r.quantityParProduct+" "+r.type})})})]}):Object(w.jsx)("p",{className:"text-lowercase",children:Object(w.jsx)("strong",{children:0!=r.quantityParProduct&&Object(w.jsx)("span",{style:{marginRight:"30px"},children:De(r.prixVente)+" x "+r.quantityParProduct+" "+r.type})})}),Object(w.jsx)("p",{className:"text-lowercase",children:Object(w.jsx)("strong",{children:0!=r.qttByCC&&Object(w.jsx)("span",{style:{marginRight:"30px"},children:De(r.prixParCC)+" x "+r.qttByCC+" ML"})})})]}),0!==r.condml&&0!==r.qttccpvente&&Object(w.jsxs)("div",{className:"text-inline text-center mr-3",children:[Object(w.jsx)("h5",{className:"mb-1 text-uppercase",children:"Litre"}),Object(w.jsx)(nl,{product:r,setState:c,state:t,index:n,realQttLitre:v,setRealQttLitre:f,maxRealQttByLitre:D})," "]}),Object(w.jsxs)("div",{className:"d-flex  justify-content-between align-items-center ",children:[Object(w.jsxs)("div",{className:"text-center mr-2",children:[Object(w.jsx)("h5",{className:"mb-1",children:r.type}),Object(w.jsx)(Jd,{index:n,state:t,setState:c,product:r,setRealQtt:O,realQtt:m,maxRealQtt:N})]}),"FLACON"===r.type&&Object(w.jsxs)("div",{className:"text-inline text-center",children:[Object(w.jsx)("h5",{className:"mb-1",children:3==r.categoryId?"DOSE":"ML"}),Re(r.name,"ita new")&&Object(w.jsx)(Zd,{product:r,index:n,state:t,setState:c,setRealQttCC:u,realQttCC:o,maxRealQttCC:A}),Re(r.name,"sovax")&&Object(w.jsx)(el,{index:n,state:t,setState:c,realQttCC:o,setRealQttCC:u,product:r,maxRealQttCC:A}),0==r.condml&&0==r.qttccpvente&&!Re(r.name,"sovax")&&!Re(r.name,"ita new")&&Object(w.jsx)(tl,{index:n,realQttCC:o,setRealQttCC:u,state:t,setState:c,product:r,maxRealQttCC:A}),0!==r.condml&&0!==r.qttccpvente&&Object(w.jsx)(cl,{product:r,state:t,realQttCC:o,setRealQttCC:u,maxRealQttCC:A,setState:c,index:n})]})]})]})})},sl=function(e){return e&&0!==(null===e||void 0===e?void 0:e.length)?e.reduce((function(e,t){return e+t}),0):0};function dl(e){var t,n,c;for(c in t=Array.isArray(e)?[]:{},e)n=e[c],t[c]="object"===typeof n?dl(n):n;return t}var ll=function(e){var t=e.state,n=(e.meta,e.setState),c=e.disabled,r=e.products,i=e.commandes,s=Object(a.useState)("direct"),d=Object(p.a)(s,2),l=d[0],j=(d[1],Object(a.useState)(1)),b=Object(p.a)(j,2),m=(b[0],b[1],Object(a.useState)(null)),O=Object(p.a)(m,2),h=(O[0],O[1],Object(a.useState)(null)),x=Object(p.a)(h,2),v=(x[0],x[1]),g=Object(u.g)(),C=Object(a.useState)([]),N=Object(p.a)(C,2),y=N[0],q=N[1],S=Object(xe.d)((function(e){return{fromdepots:e.fromdepots}})),A=S.fromdepots;Object(a.useEffect)((function(){q(null===i||void 0===i?void 0:i.contenu)}),[i]);var E=Object(xe.c)(),P=Object(xe.d)(wn("emprunters").value),V=new Date,D=Object(a.useState)(V),F=Object(p.a)(D,2),R=F[0],M=F[1];Object(a.useEffect)((function(){E(qn("emprunters").fetch())}),[]);return Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)(zc.a,{children:[Object(w.jsx)(zc.a.Header,{className:" bg-dark py-3 text-white d-flex justify-content-between align-items-center",children:Object(w.jsx)("div",{style:{width:"60%"},children:"BON DE SORTIE"})}),Object(w.jsxs)("div",{className:"commande-vente",children:[Object(w.jsxs)(zc.a.Body,{style:{padding:12,marginTop:3,marginRight:2,marginLeft:2},children:[Object(w.jsx)("div",{className:"d-flex justify-content-end",children:Object(w.jsx)(o.b,{className:"btn btn-primary mb-2 btn-sm",to:ue,children:"Voir l'historique de vente"})}),Object(w.jsxs)("div",{style:{overflowY:"auto",height:"350px",maxHeight:"350px",overflowX:"hidden"},children:[Object(w.jsxs)("div",{class:"form-group",children:[Object(w.jsxs)("label",{children:["Date de sortie : ",Ve(R)]}),Object(w.jsx)("div",{children:Object(w.jsx)("input",{type:"date",disabled:c,onChange:function(e){return M(e.target.value)},value:R,className:"form-control"})})]}),"credit"===l&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("label",{children:"Crediteur:"}),Object(w.jsxs)("select",{disabled:c,className:"form-control",onChange:function(e){v(e.target.value)},children:[Object(w.jsx)("option",{value:""}),P.map((function(e){return Object(w.jsx)("option",{value:e.id,children:e.name})}))]})]}),(null===t||void 0===t?void 0:t.length)<=0&&Object(w.jsx)("div",{className:"alert alert-success ",children:"Aucune enregistrement trouv\xe9"}),null===t||void 0===t?void 0:t.sort((function(e,t){return t.quantityBruteCVA-e.quantityBruteCVA})).map((function(e,c){var a;return Object(w.jsx)(il,{product:e,realcommande:null===(a=i[0])||void 0===a?void 0:a.find((function(t){return t.id==e.id})),state:t,index:c,products:null===r||void 0===r?void 0:r.find((function(t){return t.id==e.id})),setState:n,basket:A,dispatch:E},"".concat(null===e||void 0===e?void 0:e.id,"_").concat(c))}))]})]}),(null===t||void 0===t?void 0:t.length)>0&&Object(w.jsxs)(zc.a.Footer,{className:"d-flex align-items-center justify-content-between",children:[Object(w.jsx)("div",{style:{width:"40%"},children:Object(w.jsx)("h2",{className:"p-2 text-uppercase bg-primary",children:Object(w.jsxs)("strong",{"data-test-id":"total-price-orders",children:["Total:",De(sl(null===t||void 0===t?void 0:t.map((function(e){return Ds(e)?e.prixqttccvente*e.quantityParProduct*e.qttccpvente+e.prixlitre*e.qttbylitre:e.prixVente*e.quantityParProduct})))+sl(null===t||void 0===t?void 0:t.map((function(e){return e.prixParCC*e.qttByCC}))))]})})}),Object(w.jsx)("div",{style:{width:"60%"},children:(null===t||void 0===t?void 0:t.length)>0&&Object(w.jsxs)("div",{className:"d-flex text-right align-items-end justify-content-end",children:[Object(w.jsx)("button",{className:"btn btn-green btn-sm mr-2",disabled:0===(null===t||void 0===t?void 0:t.length),onClick:function(){var e,n=function(){var e=dl(y).filter((function(e){return!t.find((function(t){return e.id===t.id}))})),n=dl(y).filter((function(e){return!t.find((function(t){return e.id===t.id}))}));return{exist:dl(y).map((function(e){return t.find((function(t){return t.id===e.id}))})).filter((function(e){return null!=e})),added:n,missing:e}}(),c=n.exist,r=n.added,a=n.missing;ks(t)?alert("modification non conforme,veuillez verifier"):E(qn("commandes").updateTransaction((e={id:null===i||void 0===i?void 0:i.id,contenu:t,commande:t,type:"vente-cva",sorte:"sortie"},Object(f.a)(e,"sorte","sortie"),Object(f.a)(e,"status",!0),Object(f.a)(e,"dateCom",null!=R?R:V),Object(f.a)(e,"exist",c),Object(f.a)(e,"added",r),Object(f.a)(e,"missing",a),e),"update-from-magasin"))},type:"button",children:"Valider l'operation"}),Object(w.jsx)("button",{className:"btn btn-danger btn-sm",onClick:function(){return g.goBack()},type:"button",children:Object(w.jsx)("span",{children:"Annuler"})})]})})]})]})]})})},ol=function(){var e=Object(u.i)().id,t=Object(a.useState)(!1),n=Object(p.a)(t,2),c=n[0],r=n[1],s=Object(xe.c)(),d=Object(xe.d)(wn("commandes").value),l=Object(xe.d)(wn("commandes").meta),o=Object(xe.d)(wn("products").value),j=Object(xe.d)(wn("products").meta),b=Object(a.useState)([]),m=Object(p.a)(b,2),O=m[0],h=m[1];i.a.useEffect((function(){s(qn("commandes").get(e))}),[e]);var x=Object(a.useState)(""),v=Object(p.a)(x,2),f=v[0],g=v[1],C=Object(a.useState)([]),N=Object(p.a)(C,2),y=N[0],q=N[1];i.a.useEffect((function(){return 1==c&&(s(qn("products").fetch()),r(!1)),function(){r(!1)}}),[c]);var S=Object(a.useState)(),A=Object(p.a)(S,2);A[0],A[1];return i.a.useEffect((function(){h(fr(o,f))}),[f]),i.a.useEffect((function(){s(qn("products").fetch())}),[]),i.a.useEffect((function(){var e;l.isFetching||q(null===(e=d[0])||void 0===e?void 0:e.contenu)}),[l]),i.a.useEffect((function(){j.isFetching||h(o)}),[j]),Object(w.jsx)("div",{children:Object(w.jsxs)(qe,{children:[Object(w.jsx)(ge,{title:"Editer une vente du magasin",children:Object(w.jsx)(Ne,{title:"Editer une vente du magasin"})}),Object(w.jsx)(Se,{children:Object(w.jsxs)(rr.a,{children:[Object(w.jsx)(ar.a,{xs:6,children:Object(w.jsx)(cr.a,{children:Object(w.jsxs)(zc.a,{children:[Object(w.jsx)(zc.a.Header,{className:"d-flex justify-content-between align-items-center bg-dark text-white",children:"Produits"}),Object(w.jsxs)(zc.a.Body,{children:[Object(w.jsx)("input",{type:"text",onChange:function(e){g(e.target.value)},placeholder:"Rechercher un produit",className:"form-control mb-2"}),Object(w.jsxs)("div",{style:{overflowY:"auto",height:"350px",maxHeight:"350px",overflowX:"hidden"},children:[Object(w.jsxs)(w.Fragment,{children:[O.map((function(e){return Object(w.jsx)(Xd,{state:y,realproduct:o,setState:q,product:e})})),0==O.length&&"Aucune enregistrement trouv\xe9"]})," "]})]})]})})}),Object(w.jsx)(ar.a,{xs:6,children:Object(w.jsx)(ll,{state:y,meta:l,disabled:j.isFetching,setState:q,products:o,commandes:d[0]})})]})})]})})},ul=function(e){var t=e.product,n=e.index,c=e.state,r=e.setState,a=(e.setRealQttCC,e.setRealQtt),i=e.stock,s=e.realcommand,d=(e.realQtt,e.realQttCC,function(e){console.log(e),function(e,t,n){var a=Object(me.a)(c);a[e]=Object(_e.a)(Object(_e.a)({},a[e]),{},Object(f.a)({},t,n)),console.log(a),r(a)}(n,"quantityParProduct",e)});return Object(w.jsx)("div",{className:"basket-item-control",children:(null===i||void 0===i?void 0:i.quantityBruteCVA)<(null===s||void 0===s?void 0:s.quantityParProduct)?Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("div",{children:Object(w.jsxs)(Rc.c,{inputMode:"numeric",w:28,step:1,disabled:!0,bg:"whitesmoke",onChange:function(e){d(Number(e)),a(Number(e)),(null===i||void 0===i?void 0:i.quantityBruteCVA)-(null===s||void 0===s?void 0:s.quantityParProduct)<0&&alert("Le stock ne satisfait pas votre commande")},defaultValue:null===s||void 0===s?void 0:s.quantityParProduct,children:[Object(w.jsx)(Rc.d,{}),Object(w.jsxs)(Rc.e,{children:[Object(w.jsx)(Rc.b,{}),Object(w.jsx)(Rc.a,{})]})]})}),4==(null===s||void 0===s?void 0:s.correctiontype)?Object(w.jsx)("div",{children:Object(w.jsx)(Ws.a,{textTransform:"uppercase",className:"text text-danger",children:"CE PRODUIT A ETE RETIR\xc9"})}):Object(w.jsxs)("div",{children:[Object(w.jsx)(Ws.a,{textTransform:"uppercase",children:"Restituable"}),Object(w.jsxs)(Rc.c,{inputMode:"numeric",w:28,step:1,bg:"whitesmoke",min:0,onChange:function(e){d(Number(e)),a(Number(e))},defaultValue:null===i||void 0===i?void 0:i.quantityBruteCVA,max:null===i||void 0===i?void 0:i.quantityBrute,children:[Object(w.jsx)(Rc.d,{}),Object(w.jsxs)(Rc.e,{children:[Object(w.jsx)(Rc.b,{}),Object(w.jsx)(Rc.a,{})]})]})]})]}):Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)(Rc.c,{inputMode:"numeric",w:28,step:1,bg:"whitesmoke",onChange:function(e){d(Number(e)),a(Number(e)),(null===i||void 0===i?void 0:i.quantityBruteCVA)-(null===s||void 0===s?void 0:s.quantityParProduct)<0&&alert("Le stock ne satisfait pas votre commande")},min:0,defaultValue:null===t||void 0===t?void 0:t.quantityParProduct,max:null===i||void 0===i?void 0:i.quantityBrute,children:[Object(w.jsx)(Rc.d,{}),Object(w.jsxs)(Rc.e,{children:[Object(w.jsx)(Rc.b,{}),Object(w.jsx)(Rc.a,{})]})]})})})},jl=function(e){return 1==e.correctiontype?{text:"plus (+"+e.correction+")",textStyle:"text text-info",date:Ve(e.datedecorrection),style:"badge badge-info"}:2==e.correctiontype?{text:"moins (-"+e.correction+")",textStyle:"text text-warning",date:Ve(e.datedecorrection),style:"badge badge-warning"}:3==e.correctiontype?{text:"ajouter au commande ( + "+e.correction+")",textStyle:"text text-success",date:Ve(e.datedecorrection),style:"badge badge-success"}:4==e.correctiontype?{text:"supprimer du commande ( - "+e.correction+")",textStyle:"text text-danger",date:Ve(e.datedecorrection),style:"badge badge-danger"}:void 0},bl=function(e){var t=e.state,n=e.index,c=e.setState,r=e.cloneCommandes,i=e.product,s=e.realstock,d=(e.realcommand,Object(a.useState)(null)),l=Object(p.a)(d,2),o=l[0],u=l[1],j=Object(a.useState)(null),b=Object(p.a)(j,2),m=b[0],O=b[1],h=s.find((function(e){return e.id==i.id})),x=null===r||void 0===r?void 0:r.contenu.find((function(e){return e.id==i.id}));return Object(w.jsxs)("div",{className:" mb-2 p-2",style:{opacity:(null===h||void 0===h?void 0:h.quantityBruteCVA)<(null===x||void 0===x?void 0:x.quantityParProduct)?.8:1,border:(null===h||void 0===h?void 0:h.quantityBruteCVA)<(null===x||void 0===x?void 0:x.quantityParProduct)?"1px solid red":"1px solid gray"},children:[(null===h||void 0===h?void 0:h.quantityBruteCVA)<(null===x||void 0===x?void 0:x.quantityParProduct)&&Object(w.jsx)("div",{className:"text-danger text-sm",children:"** Des operations ont \xeate d\xe9ja faite apres la sortie vers magasin et vous ne pourrez pas retourner tous les produits au dep\xf4t**"}),Object(w.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[Object(w.jsxs)("div",{style:{width:"45%"},children:[i.correction>0&&Object(w.jsxs)("div",{children:[Object(w.jsx)("div",{className:jl(i).style,children:Object(w.jsx)("p",{children:jl(i).text})}),Object(w.jsxs)("p",{className:jl(i).textStyle,children:["Date de modification:",jl(i).date]})]}),Object(w.jsx)("p",{className:"text-blue",children:i.name}),Object(w.jsx)("span",{className:"text-lowercase",children:Object(w.jsxs)("strong",{children:[0!=i.quantityParProduct&&De(i.prixVente),0==i.quantityParProduct&&0!=i.prixParCC&&Object(w.jsx)(w.Fragment,{children:null!=i.prixqttccvente&&0!=i.prixqttccvente?De(i.prixqttccvente):De(i.prixParCC)}),0!=i.quantityParProduct&&" x "+i.quantityParProduct+" "+i.type," ",null==i.prixqttccvente&&0==i.prixqttccvente&&Object(w.jsx)(w.Fragment,{children:0!=i.qttByCC&&(0==i.quantityParProduct?" x ":"+")+i.qttByCC+"ML"})]})})]}),Object(w.jsxs)("div",{className:"text-inline text-center",children:[Object(w.jsx)("h5",{className:"mb-1",children:i.type}),Object(w.jsx)(ul,{index:n,state:t,setState:c,product:i,realcommand:x,setRealQttCC:u,setRealQtt:O,realQtt:m,stock:h,realQttCC:o})]})]})]})},ml=function(e){return e&&0!==(null===e||void 0===e?void 0:e.length)?e.reduce((function(e,t){return e+t}),0):0};function Ol(e){var t,n,c;for(c in t=Array.isArray(e)?[]:{},e)n=e[c],t[c]="object"===typeof n?Ol(n):n;return t}var hl=function(e){var t,n,c=e.state,r=(e.meta,e.setState),i=e.realstock,s=e.disabled,d=e.cloneCommandes,l=e.commandes,o=Object(a.useState)("direct"),j=Object(p.a)(o,2),b=j[0],m=(j[1],Object(a.useState)(1)),O=Object(p.a)(m,2),h=(O[0],O[1],Object(a.useState)(null)),x=Object(p.a)(h,2),v=(x[0],x[1],Object(a.useState)(null)),g=Object(p.a)(v,2),C=(g[0],g[1]),N=Object(u.g)(),y=Object(a.useState)([]),q=Object(p.a)(y,2),S=q[0],A=q[1],E=Object(xe.d)((function(e){return{tomagasins:e.tomagasins}})),P=E.tomagasins;Object(a.useEffect)((function(){A(null===l||void 0===l?void 0:l.contenu)}),[l]);var V=Object(xe.c)(),D=Object(xe.d)(wn("emprunters").value),F=new Date,R=Object(a.useState)(F),M=Object(p.a)(R,2),B=M[0],T=M[1];Object(a.useEffect)((function(){}),[]);return Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)(zc.a,{children:[Object(w.jsx)(zc.a.Header,{className:" bg-dark py-3 text-white d-flex justify-content-between align-items-center",children:Object(w.jsx)("div",{style:{width:"60%"},children:"BON DE SORTIE"})}),Object(w.jsxs)("div",{className:"commande-vente",children:[Object(w.jsx)(zc.a.Body,{style:{padding:12,marginTop:3,marginRight:2,marginLeft:2},children:Object(w.jsxs)("div",{style:{overflowY:"auto",height:"350px",maxHeight:"350px",overflowX:"hidden"},children:[Object(w.jsxs)("div",{className:"alert alert-warning",children:[Object(w.jsx)("span",{className:"text-uppercase",children:"Attention !!!"})," , la modification d'un bon de sortie entraine aussi la mis \xe0 jour de stock du produit"]}),Object(w.jsxs)("div",{class:"form-group",children:[Object(w.jsxs)("label",{children:["Date de sortie : ",Ve(B)]}),Object(w.jsx)("div",{children:Object(w.jsx)("input",{disabled:s,type:"date",onChange:function(e){return T(e.target.value)},value:B,className:"form-control"})})]}),"credit"===b&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("label",{children:"Crediteur:"}),Object(w.jsxs)("select",{disabled:s,className:"form-control",onChange:function(e){C(e.target.value)},children:[Object(w.jsx)("option",{value:""}),D.map((function(e){return Object(w.jsx)("option",{value:e.id,children:e.name})}))]})]}),(null===c||void 0===c?void 0:c.length)<=0&&Object(w.jsx)("div",{className:"alert alert-success ",children:"Aucune enregistrement trouv\xe9"}),null===c||void 0===c?void 0:c.map((function(e,t){return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(bl,{product:tn.a.cloneDeep(e),state:c,index:t,realcommand:e,cloneCommandes:d,realstock:i,setState:r,basket:P,dispatch:V},"".concat(null===e||void 0===e?void 0:e.id,"_").concat(t))})}))]})}),(null===c||void 0===c?void 0:c.length)>0&&Object(w.jsxs)(zc.a.Footer,{className:"d-flex align-items-center justify-content-between",children:[Object(w.jsx)("div",{style:{width:"30%"},children:Object(w.jsx)("h2",{className:"p-2 text-uppercase bg-primary",children:Object(w.jsxs)("strong",{"data-test-id":"total-price-orders",children:["Total:",De(ml(null===c||void 0===c?void 0:c.map((function(e){return e.prixVente*e.quantityParProduct})))+ml(null===c||void 0===c||null===(t=c.state)||void 0===t?void 0:t.map((function(e){return e.prixParCC*e.qttByCC}))))]})})}),Object(w.jsx)("div",{style:{width:"70%"},children:(null===c||void 0===c?void 0:c.length)>0&&Object(w.jsxs)("div",{className:"d-flex text-right align-items-end justify-content-end",children:[Object(w.jsx)("button",(n={disabled:s,className:"btn btn-green btn-sm mr-2"},Object(f.a)(n,"disabled",0===(null===c||void 0===c?void 0:c.length)),Object(f.a)(n,"onClick",(function(){var e=function(){var e=Ol(S).filter((function(e){return!c.find((function(t){return e.id===t.id}))})),t=c.filter((function(e){return!Ol(S).find((function(t){return e.id===t.id}))}));return{exist:Ol(S).map((function(e){return c.find((function(t){return t.id===e.id}))})).filter((function(e){return null!=e})),added:t,missing:e}}(),t=e.exist,n=e.added,r=e.missing;V(qn("commandes").updateTransaction({id:null===l||void 0===l?void 0:l.id,contenu:c,type:"cva",sorte:"sortie",status:!0,dateCom:null!=B?B:F,exist:t,added:n,missing:r},"update-to-magasin")),N.push(J)})),Object(f.a)(n,"type","button"),Object(f.a)(n,"children","Valider l'operation"),n)),Object(w.jsx)("button",{disabled:s,className:"btn btn-danger btn-sm",onClick:function(){null===c||void 0===c||c.forEach((function(e){e.quantityParProduct=0,e.qttByCC=0})),V(ci())},type:"button",children:Object(w.jsx)("span",{children:"Annuler"})})]})})]})]})]})})},xl=function(e){var t,n=e.state,c=e.setState,r=e.product,a=e.cloneCommandes,i=(Object(xe.c)(),!!(null===n||void 0===n?void 0:n.find((function(e){return(null===e||void 0===e?void 0:e.id)===r.id})))),s=null===a||void 0===a?void 0:a.contenu.find((function(e){return e.id==r.id})),d=(null===r||void 0===r?void 0:r.quantityBruteCVA)<(null===s||void 0===s?void 0:s.quantityParProduct);return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(cr.a.Item,{className:"mb-2 mr-3",style:{border:"1px solid gray"},children:Object(w.jsx)("div",{className:" d-flex justify-content-between align-items-center",children:Object(w.jsxs)("div",{className:" ".concat(r.id?"":"product-loading"),style:{boxShadow:r&&i?"15px 10px 15px rgba(0, 0, 0, .07)":"none"},children:[Object(w.jsxs)("div",{children:[4==(null===s||void 0===s?void 0:s.correctiontype)&&Object(w.jsx)("div",{className:"badge badge-danger",children:Object(w.jsx)("h2",{textTransform:"uppercase",children:"CE PRODUIT A ETE RETIR\xc9"})}),Object(w.jsxs)("div",{children:[r.name," "]}),Object(w.jsx)("div",{class:"badge badge-primary",children:null===r||void 0===r||null===(t=r.fournisseur)||void 0===t?void 0:t.name}),Object(w.jsx)("br",{})]})," ",Object(w.jsx)("div",{children:(null===r||void 0===r?void 0:r.id)&&Object(w.jsx)(w.Fragment,{children:i?Object(w.jsx)("button",{disabled:d,className:"btn btn-danger btn-sm",onClick:function(){return function(e){c(n.filter((function(t){return t.id!==e})))}(null===r||void 0===r?void 0:r.id)},children:"Retirer"}):Object(w.jsx)("button",{className:"btn btn-green btn-sm",onClick:function(){c(n.some((function(e){return e.id===r.id}))?n:[r].concat(Object(me.a)(n)))},children:"Ajouter"})})})]})})})})},vl=function(){var e=Object(u.i)().id,t=(Object(u.g)(),Object(a.useState)(!1)),n=Object(p.a)(t,2),c=n[0],r=n[1],s=Object(xe.c)(),d=Object(xe.d)(wn("commandes").value),l=Object(xe.d)(wn("commandesclone").value),o=Object(xe.d)(wn("commandes").meta),j=Object(xe.d)(wn("products").value),b=Object(xe.d)(wn("products").meta),m=Object(a.useState)([]),O=Object(p.a)(m,2),h=O[0],x=O[1];i.a.useEffect((function(){s(qn("commandesclone").get(e)),s(qn("commandes").get(e))}),[e]);var v=Object(a.useState)(""),f=Object(p.a)(v,2),g=f[0],C=f[1],N=Object(a.useState)([]),y=Object(p.a)(N,2),q=y[0],S=y[1];i.a.useEffect((function(){return 1==c&&(s(qn("products").fetch()),r(!1)),function(){r(!1)}}),[c]);var A=Object(a.useState)(),E=Object(p.a)(A,2),P=E[0],V=E[1];i.a.useEffect((function(){x(null!=P?Aa(j,g,P):fr(j,g))}),[g]),i.a.useEffect((function(){x(""!=g?Aa(j,g,P):qa(j,P))}),[P]),i.a.useEffect((function(){s(qn("products").fetch())}),[]),i.a.useEffect((function(){}),[P]),i.a.useEffect((function(){var e;o.isFetching||S(null===(e=d[0])||void 0===e?void 0:e.contenu)}),[o]),i.a.useEffect((function(){b.isFetching||x(j)}),[b]);return Object(w.jsxs)(qe,{children:[Object(w.jsx)(ge,{title:"Edition d'un sortie vers magasin",children:Object(w.jsx)(Ne,{title:"Edition d'un sortie vers magasin"})}),Object(w.jsx)(Se,{children:Object(w.jsxs)(rr.a,{className:"py-2",children:[Object(w.jsx)(ar.a,{xs:6,children:Object(w.jsx)(cr.a,{children:Object(w.jsxs)(zc.a,{children:[Object(w.jsx)(zc.a.Header,{className:"d-flex justify-content-between align-items-center bg-dark text-white",children:"Produits"}),Object(w.jsxs)(zc.a.Body,{children:[Object(w.jsx)("input",{type:"text",onChange:function(e){C(e.target.value)},placeholder:"Rechercher un produit",className:"form-control mb-2"}),Object(w.jsx)(Ua,{model:"fournisseurs",children:Object(w.jsx)(Ya,{children:function(e){var t=e.data;e.meta;return Object(w.jsx)("div",{className:"my-2",children:Object(w.jsxs)("select",{className:"form-control",selected:2==P,onChange:function(e){V(e.target.value)},children:[Object(w.jsx)("option",{value:"",children:"Selectionner un fournisseur"}),t.map((function(e){return Object(w.jsx)("option",{value:e.id,children:e.name})}))]})})}})}),Object(w.jsxs)("div",{style:{overflowY:"auto",height:"350px",maxHeight:"350px",overflowX:"hidden"},children:[Object(w.jsxs)(w.Fragment,{children:[h.map((function(e){return Object(w.jsx)(xl,{state:q,setState:S,cloneCommandes:l[0],product:e})})),0==h.length&&"Aucune enregistrement trouv\xe9"]})," "]})]})]})})}),Object(w.jsx)(ar.a,{xs:6,children:Object(w.jsx)(hl,{disabled:b.isFetching,state:q,meta:o,cloneCommandes:l[0],setState:S,realstock:j,commandes:d[0]})})]})})]})},pl=function(e,t){var n=function(t){return!!(null===e||void 0===e?void 0:e.find((function(e){return(null===e||void 0===e?void 0:e.id)===t})))};return{frommagasin:e,isItemFromMagasin:n,addFromMagasin:function(e){n(e.id)?t(function(e){return{type:si,payload:e}}(e.id)):t(function(e){return{type:ii,payload:e}}(e))}}},fl=function(e){var t,n=e.product,c=Object(xe.d)((function(e){return e.frommagasins})),r=Object(xe.c)(),a=pl(c,r),s=a.isItemFromMagasin,d=a.addFromMagasin,l=!!s&&s(n.id),o=i.a.useCallback((function(){return n.quantityBruteCVA>15&&n.quantityBruteCVA<=20?"yellow":n.quantityBruteCVA>10&&n.quantityBruteCVA<=15?"#ffdb4c":n.quantityBruteCVA>5&&n.quantityBruteCVA<=10?" orange":n.quantityBruteCVA>0&&n.quantityBruteCVA<=5?"#c44e14b8":0==n.quantityBruteCVA?"red":"green"}),[n]);i.a.useCallback((function(){return n.quantityCCCVA>15&&n.quantityCCCVA<=20?"yellow":n.quantityCCCVA>10&&n.quantityCCCVA<=15?"#ffdb4c":n.quantityCCCVA>5&&n.quantityCCCVA<=10?" orange":n.quantityCCCVA>0&&n.quantityCCCVA<=5?"#c44e14b8":0==n.quantityCCCVA?"red":"green"}),[n]),i.a.useCallback((function(){return pa(n)?0==n.quantityBruteCVA&&(0==n.quantityCCCVA||null==n.quantityCCCVA)&&0==n.condval:0==n.quantityBruteCVA&&(0==n.quantityCCCVA||null==n.quantityCCCVA)}),[n]);return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(cr.a.Item,{className:"mb-2",style:{width:"100%",border:"1px solid gray",padding:"10px",background:"whitesmoke",borderLeft:"10px solid ".concat(o())},children:Object(w.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[Object(w.jsx)("div",{className:" ".concat(n.id?"":"product-loading"),style:{boxShadow:n&&l?"15px 10px 15px rgba(0, 0, 0, .07)":"none"},children:Object(w.jsxs)("div",{className:"d-flex justify-content-center align-items-center",children:[Object(w.jsxs)("div",{className:"d-flex flex-column mr-2 align-items-center w-20",children:[Object(w.jsx)("div",{class:"badge badge-success mb-1",style:{borderRadius:"100%"},children:n.quantityBruteCVA}),Object(w.jsx)("div",{class:"badge badge-warning mb-1",style:{borderRadius:"100%"},children:n.condval}),Object(w.jsx)("div",{class:"badge badge-info mb-1",style:{borderRadius:"100%"},children:n.quantityCC})]}),Object(w.jsx)("div",{children:Object(w.jsxs)("div",{children:[Object(w.jsx)("div",{children:n.name}),Object(w.jsx)("div",{class:"badge badge-primary",children:null===n||void 0===n||null===(t=n.fournisseur)||void 0===t?void 0:t.name})]})})]})}),Object(w.jsx)("div",{children:n.id&&Object(w.jsx)(w.Fragment,{children:Object(w.jsx)("button",{disabled:ki(n),className:"mt-3 ".concat(l?"btn btn-danger btn-sm":"btn btn-green btn-sm"),onClick:function(){d&&d(n)},children:l?"Retirer":"Ajouter"})})})]})})})},gl=i.a.memo(fl),Cl=function(e){var t=e.product,n=e.setRealQtt,c=(e.maxRealQtt,e.realQtt),r=Object(xe.c)(),a=function(e){r(Bd(t.id,e))};return Object(w.jsx)("div",{className:"basket-item-control",children:Object(w.jsxs)(Rc.c,{inputMode:"numeric",w:28,bg:"whitesmoke",min:0,value:c,defaultValue:null===t||void 0===t?void 0:t.quantityParProduct,onChange:function(e){""==e?(n(0),a(0)):(n(e),a(e))},children:[Object(w.jsx)(Rc.d,{}),Object(w.jsxs)(Rc.e,{children:[Object(w.jsx)(Rc.b,{}),Object(w.jsx)(Rc.a,{})]})]})})},Nl=function(e){var t=e.product,n=e.setRealQttCC,c=(e.setRealQtt,e.setMaxRealQttCC,e.maxRealQttCC,e.realQtt,e.realQttCC),r=Object(xe.c)(),i=(Object(a.useRef)(),Object(xe.d)((function(e){return{frommagasins:e.frommagasins}})).frommagasins,function(e){r(kd(t.id,e))});return Object(w.jsx)("div",{className:"basket-item-control",children:Object(w.jsxs)(Rc.c,{inputMode:"numeric",w:28,bg:"whitesmoke",onChange:function(e){""==e?(i(0),n(0)):(n(1*e),i(1*e))},min:0,value:c,defaultValue:null===t||void 0===t?void 0:t.qttByCC,children:[Object(w.jsx)(Rc.d,{}),Object(w.jsxs)(Rc.e,{children:[Object(w.jsx)(Rc.b,{}),Object(w.jsx)(Rc.a,{})]})]})})},yl=function(e){var t=e.product,n=e.setRealQttLitre,c=e.realQttLitre,r=e.maxRealQttByLitre,a=Object(xe.c)(),i=function(e){a(Td(t.id,e))};return Object(w.jsx)("div",{className:"basket-item-control",children:Object(w.jsxs)(Rc.c,{inputMode:"numeric",w:28,step:1,bg:"whitesmoke",min:0,value:c,defaultValue:0,onChange:function(e){""==e?(n(0),i(0)):(n(Number(e)),i(Number(e)))},max:r,children:[Object(w.jsx)(Rc.d,{}),Object(w.jsxs)(Rc.e,{children:[Object(w.jsx)(Rc.b,{}),Object(w.jsx)(Rc.a,{})]})]})})},ql=function(e){var t=e.product,n=Object(a.useState)(null===t||void 0===t?void 0:t.qttByCC),c=Object(p.a)(n,2),r=c[0],i=c[1],s=Object(a.useState)(null===t||void 0===t?void 0:t.quantityParProduct),d=Object(p.a)(s,2),l=d[0],o=d[1],u=Object(a.useState)(0),j=Object(p.a)(u,2),b=j[0],m=j[1],O=Object(a.useState)(2e3),h=Object(p.a)(O,2),x=h[0],v=h[1],f=Object(a.useState)(2e3),g=Object(p.a)(f,2),C=g[0],N=g[1],y=Object(a.useState)(2e3),q=Object(p.a)(y,2),S=q[0],A=q[1],E=Object(xe.d)((function(e){return e.frommagasins})),P=Object(xe.c)(),V=pl(E,P),D=V.isItemFromMagasin,F=V.addFromMagasin;Object(a.useEffect)((function(){var e=function(e,t,n,c){var r=!1;if(Fi(c)){r=!0;var a=e,i=t,s=n,d=c.condval,l=c.quantityCCCVA,o=c.quantityBruteCVA,u=c.condsize,j=c.doseDefault,b=c.condml,m=!0;if(s>0&&0==a&&0==i&&s>o&&(m=!1,d=a,l=i),0==s&&a>0&&0==i){var O=0;Number(a)>Number(u)&&(O=Math.floor(Number(a)/Number(u)),d-(Number(a)-Number(u)*O)<0&&(O+=1)),o-O<0&&(m=!1,o=s,l=i)}if(0==s&&0==a&&i>0&&l-i<0){var h=0,x=0;Number(i)>Number(j)&&(h=Math.floor(Number(i)/Number(j)),l-(Number(i)-Number(j)*h)<0&&(h+=1)),Number(h)>Number(u)&&(x=Math.floor(Number(h)/Number(u)),d-(Number(h)-Number(u)*h)<0&&(x+=1)),o-x<0&&(m=!1,o=s,d=a)}if(0==s&&a>0&&i>0){var v=0,p=0;Number(i)>Number(b)?(v=Math.floor(Number(i)/Number(b)),l-(Number(i)-Number(b)*v)<0&&(v+=1)):l-Number(i)<0&&(v=1);var f=Number(a)+v;f>Number(u)?(p=Math.floor(f/Number(u)),d-(f-Number(u)*p)<0&&(p+=1)):d-f<0&&(p=1),o-p<0&&(m=!1,o=s,d=a)}if(s>0&&a>0&&0==i){var g=0;Number(a)>Number(u)?(g=Math.floor(Number(a)/Number(u)),d-(Number(a)-Number(u)*g+a)<0&&(g+=1)):d-Number(a)<0&&(g=1),o-(g+s)<0&&(m=!1,o=s,d=a)}if(s>0&&0==a&&i>0){var C=0,N=0;Number(i)>Number(b)?(C=Math.floor(Number(i)/Number(b)),l-(Number(i)-Number(b)*C)<0&&(C+=1)):l-Number(i)<0&&(C=1),Number(C)>Number(u)?(N=Math.floor(Number(C)/Number(u)),d-(Number(C)-Number(u)*N)<0&&(N+=1)):d-C<0&&(N=1),o-(N+s)<0&&(m=!1,d=a)}if(s>0&&a>0&&i>0){var y=0,q=0;Number(i)>Number(b)?(y=Math.floor(Number(i)/Number(b)),l-(Number(i)-Number(b)*y)<0&&(y+=1)):l-Number(i)<0&&(y=1);var w=Number(y)+Number(a);w>Number(u)?(q=Math.floor(w/Number(u)),d-(w-Number(u)*q)<0&&(q+=1)):d-w<0&&(q=1),o-(q+s)<0&&(m=!1)}return{normalQtt:d,normalQttCC:l,normalQttLitre:o,isSpecific:r,isValid:m}}var S=e,A=t,E=c.quantityBruteCVA,P=c.quantityCCCVA,V=c.doseDefault,D=c.quantityBruteCVA;r=!1;var F=!0;if(0==S&&A>0){var R=0,M=0;Number(A)>Number(V)?(R=Math.floor(Number(A)/Number(V)),M=Number(A)-Number(V)*R,console.log(M),P-M<0&&(R+=1)):P-Number(A)<0&&(R=1),A>P&&E-R<0&&(F=!1,E=S)}if(S>0&&0==A&&S>E&&(F=!1,P=A),S>0&&A>0){var B,T=0;Number(A)>Number(V)?(B=Math.floor(Number(A)/Number(V)),T=Number(A)-Number(V)*B,console.log(T),P-T<0&&(B+=1)):P-Number(A)<0&&(B=1),Number(E)-(Number(B)+Number(S))<0&&(F=!1),S>E&&(F=!1,P=A)}return{normalQtt:E,normalQttCC:P,normalQttLitre:D,isValid:F,isSpecific:r}}(l,r,b,t),n=e.normalQtt,c=e.normalQttCC,a=e.normalQttLitre,s=e.isSpecific;e.isValid||(alert("stock insuffisant :("),s?(m(a),A(a),o(n),v(n),i(c),N(c)):(o(n),v(n),i(c),N(c)))}),[l,r,b]);var R=!!D&&D(t.id);return Object(w.jsx)("div",{children:Object(w.jsxs)("div",{className:"d-flex justify-content-between align-items-center border   mb-2 p-2",children:[Object(w.jsxs)("div",{style:{width:"45%"},children:[Object(w.jsx)("p",{className:"text-blue",children:t.name}),Fi(t)?Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("p",{className:"text-lowercase",children:Object(w.jsx)("strong",{children:0!=t.qttbylitre&&Object(w.jsx)("span",{style:{marginRight:"30px"},children:De(t.prixlitre)+" x "+t.qttbylitre+" Litre(s)"})})}),Object(w.jsx)("p",{className:"text-lowercase",children:Object(w.jsx)("strong",{children:0!=t.quantityParProduct&&Object(w.jsx)("span",{style:{marginRight:"30px"},children:De(t.prixqttccvente*t.qttccpvente)+" x "+t.quantityParProduct+" "+t.type})})})]}):Object(w.jsx)("p",{className:"text-lowercase",children:Object(w.jsx)("strong",{children:0!=t.quantityParProduct&&Object(w.jsx)("span",{style:{marginRight:"30px"},children:De(t.prixVente)+" x "+t.quantityParProduct+" "+t.type})})}),Object(w.jsx)("p",{className:"text-lowercase",children:Object(w.jsx)("strong",{children:0!=t.qttByCC&&Object(w.jsx)("span",{style:{marginRight:"30px"},children:De(t.prixParCC)+" x "+t.qttByCC+" ML"})})})]}),0!==t.condml&&0!==t.qttccpvente&&Object(w.jsxs)("div",{className:"text-inline text-center mr-3",children:[Object(w.jsx)("h5",{className:"mb-1 text-uppercase",children:"Litre"}),Object(w.jsx)(yl,{product:t,setRealQttLitre:m,realQttLitre:b,maxRealQttByLitre:S})," "]}),Object(w.jsxs)("div",{className:"text-inline text-center mr-2",children:[Object(w.jsx)("h5",{className:"mb-1",children:t.type}),Object(w.jsx)(Cl,{product:t,setRealQtt:o,setMaxRealQtt:v,maxRealQtt:x,realQtt:l})]}),"FLACON"===t.type&&Object(w.jsxs)("div",{className:"text-inline text-center",children:[Object(w.jsx)("h5",{className:"mb-1",children:3==t.categoryId?"DOSE":"ML"}),Re(t.name,"ita new")&&Object(w.jsx)(Dd,{product:t,setRealQttCC:i,realQttCC:r}),Re(t.name,"sovax")&&Object(w.jsx)(Rd,{setRealQttCC:i,realQttCC:r,product:t}),0==t.condml&&0==t.qttccpvente&&!Re(t.name,"sovax")&&!Re(t.name,"ita new")&&Object(w.jsx)(Nl,{setRealQttCC:i,realQttCC:r,maxRealQttCC:C,product:t}),0!==t.condml&&0!==t.qttccpvente&&Object(w.jsx)(Fd,{product:t,setRealQttCC:i,realQttCC:r,maxRealQttCC:C})]}),Object(w.jsx)("div",{className:"ml-2",children:R&&Object(w.jsx)("button",{onClick:function(){F&&F(t)},className:"btn btn-danger btn-xs text-right",children:"X"})})]})})},wl={fromMagasin:{emptyOrder:"Aucune commande"}},Sl=function(e){return e&&0!==(null===e||void 0===e?void 0:e.length)?e.reduce((function(e,t){return e+t}),0):0},Al=function(){var e=Object(a.useState)("vente-cva"),t=Object(p.a)(e,2),n=t[0],c=t[1],r=Object(a.useState)(null),i=Object(p.a)(r,2),s=i[0],d=(i[1],Object(a.useState)(null)),l=Object(p.a)(d,2),o=l[0],j=l[1],b=Object(u.g)(),m=Object(xe.d)((function(e){return{frommagasins:e.frommagasins}})).frommagasins,O=Object(xe.c)(),h=Object(xe.d)(wn("emprunters").value),x=Object(a.useState)(!1),v=Object(p.a)(x,2),f=(v[0],v[1],new Date),g=Object(a.useState)(f),C=Object(p.a)(g,2),N=C[0],y=C[1];Object(a.useEffect)((function(){O(qn("emprunters").fetch())}),[]);return Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)(zc.a,{children:[Object(w.jsxs)(zc.a.Header,{className:" bg-dark py-2 text-white d-flex justify-content-between align-items-center",children:[Object(w.jsxs)("div",{style:{width:"60%"},children:["BON DE SORTIE ("," ".concat(null===m||void 0===m?void 0:m.length," ").concat((null===m||void 0===m?void 0:m.length)>1?"articles":"article"),")"]}),Object(w.jsx)("div",{style:{width:"40%"},className:"text-right",children:Object(w.jsxs)("select",{className:"form-control input-sm",onChange:function(e){c(e.target.value)},children:[Object(w.jsx)("option",{value:"vente-cva",selected:!0,children:"Comptant"}),Object(w.jsx)("option",{value:"credit-cva",children:"Credit"})]})})]}),Object(w.jsxs)("div",{className:"commande-vente",children:[Object(w.jsxs)(zc.a.Body,{style:{padding:2,marginTop:3,marginRight:2,marginLeft:2},children:[Object(w.jsx)("div",{className:"d-flex justify-content-end"}),Object(w.jsxs)("div",{style:{overflowY:"auto",height:"350px",maxHeight:"350px",overflowX:"hidden"},children:[Object(w.jsxs)("div",{class:"form-group",children:[Object(w.jsx)("label",{children:"Date de sortie :"}),Object(w.jsx)("div",{children:Object(w.jsx)("input",{type:"date",onChange:function(e){return y(e.target.value)},value:N,className:"form-control"})})]}),"credit-cva"===n&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("label",{children:"Crediteur:"}),Object(w.jsxs)("select",{className:"form-control",onChange:function(e){j(e.target.value)},children:[Object(w.jsx)("option",{value:""}),h.map((function(e){return Object(w.jsx)("option",{value:e.id,children:e.name})}))]})]}),(null===m||void 0===m?void 0:m.length)<=0&&Object(w.jsx)("div",{className:"alert alert-success ",children:wl.fromMagasin.emptyOrder}),null===m||void 0===m?void 0:m.map((function(e,t){return Object(w.jsx)(ql,{product:e,basket:m,dispatch:O},"".concat(null===e||void 0===e?void 0:e.id,"_").concat(t))}))]})]}),(null===m||void 0===m?void 0:m.length)>0&&Object(w.jsxs)(zc.a.Footer,{className:"d-flex align-items-center justify-content-between",children:[Object(w.jsx)("div",{style:{width:"40%"},children:Object(w.jsx)("h2",{className:"p-2 text-uppercase bg-primary",children:Object(w.jsxs)("strong",{"data-test-id":"total-price-orders",children:["Total:",De(Sl(m.map((function(e){return pa(e)?e.prixqttccvente*e.quantityParProduct*e.qttccpvente+e.prixlitre*e.qttbylitre:e.prixVente*e.quantityParProduct})))+Sl(m.map((function(e){return e.prixParCC*e.qttByCC}))))]})})}),Object(w.jsx)("div",{style:{width:"60%"},children:m.length>0&&Object(w.jsxs)("div",{className:"d-flex text-right align-items-end justify-content-end",children:[Object(w.jsx)("button",{className:"btn btn-green btn-sm mr-2",disabled:0===m.length,onClick:function(){_i(m)?alert("commande non-conforme,veuillez verifier!!"):(m.forEach((function(e){!function(e){if(Ld(e)){var t=e.quantityParProduct,n=e.qttByCC,c=e.qttbylitre,r=e.condval,a=e.quantityCCCVA,i=e.condsize,s=(e.doseDefault,e.condml);if(c>0&&0==t&&0==n&&(e.quantityBruteCVA-=c),0==c&&t>0&&0==n){var d=0,l=0;if(Number(t)>=Number(i))if(d=Math.floor(Number(t)/Number(i)),r-(l=Number(t)-Number(i)*d)<0){var o=Number(l)-Number(r);e.condval=Number(i)-Number(o),d+=1}else e.condval=r-l;else if(e.condval-Number(t)<0){var u=Number(t)-Number(e.condval),j=Number(i)-Number(u);e.condval=j,d+=1}else e.condval-=Number(t);e.quantityBruteCVA-=d}if(0==c&&0==t&&n>0){var b=0,m=0,O=0,h=0;if(Number(n)>=Number(s))if(b=Math.floor(Number(n)/Number(s)),a-(h=Number(n)-Number(s)*b)<0){var x=Number(h)-Number(a);e.quantityCCCVA=Number(s)-Number(x),b+=1}else e.quantityCCCVA=a-h;else if(Number(n)>=e.quantityCCCVA){b+=1;var v=Number(n)-e.quantityCCCVA;e.quantityCCCVA=Number(s)-v}else e.quantityCCCVA-=Number(n);if(Number(b)>=Number(i))if(m=Math.floor(Number(b)/Number(i)),r-(O=Number(b)-Number(i)*O)<0){var p=Number(O)-Number(r);e.condval=Number(i)-Number(p),m+=1}else e.condval=r-O;else if(e.condval-Number(b)<0){var f=Number(b)-Number(e.condval),g=Number(i)-Number(f);e.condval=g,m+=1}else e.condval-=Number(b);e.quantityBruteCVA-=m}if(0==c&&t>0&&n>0){var C=0,N=0,y=0,q=0;if(Number(n)>=Number(s))if(C=Math.floor(Number(n)/Number(s)),a-(q=Number(n)-Number(s)*C)<0){var w=Number(q)-Number(a);e.quantityCCCVA=Number(s)-Number(w),C+=1}else e.quantityCCCVA=Number(a)-q;else if(Number(n)>=e.quantityCCCVA){C+=1;var S=Number(n)-e.quantityCCCVA;e.quantityCCCVA=Number(s)-S}else e.quantityCCCVA-=Number(n);var A=Number(t)+C;if(A>=Number(i))if(N=Math.floor(A/Number(i)),r-(y=A-Number(i)*C)<0){var E=Number(y)-Number(r);e.condval=Number(i)-Number(E),N+=1}else e.condval=r-y;else if(e.condval-Number(A)<0){var P=Number(A)-Number(e.condval),V=Number(i)-Number(P);e.condval=V,N+=1}else e.condval-=Number(A);e.quantityBruteCVA-=N}if(c>0&&t>0&&0==n){var D=0,F=0;if(Number(t)>=Number(i))if(D=Math.floor(Number(t)/Number(i)),r-(F=Number(t)-Number(i)*D)<0){var R=Number(F)-Number(r);e.condval=Number(i)-Number(R),D+=1}else e.condval=r-F;else if(e.condval-Number(t)<0){var M=Number(t)-Number(e.condval),B=Number(i)-Number(M);e.condval=B,D+=1}else e.condval-=Number(t);e.quantityBruteCVA-=D+c}if(c>0&&0==t&&n>0){var T=0,k=0,_=0,I=0;if(Number(n)>=Number(s))if(T=Math.floor(Number(n)/Number(s)),a-(I=Number(n)-Number(s)*T)<0){var Q=Number(I)-Number(a);e.quantityCCCVA=Number(s)-Number(Q),T+=1}else e.quantityCCCVA=a-I;else if(Number(n)>=e.quantityCCCVA){T+=1;var L=Number(n)-e.quantityCCCVA;e.quantityCCCVA=Number(s)-L}else e.quantityCCCVA-=Number(n);if(Number(T)>=Number(i))if(k=Math.floor(Number(T)/Number(i)),r-(_=Number(T)-Number(i)*k)<0){var H=Number(_)-Number(r);e.condval=Number(i)-Number(H),k+=1}else e.condval=r-I;else if(e.condval-Number(T)<0){var U=Number(T)-Number(e.condval),Y=Number(i)-Number(U);e.condval=Y,k+=1}else e.condval-=Number(T);e.quantityBruteCVA-=k+c}if(c>0&&t>0&&n>0){var K=0,z=0,G=0,W=0;if(Number(n)>=Number(s))if(K=Math.floor(Number(n)/Number(s)),a-(W=Number(n)-Number(s)*K)<0){var X=Number(W)-Number(a);e.quantityCCCVA=Number(s)-Number(X),K+=1}else e.quantityCCCVA=a-W;else if(Number(n)>=e.quantityCCCVA){K+=1;var J=Number(n)-e.quantityCCCVA;e.quantityCCCVA=Number(s)-J}else e.quantityCCCVA-=Number(n);var Z=Number(K)+Number(t);if(Z>=Number(i))if(z=Math.floor(Z/Number(i)),r-(G=Z-Number(i)*z)<0){var $=Number(G)-Number(r);e.condval=Number(i)-Number($),z+=1}else e.condval=r-W;else if(e.condval-Number(Z)<0){var ee=Number(Z)-Number(e.condval),te=Number(i)-Number(ee);e.condval=te,z+=1}else e.condval-=Number(Z);e.quantityBruteCVA-=z+c}}else{var ne=e.quantityParProduct,ce=e.qttByCC,re=(e.quantityBruteCVA,e.quantityCCCVA),ae=e.doseDefault;if(0==ne&&ce>0){var ie=0,se=0;if(Number(ce)>=Number(ae))if(ie=Math.floor(Number(ce)/Number(ae)),re-(se=Number(ce)-Number(ae)*ie)<0){var de=Number(se)-Number(re);e.quantityCCCVA=Number(ae)-Number(de),ie+=1}else e.quantityCCCVA=Number(re)-se;else if(e.quantityCCCVA-Number(ce)<0){var le=Number(ce)-Number(e.quantityCCCVA);e.quantityCCCVA=Number(ae)-Number(le),ie+=1}else e.quantityCCCVA-=Number(ce);console.log(ie),e.quantityBruteCVA-=ie}if(ne>0&&0==ce&&(e.quantityBruteCVA-=ne),ne>0&&ce>0){var oe=0,ue=0;if(Number(ce)>=Number(ae))if(oe=Math.floor(Number(ce)/Number(ae)),re-(ue=Number(ce)-Number(ae)*oe)<0){var je=Number(ue)-Number(re);e.quantityCCCVA=Number(ae)-Number(je),oe+=1}else e.quantityCCCVA=Number(re)-ue;else if(e.quantityCCCVA-Number(ce)<0){var be=Number(ce)-Number(e.quantityCCCVA);e.quantityCCCVA=Number(ae)-Number(be),oe+=1}else e.quantityCCCVA-=Number(ce);var me=oe+Number(ne);e.quantityBruteCVA-=me}}}(e)})),O(qn("commandes").createTransaction({id:Math.floor(Date.now()/1e3),contenu:m,type:n,sorte:"sortie",vaccinateurId:s,status:"vente-cva"===n,emprunterId:o,dateCom:null!=N?N:f},"add-from-magasin")),O(Md()),b.push(Z))},type:"button",children:"Valider l'operation"}),Object(w.jsx)("button",{className:"btn btn-danger btn-sm",onClick:function(){m.forEach((function(e){e.quantityParProduct=0,e.qttByCC=0})),O(qs()),O(Md())},type:"button",children:Object(w.jsx)("span",{children:"Annuler"})})]})})]})]})]})})},El=function(){var e=Object(xe.d)(wn("products").value),t=Object(xe.d)(wn("products").meta),n=Object(xe.c)(),c=Object(a.useState)(""),r=Object(p.a)(c,2),i=r[0],s=r[1],d=Object(a.useState)(2),l=Object(p.a)(d,2),o=(l[0],l[1],Object(a.useState)(!1)),u=Object(p.a)(o,2),j=u[0],b=u[1],m=(Object(a.useRef)(null),Object(a.useRef)(null),Object(a.useState)([])),O=Object(p.a)(m,2),h=O[0],x=O[1];Object(a.useEffect)((function(){n(qn("products").fetch())}),[]),Object(a.useEffect)((function(){return 1==j&&(n(qn("products").fetch()),b(!1)),function(){b(!1)}}),[j]),Object(a.useEffect)((function(){t.isFetching||x(e.filter((function(e){return!ki(e)})))}),[t]),Object(a.useEffect)((function(){x(fr(e.filter((function(e){return!ki(e)})),i))}),[i]);return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(xr.a,{children:Object(w.jsx)(Es,{})}),Object(w.jsxs)(xr.a,{children:[Object(w.jsxs)("div",{className:"d-flex align-items-center flex-row mr-2",children:[Object(w.jsx)("div",{class:"badge badge-success",style:{borderRadius:"100%"},children:"30"}),Object(w.jsx)("div",{className:"mx-2",children:":Quantit\xe9"}),Object(w.jsx)("div",{class:"badge badge-warning",style:{borderRadius:"100%"},children:"3"}),Object(w.jsx)("div",{className:"mx-2",children:":Conditionnement (ML)"}),Object(w.jsx)("div",{class:"badge badge-info",style:{borderRadius:"100%"},children:"200"}),Object(w.jsx)("div",{className:"mx-2",children:":Reste en ML"})]}),Object(w.jsxs)(rr.a,{children:[Object(w.jsx)(ar.a,{xs:6,children:Object(w.jsxs)(zc.a,{className:"mt-2",children:[Object(w.jsxs)(zc.a.Header,{className:"bg-dark p-2 text-white d-flex text-uppercase justify-content-between align-items-center",children:[Object(w.jsx)("div",{style:{width:"60%"},children:"Produits"}),Object(w.jsx)("div",{children:Object(w.jsx)("button",{className:"btn btn-green btn-sm",onClick:function(){b(!0)},children:"Mettre \xe0 jour"})})]}),Object(w.jsxs)(zc.a.Body,{children:[Object(w.jsx)("div",{class:"d-flex justify-content-between align-items-center",children:Object(w.jsx)("input",{type:"text",onChange:function(e){s(e.target.value)},placeholder:"Nom du produit",className:"form-control mb-2"})}),Object(w.jsx)(cr.a,{children:Object(w.jsxs)("div",{style:{overflowY:"auto",width:"100%",height:"350px",maxHeight:"350px",overflowX:"hidden"},children:[Object(w.jsxs)("div",{class:"d-flex justify-content-start flex-wrap",children:[h.sort((function(e,t){return t.quantityBruteCVA-e.quantityBruteCVA})).map((function(e){return Object(w.jsx)(gl,{product:e})})),0==h.length&&"Aucune enregistrement trouv\xe9"]})," "]})})]})]})}),Object(w.jsx)(ar.a,{xs:6,children:Object(w.jsx)("div",{className:" py-2",children:Object(w.jsx)(Al,{setRegenerate:b})})})]})]})]})},Pl=function(){return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(El,{})})},Vl=function(e){var t,n=e.product,c=Object(xe.d)((function(e){return e.frommagasins})),r=Object(xe.c)(),a=pl(c,r),s=a.isItemFromMagasin,d=a.addFromMagasin,l=!!s&&s(n.id),o=i.a.useCallback((function(){return n.quantityBruteCVA>15&&n.quantityBruteCVA<=20?"yellow":n.quantityBruteCVA>10&&n.quantityBruteCVA<=15?"#ffdb4c":n.quantityBruteCVA>5&&n.quantityBruteCVA<=10?" orange":n.quantityBruteCVA>0&&n.quantityBruteCVA<=5?"#c44e14b8":0==n.quantityBruteCVA?"red":"green"}),[n]),u=i.a.useCallback((function(){return n.quantityCCCVA>15&&n.quantityCCCVA<=20?"yellow":n.quantityCCCVA>10&&n.quantityCCCVA<=15?"#ffdb4c":n.quantityCCCVA>5&&n.quantityCCCVA<=10?" orange":n.quantityCCCVA>0&&n.quantityCCCVA<=5?"#c44e14b8":0==n.quantityCCCVA?"red":"green"}),[n]);i.a.useCallback((function(){return pa(n)?0==n.quantityBruteCVA&&(0==n.quantityCCCVA||null==n.quantityCCCVA)&&0==n.condval:0==n.quantityBruteCVA&&(0==n.quantityCCCVA||null==n.quantityCCCVA)}),[n]);return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(cr.a.Item,{className:"mb-2 mr-3",style:{width:"100%",border:"1px solid gray",background:"whitesmoke",borderLeft:"10px solid ".concat(o())},children:Object(w.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[Object(w.jsxs)("div",{className:" ".concat(n.id?"":"product-loading"),style:{boxShadow:n&&l?"15px 10px 15px rgba(0, 0, 0, .07)":"none"},children:[Object(w.jsx)("div",{style:{width:10,height:4,background:"".concat(u())}}),Object(w.jsxs)("div",{children:[Object(w.jsx)("div",{children:n.name}),Object(w.jsx)("div",{class:"badge badge-primary",children:null===n||void 0===n||null===(t=n.fournisseur)||void 0===t?void 0:t.name}),Object(w.jsx)("br",{})]})," "]}),Object(w.jsx)("div",{children:n.id&&Object(w.jsx)(w.Fragment,{children:Object(w.jsx)("button",{className:"mt-3 ".concat(l?"btn btn-danger btn-sm":"btn btn-green btn-sm"),onClick:function(){d&&d(n)},children:l?"Retirer":"Ajouter"})})})]})})})},Dl=i.a.memo(Vl),Fl=function(e){var t=e.product,n=(e.setRealQttCC,e.setRealQtt),c=(e.realQtt,e.realQttCC,Object(xe.c)()),r=function(e){c(Bd(t.id,e))};return Object(w.jsx)("div",{className:"basket-item-control",children:Object(w.jsxs)(Rc.c,{inputMode:"numeric",w:28,bg:"whitesmoke",min:0,defaultValue:pa(t)?null===t||void 0===t?void 0:t.condval:null===t||void 0===t?void 0:t.quantityBruteCVA,onChange:function(e){""==e?(n(pa(t)?null===t||void 0===t?void 0:t.condval:null===t||void 0===t?void 0:t.quantityBruteCVA),r(pa(t)?null===t||void 0===t?void 0:t.condval:null===t||void 0===t?void 0:t.quantityBruteCVA)):(n(e),r(e))},children:[Object(w.jsx)(Rc.d,{}),Object(w.jsxs)(Rc.e,{children:[Object(w.jsx)(Rc.b,{}),Object(w.jsx)(Rc.a,{})]})]})})},Rl=function(e){var t=e.product,n=e.setRealQttCC,c=(e.setRealQtt,e.realQtt,e.realQttCC,Object(xe.c)()),r=Object(a.useRef)(),i=(Object(xe.d)((function(e){return{frommagasins:e.frommagasins}})).frommagasins,function(e){c(kd(t.id,e))});return Object(w.jsx)("div",{className:"basket-item-control",children:Object(w.jsxs)(Rc.c,{inputMode:"numeric",w:28,step:1,ref:r,bg:"whitesmoke",defaultValue:t.quantityCCCVA,onChange:function(e){""==e?(i(t.quantityCCCVA),n(t.quantityCCCVA)):(n(1*e),i(1*e))},min:0,max:Fi(t)?null===t||void 0===t?void 0:t.condml:null===t||void 0===t?void 0:t.doseDefault,children:[Object(w.jsx)(Rc.d,{}),Object(w.jsxs)(Rc.e,{children:[Object(w.jsx)(Rc.b,{}),Object(w.jsx)(Rc.a,{})]})]})})},Ml=function(e){var t=e.product,n=e.setRealQttCC,c=(e.setRealQtt,e.realQtt,e.realQttCC,Object(xe.c)());return Object(w.jsx)("div",{className:"basket-item-control",children:Object(w.jsxs)(Rc.c,{inputMode:"decimal",w:28,step:1,bg:"whitesmoke",onChange:function(e){!function(e){c(vi(t.id,e))}(e),n(e)},min:0,defaultValue:t.quantityCCCVA,children:[Object(w.jsx)(Rc.d,{}),Object(w.jsxs)(Rc.e,{children:[Object(w.jsx)(Rc.b,{}),Object(w.jsx)(Rc.a,{})]})]})})},Bl=function(e){var t=e.product,n=Object(xe.c)();return Object(w.jsx)("div",{className:"basket-item-control",children:Object(w.jsxs)(Rc.c,{inputMode:"decimal",w:28,bg:"whitesmoke",onChange:function(e){!function(e){n(fi(t.id,e))}(e)},min:0,defaultValue:t.quantityCCCVA,children:[Object(w.jsx)(Rc.d,{}),Object(w.jsxs)(Rc.e,{children:[Object(w.jsx)(Rc.b,{}),Object(w.jsx)(Rc.a,{})]})]})})},Tl=function(e){var t=e.product,n=e.setRealQttCC,c=(e.setRealQtt,e.realQtt,e.realQttCC,Object(xe.c)());return Object(w.jsx)("div",{className:"basket-item-control",children:Object(w.jsxs)(Rc.c,{inputMode:"numeric",w:28,step:1,bg:"whitesmoke",onChange:function(e){!function(e){c(pi(t.id,e))}(e),n(e)},min:0,defaultValue:t.quantityCCCVA,children:[Object(w.jsx)(Rc.d,{}),Object(w.jsxs)(Rc.e,{children:[Object(w.jsx)(Rc.b,{}),Object(w.jsx)(Rc.a,{})]})]})})},kl=function(e){var t=e.product,n=(e.setRealQttCC,e.setRealQtt,e.realQtt,e.realQttCC,Object(xe.c)()),c=function(e){n(Td(t.id,e))};return Object(w.jsx)("div",{className:"basket-item-control",children:Object(w.jsxs)(Rc.c,{inputMode:"numeric",w:28,step:1,bg:"whitesmoke",min:0,defaultValue:null===t||void 0===t?void 0:t.quantityBruteCVA,onChange:function(e){c(""==e?0:e)},children:[Object(w.jsx)(Rc.d,{}),Object(w.jsxs)(Rc.e,{children:[Object(w.jsx)(Rc.b,{}),Object(w.jsx)(Rc.a,{})]})]})})},_l=function(e){var t,n=e.product,c=Object(a.useState)(null),r=Object(p.a)(c,2),i=r[0],s=r[1],d=Object(a.useState)(null),l=Object(p.a)(d,2),o=l[0],u=l[1],j=Object(xe.d)((function(e){return e.frommagasins})),b=Object(xe.c)(),m=pl(j,b),O=m.isItemFromMagasin,h=m.addFromMagasin,x=!!O&&O(n.id);return Object(w.jsx)("div",{children:Object(w.jsxs)("div",{className:"d-flex justify-content-between align-items-center border   mb-2 p-2",children:[Object(w.jsxs)("div",{style:{width:"45%"},children:[Object(w.jsx)("p",{className:"text-blue",children:n.name}),Object(w.jsx)("div",{class:"badge badge-primary",children:null===n||void 0===n||null===(t=n.fournisseur)||void 0===t?void 0:t.name})]}),0!==n.condml&&0!==n.qttccpvente&&Object(w.jsxs)("div",{className:"text-inline text-center mr-3",children:[Object(w.jsx)("h5",{className:"mb-1 text-uppercase",children:"Litre"}),Object(w.jsx)(kl,{product:n,setRealQttCC:s,setRealQtt:u,realQtt:o,realQttCC:i})," "]}),Object(w.jsxs)("div",{className:"text-inline text-center mr-2",children:[Object(w.jsx)("h5",{className:"mb-1",children:n.type}),Object(w.jsx)(Fl,{product:n,setRealQttCC:s,setRealQtt:u,realQtt:o,realQttCC:i})]}),"FLACON"===n.type&&Object(w.jsxs)("div",{className:"text-inline text-center",children:[Object(w.jsx)("h5",{className:"mb-1",children:3==n.categoryId?"DOSE":"ML"}),Re(n.name,"ita new")&&Object(w.jsx)(Ml,{product:n,setRealQttCC:s,setRealQtt:u,realQtt:o,realQttCC:i}),Re(n.name,"sovax")&&Object(w.jsx)(Tl,{setRealQttCC:s,setRealQtt:u,realQtt:o,realQttCC:i,product:n}),0==n.condml&&0==n.qttccpvente&&!Re(n.name,"sovax")&&!Re(n.name,"ita new")&&Object(w.jsx)(Rl,{setRealQttCC:s,setRealQtt:u,realQtt:o,realQttCC:i,product:n}),0!==n.condml&&0!==n.qttccpvente&&Object(w.jsx)(Bl,{product:n})]}),Object(w.jsx)("div",{className:"ml-2",children:x&&Object(w.jsx)("button",{onClick:function(){h&&h(n)},className:"btn btn-danger btn-xs text-right",children:"X"})})]})})},Il=function(){var e=Object(a.useState)("vente-cva"),t=Object(p.a)(e,2),n=t[0],c=(t[1],Object(a.useState)(1)),r=Object(p.a)(c,2),i=(r[0],r[1],Object(a.useState)(null)),s=Object(p.a)(i,2),d=s[0],l=(s[1],Object(a.useState)(null)),o=Object(p.a)(l,2),j=o[0],b=o[1],m=Object(u.g)(),O=Object(xe.d)((function(e){return{frommagasins:e.frommagasins}})).frommagasins,h=Object(xe.c)(),x=Object(xe.d)(wn("emprunters").value),v=(Object(xe.d)(wn("commandes").meta),Object(xe.d)(wn("commandes").value),new Date),f=Object(a.useState)(v),g=Object(p.a)(f,2),C=g[0],N=g[1];Object(a.useEffect)((function(){h(qn("commandes").fetch()),h(qn("emprunters").fetch())}),[]);return Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)(zc.a,{children:[Object(w.jsx)(zc.a.Header,{className:" bg-dark py-2 text-white d-flex justify-content-between align-items-center",children:Object(w.jsxs)("div",{style:{width:"60%"},children:["Correction("," ".concat(null===O||void 0===O?void 0:O.length," ").concat((null===O||void 0===O?void 0:O.length)>1?"articles":"article"),")"]})}),Object(w.jsxs)("div",{className:"commande-vente",children:[Object(w.jsx)(zc.a.Body,{style:{padding:2,marginTop:3,marginRight:2,marginLeft:2},children:Object(w.jsxs)("div",{style:{overflowY:"auto",height:"350px",maxHeight:"350px",overflowX:"hidden"},children:[Object(w.jsxs)("div",{class:"form-group",children:[Object(w.jsx)("label",{children:"Date de correction :"}),Object(w.jsx)("div",{children:Object(w.jsx)("input",{type:"date",onChange:function(e){return N(e.target.value)},value:C,className:"form-control"})})]}),"credit-cva"===n&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("label",{children:"Crediteur:"}),Object(w.jsxs)("select",{className:"form-control",onChange:function(e){b(e.target.value)},children:[Object(w.jsx)("option",{value:""}),x.map((function(e){return Object(w.jsx)("option",{value:e.id,children:e.name})}))]})]}),(null===O||void 0===O?void 0:O.length)<=0&&Object(w.jsx)("div",{className:"alert alert-success ",children:wl.fromMagasin.emptyOrder}),null===O||void 0===O?void 0:O.map((function(e,t){return Object(w.jsx)(_l,{product:e,basket:O,dispatch:h},"".concat(null===e||void 0===e?void 0:e.id,"_").concat(t))}))]})}),(null===O||void 0===O?void 0:O.length)>0&&Object(w.jsxs)(zc.a.Footer,{className:"d-flex align-items-center justify-content-between",children:[Object(w.jsx)("div",{style:{width:"30%"}}),Object(w.jsx)("div",{style:{width:"70%"},children:O.length>0&&Object(w.jsxs)("div",{className:"d-flex text-right align-items-end justify-content-end",children:[Object(w.jsx)("button",{className:"btn btn-green btn-sm mr-2",disabled:0===O.length,onClick:function(){h(qn("commandes").createTransaction({id:Math.floor(Date.now()/1e3),contenu:O,commande:O,type:"correction-cva",sorte:"sortie",vaccinateurId:d,status:!0,emprunterId:j,dateCom:null!=C?C:v},"add-to-correction")),h(Md()),m.push(te)},type:"button",children:"Valider l'operation"}),Object(w.jsx)("button",{className:"btn btn-danger btn-sm",onClick:function(){O.forEach((function(e){e.quantityParProduct=0,e.qttByCC=0})),h(qs()),h(Md())},type:"button",children:Object(w.jsx)("span",{children:"Annuler"})})]})})]})]})]})})};function Ql(){var e=Object(xe.d)(wn("products").value),t=Object(xe.d)(wn("products").meta),n=Object(xe.c)(),c=Object(a.useState)(""),r=Object(p.a)(c,2),i=r[0],s=r[1],d=Object(a.useState)(2),l=Object(p.a)(d,2),o=(l[0],l[1],Object(a.useState)(!1)),u=Object(p.a)(o,2),j=u[0],b=u[1],m=(Object(a.useRef)(null),Object(a.useRef)(null),Object(a.useState)([])),O=Object(p.a)(m,2),h=O[0],x=O[1];Object(a.useEffect)((function(){n(qn("products").fetch())}),[]),Object(a.useEffect)((function(){return 1==j&&(n(qn("products").fetch()),b(!1)),function(){b(!1)}}),[j]),Object(a.useEffect)((function(){t.isFetching||x(e)}),[t]),Object(a.useEffect)((function(){x(fr(e,i))}),[i]);return Object(w.jsxs)(qe,{children:[Object(w.jsx)(ge,{title:"Correction",children:Object(w.jsx)(Ne,{title:"Correction"})}),Object(w.jsx)(Se,{children:Object(w.jsxs)(rr.a,{children:[Object(w.jsx)(ar.a,{xs:6,children:Object(w.jsxs)(zc.a,{className:"mt-2",children:[Object(w.jsxs)(zc.a.Header,{className:"bg-dark p-2 text-white d-flex text-uppercase justify-content-between align-items-center",children:[Object(w.jsx)("div",{style:{width:"60%"},children:"Produits"}),Object(w.jsx)("div",{children:Object(w.jsx)("button",{className:"btn btn-green btn-sm",onClick:function(){s(""),b(!0)},children:"Mettre \xe0 jour"})})]}),Object(w.jsxs)(zc.a.Body,{children:[Object(w.jsxs)("div",{class:"d-flex justify-content-between align-items-center",children:[Object(w.jsx)("input",{type:"text",onChange:function(e){s(e.target.value)},placeholder:"Nom du produit",className:"form-control mb-2"})," "]}),Object(w.jsx)(cr.a,{children:Object(w.jsxs)("div",{style:{overflowY:"auto",width:"100%",height:"350px",maxHeight:"350px",overflowX:"hidden"},children:[Object(w.jsxs)("div",{class:"d-flex justify-content-start flex-wrap",children:[h.sort((function(e,t){return t.quantityBruteCVA-e.quantityBruteCVA})).map((function(e){return Object(w.jsx)(Dl,{product:e})})),0==h.length&&"Aucune enregistrement trouv\xe9"]})," "]})})]})]})}),Object(w.jsx)(ar.a,{xs:6,children:Object(w.jsx)("div",{className:" py-2",children:Object(w.jsx)(Il,{setRegenerate:b})})})]})})]})}var Ll=function(e){for(var t=0;t<e.length;++t)return e[t].correction>0||e[t].correctionml>0},Hl=function(){var e=Object(xe.d)((function(e){return e.searchbydate}));console.log(e);var t=Object(a.useState)([e.deb,e.fin]),n=Object(p.a)(t,2),c=n[0],r=n[1],s=(Object(a.useRef)(null),Object(a.useRef)(null),Object(xe.d)(wn("commandes").value)),d=Object(xe.d)(wn("commandes").meta),l=Object(xe.c)();Object(a.useEffect)((function(){var t,n;l((t=e.deb,n=e.fin,hn("commandes",{path:"/vente-correction?deb=".concat(t,"&fin=").concat(n),replace:!0})))}),[e.deb,e.fin]),Object(a.useEffect)((function(){null!==c&&c[0]&&l(ys(c[0],c[1]))}),[c]);var u=i.a.useMemo((function(){return[{Header:"Date",Cell:function(e){var t;return Object(w.jsx)(w.Fragment,{children:Ve(null===(t=e.row.original)||void 0===t?void 0:t.dateCom)})}},{Header:"Produits",Cell:function(e){var t,n,c,r,a,i;return Object(w.jsxs)("div",{style:{width:"350px"},children:[1==(null===(t=e.row.original)||void 0===t?void 0:t.isdeleted)&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("div",{className:"badge badge-danger",children:"Supprim\xe9"}),Object(w.jsxs)("div",{className:"text text-danger",children:["Date de suppression :"," ",Ve(null===(n=e.row.original)||void 0===n?void 0:n.deletedat)]})]}),null==(null===(c=e.row.original)||void 0===c?void 0:c.isdeleted)&&Object(w.jsx)("p",{children:Ll(null===(r=e.row.original)||void 0===r?void 0:r.contenu)&&Object(w.jsx)("div",{className:"badge badge-warning",children:"Modifi\xe9"})}),null===(a=e.row.original)||void 0===a||null===(i=a.contenu)||void 0===i?void 0:i.map((function(t){var n,c;return Object(w.jsxs)("tr",{children:[Object(w.jsx)("span",{style:{background:"white",color:1==(null===(n=e.row.original)||void 0===n?void 0:n.isdeleted)?"red":"inherit",padding:2},children:t.name}),Object(w.jsxs)("span",{style:{color:1==(null===(c=e.row.original)||void 0===c?void 0:c.isdeleted)?"red":"inherit"},children:[" ","  "]})]})}))]})}},{Header:"Actions",Cell:function(e){var t;return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(o.b,{to:"/detailcorrection/".concat(null===(t=e.row.original)||void 0===t?void 0:t.id),className:"btn btn-green btn-sm mr-2",children:"D\xe9tails"})})}}]}),[]);return Object(w.jsxs)(qe,{children:[Object(w.jsx)(ge,{title:"Historique de correction",children:Object(w.jsx)(Ne,{title:"Historique de correction"})}),Object(w.jsxs)(Se,{children:[Object(w.jsxs)("div",{className:"row",children:[Object(w.jsx)("div",{className:"col-lg-6",children:Object(w.jsxs)("div",{children:[Object(w.jsx)("h3",{className:"text-uppercase",children:"Historique de correction"}),Object(w.jsx)("p",{children:"".concat(Ve(e.deb)," ->  ").concat(Ve(e.fin))})]})}),Object(w.jsx)("div",{className:"col-lg-6 text-right",children:Object(w.jsx)(Cr.a,{locale:"fr-FR",onChange:r,value:c})})," "]}),Object(w.jsx)(Zc,{data:s.sort((function(e,t){return t.id-e.id})),meta:d,columns:u})]})]})};var Ul=Object(u.j)((function(e){Object(u.h)();var t,n,c=Object(u.i)().id,r=Object(xe.d)(wn("commandes").value),i=Object(xe.c)();return Object(a.useEffect)((function(){i(qn("commandes").get(c))}),[c]),Object(w.jsxs)(qe,{children:[Object(w.jsx)(ge,{title:"Historique de correction",children:Object(w.jsx)(Ne,{title:"Historique de correction"})}),Object(w.jsx)(Se,{children:Object(w.jsxs)("div",{children:[r.length>0&&Object(w.jsx)("div",{className:"d-flex justify-content-between",children:Object(w.jsx)("div",{className:"my-2",children:Object(w.jsxs)("h2",{className:"my-2",children:["Date : ",Ve(null===(t=r[0])||void 0===t?void 0:t.dateCom)]})})}),Object(w.jsxs)("table",{className:"table table-bordered",children:[Object(w.jsxs)("tr",{className:"bg-thead",children:[Object(w.jsx)("td",{children:"Nom de l'article"}),Object(w.jsx)("td",{children:"Quantit\xe9"}),Object(w.jsx)("td",{children:"Sous total"})]}),r.length>0&&(null===(n=r[0])||void 0===n?void 0:n.contenu.map((function(e){return Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{style:{width:"40%"},children:e.name}),Object(w.jsxs)(w.Fragment,{children:[0!=e.qttbybrute&&Object(w.jsxs)("div",{className:"d-flex align-items-center py-0",children:[Object(w.jsx)("strong",{className:"text-lowercase",children:"Depot:"}),De(e.prixVente)," (","x"," ",e.qttbybrute,") "," = ",De(e.prixVente*e.qttbybrute)]}),pa(e)&&Object(w.jsx)(w.Fragment,{children:0!=e.qttbylitre&&Object(w.jsxs)("div",{className:"d-flex align-items-center py-0 px-2",children:[Object(w.jsx)("strong",{children:"Litre :"}),De(e.prixlitre)," (","x"," ",e.qttbylitre,")"," "," = ",De(e.prixlitre*e.qttbylitre)]})}),0!=e.quantityParProduct&&Object(w.jsxs)("div",{className:"d-flex align-items-center py-0",children:[Object(w.jsxs)("strong",{className:"text-lowercase",children:[e.type,":"]}),De(e.prixVente)," (","x"," ",e.quantityParProduct,") "," = ",De(e.prixVente*e.quantityParProduct)]})]}),"FLACON"==e.type&&Object(w.jsx)(w.Fragment,{children:0!=e.qttByCC&&Object(w.jsxs)("div",{className:"d-flex align-items-center  py-0",children:[Object(w.jsx)("strong",{children:"ml:"})," ",De(e.prixParCC)," ","x"," ",0!=e.qttyspecificmirror?e.qttyspecificmirror+" Dose":e.qttByCC+" ml"," "," = "," ",De(e.prixParCC*e.qttByCC)]})}),Object(w.jsx)("td",{children:pa(e)?De(e.prixqttccvente*e.quantityParProduct*e.qttccpvente+e.prixlitre*e.qttbylitre+e.prixParCC*e.qttByCC):De(e.prixVente*e.quantityParProduct+e.prixParCC*e.qttByCC)})]})})))]})]})})]})}));function Yl(){return Rr.b().shape({name:Rr.c().required("Le champ est requis")})}var Kl=function(){Object(xe.d)(wn("fournisseurs").value);var e=Object(xe.c)(),t=Object(u.g)();return Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)(qe,{children:[Object(w.jsx)(ge,{title:"Ajouter un fournisseur",children:Object(w.jsx)(Ne,{title:"Ajouter un fournisseur"})}),Object(w.jsx)(Se,{children:Object(w.jsx)(Hc,{id:"add-form-fournisseur",enableReinitialize:!0,initialValues:{name:""},validations:Yl,onSubmit:function(n,c){var r=n.name;e(qn("fournisseurs").create({name:r})),t.push(ce)},render:function(e){e.values;return Object(w.jsx)(Hc.Element,{children:Object(w.jsx)("div",{className:"row",children:Object(w.jsx)("div",{className:"col-lg-6",children:Object(w.jsxs)("div",{className:"card",children:[Object(w.jsx)("div",{className:"card-header bg-dark text-white",children:"Information g\xe9n\xe9rale"}),Object(w.jsxs)("div",{className:"card-body",children:[Object(w.jsx)(Hc.Field.Input,{name:"name",label:"Nom",placeholder:"Nom"}),Object(w.jsxs)("div",{className:"mt-3",children:[Object(w.jsx)("button",{className:"btn btn-green  btn-sm ",type:"submit",children:"Ajouter"}),Object(w.jsx)("button",{className:"btn btn-danger ml-2  btn-sm ",type:"reset",children:"Annuler"})]})]})]})})})})}})})]})})};var zl=function(){var e=Object(u.i)().id,t=Object(xe.d)(wn("fournisseurs").value),n=Object(xe.d)(wn("fournisseurs").meta),c=Object(a.useState)({name:""}),r=Object(p.a)(c,2),i=r[0],s=r[1],d=Object(u.g)(),l=Object(xe.c)(),o=Object(a.useState)({}),j=Object(p.a)(o,2);return j[0],j[1],Object(a.useEffect)((function(){l(qn("fournisseurs").fetch())}),[e]),Object(a.useEffect)((function(){n.isFetching||s(null===t||void 0===t?void 0:t.find((function(t){return t.id==e})))}),[n]),Object(w.jsxs)(qe,{children:[Object(w.jsx)(ge,{title:"Editer un fournisseur",children:Object(w.jsx)(Ne,{title:"Editer un fournisseur"})}),Object(w.jsx)(Se,{children:Object(w.jsx)(Hc,{id:"add-form-fournisseur",initialValues:{name:i.name},validations:Yl,onSubmit:function(e,t){var n=e.name;l(qn("fournisseurs").update({id:i.id,name:n})),d.push(ce)},render:function(e){var t=e.values;return Object(w.jsx)(Hc.Element,{children:Object(w.jsx)("div",{className:"row",children:Object(w.jsx)("div",{className:"col-lg-6",children:Object(w.jsxs)("div",{className:"card",children:[Object(w.jsx)("div",{className:"card-header bg-dark text-white",children:"Information g\xe9n\xe9rale"}),Object(w.jsxs)("div",{className:"card-body",children:[Object(w.jsx)(Hc.Field.Input,{name:"name",value:null===t||void 0===t?void 0:t.name,label:"Nom",placeholder:"Nom"}),Object(w.jsxs)("div",{className:"mt-3",children:[Object(w.jsx)("button",{className:"btn btn-green  btn-sm ",type:"submit",children:"Editer"}),Object(w.jsx)("button",{className:"btn btn-danger ml-2 btn-sm ",type:"reset",children:"Annuler"})]})]})]})})})})}})})]})};function Gl(){return Rr.b().shape({name:Rr.c().required("Le champ est requis")})}var Wl=function(){Object(xe.d)(wn("categories").value);var e=Object(xe.c)(),t=Object(u.g)();return Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)(qe,{children:[Object(w.jsx)(ge,{title:"Ajouter un categorie",children:Object(w.jsx)(Ne,{title:"Ajouter un categorie"})}),Object(w.jsx)(Se,{children:Object(w.jsx)(Hc,{id:"add-form-categorie",enableReinitialize:!0,initialValues:{name:""},validations:Gl,onSubmit:function(n,c){var r=n.name;e(qn("categories").create({name:r})),t.push(ae)},render:function(e){e.values;return Object(w.jsx)(Hc.Element,{children:Object(w.jsx)("div",{className:"row",children:Object(w.jsx)("div",{className:"col-lg-6",children:Object(w.jsxs)("div",{className:"card",children:[Object(w.jsx)("div",{className:"card-header bg-dark text-white",children:"Information g\xe9n\xe9rale"}),Object(w.jsxs)("div",{className:"card-body",children:[Object(w.jsx)(Hc.Field.Input,{name:"name",label:"Nom",placeholder:"Nom"}),Object(w.jsxs)("div",{className:"mt-3",children:[Object(w.jsx)("button",{className:"btn btn-green  btn-sm ",type:"submit",children:"Ajouter"}),Object(w.jsx)("button",{className:"btn btn-danger ml-2  btn-sm ",type:"reset",children:"Annuler"})]})]})]})})})})}})})]})})};var Xl=function(){var e=Object(u.i)().id,t=Object(xe.d)(wn("categories").value),n=Object(xe.d)(wn("categories").meta),c=Object(a.useState)({name:""}),r=Object(p.a)(c,2),i=r[0],s=r[1],d=Object(u.g)(),l=Object(xe.c)(),o=Object(a.useState)({}),j=Object(p.a)(o,2);return j[0],j[1],Object(a.useEffect)((function(){l(qn("categories").fetch())}),[e]),Object(a.useEffect)((function(){n.isFetching||s(null===t||void 0===t?void 0:t.find((function(t){return t.id==e})))}),[n]),Object(w.jsxs)(qe,{children:[Object(w.jsx)(ge,{title:"Editer un categorie",children:Object(w.jsx)(Ne,{title:"Editer un categorie"})}),Object(w.jsx)(Se,{children:Object(w.jsx)(Hc,{id:"add-form-categorie",initialValues:{name:i.name},validations:Gl,onSubmit:function(e,t){var n=e.name;l(qn("categories").update({id:i.id,name:n})),d.push(ae)},render:function(e){var t=e.values;return Object(w.jsx)(Hc.Element,{children:Object(w.jsx)("div",{className:"row",children:Object(w.jsx)("div",{className:"col-lg-6",children:Object(w.jsxs)("div",{className:"card",children:[Object(w.jsx)("div",{className:"card-header bg-dark text-white",children:"Information g\xe9n\xe9rale"}),Object(w.jsxs)("div",{className:"card-body",children:[Object(w.jsx)(Hc.Field.Input,{name:"name",value:null===t||void 0===t?void 0:t.name,label:"Nom",placeholder:"Nom"}),Object(w.jsxs)("div",{className:"mt-3",children:[Object(w.jsx)("button",{className:"btn btn-green  btn-sm ",type:"submit",children:"Editer"}),Object(w.jsx)("button",{className:"btn btn-danger ml-2 btn-sm ",type:"reset",children:"Annuler"})]})]})]})})})})}})})]})};function Jl(){return Rr.b().shape({name:Rr.c().required("Le champ est requis")})}var Zl=function(){Object(xe.d)(wn("emprunters").value);var e=Object(xe.c)(),t=Object(u.g)();return Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)(qe,{children:[Object(w.jsx)(ge,{title:"Ajouter un personne",children:Object(w.jsx)(Ne,{title:"Ajouter un personne"})}),Object(w.jsx)(Se,{children:Object(w.jsx)(Hc,{id:"add-form-emprunters",enableReinitialize:!0,initialValues:{name:"",contact:""},validations:Jl,onSubmit:function(n,c){var r=n.name,a=n.contact;e(qn("emprunters").create({name:r,contact:a})),t.goBack()},render:function(e){e.values;return Object(w.jsx)(Hc.Element,{children:Object(w.jsx)("div",{className:"row",children:Object(w.jsx)("div",{className:"col-lg-6",children:Object(w.jsxs)("div",{className:"card",children:[Object(w.jsx)("div",{className:"card-header bg-dark text-white",children:"Information g\xe9n\xe9rale"}),Object(w.jsxs)("div",{className:"card-body",children:[Object(w.jsx)(Hc.Field.Input,{name:"name",label:"Nom",placeholder:"Nom"}),Object(w.jsx)(Hc.Field.Input,{name:"contact",label:"T\xe9l\xe9phone",placeholder:"T\xe9l\xe9phone"}),Object(w.jsxs)("div",{className:"mt-3",children:[Object(w.jsx)("button",{className:"btn btn-green  btn-sm ",type:"submit",children:"Ajouter"}),Object(w.jsx)("button",{className:"btn btn-danger ml-2  btn-sm ",type:"reset",children:"Annuler"})]})]})]})})})})}})})]})})};var $l=function(){var e=Object(u.i)().id,t=Object(xe.d)(wn("emprunters").value),n=Object(xe.d)(wn("emprunters").meta),c=Object(a.useState)({name:"",contact:""}),r=Object(p.a)(c,2),i=r[0],s=r[1],d=Object(u.g)(),l=Object(xe.c)(),o=Object(a.useState)({}),j=Object(p.a)(o,2);return j[0],j[1],Object(a.useEffect)((function(){l(qn("emprunters").fetch())}),[e]),Object(a.useEffect)((function(){n.isFetching||s(null===t||void 0===t?void 0:t.find((function(t){return t.id==e})))}),[n]),Object(w.jsxs)(qe,{children:[Object(w.jsx)(ge,{title:"Editer une personne",children:Object(w.jsx)(Ne,{title:"Editer une personne"})}),Object(w.jsx)(Se,{children:Object(w.jsx)(Hc,{id:"add-form-emprunteur",initialValues:{name:null===i||void 0===i?void 0:i.name,contact:null===i||void 0===i?void 0:i.contact},validations:Jl,onSubmit:function(e,t){var n=e.name,c=e.contact;l(qn("emprunters").update({id:i.id,name:n,contact:c})),d.goBack()},render:function(e){var t=e.values;return Object(w.jsx)(Hc.Element,{children:Object(w.jsx)("div",{className:"row",children:Object(w.jsx)("div",{className:"col-lg-6",children:Object(w.jsxs)("div",{className:"card",children:[Object(w.jsx)("div",{className:"card-header bg-dark text-white",children:"Information g\xe9n\xe9rale"}),Object(w.jsxs)("div",{className:"card-body",children:[Object(w.jsx)(Hc.Field.Input,{name:"name",value:null===t||void 0===t?void 0:t.name,label:"Nom",placeholder:"Nom"}),Object(w.jsx)(Hc.Field.Input,{name:"contact",value:null===t||void 0===t?void 0:t.contact,label:"T\xe9l\xe9phone",placeholder:"T\xe9l\xe9phone"}),Object(w.jsxs)("div",{className:"mt-3",children:[Object(w.jsx)("button",{className:"btn btn-green  btn-sm ",type:"submit",children:"Editer"}),Object(w.jsx)("button",{className:"btn btn-danger ml-2 btn-sm ",type:"reset",children:"Annuler"})]})]})]})})})})}})})]})};function eo(){return Rr.b().shape({name:Rr.c().required("Le champ est requis")})}var to=function(){Object(xe.d)(wn("vaccinateurs").value);var e=Object(xe.c)(),t=Object(u.g)();return Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)(qe,{children:[Object(w.jsx)(ge,{title:"Ajouter un vaccinateur",children:Object(w.jsx)(Ne,{title:"Ajouter un vaccinateur"})}),Object(w.jsx)(Se,{children:Object(w.jsx)(Hc,{id:"add-form-vaccinateurs",enableReinitialize:!0,initialValues:{name:"",contact:""},validations:eo,onSubmit:function(n,c){var r=n.name,a=n.contact;e(qn("vaccinateurs").create({name:r,contact:a})),t.goBack()},render:function(e){e.values;return Object(w.jsx)(Hc.Element,{children:Object(w.jsx)("div",{className:"row",children:Object(w.jsx)("div",{className:"col-lg-6",children:Object(w.jsxs)("div",{className:"card",children:[Object(w.jsx)("div",{className:"card-header bg-dark text-white",children:"Information g\xe9n\xe9rale"}),Object(w.jsxs)("div",{className:"card-body",children:[Object(w.jsx)(Hc.Field.Input,{name:"name",label:"Nom",placeholder:"Nom"}),Object(w.jsx)(Hc.Field.Input,{name:"contact",label:"T\xe9l\xe9phone",placeholder:"T\xe9l\xe9phone"}),Object(w.jsxs)("div",{className:"mt-3",children:[Object(w.jsx)("button",{className:"btn btn-green  btn-sm ",type:"submit",children:"Ajouter"}),Object(w.jsx)("button",{className:"btn btn-danger ml-2  btn-sm ",type:"reset",children:"Annuler"})]})]})]})})})})}})})]})})};var no=function(){var e=Object(u.i)().id,t=Object(xe.d)(wn("vaccinateurs").value),n=Object(xe.d)(wn("vaccinateurs").meta),c=Object(a.useState)({name:"",contact:""}),r=Object(p.a)(c,2),i=r[0],s=r[1],d=Object(u.g)(),l=Object(xe.c)(),o=Object(a.useState)({}),j=Object(p.a)(o,2);return j[0],j[1],Object(a.useEffect)((function(){l(qn("vaccinateurs").fetch())}),[e]),Object(a.useEffect)((function(){n.isFetching||s(null===t||void 0===t?void 0:t.find((function(t){return t.id==e})))}),[n]),Object(w.jsxs)(qe,{children:[Object(w.jsx)(ge,{title:"Editer un vaccinateur",children:Object(w.jsx)(Ne,{title:"Editer un vaccinateur"})}),Object(w.jsx)(Se,{children:Object(w.jsx)(Hc,{id:"add-form-vaccinateur",initialValues:{name:i.name,contact:i.contact},validations:eo,onSubmit:function(e,t){var n=e.name,c=e.contact;l(qn("vaccinateurs").update({id:i.id,name:n,contact:c})),d.goBack()},render:function(e){var t=e.values;return Object(w.jsx)(Hc.Element,{children:Object(w.jsx)("div",{className:"row",children:Object(w.jsx)("div",{className:"col-lg-6",children:Object(w.jsxs)("div",{className:"card",children:[Object(w.jsx)("div",{className:"card-header bg-dark text-white",children:"Information g\xe9n\xe9rale"}),Object(w.jsxs)("div",{className:"card-body",children:[Object(w.jsx)(Hc.Field.Input,{name:"name",value:null===t||void 0===t?void 0:t.name,label:"Nom",placeholder:"Nom"}),Object(w.jsx)(Hc.Field.Input,{name:"contact",value:null===t||void 0===t?void 0:t.contact,label:"T\xe9l\xe9phone",placeholder:"T\xe9l\xe9phone"}),Object(w.jsxs)("div",{className:"mt-3",children:[Object(w.jsx)("button",{className:"btn btn-green  btn-sm ",type:"submit",children:"Editer"}),Object(w.jsx)("button",{className:"btn btn-danger ml-2 btn-sm ",type:"reset",children:"Annuler"})]})]})]})})})})}})})]})},co=function(e){var t,n=e.product,c=Object(xe.d)((function(e){return e.frommagasins})),r=Object(xe.c)(),a=pl(c,r),s=a.isItemFromMagasin,d=a.addFromMagasin,l=!!s&&s(n.id),o=i.a.useCallback((function(){return n.quantityBruteCVA>15&&n.quantityBruteCVA<=20?"yellow":n.quantityBruteCVA>10&&n.quantityBruteCVA<=15?"#ffdb4c":n.quantityBruteCVA>5&&n.quantityBruteCVA<=10?" orange":n.quantityBruteCVA>0&&n.quantityBruteCVA<=5?"#c44e14b8":0==n.quantityBruteCVA?"red":"green"}),[n]),u=i.a.useCallback((function(){return n.quantityCCCVA>15&&n.quantityCCCVA<=20?"yellow":n.quantityCCCVA>10&&n.quantityCCCVA<=15?"#ffdb4c":n.quantityCCCVA>5&&n.quantityCCCVA<=10?" orange":n.quantityCCCVA>0&&n.quantityCCCVA<=5?"#c44e14b8":0==n.quantityCCCVA?"red":"green"}),[n]);i.a.useCallback((function(){return pa(n)?0==n.quantityBruteCVA&&(0==n.quantityCCCVA||null==n.quantityCCCVA)&&0==n.condval:0==n.quantityBruteCVA&&(0==n.quantityCCCVA||null==n.quantityCCCVA)}),[n]);return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(cr.a.Item,{className:"mb-2 mr-3",style:{width:"100%",border:"1px solid gray",background:"whitesmoke",borderLeft:"10px solid ".concat(o())},children:Object(w.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[Object(w.jsxs)("div",{className:" ".concat(n.id?"":"product-loading"),style:{boxShadow:n&&l?"15px 10px 15px rgba(0, 0, 0, .07)":"none"},children:[Object(w.jsx)("div",{style:{width:10,height:4,background:"".concat(u())}}),Object(w.jsxs)("div",{children:[Object(w.jsx)("div",{children:n.name}),Object(w.jsx)("div",{class:"badge badge-primary",children:null===n||void 0===n||null===(t=n.fournisseur)||void 0===t?void 0:t.name}),Object(w.jsx)("br",{})]})," "]}),Object(w.jsx)("div",{children:n.id&&Object(w.jsx)(w.Fragment,{children:Object(w.jsx)("button",{disabled:Ts(n),className:"mt-3 ".concat(l?"btn btn-danger btn-sm":"btn btn-green btn-sm"),onClick:function(){d&&d(n)},children:l?"Retirer":"Ajouter"})})})]})})})},ro=i.a.memo(co),ao=function(e){var t=e.product,n=e.setRealQtt,c=(e.maxRealQtt,e.realQtt),r=Object(xe.c)(),a=function(e){r(Bd(t.id,e))};return Object(w.jsx)("div",{className:"basket-item-control",children:Object(w.jsxs)(Rc.c,{inputMode:"numeric",w:28,bg:"whitesmoke",min:0,value:c,defaultValue:null===t||void 0===t?void 0:t.quantityParProduct,onChange:function(e){""==e?(n(0),a(0)):(n(e),a(e))},children:[Object(w.jsx)(Rc.d,{}),Object(w.jsxs)(Rc.e,{children:[Object(w.jsx)(Rc.b,{}),Object(w.jsx)(Rc.a,{})]})]})})},io=function(e){var t=e.product,n=e.setRealQttCC,c=(e.setRealQtt,e.setMaxRealQttCC,e.maxRealQttCC,e.realQtt,e.realQttCC),r=Object(xe.c)(),i=(Object(a.useRef)(),Object(xe.d)((function(e){return{frommagasins:e.frommagasins}})).frommagasins,function(e){r(kd(t.id,e))});return Object(w.jsx)("div",{className:"basket-item-control",children:Object(w.jsxs)(Rc.c,{inputMode:"numeric",w:28,bg:"whitesmoke",onChange:function(e){""==e?(i(0),n(0)):(n(1*e),i(1*e))},min:0,value:c,defaultValue:null===t||void 0===t?void 0:t.qttByCC,children:[Object(w.jsx)(Rc.d,{}),Object(w.jsxs)(Rc.e,{children:[Object(w.jsx)(Rc.b,{}),Object(w.jsx)(Rc.a,{})]})]})})},so=function(e){var t=e.product,n=e.setRealQttLitre,c=e.realQttLitre,r=e.maxRealQttByLitre,a=Object(xe.c)(),i=function(e){a(Td(t.id,e))};return Object(w.jsx)("div",{className:"basket-item-control",children:Object(w.jsxs)(Rc.c,{inputMode:"numeric",w:28,step:1,bg:"whitesmoke",min:0,value:c,defaultValue:0,onChange:function(e){""==e?(n(0),i(0)):(n(Number(e)),i(Number(e)))},max:r,children:[Object(w.jsx)(Rc.d,{}),Object(w.jsxs)(Rc.e,{children:[Object(w.jsx)(Rc.b,{}),Object(w.jsx)(Rc.a,{})]})]})})},lo=function(e){var t=e.product,n=Object(a.useState)(null===t||void 0===t?void 0:t.qttByCC),c=Object(p.a)(n,2),r=c[0],i=c[1],s=Object(a.useState)(null===t||void 0===t?void 0:t.quantityParProduct),d=Object(p.a)(s,2),l=d[0],o=d[1],u=Object(a.useState)(0),j=Object(p.a)(u,2),b=j[0],m=j[1],O=Object(a.useState)(2e3),h=Object(p.a)(O,2),x=h[0],v=h[1],f=Object(a.useState)(2e3),g=Object(p.a)(f,2),C=g[0],N=g[1],y=Object(a.useState)(2e3),q=Object(p.a)(y,2),S=q[0],A=q[1],E=Object(xe.d)((function(e){return e.frommagasins})),P=Object(xe.c)(),V=pl(E,P),D=V.isItemFromMagasin,F=V.addFromMagasin;Object(a.useEffect)((function(){var e=function(e,t,n,c){var r=!1;if(Ds(c)){r=!0;var a=e,i=t,s=n,d=c.condval,l=c.quantityCCCVA,o=c.quantityBruteCVA,u=c.condsize,j=c.doseDefault,b=c.condml,m=!0;if(s>0&&0==a&&0==i&&s>o&&(m=!1,d=a,l=i),0==s&&a>0&&0==i){var O=0;Number(a)>Number(u)&&(O=Math.floor(Number(a)/Number(u)),d-(Number(a)-Number(u)*O)<0&&(O+=1)),o-O<0&&(m=!1,o=s,l=i)}if(0==s&&0==a&&i>0&&l-i<0){var h=0,x=0;Number(i)>Number(j)&&(h=Math.floor(Number(i)/Number(j)),l-(Number(i)-Number(j)*h)<0&&(h+=1)),Number(h)>Number(u)&&(x=Math.floor(Number(h)/Number(u)),d-(Number(h)-Number(u)*h)<0&&(x+=1)),o-x<0&&(m=!1,o=s,d=a)}if(0==s&&a>0&&i>0){var v=0,p=0;Number(i)>Number(b)?(v=Math.floor(Number(i)/Number(b)),l-(Number(i)-Number(b)*v)<0&&(v+=1)):l-Number(i)<0&&(v=1);var f=Number(a)+v;f>Number(u)?(p=Math.floor(f/Number(u)),d-(f-Number(u)*p)<0&&(p+=1)):d-f<0&&(p=1),o-p<0&&(m=!1,o=s,d=a)}if(s>0&&a>0&&0==i){var g=0;Number(a)>Number(u)?(g=Math.floor(Number(a)/Number(u)),d-(Number(a)-Number(u)*g+a)<0&&(g+=1)):d-Number(a)<0&&(g=1),o-(g+s)<0&&(m=!1,o=s,d=a)}if(s>0&&0==a&&i>0){var C=0,N=0;Number(i)>Number(b)?(C=Math.floor(Number(i)/Number(b)),l-(Number(i)-Number(b)*C)<0&&(C+=1)):l-Number(i)<0&&(C=1),Number(C)>Number(u)?(N=Math.floor(Number(C)/Number(u)),d-(Number(C)-Number(u)*N)<0&&(N+=1)):d-C<0&&(N=1),o-(N+s)<0&&(m=!1,d=a)}if(s>0&&a>0&&i>0){var y=0,q=0;Number(i)>Number(b)?(y=Math.floor(Number(i)/Number(b)),l-(Number(i)-Number(b)*y)<0&&(y+=1)):l-Number(i)<0&&(y=1);var w=Number(y)+Number(a);w>Number(u)?(q=Math.floor(w/Number(u)),d-(w-Number(u)*q)<0&&(q+=1)):d-w<0&&(q=1),o-(q+s)<0&&(m=!1)}return{normalQtt:d,normalQttCC:l,normalQttLitre:o,isSpecific:r,isValid:m}}var S=e,A=t,E=c.quantityBruteCVA,P=c.quantityCCCVA,V=c.doseDefault,D=c.quantityBruteCVA;r=!1;var F=!0;if(0==S&&A>0){var R=0,M=0;Number(A)>Number(V)?(R=Math.floor(Number(A)/Number(V)),M=Number(A)-Number(V)*R,console.log(M),P-M<0&&(R+=1)):P-Number(A)<0&&(R=1),A>P&&E-R<0&&(F=!1,E=S)}if(S>0&&0==A&&S>E&&(F=!1,P=A),S>0&&A>0){var B,T=0;Number(A)>Number(V)?(B=Math.floor(Number(A)/Number(V)),T=Number(A)-Number(V)*B,console.log(T),P-T<0&&(B+=1)):P-Number(A)<0&&(B=1),Number(E)-(Number(B)+Number(S))<0&&(F=!1),S>E&&(F=!1,P=A)}return{normalQtt:E,normalQttCC:P,normalQttLitre:D,isValid:F,isSpecific:r}}(l,r,b,t),n=e.normalQtt,c=e.normalQttCC,a=e.normalQttLitre,s=e.isSpecific;e.isValid||(alert("stock insuffisant :("),s?(m(a),A(a),o(n),v(n),i(c),N(c)):(o(n),v(n),i(c),N(c)))}),[l,r,b]);var R=!!D&&D(t.id);return Object(w.jsx)("div",{children:Object(w.jsxs)("div",{className:"d-flex justify-content-between align-items-center border   mb-2 p-2",children:[Object(w.jsxs)("div",{style:{width:"45%"},children:[Object(w.jsx)("p",{className:"text-blue",children:t.name}),Ds(t)?Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("p",{className:"text-lowercase",children:Object(w.jsx)("strong",{children:0!=t.qttbylitre&&Object(w.jsx)("span",{style:{marginRight:"30px"},children:De(t.prixlitre)+" x "+t.qttbylitre+" Litre(s)"})})}),Object(w.jsx)("p",{className:"text-lowercase",children:Object(w.jsx)("strong",{children:0!=t.quantityParProduct&&Object(w.jsx)("span",{style:{marginRight:"30px"},children:De(t.prixqttccvente*t.qttccpvente)+" x "+t.quantityParProduct+" "+t.type})})})]}):Object(w.jsx)("p",{className:"text-lowercase",children:Object(w.jsx)("strong",{children:0!=t.quantityParProduct&&Object(w.jsx)("span",{style:{marginRight:"30px"},children:De(t.prixVente)+" x "+t.quantityParProduct+" "+t.type})})}),Object(w.jsx)("p",{className:"text-lowercase",children:Object(w.jsx)("strong",{children:0!=t.qttByCC&&Object(w.jsx)("span",{style:{marginRight:"30px"},children:De(t.prixParCC)+" x "+t.qttByCC+" ML"})})})]}),0!==t.condml&&0!==t.qttccpvente&&Object(w.jsxs)("div",{className:"text-inline text-center mr-3",children:[Object(w.jsx)("h5",{className:"mb-1 text-uppercase",children:"Litre"}),Object(w.jsx)(so,{product:t,setRealQttLitre:m,realQttLitre:b,maxRealQttByLitre:S})," "]}),Object(w.jsxs)("div",{className:"text-inline text-center mr-2",children:[Object(w.jsx)("h5",{className:"mb-1",children:t.type}),Object(w.jsx)(ao,{product:t,setRealQtt:o,setMaxRealQtt:v,maxRealQtt:x,realQtt:l})]}),"FLACON"===t.type&&Object(w.jsxs)("div",{className:"text-inline text-center",children:[Object(w.jsx)("h5",{className:"mb-1",children:3==t.categoryId?"DOSE":"ML"}),Re(t.name,"ita new")&&Object(w.jsx)(Zd,{product:t,setRealQttCC:i,realQttCC:r}),Re(t.name,"sovax")&&Object(w.jsx)(el,{setRealQttCC:i,realQttCC:r,product:t}),0==t.condml&&0==t.qttccpvente&&!Re(t.name,"sovax")&&!Re(t.name,"ita new")&&Object(w.jsx)(io,{setRealQttCC:i,realQttCC:r,maxRealQttCC:C,product:t}),0!==t.condml&&0!==t.qttccpvente&&Object(w.jsx)($d,{product:t,setRealQttCC:i,realQttCC:r,maxRealQttCC:C})]}),Object(w.jsx)("div",{className:"ml-2",children:R&&Object(w.jsx)("button",{onClick:function(){F&&F(t)},className:"btn btn-danger btn-xs text-right",children:"X"})})]})})},oo=function(e){return e&&0!==(null===e||void 0===e?void 0:e.length)?e.reduce((function(e,t){return e+t}),0):0},uo=function(){var e=Object(a.useState)("vente-cva"),t=Object(p.a)(e,2),n=t[0],c=t[1],r=Object(a.useState)(null),i=Object(p.a)(r,2),s=i[0],d=(i[1],Object(a.useState)(null)),l=Object(p.a)(d,2),j=l[0],b=l[1],m=Object(u.g)(),O=Object(xe.d)((function(e){return{frommagasins:e.frommagasins}})).frommagasins,h=Object(xe.c)(),x=Object(xe.d)(wn("emprunters").value),v=Object(a.useState)(!1),f=Object(p.a)(v,2),g=(f[0],f[1],new Date),C=Object(a.useState)(g),N=Object(p.a)(C,2),y=N[0],q=N[1];Object(a.useEffect)((function(){h(qn("emprunters").fetch())}),[]);return Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)(zc.a,{children:[Object(w.jsxs)(zc.a.Header,{className:" bg-dark py-2 text-white d-flex justify-content-between align-items-center",children:[Object(w.jsxs)("div",{style:{width:"60%"},children:["BON DE SORTIE ("," ".concat(null===O||void 0===O?void 0:O.length," ").concat((null===O||void 0===O?void 0:O.length)>1?"articles":"article"),")"]}),Object(w.jsx)("div",{style:{width:"40%"},className:"text-right",children:Object(w.jsxs)("select",{className:"form-control input-sm",onChange:function(e){c(e.target.value)},children:[Object(w.jsx)("option",{value:"vente-cva",selected:!0,children:"Comptant"}),Object(w.jsx)("option",{value:"credit-cva",children:"Credit"})]})})]}),Object(w.jsxs)("div",{className:"commande-vente",children:[Object(w.jsxs)(zc.a.Body,{style:{padding:2,marginTop:3,marginRight:2,marginLeft:2},children:[Object(w.jsxs)("div",{className:"d-flex justify-content-end",children:[Object(w.jsx)(o.b,{className:"btn btn-danger mb-2 mr-2 btn-sm",to:"/historique/vente/vendeur/credit-cva",children:"CREDITS"}),Object(w.jsx)(o.b,{className:"btn btn-primary mb-2 btn-sm text-uppercase",to:"/historique/vente/vendeur/vente-cva",children:"Voir l'historique de vente"})]}),Object(w.jsxs)("div",{style:{overflowY:"auto",height:"350px",maxHeight:"350px",overflowX:"hidden"},children:[Object(w.jsxs)("div",{class:"form-group",children:[Object(w.jsx)("label",{children:"Date de sortie :"}),Object(w.jsx)("div",{children:Object(w.jsx)("input",{type:"date",onChange:function(e){return q(e.target.value)},value:y,className:"form-control"})})]}),"credit-cva"===n&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("label",{children:"Crediteur:"}),Object(w.jsxs)("select",{className:"form-control",onChange:function(e){b(e.target.value)},children:[Object(w.jsx)("option",{value:""}),x.map((function(e){return Object(w.jsx)("option",{value:e.id,children:e.name})}))]})]}),(null===O||void 0===O?void 0:O.length)<=0&&Object(w.jsx)("div",{className:"alert alert-success ",children:wl.fromMagasin.emptyOrder}),null===O||void 0===O?void 0:O.map((function(e,t){return Object(w.jsx)(lo,{product:e,basket:O,dispatch:h},"".concat(null===e||void 0===e?void 0:e.id,"_").concat(t))}))]})]}),(null===O||void 0===O?void 0:O.length)>0&&Object(w.jsxs)(zc.a.Footer,{className:"d-flex align-items-center justify-content-between",children:[Object(w.jsx)("div",{style:{width:"40%"},children:Object(w.jsx)("h2",{className:"p-2 text-uppercase bg-primary",children:Object(w.jsxs)("strong",{"data-test-id":"total-price-orders",children:["Total:",De(oo(O.map((function(e){return pa(e)?e.prixqttccvente*e.quantityParProduct*e.qttccpvente+e.prixlitre*e.qttbylitre:e.prixVente*e.quantityParProduct})))+oo(O.map((function(e){return e.prixParCC*e.qttByCC}))))]})})}),Object(w.jsx)("div",{style:{width:"60%"},children:O.length>0&&Object(w.jsxs)("div",{className:"d-flex text-right align-items-end justify-content-end",children:[Object(w.jsx)("button",{className:"btn btn-green btn-sm mr-2",disabled:0===O.length,onClick:function(){ks(O)?alert("commande non-conforme,veuillez verifier!!"):(O.forEach((function(e){!function(e){if(rl(e)){var t=e.quantityParProduct,n=e.qttByCC,c=e.qttbylitre,r=e.condval,a=e.quantityCCCVA,i=e.condsize,s=(e.doseDefault,e.condml);if(c>0&&0==t&&0==n&&(e.quantityBruteCVA-=c),0==c&&t>0&&0==n){var d=0,l=0;if(Number(t)>=Number(i))if(d=Math.floor(Number(t)/Number(i)),r-(l=Number(t)-Number(i)*d)<0){var o=Number(l)-Number(r);e.condval=Number(i)-Number(o),d+=1}else e.condval=r-l;else if(e.condval-Number(t)<0){var u=Number(t)-Number(e.condval),j=Number(i)-Number(u);e.condval=j,d+=1}else e.condval-=Number(t);e.quantityBruteCVA-=d}if(0==c&&0==t&&n>0){var b=0,m=0,O=0,h=0;if(Number(n)>=Number(s))if(b=Math.floor(Number(n)/Number(s)),a-(h=Number(n)-Number(s)*b)<0){var x=Number(h)-Number(a);e.quantityCCCVA=Number(s)-Number(x),b+=1}else e.quantityCCCVA=a-h;else if(Number(n)>=e.quantityCCCVA){b+=1;var v=Number(n)-e.quantityCCCVA;e.quantityCCCVA=Number(s)-v}else e.quantityCCCVA-=Number(n);if(Number(b)>=Number(i))if(m=Math.floor(Number(b)/Number(i)),r-(O=Number(b)-Number(i)*O)<0){var p=Number(O)-Number(r);e.condval=Number(i)-Number(p),m+=1}else e.condval=r-O;else if(e.condval-Number(b)<0){var f=Number(b)-Number(e.condval),g=Number(i)-Number(f);e.condval=g,m+=1}else e.condval-=Number(b);e.quantityBruteCVA-=m}if(0==c&&t>0&&n>0){var C=0,N=0,y=0,q=0;if(Number(n)>=Number(s))if(C=Math.floor(Number(n)/Number(s)),a-(q=Number(n)-Number(s)*C)<0){var w=Number(q)-Number(a);e.quantityCCCVA=Number(s)-Number(w),C+=1}else e.quantityCCCVA=Number(a)-q;else if(Number(n)>=e.quantityCCCVA){C+=1;var S=Number(n)-e.quantityCCCVA;e.quantityCCCVA=Number(s)-S}else e.quantityCCCVA-=Number(n);var A=Number(t)+C;if(A>=Number(i))if(N=Math.floor(A/Number(i)),r-(y=A-Number(i)*C)<0){var E=Number(y)-Number(r);e.condval=Number(i)-Number(E),N+=1}else e.condval=r-y;else if(e.condval-Number(A)<0){var P=Number(A)-Number(e.condval),V=Number(i)-Number(P);e.condval=V,N+=1}else e.condval-=Number(A);e.quantityBruteCVA-=N}if(c>0&&t>0&&0==n){var D=0,F=0;if(Number(t)>=Number(i))if(D=Math.floor(Number(t)/Number(i)),r-(F=Number(t)-Number(i)*D)<0){var R=Number(F)-Number(r);e.condval=Number(i)-Number(R),D+=1}else e.condval=r-F;else if(e.condval-Number(t)<0){var M=Number(t)-Number(e.condval),B=Number(i)-Number(M);e.condval=B,D+=1}else e.condval-=Number(t);e.quantityBruteCVA-=D+c}if(c>0&&0==t&&n>0){var T=0,k=0,_=0,I=0;if(Number(n)>=Number(s))if(T=Math.floor(Number(n)/Number(s)),a-(I=Number(n)-Number(s)*T)<0){var Q=Number(I)-Number(a);e.quantityCCCVA=Number(s)-Number(Q),T+=1}else e.quantityCCCVA=a-I;else if(Number(n)>=e.quantityCCCVA){T+=1;var L=Number(n)-e.quantityCCCVA;e.quantityCCCVA=Number(s)-L}else e.quantityCCCVA-=Number(n);if(Number(T)>=Number(i))if(k=Math.floor(Number(T)/Number(i)),r-(_=Number(T)-Number(i)*k)<0){var H=Number(_)-Number(r);e.condval=Number(i)-Number(H),k+=1}else e.condval=r-I;else if(e.condval-Number(T)<0){var U=Number(T)-Number(e.condval),Y=Number(i)-Number(U);e.condval=Y,k+=1}else e.condval-=Number(T);e.quantityBruteCVA-=k+c}if(c>0&&t>0&&n>0){var K=0,z=0,G=0,W=0;if(Number(n)>=Number(s))if(K=Math.floor(Number(n)/Number(s)),a-(W=Number(n)-Number(s)*K)<0){var X=Number(W)-Number(a);e.quantityCCCVA=Number(s)-Number(X),K+=1}else e.quantityCCCVA=a-W;else if(Number(n)>=e.quantityCCCVA){K+=1;var J=Number(n)-e.quantityCCCVA;e.quantityCCCVA=Number(s)-J}else e.quantityCCCVA-=Number(n);var Z=Number(K)+Number(t);if(Z>=Number(i))if(z=Math.floor(Z/Number(i)),r-(G=Z-Number(i)*z)<0){var $=Number(G)-Number(r);e.condval=Number(i)-Number($),z+=1}else e.condval=r-W;else if(e.condval-Number(Z)<0){var ee=Number(Z)-Number(e.condval),te=Number(i)-Number(ee);e.condval=te,z+=1}else e.condval-=Number(Z);e.quantityBruteCVA-=z+c}}else{var ne=e.quantityParProduct,ce=e.qttByCC,re=(e.quantityBruteCVA,e.quantityCCCVA),ae=e.doseDefault;if(0==ne&&ce>0){var ie=0,se=0;if(Number(ce)>=Number(ae))if(ie=Math.floor(Number(ce)/Number(ae)),re-(se=Number(ce)-Number(ae)*ie)<0){var de=Number(se)-Number(re);e.quantityCCCVA=Number(ae)-Number(de),ie+=1}else e.quantityCCCVA=Number(re)-se;else if(e.quantityCCCVA-Number(ce)<0){var le=Number(ce)-Number(e.quantityCCCVA);e.quantityCCCVA=Number(ae)-Number(le),ie+=1}else e.quantityCCCVA-=Number(ce);console.log(ie),e.quantityBruteCVA-=ie}if(ne>0&&0==ce&&(e.quantityBruteCVA-=ne),ne>0&&ce>0){var oe=0,ue=0;if(Number(ce)>=Number(ae))if(oe=Math.floor(Number(ce)/Number(ae)),re-(ue=Number(ce)-Number(ae)*oe)<0){var je=Number(ue)-Number(re);e.quantityCCCVA=Number(ae)-Number(je),oe+=1}else e.quantityCCCVA=Number(re)-ue;else if(e.quantityCCCVA-Number(ce)<0){var be=Number(ce)-Number(e.quantityCCCVA);e.quantityCCCVA=Number(ae)-Number(be),oe+=1}else e.quantityCCCVA-=Number(ce);var me=oe+Number(ne);e.quantityBruteCVA-=me}}}(e)})),h(qn("commandes").createTransaction({id:Math.floor(Date.now()/1e3),contenu:O,type:n,sorte:"sortie",vaccinateurId:s,status:"vente-cva"===n,emprunterId:j,dateCom:null!=y?y:g},"add-from-magasin")),h(Md()),m.push("/historique/vente/vendeur/vente-cva"))},type:"button",children:"Valider l'operation"}),Object(w.jsx)("button",{className:"btn btn-danger btn-sm",onClick:function(){O.forEach((function(e){e.quantityParProduct=0,e.qttByCC=0})),h(qs()),h(Md())},type:"button",children:Object(w.jsx)("span",{children:"Annuler"})})]})})]})]})]})})},jo=new Date;function bo(){var e=Object(a.useState)({hours:jo.getHours(),minutes:jo.getMinutes(),seconds:jo.getSeconds()}),t=Object(p.a)(e,2),n=t[0],c=t[1];return Object(a.useEffect)((function(){var e=setInterval((function(){var e=new Date;c({hours:e.getHours()<10?"0"+e.getHours():e.getHours(),minutes:e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes(),seconds:e.getSeconds()<10?"0"+e.getSeconds():e.getSeconds()})}),1e3);return function(){return clearInterval(e)}}),[]),Object(w.jsxs)("div",{className:"bg-dark py-1 px-4 text-center",children:[Object(w.jsxs)("h1",{style:{fontSize:"20px"},children:[n.hours," : ",n.minutes," : ",n.seconds]}),Object(w.jsx)("h4",{className:"bg-thead p-1",children:Ve(jo)})]})}ve.reactFastCompare;var mo=function(){var e=Object(xe.d)(wn("products").value),t=Object(xe.d)(wn("products").meta),n=Object(xe.c)(),c=Object(a.useState)(""),r=Object(p.a)(c,2),i=r[0],s=r[1],d=Object(a.useState)(2),l=Object(p.a)(d,2),o=(l[0],l[1],Object(a.useState)(!1)),u=Object(p.a)(o,2),j=u[0],b=u[1],m=(Object(a.useRef)(null),Object(a.useRef)(null),Object(a.useState)([])),O=Object(p.a)(m,2),h=O[0],x=O[1];Object(a.useEffect)((function(){n(qn("products").fetch())}),[]),Object(a.useEffect)((function(){return 1==j&&(n(qn("products").fetch()),b(!1)),function(){b(!1)}}),[j]),Object(a.useEffect)((function(){t.isFetching||x(e.filter((function(e){return!Ts(e)})))}),[t]),Object(a.useEffect)((function(){x(fr(e.filter((function(e){return!Ts(e)})),i))}),[i]);return Object(w.jsxs)(w.Fragment,{children:[" ",Object(w.jsxs)(qe,{children:[Object(w.jsx)(ge,{title:"Vente du magasin",children:Object(w.jsx)(Ne,{title:"Vente du magasin"})}),Object(w.jsx)(Se,{children:Object(w.jsxs)(rr.a,{children:[Object(w.jsx)(ar.a,{xs:6,children:Object(w.jsxs)(zc.a,{className:"mt-2",children:[Object(w.jsxs)(zc.a.Header,{className:"bg-dark p-2 text-white d-flex text-uppercase justify-content-between align-items-center",children:[Object(w.jsx)("div",{style:{width:"60%"},children:"Produits"}),Object(w.jsx)("div",{children:Object(w.jsx)("button",{className:"btn btn-green btn-sm",onClick:function(){b(!0)},children:"Mettre \xe0 jour"})})]}),Object(w.jsxs)(zc.a.Body,{children:[Object(w.jsxs)("div",{class:"d-flex justify-content-between align-items-center",children:[Object(w.jsx)("input",{type:"text",onChange:function(e){s(e.target.value)},placeholder:"Nom du produit",className:"form-control mb-2"})," "]}),Object(w.jsx)(cr.a,{children:Object(w.jsxs)("div",{style:{overflowY:"auto",width:"100%",height:"350px",maxHeight:"350px",overflowX:"hidden"},children:[Object(w.jsxs)("div",{class:"d-flex justify-content-start flex-wrap",children:[h.sort((function(e,t){return t.quantityBruteCVA-e.quantityBruteCVA})).map((function(e){return Object(w.jsx)(ro,{product:e})})),0==h.length&&"Aucune enregistrement trouv\xe9"]})," "]})})]})]})}),Object(w.jsx)(ar.a,{xs:6,children:Object(w.jsx)("div",{className:" py-2",children:Object(w.jsx)(uo,{setRegenerate:b})})})]})})]})]})},Oo=function(){return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(mo,{})})};function ho(){return Rr.b().shape({prices:Rr.a().of(Rr.b().shape({}))})}var xo=function(){var e=Object(Un.e)(),t=e.values;e.setValues;return Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)("table",{className:"table table-bordered",children:[Object(w.jsx)("thead",{className:" bg-thead",children:Object(w.jsxs)("tr",{children:[Object(w.jsx)("th",{children:"Date debut"}),Object(w.jsx)("th",{children:"Date fin"}),Object(w.jsx)("th",{style:{width:"60%"},children:"Prix"}),Object(w.jsx)("th",{children:"Actions"})]})}),Object(w.jsxs)("tbody",{children:[0==(null===t||void 0===t?void 0:t.prices.length)&&Object(w.jsx)("tr",{children:Object(w.jsx)("td",{colspan:4,className:"text-center",children:"Aucun prix ajout\xe9"})}),Object(w.jsx)(Un.b,{name:"prices",render:function(e){var n;return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("tr",{children:Object(w.jsx)("td",{colspan:4,children:Object(w.jsx)("button",{className:"bg-primary py-1 px-2",onClick:function(){return e.push("")},children:"Ajouter plus"})})}),(null===t||void 0===t?void 0:t.prices)&&(null===t||void 0===t||null===(n=t.prices)||void 0===n?void 0:n.map((function(t,n){return Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:Object(w.jsx)(Hc.Field.Date,{placeholder:"date de debut.",name:"prices.".concat(n,".deb")})}),Object(w.jsx)("td",{children:Object(w.jsx)(Hc.Field.Date,{placeholder:"date de debut.",name:"prices.".concat(n,".fin")})}),Object(w.jsxs)("td",{className:"d-flex flex-row justify-content-between",children:[Object(w.jsx)("div",{className:"mr-2",children:Object(w.jsx)(Hc.Field.Input,{placeholder:"Prix du litre",name:"prices.".concat(n,".prixlitre")})}),Object(w.jsx)("div",{className:"mr-2",children:Object(w.jsx)(Hc.Field.Input,{placeholder:"prix par quantit\xe9",name:"prices.".concat(n,".montant")})}),Object(w.jsx)(Hc.Field.Input,{placeholder:"prix par cc",name:"prices.".concat(n,".prixparcc")})]}),Object(w.jsx)("td",{className:"text-center",children:Object(w.jsx)("button",{className:"btn btn-danger btn-sm",onClick:function(){return e.remove(n)},children:"Retirer"})})]})})))]})}})]})]})})};function vo(){var e,t,n=Object(u.i)().id,c=Object(xe.c)(),r=Object(a.useState)("vente-magasin"),s=Object(p.a)(r,2),d=(s[0],s[1],Object(xe.d)(wn("products").value)),l=Object(xe.d)(wn("commandes").meta),o=Object(a.useState)([]),j=Object(p.a)(o,2);j[0],j[1];Object(a.useEffect)((function(){c(qn("products").get(n))}),[]);var b=Object(a.useCallback)((function(e){c(qn("commandes").createTransaction(Object(_e.a)(Object(_e.a)({},e),{},{id:n}),"get-commande-bw"))}),[]),m=i.a.useMemo((function(){return[{Header:"Date D\xe9but",accessor:"deb"},{Header:"Date Fin",accessor:"fin"},{Header:"Informations",Cell:function(e){var t;return Object(w.jsxs)("table",{className:"table text-center",children:[Object(w.jsx)("thead",{children:Object(w.jsxs)("tr",{children:[Object(w.jsx)("th",{children:"Date"}),Object(w.jsx)("th",{children:"Ancien prix du litre"}),Object(w.jsx)("th",{children:"Nouvel prix du litre "}),Object(w.jsx)("th",{children:"Ancien prix en quantit\xe9"}),Object(w.jsx)("th",{children:"Nouvel prix en quantit\xe9"}),Object(w.jsx)("th",{children:"Ancien prix en ML"}),Object(w.jsx)("th",{children:"Nouvel prix en ML"})]})}),Object(w.jsx)("tbody",{children:null===(t=e.row.original)||void 0===t?void 0:t.data.map((function(e,t){return Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:Ve(e.createdAt)}),Object(w.jsx)("td",{children:"no"!=e.lastPriceLitre?De(""!=e.lastPriceLitre?e.lastPriceLitre:0):""}),Object(w.jsx)("td",{children:"no"!=e.newPriceLitre?De(e.newPriceLitre):""}),Object(w.jsx)("td",{children:De(e.lastPrice)}),Object(w.jsx)("td",{children:De(e.newPrice)}),Object(w.jsx)("td",{children:"no"!=e.lastPriceCC?De(e.lastPriceCC):""}),Object(w.jsx)("td",{children:"no"!=e.newPriceCC?De(e.newPriceCC):""})]},t)}))})]})}}]}),[]);return Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)(qe,{children:[Object(w.jsx)(ge,{title:"Rectification de prix",children:Object(w.jsx)(Ne,{title:"Rectification de prix"})}),Object(w.jsxs)(Se,{children:[Object(w.jsxs)("div",{className:"d-flex flex-row justify-content-between",children:[Object(w.jsx)("h2",{className:"mb-2",style:{fontSize:20},children:null===(e=d[0])||void 0===e?void 0:e.name}),Object(w.jsx)("div",{})]}),Object(w.jsx)(Hc,{enableReinitialize:!0,initialValues:{type:"vente-magasin",prices:[]},validations:ho,onSubmit:b,render:function(e){e.values;return Object(w.jsxs)(Hc.Element,{children:[Object(w.jsx)("div",{style:{width:"30%"},children:Object(w.jsx)(Hc.Field.Select,{name:"type",label:"Type de sortie",emptyValue:!1,valueKey:"name",disabled:!1,defaultValue:1,options:[{id:1,name:"Vente du Magasin"},{id:2,name:"Facture"}]})}),Object(w.jsx)(xo,{}),Object(w.jsxs)("div",{className:"mt-3",children:[Object(w.jsx)("button",{className:"btn btn-green  btn-sm ",type:"submit",children:"Appliquer les changements"}),Object(w.jsx)("button",{className:"btn btn-danger ml-2  btn-sm ",type:"reset",children:"Annuler"})]})]})}}),Object(w.jsx)("h2",{className:"my-3",children:"Recapitulatif des changements"}),Object(w.jsx)(Zc,{filter:!1,data:null===l||void 0===l||null===(t=l.data)||void 0===t?void 0:t.recap,meta:l,columns:m})]})]})})}var po=function(){var e=Object(xe.d)(wn("products").value),t=Object(xe.d)(wn("products").meta),n=Object(xe.c)();Object(a.useEffect)((function(){n(qn("products").fetch())}),[]);var c=i.a.useMemo((function(){return[{Header:"Nom de l'article",accessor:"name"},{Header:"Fournisseur",Cell:function(e){var t,n;return Object(w.jsx)("div",{children:Object(w.jsx)("h3",{className:"badge badge-primary",children:null===(t=e.row.original)||void 0===t||null===(n=t.fournisseur)||void 0===n?void 0:n.name})})}},{Header:"Quantit\xe9",accessor:"quantityBruteCVA"},{Header:"Conditionnement (ML)",accessor:"condval"},{Header:"Reste en ML",accessor:"quantityCC",Cell:function(e){var t,n;return Object(w.jsx)("div",{children:null==(null===(t=e.row.original)||void 0===t?void 0:t.quantityCCCVA)?0:null===(n=e.row.original)||void 0===n?void 0:n.quantityCCCVA})}}]}));return Object(w.jsxs)(xr.a,{children:[Object(w.jsx)(Es,{}),Object(w.jsx)("div",{className:"row",children:Object(w.jsx)("div",{className:"col-lg-6 text-right"})}),Object(w.jsx)(Zc,{data:e,meta:t,columns:c})]})};var fo=function(e){for(var t=0;t<e.length;++t)return e[t].correction>0||e[t].correctionml>0},go=function(){var e=he()().isoWeekday(1).startOf("week"),t=he()().endOf("week"),n=Object(a.useState)(e),c=Object(p.a)(n,2),r=c[0],s=c[1],d=Object(a.useState)(t),l=Object(p.a)(d,2),o=l[0],u=l[1],j=(Object(a.useRef)(null),Object(a.useRef)(null),Object(xe.d)(wn("commandes").value)),b=Object(xe.d)(wn("commandes").meta),m=Object(a.useState)([e,t]),O=Object(p.a)(m,2),h=O[0],x=O[1],v=Object(xe.c)();Object(a.useEffect)((function(){v(function(e,t,n){return hn("commandes",{path:"/operation-vente-cva?deb=".concat(e,"&fin=").concat(t),replace:!0})}(r,o))}),[r,o]),Object(a.useEffect)((function(){null!==h?(h[0]&&s(h[0]),h[1]&&u(h[1])):(s(e),u(t))}),[h]);var f,g=function(e){return e&&0!==(null===e||void 0===e?void 0:e.length)?e.reduce((function(e,t){return e+t}),0):0},C=function(e){return g(null===e||void 0===e?void 0:e.map((function(e){return Fi(e)?e.prixqttccvente*e.quantityParProduct*e.qttccpvente+e.prixVente*e.qttbylitre:e.prixVente*e.quantityParProduct})))+g(null===e||void 0===e?void 0:e.map((function(e){return e.prixParCC*e.qttByCC})))},N=i.a.useMemo((function(){return[{Header:"Date",Cell:function(e){var t;return Object(w.jsx)(w.Fragment,{children:Ve(null===(t=e.row.original)||void 0===t?void 0:t.dateCom)})}},{Header:"Produits",Cell:function(e){var t,n,c,r,a,i;return Object(w.jsxs)("div",{style:{width:"350px"},children:[1==(null===(t=e.row.original)||void 0===t?void 0:t.isdeleted)&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("div",{className:"badge badge-danger",children:"Supprim\xe9"}),Object(w.jsxs)("div",{className:"text text-danger",children:["Date de suppression :"," ",Ve(null===(n=e.row.original)||void 0===n?void 0:n.deletedat)]})]}),null==(null===(c=e.row.original)||void 0===c?void 0:c.isdeleted)&&Object(w.jsx)("p",{children:fo(null===(r=e.row.original)||void 0===r?void 0:r.contenu)&&Object(w.jsx)("div",{className:"badge badge-warning",children:"Modifi\xe9"})}),null===(a=e.row.original)||void 0===a||null===(i=a.contenu)||void 0===i?void 0:i.map((function(t){var n,c;return Object(w.jsxs)("span",{children:[Object(w.jsx)("span",{style:{background:"white",color:1==(null===(n=e.row.original)||void 0===n?void 0:n.isdeleted)?"red":"inherit",padding:2},children:t.name}),Object(w.jsxs)("span",{style:{color:1==(null===(c=e.row.original)||void 0===c?void 0:c.isdeleted)?"red":"inherit"},children:[" "," || "]})]})}))]})}},{Header:"Total",Cell:function(e){var t;return Object(w.jsx)("div",{children:De(C(null===(t=e.row.original)||void 0===t?void 0:t.contenu))})}}]}),[]);return Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)(qe,{children:[Object(w.jsx)(ge,{title:"Operations sur les commandes",children:Object(w.jsx)(Ne,{title:"Operations sur les commandes"})}),Object(w.jsxs)(Se,{children:[Object(w.jsxs)("div",{className:"row my-2",children:[Object(w.jsx)("div",{className:"col-lg-8",children:Object(w.jsxs)("div",{children:[r&&o&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("h2",{children:"Operations sur les commandes"}),Object(w.jsxs)("span",{children:["Du: ",Ve(r)," Au ",Ve(o)]})]})," "]})}),Object(w.jsx)("div",{className:"col-lg-4 text-right",children:Object(w.jsx)("div",{children:Object(w.jsx)(Ee.a,{locale:"fr-FR",onChange:x,value:h})})})]}),Object(w.jsx)(Zc,{filter:!1,data:(f=j,f.filter((function(e){return e.deletedat!=he()("2021-01-01")}))),meta:b,columns:N})]})]})})};var Co,No=function(){return Object(xe.c)(),Object(j.a)(),Object(w.jsx)(o.a,{children:Object(w.jsxs)(u.d,{children:[Object(w.jsx)(Zs,{path:"/",exact:!0,component:Vn}),Object(w.jsx)(Zs,{path:D,component:xd}),Object(w.jsx)(Zs,{path:V,component:Cd}),Object(w.jsx)(Zs,{path:P,component:yd}),Object(w.jsx)(ns,{path:"/vendeur",component:Pl}),Object(w.jsx)(ns,{path:"/stock-cva",component:po}),Object(w.jsx)(ns,{path:"/detailvendeur/:id",component:Ks}),Object(w.jsx)(ns,{path:"/vendeur-commande/:id",component:Gd}),Object(w.jsx)(ns,{path:Z,component:Vs}),Object(w.jsx)(Zs,{path:"/vendre/in/admin",component:Oo}),Object(w.jsx)(Zs,{path:"/detailvendeuradmin/:id",component:Gs}),Object(w.jsx)(Zs,{path:"/vendeur-admin-commande/:id",component:ol}),Object(w.jsx)(Zs,{path:ue,component:Qs}),Object(w.jsx)(Zs,{path:"/changer/prix/:id",component:vo}),Object(w.jsx)(Zs,{path:"/approv",component:Hn}),Object(w.jsx)(Zs,{path:M,component:Fr}),Object(w.jsx)(Zs,{path:"/para/suppl",component:Dr}),Object(w.jsx)(Zs,{path:R,component:Kr}),Object(w.jsx)(Zs,{path:"/bon-commande-depot",component:jd}),Object(w.jsx)(Zs,{path:"/product/edit/:id",component:Hr}),Object(w.jsx)(Zs,{path:F,component:Qr}),Object(w.jsx)(Zs,{path:"/journal",component:Vr}),Object(w.jsx)(Zs,{path:B,component:Wr}),Object(w.jsx)(Zs,{path:T,component:yr}),Object(w.jsx)(Zs,{path:I,component:Qa}),Object(w.jsx)(Zs,{path:k,component:qr}),Object(w.jsx)(Zs,{path:_,component:Pr}),Object(w.jsx)(Zs,{path:Y,component:jd}),Object(w.jsx)(Zs,{path:Q,component:Gr}),Object(w.jsx)(Zs,{path:L,component:zr}),Object(w.jsx)(Zs,{path:U,component:La}),Object(w.jsx)(Zs,{path:"/editer/commande/:id",component:Ui}),Object(w.jsx)(Zs,{path:H,component:Jr}),Object(w.jsx)(Zs,{path:"/detail/:id",component:Sr}),Object(w.jsx)(Zs,{path:"/depot/detail/:id",exact:!0,component:Er}),Object(w.jsx)(Zs,{path:"/product/detail/:id",component:Lr}),Object(w.jsx)(Zs,{path:"/b/sortie",component:nr}),Object(w.jsx)(Zs,{path:"/add/prod",component:Uc}),Object(w.jsx)(Zs,{path:K,component:Ra}),Object(w.jsx)(Zs,{path:"/editer/facture/:id",exact:!0,component:sd}),Object(w.jsx)(Zs,{path:z,component:tr}),Object(w.jsx)(Zs,{path:"/approvis/detail/:id",exact:!0,component:Gc}),Object(w.jsx)(u.b,{path:G,component:Wi}),Object(w.jsx)(u.b,{path:W,component:$i}),Object(w.jsx)(Zs,{path:X,component:xs}),Object(w.jsx)(Zs,{path:"/depot/to/magasin/edit/:id",component:vl}),Object(w.jsx)(Zs,{path:J,component:fs}),Object(w.jsx)(Zs,{path:"/depot/to/magasin/detail/:id",component:Sd}),Object(w.jsx)(Zs,{path:ee,component:Ls}),Object(w.jsx)(Zs,{path:$,component:Us}),Object(w.jsx)(Zs,{path:"/magasin/detail/vente/:id",component:Ed}),Object(w.jsx)(Zs,{path:te,component:Ql}),Object(w.jsx)(Zs,{path:ne,component:Hl}),Object(w.jsx)(Zs,{path:"/detailcorrection/:id",component:Ul}),Object(w.jsx)(Zs,{path:ce,component:ka}),Object(w.jsx)(Zs,{path:re,component:Kl}),Object(w.jsx)(Zs,{path:"/fournisseurs/edit/:id",component:zl}),Object(w.jsx)(Zs,{path:ae,component:Ta}),Object(w.jsx)(Zs,{path:ie,component:Wl}),Object(w.jsx)(Zs,{path:"/categories/edit/:id",component:Xl}),Object(w.jsx)(Zs,{path:se,component:Ia}),Object(w.jsx)(Zs,{path:de,component:Zl}),Object(w.jsx)(Zs,{path:"/emprunters/edit/:id",component:$l}),Object(w.jsx)(Zs,{path:le,component:_a}),Object(w.jsx)(Zs,{path:"/opcommandes",component:go}),Object(w.jsx)(Zs,{path:oe,component:to}),Object(w.jsx)(Zs,{path:"/vaccinateurs/edit/:id",component:no})]})})},yo=(c(935),c(507)),qo=yn("products",{key:"id"}),wo=JSON.parse(localStorage.getItem("user")),So=wo?{isLoggedIn:!0,user:wo}:{isLoggedIn:!1,user:null},Ao=yn("commandes"),Eo=yn("fournisseurs"),Po=yn("emprunters"),Vo=yn("vaccinateurs"),Do=yn("categories"),Fo=yn("approvis"),Ro=yn("parametres"),Mo={shipping:{},payment:{type:"",name:"",cardnumber:"",expiry:"",ccv:""}},Bo=yn("sortiedepots"),To=Object(fn.b)({searchbydate:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{deb:he()().isoWeekday(1).startOf("week"),fin:he()().endOf("week")},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Cs:return t.payload;case Ns:return{deb:he()().isoWeekday(1).startOf("week"),fin:he()().endOf("week")};default:return e}},count:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{counter:0},t=arguments.length>1?arguments[1]:void 0;return"ADD"===t.type?Object(_e.a)(Object(_e.a)({},e),{},{counter:e.counter+1}):e},auth:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:So,c=arguments.length>1?arguments[1]:void 0,r=c.type,a=c.payload;switch(r){case Mn:return Object(_e.a)(Object(_e.a)({},n),{},{isLoggedIn:!0,user:null===(e=a.user)||void 0===e?void 0:e.user,success:a.success,error:null});case Bn:return Object(_e.a)(Object(_e.a)({},n),{},{isLoggedIn:!1,user:null,success:null,error:a.error});case Tn:return Object(_e.a)(Object(_e.a)({},n),{},{isLoggedIn:!0,user:null===(t=a.user)||void 0===t?void 0:t.user,success:a.success,error:null});case kn:return Object(_e.a)(Object(_e.a)({},n),{},{isLoggedIn:!1,user:null,token:null,success:null,error:a.error});case _n:return Object(_e.a)(Object(_e.a)({},n),{},{isLoggedIn:!1,user:null,token:null});default:return n}},products:qo,realproducts:qo,categories:Do,fournisseurs:Eo,emprunters:Po,vaccinateurs:Vo,commandes:Ao,commandesclone:Ao,basket:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ir:return t.payload;case sr:return e.some((function(e){return e.id===t.payload.id}))?e:[t.payload].concat(Object(me.a)(e));case dr:return e.filter((function(e){return e.id!==t.payload}));case lr:return[];case or:return e.map((function(e){return e.id==t.payload.id&&(e.quantityParProduct+=1),e.id==t.payload.id&&e.doseRestantEnMg>=1e3*e.doseDefault?e.doseRestantEnMg+=1e3*e.doseDefault:e.doseRestantEnMg=e.doseRestantEnMg,e}));case jr:return e.map((function(e){return e.id==t.payload.id&&(e.qttByCC+=1),e.id==t.payload.id&&e.doseRestantEnMg>=1e3*e.doseDefault?e.doseRestantEnMg+=1e3:e.doseRestantEnMg=e.doseRestantEnMg,e}));case ur:return e.map((function(e){return e.id==t.payload.id&&(e.quantityParProduct-=1),e.id==t.payload.id&&e.doseRestantEnMg>=1e3*e.doseDefault?e.doseRestantEnMg-=1e3*e.doseDefault:e.doseRestantEnMg=e.doseRestantEnMg,e}));case br:return e.map((function(e){return e.id==t.payload.id&&(e.qttByCC-=1),e.id==t.payload.id&&e.doseRestantEnMg>=e.doseDefault?e.doseRestantEnMg-=1e3:e.doseRestantEnMg=e.doseRestantEnMg,e}));default:return e}},approvisionnements:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case na:return t.payload;case ca:return e.some((function(e){return e.id===t.payload.id}))?e:[t.payload].concat(Object(me.a)(e));case ra:return e.filter((function(e){return e.id!==t.payload}));case aa:return[];case ia:return e.map((function(e){return e.id==t.payload.id&&(e.quantityParProduct+=1),e}));case da:return e.map((function(e){return e.id==t.payload.id&&(e.quantityParProduct=Number(t.payload.qtt)),e}));case sa:return e.map((function(e){return e.id==t.payload.id&&(e.quantityParProduct-=1),e}));case la:return e.map((function(e){return e.id===t.payload.id&&(e.quantityParProduct=t.payload.value),e}));case oa:return e.map((function(e){return e.id===t.payload.id&&(e.remise=t.payload.value),e}));case ua:return e.map((function(e){return e.id===t.payload.id&&(e.remisePerProduct=t.payload.value),e}));default:return e}},approvis:Fo,fromdepots:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ka:return t.payload;case za:return e.some((function(e){return e.id===t.payload.id}))?e:[t.payload].concat(Object(me.a)(e));case Ga:return e.filter((function(e){return e.id!==t.payload}));case Wa:return[];case Xa:return e.map((function(e){return e.id===t.payload.id&&(e.quantityParProductDepot=Number(t.payload.qtt)),e}));case Ja:case ti:return e.map((function(e){return e.id==t.payload.id&&(e.qttByCCDepot=Number(t.payload.value)),e}));case Za:return e.map((function(e){return e.id===t.payload.id&&(e.quantityParProductDepot=Number(t.payload.value)),e}));case $a:return e.map((function(e){return e.id===t.payload.id&&(e.qttyspecificmirrordepot=Number(t.payload.value),e.qttByCCDepot=1*t.payload.value/2),e}));case ei:return e.map((function(e){return e.id===t.payload.id&&(e.qttyspecificmirrordepot=Number(t.payload.value),e.qttByCCDepot=1*t.payload.value*2),e}));case ni:return e.map((function(e){return e.id===t.payload.id&&(e.qttByCCDepot-=t.payload.qttccpventedepot),e}));default:return e}},stock:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=(t.type,t.payload);switch(t.type){case In:return Object(_e.a)(Object(_e.a)({},e),t.payload);case Qn:return n;default:return e}},checkout:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Mo,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case mr:return Object(_e.a)(Object(_e.a)({},e),{},{shipping:t.payload});case Or:return Object(_e.a)(Object(_e.a)({},e),{},{payment:t.payload});case hr:return Mo;default:return e}},parametres:Ro,tomagasins:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case cs:return t.payload;case rs:return e.some((function(e){return e.id===t.payload.id}))?e:[t.payload].concat(Object(me.a)(e));case as:return e.filter((function(e){return e.id!==t.payload}));case is:return[];case ss:return e.map((function(e){return e.id===t.payload.id&&(e.quantityParProduct+=1),e}));case ss:return e.map((function(e){return e.id===t.payload.id&&(e.quantityParProduct=Number(t.payload.qtt)),e}));case ds:return e.map((function(e){return e.id===t.payload.id&&(e.quantityParProduct-=1),e}));case ls:return e.map((function(e){return e.id===t.payload.id&&(e.quantityParProduct=t.payload.value),e}));default:return e}},frommagasins:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ai:return t.payload;case ii:return e.some((function(e){return e.id===t.payload.id}))?e:[t.payload].concat(Object(me.a)(e));case si:return e.filter((function(e){return e.id!==t.payload}));case di:return[];case li:return e.map((function(e){return e.id===t.payload.id&&(e.quantityParProduct=Number(t.payload.qtt)),e}));case xi:return e.map((function(e){return e.id==t.payload.id&&(e.qttbybrute=Number(t.payload.value)),e}));case oi:case mi:return e.map((function(e){return e.id==t.payload.id&&(e.qttByCC=Number(t.payload.value)),e}));case ui:return e.map((function(e){return e.id===t.payload.id&&(e.quantityParProduct=Number(t.payload.value)),e}));case hi:return e.map((function(e){return e.id===t.payload.id&&(e.qttbylitre=Number(t.payload.value)),e}));case ji:return e.map((function(e){return e.id===t.payload.id&&(e.qttyspecificmirror=Number(t.payload.value),e.qttByCC=1*t.payload.value),e}));case bi:return e.map((function(e){return e.id===t.payload.id&&(e.qttyspecificmirror=Number(t.payload.value),e.qttByCC=1*t.payload.value*2),e}));case Oi:return e.map((function(e){return e.id===t.payload.id&&(e.qttByCC-=t.payload.qttccpvente),e}));default:return e}},sortiedepots:Bo}),ko=c(1003),_o=ko.persistStore,Io=(0,ko.persistReducer)({key:"root",whitelist:["auth","profile","basket","approvisionnement","searchbydate"],storage:c(936).default},To),Qo=Object(fn.c)(Io,(Co=[yo.a],fn.a.apply(void 0,Object(me.a)(Co)))),Lo=_o(Qo);c(508),new Date;var Ho=c(509),Uo=c(1054),Yo=(c(939),c(940),c(941),c(942),c(943),c(1050)),Ko=Object(Yo.a)({fontSizes:{lg:"18px"},fonts:{heading:"Montserrat",body:"Montserrat"},styles:{global:function(e){return{"html, body":{fontSize:"sm",lineHeight:"tall"}}}},components:{Button:{baseStyle:{fontWeight:"bold"},sizes:{xl:{h:"56px",fontSize:"sm",px:"13px"}},variants:{"with-shadow":{bg:"#2c5282"},solid:function(e){return{bg:(e.colorMode,"#2c5282")}}}}}}),zo=c(174);d.a.render(Object(zo.jsx)(Uo.a,{theme:Ko,children:Object(zo.jsxs)(xe.a,{store:Qo,children:[Object(zo.jsx)(nn.a,{position:"top-right",autoClose:5e3,limit:2,hideProgressBar:!1,newestOnTop:!0,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"dark"}),Object(zo.jsx)(Ho.a,{loading:null,persistor:Lo,children:Object(zo.jsx)(No,{})})]})}),document.getElementById("root")),l()},522:function(e,t,n){},759:function(e,t,n){},833:function(e,t,n){},941:function(e,t,n){},958:function(e,t){}},[[1001,1,2]]]);
//# sourceMappingURL=main.adb2bba4.chunk.js.map