(this["webpackJsonpVeto-react"]=this["webpackJsonpVeto-react"]||[]).push([[0],{1238:function(e,t,n){},1255:function(e,t){},1299:function(e,n,c){"use strict";c.r(n);var r,a=c(2),i=c.n(a),s=(c(653),c(74)),o=c.n(s),l=c(644),d=function(e){e&&e instanceof Function&&c.e(3).then(c.bind(null,1367)).then((function(t){var n=t.getCLS,c=t.getFID,r=t.getFCP,a=t.getLCP,i=t.getTTFB;n(e),c(e),r(e),a(e),i(e)}))},u=c(10),j=c(30),b=c(68),m=c(118),O=c.n(m),h=c(29),x=c(32),v=c(40),p=c(41),f=c(4),g=c(7),y="ADMIN",N="VENDEURLV1",C="VENDEURL2",S={canShowDashboard:"can-view-dashboard",canShowFactureProducts:"can-show-facture-products",canShowFactures:"can-show-factures",canShowProducts:"can-show-products",canShowDepot:"can-show-depot",canShowBonDeSortie:"can-show-bon-de-sortie",canShowHistoriqueDeSortie:"can-show-historique-de-sortie",canShowCredit:"can-show-credit",canShowVaccinateur:"can-show-vaccinateur",canShowMagasin:"can-show-magasin",canShowDepotVersMagasin:"can-show-depot-vers-magasin",canHistoriqueDeDM:"can-show-historique-de-dm",canShowCorrection:"can-show-correction",canAddCorrection:"can-add-correction",canShowHistoriqueDeCorrection:"can-show-historique-de-correction",canShowVente:"can-show-vente",canShowEffectuerUneVente:"can-show-effectuer-une-vente",canShowEtatDeStockMagasin:"can-show-etat-de-stock-magasin",canShowHistoriqueDeVenteDuMagasin:"can-show-historique-de-vente-du-magasin",canShowVenteCredit:"can-show-vente-credit",canShowParameter:"can-show-parameter",canShowCategory:"can-show-category",canShowFournisseur:"can-show-fournisseur",canShowDemandeurCredit:"can-show-demandeur-credit",canShowVaccinateurs:"can-show-vaccinateurs",canShowDetailFactures:"can-show-detail-factures",canShowEditFacture:"can-show-edit-facture",canShowAddFacture:"can-show-add-facture",canShowDeleteFacture:"can-show-delete-facture",canShowDetailProduit:"can-show-detail-produit",canShowEditProduit:"can-show-edit-produit",canShowAddProduit:"can-show-add-produit",canShowDeleteProduit:"can-show-delete-produit",canShowDetailCreditDepot:"can-show-detail-credit-depot",canShowEditCreditDepot:"can-show-edit-credit-depot",canShowAddCreditDepot:"can-show-add-credit-depot",canShowDeleteCreditDepot:"can-show-delete-credit-depot",canShowDetailVaccinateurCreditDepot:"can-show-detail-vaccinateur-credit-depot",canShowEditVaccinateurCreditDepot:"can-show-edit-vaccinateur-credit-depot",canShowAddVaccinateurCreditDepot:"can-show-add-vaccinateur-credit-depot",canShowDeleteVaccinateurCreditDepot:"can-show-delete-vaccinateur-credit-depot",canShowDetailHistoricDeSortieDepot:"can-show-detail-historic-de-sortie-depot",canShowEditHistoricDeSortieDepot:"can-show-edit-historic-de-sortie-depot",canShowAddHistoricDeSortieDepot:"can-show-add-historic-de-sortie-depot",canShowDeleteHistoricDeSortieDepot:"can-show-delete-historic-de-sortie-depot",canCreateCategory:"can-create-category",canEditCategory:"can-edit-category",canDeleteCategory:"can-delete-category",canViewCategory:"can-view-category",canCreateEmprunter:"can-create-emprunter",canEditEmprunter:"can-edit-emprunter",canDeleteEmprunter:"can-delete-emprunter",canViewEmprunter:"can-view-emprunter",canCreateFournisseurs:"can-create-fournisseurs",canEditFournisseurs:"can-edit-fournisseurs",canDeleteFournisseurs:"can-delete-fournisseurs",canViewFournisseurs:"can-view-fournisseurs",canCreateVaccinateur:"can-create-vaccinateur",canEditVaccinateur:"can-edit-vaccinateur",canDeleteVaccinateur:"can-delete-vaccinateur",canViewVaccinateur:"can-view-vaccinateur",canCreate:"can-create",canEdit:"can-edit",canDelete:"can-delete",canView:"can-view"},q=(r={},Object(g.a)(r,y,[S.canShowDashboard,S.canShowFactureProducts,S.canShowFactures,S.canShowProducts,S.canShowDepot,S.canShowBonDeSortie,S.canShowHistoriqueDeSortie,S.canShowCredit,S.canShowVaccinateur,S.canShowMagasin,S.canShowDepotVersMagasin,S.canAddCorrection,S.canShowVente,S.canShowEffectuerUneVente,S.canShowEtatDeStockMagasin,S.canShowHistoriqueDeVenteDuMagasin,S.canShowVenteCredit,S.canShowParameter,S.canShowCategory,S.canShowFournisseur,S.canShowDemandeurCredit,S.canShowVaccinateurs,S.canShowDetailFactures,S.canShowEditFacture,S.canShowAddFacture,S.canShowDeleteFacture,S.canShowDetailProduit,S.canShowEditProduit,S.canShowAddProduit,S.canShowDeleteProduit,S.canShowDetailCreditDepot,S.canShowEditCreditDepot,S.canShowAddCreditDepot,S.canShowDeleteCreditDepot,S.canShowDetailHistoricDeSortieDepot,S.canShowEditHistoricDeSortieDepot,S.canShowAddHistoricDeSortieDepot,S.canShowDeleteHistoricDeSortieDepot,S.canShowDetailVaccinateur,S.canShowEditVaccinateur,S.canShowAddVaccinateur,S.canShowDeleteVaccinateur,S.canShowDetailVaccinateurCreditDepot,S.canShowEditVaccinateurCreditDepot,S.canShowAddVaccinateurCreditDepot,S.canShowDeleteVaccinateurCreditDepot,S.canCreateCategory,S.canEditCategory,S.canDeleteCategory,S.canCreateFournisseurs,S.canEditFournisseurs,S.canDeleteFournisseurs,S.canCreateEmprunter,S.canEditEmprunter,S.canDeleteEmprunter,S.canCreateVaccinateur,S.canEditVaccinateur,S.canDeleteVaccinateur,S.canHistoriqueDeDM,S.canShowCorrection,S.canAddCorrection,S.canShowHistoriqueDeCorrection]),Object(g.a)(r,N,[]),Object(g.a)(r,C,[]),r),w=c(1);function E(e){var t=e.children,n=e.scopes,c=function(e){var t=e.permissions,n=e.scopes,c={};return n.forEach((function(e){c[e]=!0})),t.some((function(e){return c[e]}))}({permissions:q[y],scopes:void 0===n?[]:n});return c?Object(w.jsx)(w.Fragment,{children:t}):Object(w.jsx)(w.Fragment,{})}var A=function(e){var t=e.title,n=e.route,c=e.scopes,r=void 0===c?[]:c,a=Object(j.h)().pathname==n;return Object(w.jsx)(E,{scopes:r,children:Object(w.jsx)("li",{class:"nav-item",children:Object(w.jsxs)(u.b,{as:u.c,to:n,class:"text-white nav-link ".concat(a?"active":""),children:[Object(w.jsx)("i",{class:"far fa-circle nav-icon"}),Object(w.jsx)("p",{children:t})]})})})},D=function(e){var t=e.children,n=e.title,c=e.scopes,r=void 0===c?[]:c,i=Object(a.useState)(!1),s=Object(f.a)(i,2),o=s[0];s[1];return Object(w.jsx)(E,{scopes:r,children:Object(w.jsxs)("li",{as:u.c,class:"nav-item ".concat(o?"menu-is-opening":null," menu-open"),children:[Object(w.jsxs)("a",{href:"#",class:"nav-link",children:[Object(w.jsx)("i",{class:"nav-icon fas fa-tachometer-alt"}),Object(w.jsxs)("p",{children:[n,Object(w.jsx)("i",{className:"right fas fa-angle-left"})]})]}),Object(w.jsx)("ul",{className:"nav nav-treeview",style:{display:"block"},children:t})]})})};var P=c(3),V="Checking",F="Latest",R="Downloading",T="Downloaded",M="Unknown",B="Failed",k="Available",_="1.0",I=c(23),L=c.n(I),Q=c(49),H="REGISTER_SUCCESS",U="REGISTER_FAIL",Y="LOGIN_SUCCESS",K="LOGIN_FAIL",z="LOGOUT",W="UPDATE_STOCK_REQUEST_SUCCESS",G="UPDATE_STOCK_REQUEST_FAIL",X="SET_VERSION_INFO",J="SET_IGNORE_VERSION",$=function(e,t){console.log("currentVersion",e,"targetVer",t);var n=function(e){return".".concat(e.toLowerCase().charCodeAt(0)-2147483647,".")};e=(""+e).replace(/[^0-9.]/g,n).split("."),t=(""+t).replace(/[^0-9.]/g,n).split(".");for(var c=Math.max(e.length,t.length),r=0;r<c;r++){if(e[r]=~~e[r],t[r]=~~t[r],e[r]>t[r])return 1;if(e[r]<t[r])return-1}return 0},Z=function(){return new Promise((function(e,t){O.a.get("https://raw.githubusercontent.com/armelgeek/real-veto-react/master/publish/version.json").then((function(t){e(t.data)})).catch((function(e){return t(e)}))}))},ee=function(e){return{type:X,payload:e}},te=c(332),ne=(te.actions.toggleModal,te.actions.modifyOkModal,Object(a.memo)((function(){var e=Object(P.useSelector)((function(e){return e.version})),t=Object(P.useDispatch)(),n=Object(a.useState)(""),c=Object(f.a)(n,2),r=(c[0],c[1]);return Object(a.useEffect)((function(){switch(e.status){case k:case R:r("\ud83c\udf1f New version found \ud83c\udf1f");break;case T:r("version_title_update");break;case V:r("\u23f3 Checking for updates \u23f3");break;case B:r("\u274c Download failed \u274c");break;case M:r("\u2753 Failed to get the latest version information \u2753");break;default:r("The software is up to date, please enjoy it~\ud83e\udd42")}}),[e]),Object(w.jsx)("div",{className:"pr-2",children:e.status==k?Object(w.jsx)("div",{children:Object(w.jsx)("button",{className:"btn btn-primary btn-sm",onClick:function(){t(ee({showModal:!0}))},children:"\ud83c\udf1f Nouvelle version trouv\xe9e \ud83c\udf1f \ud83d\ude80"})}):Object(w.jsx)("div",{children:Object(w.jsxs)("h3",{className:"text-white",children:["Version actuelle:  ","1.0"]})})})}))),ce="/tdb-depot-magasin",re="/tdb-vente-cbv",ae="/tdb-facture",ie="/create-product",se="/products",oe="/perimes",le="/rupture",de="/credit/normal",ue="/credit/vaccinateur",je="/direct",be="/parametres",me="/product/fournisseur",Oe="/product/category",he="/entree",xe="/sortie",ve="/bon/sortie",pe="/nouvelle/facture",fe="/list/approv",ge="/signin",ye="/signup",Ne="/admin",Ce="/historique/sortie/cva",Se="/historique/vente/admin/vendeur",qe="/etat/stock/magasin",we="/corrections",Ee="/historique/corrections",Ae="/fournisseurs/list",De="/add-fournisseur",Pe="/categories/list",Ve="/add-categories",Fe="/emprunteurs/list",Re="/add-emprunteurs",Te="/vaccinateurs/list",Me="/add-vaccinateurs",Be="/historique-admin/vente/vendeur/:type",ke=function(e){Object(v.a)(n,e);var t=Object(p.a)(n);function n(){return Object(h.a)(this,n),t.apply(this,arguments)}return Object(x.a)(n,[{key:"render",value:function(){var e=this.props,t=e.children,n=(e.navigation,e.title),c=(e.titleShort,this.props.searchbarFilter,this.props.homeTo);return t||(t=[Object(w.jsx)("div",{children:"No content"})]),t.length||(t=[t]),n.length||(n=[n]),Object(w.jsxs)("div",{className:"wrapper position-relative",children:[Object(w.jsx)("div",{className:"bg-dark p-2 text-center",children:Object(w.jsx)("h4",{className:"m-0 p-2 text-white",children:"CABINET VETERINAIRE AMBALAVAO"})}),Object(w.jsx)("div",{style:{position:"absolute",top:10,right:5},children:Object(w.jsx)(ne,{})}),Object(w.jsxs)("aside",{className:"main-sidebar sidebar-dark-primary",style:{maxHeight:"100%",overflow:"auto"},children:[Object(w.jsx)(u.b,{to:c,className:"brand-link border-0",children:Object(w.jsx)("span",{className:"ml-4 brand-text font-weight-light text-center text-uppercase",children:n})}),Object(w.jsx)("div",{className:"sidebar position-relative",children:Object(w.jsx)("nav",{className:"mt-2",children:Object(w.jsxs)("ul",{className:"nav nav-pills nav-sidebar flex-column","data-widget":"treeview",role:"menu","data-accordion":"false",children:[Object(w.jsx)(A,{title:"Tableau de bord",route:"/",scopes:[S.canShowDashboard]}),Object(w.jsxs)(D,{title:"Factures && Produits",scopes:[S.canShowFactureProducts],children:[Object(w.jsx)(A,{title:"Factures",route:fe,scopes:[S.canShowFactures]}),Object(w.jsx)(A,{title:"Produits",route:se,scopes:[S.canShowProducts]})]}),Object(w.jsxs)(D,{title:"D\xe9pot",scopes:[S.canShowDepot],children:[Object(w.jsx)(A,{title:"Bon de sortie",route:ve,scopes:[S.canShowBonDeSortie]}),Object(w.jsx)(A,{title:"Historique de sortie",route:xe,scopes:[S.canShowHistoriqueDeSortie]}),Object(w.jsx)(A,{title:"Credit",route:de,scopes:[S.canShowCredit]}),Object(w.jsx)(A,{title:"Vaccinateur",route:ue,scopes:[S.canShowVaccinateur]})]}),Object(w.jsxs)(D,{title:"Magasin",scopes:[S.canShowMagasin],children:[Object(w.jsx)(A,{title:"Depot vers Magasin",route:Ne,scopes:[S.canShowDepotVersMagasin]}),Object(w.jsx)(A,{title:"Historique de 'D\xe9p\xf4t vers Magasin'",route:Ce,scopes:[S.canHistoriqueDeDM]})]}),Object(w.jsxs)(D,{title:"Correction",scopes:[S.canShowCorrection],children:[Object(w.jsx)(A,{title:"Ajouter une correction",route:we,scopes:[S.canAddCorrection]}),Object(w.jsx)(A,{title:"Historique de correction",route:Ee,scopes:[S.canShowHistoriqueDeCorrection]})]}),Object(w.jsxs)(D,{title:"Vente",scopes:[S.canShowVente],children:[Object(w.jsx)(A,{title:"Effectuer une vente",route:"/vendre/in/admin",scopes:[S.canShowEffectuerUneVente]}),Object(w.jsx)(A,{title:"Etat de stock magasin",route:qe,scopes:[S.canShowEtatDeStockMagasin]}),Object(w.jsx)(A,{title:"Historique de vente du magasin",route:"/historique-admin/vente/vendeur/vente-cva",scopes:[S.canShowHistoriqueDeVenteDuMagasin]}),Object(w.jsx)(A,{title:"Cr\xe9dit",route:"/historique-admin/vente/vendeur/credit-cva",scopes:[S.canShowVenteCredit]})]}),Object(w.jsxs)(D,{title:"Parametres",scopes:[S.canShowParameter],children:[Object(w.jsx)(A,{title:"Categories",route:Pe,scopes:[S.canShowCategory]}),Object(w.jsx)(A,{title:"Fournisseurs",route:Ae,scopes:[S.canShowFournisseur]}),Object(w.jsx)(A,{title:"Demandeurs de credit",route:Fe,scopes:[S.canShowDemandeurCredit]}),Object(w.jsx)(A,{title:"Vaccinateurs",route:Te,scopes:[S.canShowVaccinateur]})]})]})})})]}),Object(w.jsx)(w.Fragment,{children:t}),Object(w.jsxs)("footer",{className:"shadow-sm bg-white main-footer d-flex flex-row justify-content-between align-items-center",children:[Object(w.jsx)("div",{children:Object(w.jsxs)("h4",{children:["Copyright \xa9 2022 ",Object(w.jsx)("a",{href:"https://www.facebook.com/armel.mouhid",children:"Armel Wanes"}),"."]})}),Object(w.jsx)("div",{})]})]})}}]),n}(i.a.PureComponent);ke.defaultProps={children:null,title:["Admin","LTE"],browserTitle:null,theme:"blue",footer:null,sidebar:void 0,homeTo:"/",searchbarFilter:!1};var _e=ke,Ie=c(14),Le=(c(692),c.p,c(901),c(15)),Qe=c.n(Le);c(1327);var He=c(86),Ue=c.n(He);function Ye(e){var t=e.children,n=e.title,c=Object(j.g)();return Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)("div",{children:[Object(w.jsx)("div",{className:"content-header p-2 shadow-sm bg-white",children:Object(w.jsx)("div",{className:"container-fluid",children:Object(w.jsxs)("div",{className:"row",children:[Object(w.jsx)("div",{className:"col-sm-6",children:Object(w.jsx)("h4",{className:"mt-2 text-uppercase",children:n})}),Object(w.jsx)("div",{className:"col-sm-6",children:Object(w.jsxs)("ol",{className:"breadcrumb float-sm-right",children:[Object(w.jsx)("li",{className:"breadcrumb-item",children:Object(w.jsx)(u.b,{to:"/",children:"Accueil"})}),t]})})]})})}),Object(w.jsx)("div",{className:"mb-1",children:Object(w.jsxs)("button",{type:"button",onClick:function(){return c.goBack()},className:"btn btn-link",children:["<<"," Revenir en arriere"]})})]})})}var Ke=i.a.memo(Ye,Ue.a);function ze(e){var t=e.title;return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)("li",{className:"breadcrumb-item active",children:t})})}var We=i.a.memo(ze,Ue.a);function Ge(e){var t=e.children;return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)("div",{className:"content-wrapper",children:t})})}var Xe=i.a.memo(Ge,Ue.a);function Je(e){var t=e.children;return Object(w.jsx)("section",{className:"content",children:Object(w.jsx)("div",{className:"container-fluid",children:t})})}var $e=i.a.memo(Je),Ze=(c(300),c(89)),et=c.n(Ze),tt=c(35);c(645);var nt=function(e){var t=new Date(e),n=t.getDate(),c=t.getMonth(),r=t.getFullYear();return" ".concat(n," ").concat(["Janvier","Fevrier","Mars","Avril","Mai","Juin","Juillet","Ao\xfbt","Septembre","Octobre","Novembre","Decembre"][c]," ").concat(r)},ct=function(e){return new Intl.NumberFormat("fr-MG",{style:"currency",currency:"MGA"}).format(e)};function rt(e){return e.toString().replace(/\s/g,"").toLowerCase()}var at=function(e,t){if(rt(e).includes(rt(t)))return!0};var it=function(e){var t=e.date,n=new Date(t).toLocaleString("fr-FR",{weekday:"short"}),c=new Date(t).getDate();return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)("td",{style:{height:"100%"},className:"sam."==n?" bg-warning text-white text-center mr-2":"bg-dark text-center mr-2",children:c})})},st=function(e){var t=e.flat,n=(e.gr,e.quantityb,e.quantityc,e.quantitycond,e.id),c=t.filter((function(e){return e.id==n})),r=void 0!=c[c.length-1]?c[c.length-1]:{},a=(r.hasOwnProperty("id")&&r.quantityBruteCVA,r.hasOwnProperty("id")&&r.quantityCCCVA,0),i=0,s=0;c?(a=c.map((function(e){return 1*e.quantityParProduct})).reduce((function(e,t){return e+t}),0),i=c.map((function(e){return e.qttByCC})).reduce((function(e,t){return e+t}),0),s=c.map((function(e){return e.qttbylitre})).reduce((function(e,t){return e+t}),0)):(a=0,i=0,s=0);var o=c.map((function(e){return e.prixVente}));return Object(w.jsx)("td",{className:"text-center p-1",title:"prix de vente:"+o[0]!=void 0?o[0]:"",children:Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{className:0==c.length?"text-center p-1":"text-center bg-secondary p-1 text-white",children:0!=s?s:"-"}),Object(w.jsx)("td",{className:0==c.length?"text-center p-1":"text-center bg-primary p-1 text-white",children:0!=a?a:"-"}),Object(w.jsx)("td",{className:0==c.length?"text-center  p-1":"text-center  bg-warning p-1",children:0!=i?i:"-"})]})})},ot=function(e,t,n,c){return e.filter((function(e){var r=new Date(e[t]);return Qe()(r).isBetween(n,c,"days","[]")}))},lt=function(e,t){var n;return Object(Ie.a)(new Set((n=[]).concat.apply(n,Object(Ie.a)(e.map((function(e){return e[t]}))))))},dt=c(5),ut=c(64),jt=c.n(ut),bt=c(185),mt=c(932),Ot=c(935);function ht(e,t,n,c){var r=mt(e).toUpperCase(),a=n.toUpperCase(),i=r+"_"+a+"_START",s=r+"_"+a+"_SUCCESS",o=r+"_"+a+"_ERROR",l=n+"Start",d=n+"Success",u=n+"Error";t[i]=i,t[s]=s,t[o]=o,c.addAlias&&(t[l]=i,t[d]=s,t[u]=o)}var xt=function(e,t){if(null==e)throw new Error("Expected resource");if(null==(t=t||{}).addAlias&&(t.addAlias=!0),""==(e=Ot(e)))throw new Error("Expected resource");var n={};return ht(e,n,"get",t),ht(e,n,"fetch",t),ht(e,n,"create",t),ht(e,n,"update",t),ht(e,n,"delete",t),n},vt=c(117);function pt(e,t){return e.resourceName+"."+t}var ft=function(e,t,n){var c=pt(e,t);if(vt(Array,n))throw new TypeError(c+": Expected record not to be an array")};var gt=function(e,t){if(null==e)throw new Error("actionCreatorsFor: Expected resourceName");t=t||function(e){return{key:"id",resourceName:e}}(e),t=jt()(t,{resourceName:e});var n=xt(e);function c(e,t){bt(null!=t,"Expected error in "+e)}function r(e,n){bt(null!=n,"Expected record in "+e),ft(t,"createStart",n)}return{getStart:function(e){return{data:e,type:n.getStart}},getSuccess:function(e,t){return bt(null!=e,"Expected record in getSuccess"),{data:t,records:e,type:n.getSuccess}},getError:function(e,t){return c("getError",e),{data:t,error:e,type:n.getError}},fetchStart:function(e){return{data:e,type:n.fetchStart}},fetchSuccess:function(e,t){return function(e,t){bt(null!=t,"Expected records "+e)}("fetchSuccess",e),{data:t,records:e,type:n.fetchSuccess}},fetchError:function(e,t){return c("fetchError",e),{data:t,error:e,type:n.fetchError}},createStart:function(e,t){return r("createStart",e),{data:t,record:e,type:n.createStart}},createSuccess:function(e,t,c){return r("createSuccess",e),{cid:t,data:c,record:e,type:n.createSuccess}},createError:function(e,t,a){var i="createError";return c(i,e),r(i,t),{data:a,error:e,record:t,type:n.createError}},updateStart:function(e,t){return r("updateStart",e),{data:t,record:e,type:n.updateStart}},updateSuccess:function(e,t){return r("updateSuccess",e),{data:t,record:e,type:n.updateSuccess}},updateError:function(e,t,a){var i="updateError";return c(i,e),r(i,t),{data:a,error:e,record:t,type:n.updateError}},deleteStart:function(e,t){return r("deleteStart",e),{data:t,record:e,type:n.deleteStart}},deleteSuccess:function(e,t){return r("deleteSuccess",e),{data:t,record:e,type:n.deleteSuccess}},deleteError:function(e,t,a){var i="deleteError";return c(i,e),r(i,t),{data:a,error:e,record:t,type:n.deleteError}}}},yt={DEFAULT_KEY:"id",STORE_LIST:"STORE_LIST",STORE_MAP:"STORE_MAP",REDUCER_NAMES:{CREATE_ERROR:"createError",CREATE_START:"createStart",CREATE_SUCCESS:"createSuccess",DELETE_ERROR:"deleteError",DELETE_START:"deleteStart",DELETE_SUCCESS:"deleteSuccess",FETCH_SUCCESS:"fetchSuccess",GET_SUCCESS:"getSuccess",UPDATE_ERROR:"updateError",UPDATE_START:"updateStart",UPDATE_SUCCESS:"updateSuccess"},SPECIAL_KEYS:{BUSY:"busy",CLIENT_GENERATED_ID:"_cid",DELETED:"deleted",PENDING_CREATE:"pendingCreate",PENDING_UPDATE:"pendingUpdate"}};var Nt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,c=arguments.length>3?arguments[3]:void 0;if(null==e)throw new Error("reducersFor: Expected resourceName");var r={key:yt.DEFAULT_KEY,resourceName:e},a=ut(r,t);return function(t,r){if(t=t||n,null==r)throw new Error(e+" reducers: Expected action");var i=xt(e),s=r.record;switch(r.type){case i.fetchSuccess:return c.fetchSuccess(a,t,r.records,n,r.data&&r.data.replace);case i.getSuccess:return c.getSuccess(a,t,r.records,n,r.data&&r.data.replace);case i.createStart:return c.createStart(a,t,s);case i.createSuccess:return c.createSuccess(a,t,s,r.cid);case i.createError:return c.createError(a,t,s);case i.updateStart:return c.updateStart(a,t,s);case i.updateSuccess:return c.updateSuccess(a,t,s);case i.updateError:return c.updateError(a,t,s);case i.deleteStart:return c.deleteStart(a,t,s);case i.deleteSuccess:return c.deleteSuccess(a,t,s);case i.deleteError:return c.deleteError(a,t,s);default:return t}}};function Ct(e,t){var n=t.config;if(!n.resourceName)throw new Error("Expected config.resourceName");var c=pt(n,e.reducerName);if(!n.key)throw new Error(c+": Expected config.key");if(!t.record)throw new Error(c+": Expected record/s");t.assertValidStore(c,t.current),e.canBeArray||ft(t.config,e.reducerName,t.record)}var St=c(142);function qt(e,t,n){var c=e.key;return St((function(e){var t=e[c];return n[c]===t}),t)}function wt(e){return vt(Array,e)?e:[e]}var Et={assert:function(e,t){if(!vt(Array,t))throw new Error(e+": Expected current to be an array")},remove:qt,merge:function(e,t,n){t=wt(t);var c={},r={},a=e.slice(0);return e.forEach((function(e,t){var a=e[n];if(null==a)throw new Error("Expected record to have "+n);c[a]=e,r[a]=t})),t.forEach((function(e){var t=e[n];c[t]?a[r[t]]=e:(r[t]=a.length,a.push(e)),c[t]=e})),a}};function At(e,t,n,c){Ct(e,{assertValidStore:Et.assert,config:t,current:n,record:c})}var Dt={reducerName:yt.REDUCER_NAMES.CREATE_ERROR,canBeArray:!1};function Pt(e){var t,n=(t={},Object(g.a)(t,yt.SPECIAL_KEYS.BUSY,!0),Object(g.a)(t,yt.SPECIAL_KEYS.PENDING_CREATE,!0),t);return ut(e,n)}var Vt={reducerName:yt.REDUCER_NAMES.CREATE_START,canBeArray:!1};var Ft={reducerName:yt.REDUCER_NAMES.CREATE_SUCCESS,canBeArray:!1};var Rt=c(201),Tt=c(428);function Mt(e,t,n){return Tt((function(e){return e[t]===n}),e)}var Bt={reducerName:yt.REDUCER_NAMES.DELETE_ERROR,canBeArray:!1};function kt(e){var t,n=(t={},Object(g.a)(t,yt.SPECIAL_KEYS.DELETED,!0),Object(g.a)(t,yt.SPECIAL_KEYS.BUSY,!0),t);return ut(e,n)}var _t={reducerName:yt.REDUCER_NAMES.DELETE_START,canBeArray:!1};var It={reducerName:yt.REDUCER_NAMES.DELETE_SUCCESS,canBeArray:!1};var Lt=c(429),Qt=c(430),Ht=function(e,t,n){var c=Lt(e.key);if(!Qt(c,n))throw new Error(t+": Expected all records to have a value for the store's key `"+e.key+"`")},Ut=yt.REDUCER_NAMES.FETCH_SUCCESS,Yt={reducerName:Ut,canBeArray:!0};var Kt={reducerName:yt.REDUCER_NAMES.GET_SUCCESS,canBeArray:!0};var zt=c(222);function Wt(e){return zt(yt.SPECIAL_KEYS.BUSY,e)}var Gt={reducerName:yt.REDUCER_NAMES.UPDATE_ERROR,canBeArray:!1};function Xt(e){var t,n=(t={},Object(g.a)(t,yt.SPECIAL_KEYS.BUSY,!0),Object(g.a)(t,yt.SPECIAL_KEYS.PENDING_UPDATE,!0),t);return ut(e,n)}var Jt={reducerName:yt.REDUCER_NAMES.UPDATE_START,canBeArray:!1};var $t={reducerName:yt.REDUCER_NAMES.UPDATE_SUCCESS,canBeArray:!1};var Zt={createError:function(e,t,n){return At(Dt,e,t,n),qt(e,t,n)},createStart:function(e,t,n){return At(Vt,e,t,n),Pt(n),t},createSuccess:function(e,t,n,c){At(Ft,e,t,n);var r=e.key,a=!1,i=t.map((function(e){var t=e[r];if(null==t)throw new Error("Expected record to have "+r);return t===n[r]||null!=c&&c===t?(a=!0,n):e}));return a||(i=i.concat([n])),i},deleteError:function(e,t,n){At(Bt,e,t,n);var c=e.key,r=Mt(t,c,n[c]);return r=Rt(["deleted","busy"],r),Et.merge(t,r,c)},deleteStart:function(e,t,n){At(_t,e,t,n);var c=e.key,r=Mt(t,c,n[c]);return r=kt(r),Et.merge(t,r,c)},deleteSuccess:function(e,t,n){At(It,e,t,n);var c=e.key,r=n[c];return St((function(e){return r==e[c]}),t)},fetchSuccess:function(e,t,n,c){var r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return At(Yt,e,t,n),n=wt(n),Ht(e,Ut,n),Et.merge(r?c:t,n,e.key)},updateError:function(e,t,n){At(Gt,e,t,n);var c=e.key,r=Mt(t,c,n[c]);return null==r?t:(r=Wt(r),Et.merge(t,r,c))},updateStart:function(e,t,n){At(Jt,e,t,n);var c=[Xt(n)];return Et.merge(t,c,e.key)},updateSuccess:function(e,t,n){return At($t,e,t,n),Et.merge(t,n,e.key)},getSuccess:function(e,t,n,c){return At(Kt,e,t,n),n=wt(n)}};var en={reducersFor:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,c=ut(Zt,n);return Nt(e,t,[],c)}};var tn={assert:function(e,t){if(!vt(Object,t))throw new Error(e+": Expected current to be an object")},merge:function(e,t,n){var c=n[e.key];return ut(t,Object(g.a)({},c,n))},remove:function(e,t,n){var c=n[e.key];return Rt([c],t)}};function nn(e,t,n,c){Ct(e,{assertValidStore:tn.assert,config:t,current:n,record:c})}var cn={reducerName:yt.REDUCER_NAMES.CREATE_ERROR,canBeArray:!1};var rn={reducerName:yt.REDUCER_NAMES.CREATE_START,canBeArray:!1};var an=c(431),sn=c(432),on={reducerName:yt.REDUCER_NAMES.CREATE_SUCCESS,canBeArray:!1};var ln={reducerName:yt.REDUCER_NAMES.DELETE_ERROR,canBeArray:!1};var dn={reducerName:yt.REDUCER_NAMES.DELETE_START,canBeArray:!1};var un={reducerName:yt.REDUCER_NAMES.DELETE_SUCCESS,canBeArray:!1};var jn=c(324),bn=c(221),mn={reducerName:yt.REDUCER_NAMES.GET_SUCCESS,canBeArray:!0};var On=yt.REDUCER_NAMES.FETCH_SUCCESS,hn={reducerName:On,canBeArray:!0};var xn={reducerName:yt.REDUCER_NAMES.UPDATE_ERROR,canBeArray:!1};var vn={reducerName:yt.REDUCER_NAMES.UPDATE_START,canBeArray:!1};var pn={reducerName:yt.REDUCER_NAMES.UPDATE_SUCCESS,canBeArray:!1};var fn={createError:function(e,t,n){return nn(cn,e,t,n),tn.remove(e,t,n)},createStart:function(e,t,n){return nn(rn,e,t,n),Pt(n),t},createSuccess:function(e,t,n,c){nn(on,e,t,n);var r=n[e.key],a=an(r),i=zt(c,t);return sn(a,n,i)},deleteError:function(e,t,n){nn(ln,e,t,n);var c=n[e.key],r=t[c];return null==r?t:(r=Rt(["deleted","busy"],r),ut(t,Object(g.a)({},c,r)))},deleteStart:function(e,t,n){nn(dn,e,t,n);var c=t[n[e.key]];return null==c?t:(c=kt(c),tn.merge(e,t,c))},deleteSuccess:function(e,t,n){nn(un,e,t,n);var c=e.key,r=n[c];return St((function(e){return r==e[c]}),t)},fetchSuccess:function(e,t,n,c){var r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];nn(hn,e,t,n),n=wt(n),Ht(e,On,n);var a=jn(bn(e.key),n);return ut(r?c:t,a)},getSuccess:function(e,t,n,c){return nn(mn,e,t,n),n=wt(n)},updateError:function(e,t,n){nn(xn,e,t,n);var c=t[n[e.key]];return null==c?t:(c=Wt(c),tn.merge(e,t,c))},updateStart:function(e,t,n){nn(vn,e,t,n);var c=Xt(n);return tn.merge(e,t,c)},updateSuccess:function(e,t,n){return nn(pn,e,t,n),tn.merge(e,t,n)}};var gn={reducersFor:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,c=ut(fn,n);return Nt(e,t,{},c)}},yn={actionCreatorsFor:gt,actionTypesFor:xt,constants:yt,List:en,Map:gn},Nn=c(164),Cn=c.n(Nn),Sn=c(618),qn=c(37),wn=c.n(qn),En=c(184),An=(Object(b.a)(),Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).API_URL,function(){return{Accept:"application/json","Content-Type":"application/json; charset=UTF-8","x-access-token":localStorage.getItem("user-veto")}}),Dn={code:"INTERNAL_ERROR",message:"Quelque chose s'est mal pass\xe9. Veuillez v\xe9rifier votre connexion Internet ou contacter notre support.",status:503,data:{}},Pn=O.a;Pn.interceptors.response.use((function(e){return wn.a.isUndefined(e)?[]:e}),(function(e){e.response.status}));var Vn=function(e,t,n,c){var r=new Promise((function(n,r){var a=c;Pn({url:"".concat(t),method:e,headers:An(),params:"get"==e?c:void 0,data:"get"!==e?a:void 0}).then((function(e){console.log("response"),wn.a.isUndefined(e)?n([]):n(e.data)}),(function(e){var t,n,c,a,i;if(console.log("error"),null===e||void 0===e?void 0:e.response){if(null===e||void 0===e||null===(t=e.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.error)r(null===e||void 0===e||null===(a=e.response)||void 0===a||null===(i=a.data)||void 0===i?void 0:i.error);else if(null===e||void 0===e||null===(c=e.response.data)||void 0===c?void 0:c.errors){var s;r(null===e||void 0===e||null===(s=e.response.data)||void 0===s?void 0:s.errors)}}else r(Dn)}))}),5e3);return En.b.promise(r,{error:"Une erreur s'est produite... \ud83e\udd2f"}),r},Fn=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Vn.apply(void 0,["get"].concat(t))},Rn=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Vn.apply(void 0,["post"].concat(t))},Tn=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Vn.apply(void 0,["put"].concat(t))},Mn=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Vn.apply(void 0,["delete"].concat(t))},Bn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t?e[t]||e[Object(Sn.singular)(t)]:e;return Cn.a.camelizeKeys(n)},kn=function(e,t,n,c,r){return Object(dt.a)(Object(dt.a)({},e),{},{records:(a=e.records,Object(qn.isArray)(a)?a:[a]),receivedAt:new Date,success:r||"",totalItems:t,totalPages:n,currentPage:c});var a},_n=function(e){return Object(dt.a)(Object(dt.a)({},e),{},{records:e.records,receivedAt:new Date})},In=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=arguments.length>4?arguments[4]:void 0,a=arguments.length>5?arguments[5]:void 0;return function(i){var s=yn.actionCreatorsFor(e),o=n.path||Cn.a.decamelize(e),l=n.replace?{replace:n.replace}:void 0,d=n.url||Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).API_URL||"http://localhost:8100/api";return i(s.getStart()),Fn("".concat(d,"/").concat(o,"/").concat(t),!1,c,n).then((function(e){i(_n(s.getSuccess(Bn(e),l))),r&&r(Bn(e))})).catch((function(e){e.response?(a&&a(e.response),i(s.getError(null===e||void 0===e?void 0:e.response.data.error))):(a&&a(e),i(s.getError(e)))}))}},Ln=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},c=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0;return function(a){var i=yn.actionCreatorsFor(e),s=t.path||Cn.a.decamelize(e),o=t.replace?{replace:t.replace}:void 0,l=t.url||Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).API_URL||"http://localhost:8100/api";return a(i.fetchStart()),Fn("".concat(l,"/").concat(s),!1,n,t).then((function(e){if(e.hasOwnProperty("data")){var t=e.data;a(kn(i.fetchSuccess(Bn(t,"rows"),o),t.totalItems,t.totalPages,t.currentPage)),c&&c(Bn(t,"rows"))}else e.hasOwnProperty("rows")?(a(kn(i.fetchSuccess(Bn(e,"rows"),o),e.totalItems,e.totalPages,e.currentPage)),c&&c(Bn(e,"rows"))):(a(kn(i.fetchSuccess(Bn(e),o),null,null,null)),c&&c(Bn(e)))})).catch((function(e){e.response?(r&&r(e.response),a(i.fetchError(null===e||void 0===e?void 0:e.response.data.error))):(r&&r(e),a(i.fetchError(e))),console.log(e)}))}},Qn=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{hasFile:!1},c=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0;return function(a){var i=yn.actionCreatorsFor(e),s=n.path||Cn.a.decamelize(e),o=n.url||Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).API_URL||"http://localhost:8100/api";return a(i.createStart(t)),Rn("".concat(o,"/").concat(s),n.hasFile,t,{replace:!0}).then((function(e){a(i.createSuccess(t,e.id,e)),c&&c(t)})).catch((function(e){var n,c;e?(a(i.createError(e,t)),r&&r(e)):e.message?(a(i.createError(e,t)),r&&r(e.message)):(null===e||void 0===e||null===(n=e.response)||void 0===n||null===(c=n.data)||void 0===c?void 0:c.message)&&(r&&r(null===e||void 0===e?void 0:e.response.data.message),a(i.createError(null===e||void 0===e?void 0:e.response.data.message,t)))}))}},Hn=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{hasFile:!1},c=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0;return function(a){var i=yn.actionCreatorsFor(e),s=n.path||[Cn.a.decamelize(e),t.id].join("/"),o=n.url||Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).API_URL||"http://localhost:8100/api";return a(i.updateStart(t)),Tn("".concat(o,"/").concat(s),n.hasFile,t,n).then((function(e){a(i.updateSuccess(t,t.id,{receivedAt:new Date})),c&&c(t)})).catch((function(e){var n,c;e?(a(i.updateError(e,t)),r&&r(e)):e.message?(a(i.updateError(e,t)),r&&r(e.message)):(null===e||void 0===e||null===(n=e.response)||void 0===n||null===(c=n.data)||void 0===c?void 0:c.message)&&(a(i.updateError(null===e||void 0===e?void 0:e.response.data.message,t)),r&&r(null===e||void 0===e?void 0:e.response.data.message))}))}},Un=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},c=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0;return function(a){var i=yn.actionCreatorsFor(e),s=n.path||[Cn.a.decamelize(e),t.id].join("/"),o=n.url||Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).API_URL||"http://localhost:8100/api";return a(i.deleteStart(t)),Mn("".concat(o,"/").concat(s),!1,t,n).then((function(){a(i.deleteSuccess(t,{receivedAt:new Date})),c&&c(t)})).catch((function(e){a(i.deleteError(e,t)),r&&r(e)}))}},Yn=c(131),Kn={isFetching:!1,lastUpdatedAt:null,error:null,success:null},zn=function(e){var t=yn.actionTypesFor(e);return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Kn,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case t.createStart:return{isLoading:!0,error:null,success:"",data:n.data};case t.createError:return{isLoading:!1,error:n.error,success:n.success,data:n.data};case t.createSuccess:return Object(dt.a)(Object(dt.a)({},n.payload),{},{isLoading:!1,error:null,success:n.success,lastUpdatedAt:n.receivedAt,data:n.data});case t.createFailed:return Object(dt.a)(Object(dt.a)({},n.payload),{},{isLoading:!1,error:n.error,success:"",data:n.data});case t.updateStart:return Object(dt.a)(Object(dt.a)({},e),{},{isLoading:!0,error:null,success:"",data:n.data});case t.updateError:return{isLoading:!1,error:n.error,success:"",data:n.data};case t.updateSuccess:return Object(dt.a)(Object(dt.a)({},e),{},{isLoading:!1,error:null,success:n.success,lastUpdatedAt:n.receivedAt,data:n.data});case t.updateFailed:return Object(dt.a)(Object(dt.a)({},e),{},{isLoading:!1,error:n.error,success:n.success,data:n.data});case t.destroyStart:return Object(dt.a)(Object(dt.a)({},e),{},{isLoading:!0,error:null,success:"",data:n.data});case t.destroySuccess:return Object(dt.a)(Object(dt.a)({},e),{},{isLoading:!1,error:null,success:n.success,lastUpdatedAt:n.receivedAt,data:n.data});case t.deleteError:return{isLoading:!1,error:n.error,success:"",data:n.data};case t.destroyFailed:return Object(dt.a)(Object(dt.a)({},e),{},{isLoading:!1,error:n.error,success:"",data:n.data});case t.getStart:return Object(dt.a)(Object(dt.a)({},e),{},{isLoading:!0,didInvalidate:!1,isFetching:!0,error:null,success:"",data:n.data});case t.getSuccess:return Object(dt.a)(Object(dt.a)({},e),{},{isFetching:!1});case t.getError:return Object(dt.a)(Object(dt.a)({},e),{},{isFetching:!1,error:n.error});case t.fetchStart:return Object(dt.a)(Object(dt.a)({},e),{},{isFetching:!0,error:null,success:"",data:n.data});case t.fetchSuccess:return Object(dt.a)(Object(dt.a)({},e),{},{isFetching:!1,success:n.success,totalPages:n.totalPages,totalItems:n.totalItems,currentPage:n.currentPage,lastUpdatedAt:n.receivedAt,error:null,data:n.data});case t.fetchError:return Object(dt.a)(Object(dt.a)({},e),{},{isFetching:!1,isLoading:!1,error:n.error,data:n.data});default:return Object(dt.a)({},e)}}},Wn=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=arguments.length>1?arguments[1]:void 0;return yn.Map.reducersFor(e,t)(n,c)}},Gn=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(Yn.b)({items:Wn(e,t),meta:zn(e,t)})};function Xn(e,t){return{get:function(t){return In(e,t,{replace:!0})},getWithPath:function(t,n){return In(e,t,{path:n,replace:!0})},getNoParams:function(t){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},c=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0;return function(a){var i=yn.actionCreatorsFor(e),s=t.path||Cn.a.decamelize(e),o=t.replace?{replace:t.replace}:void 0,l=t.url||Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).API_URL||"http://localhost:8100/api";return a(i.getStart()),Fn("".concat(l,"/").concat(s),!1,n,t).then((function(e){a(_n(i.getSuccess(Bn(e),o))),c&&c(Bn(e))})).catch((function(e){e.response?(r&&r(e.response),a(i.getError(null===e||void 0===e?void 0:e.response.data.error))):(r&&r(e),a(i.getError(e)))}))}}(e,{path:t,replace:!0})},create:function(t,n){return Qn(e,t,n)},update:function(t,n){return Hn(e,t,n)},destroy:function(t,n){return Un(e,t,n)},fetch:function(t,n){return Ln(e,t,n)},setItems:function(t){return function(e,t){return function(n){var c=yn.actionCreatorsFor(e);n(kn(c.fetchSuccess(Bn(t),{replace:!0}),null,null,null))}}(e,t)},createTransaction:function(t,n){return Qn(e,t,{path:n})},updateData:function(t,n){return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{hasFile:!1};return function(c){var r=yn.actionCreatorsFor(e),a=n.path||Cn.a.decamelize(e),i=n.url||Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).API_URL||"http://localhost:8100/api";return c(r.createStart(t)),Rn("".concat(i,"/").concat(a),n.hasFile,t,{replace:!0})}}(e,t,{path:n})},updateTransaction:function(t,n){return Hn(e,t,{path:n})},deleteTransaction:function(t,n){return Un(e,t,{path:n})}}}function Jn(e){return{value:function(t){return t[e].items?Object(qn.values)(t[e].items):[]},item:function(t){return t[e].items?t[e].items:[]},meta:function(t){return t[e].meta}}}var $n=function(e,t,n){return Ln("commandes",{path:"/get-tdb-commande?type=".concat(e,"&deb=").concat(t,"&fin=").concat(n),replace:!0})},Zn=function(e,t,n,c){return Ln("commandes",{path:"/get-cmd-by-products?type=".concat(e,"&deb=").concat(t,"&fin=").concat(n,"&id=").concat(c),replace:!0})},ec=function(e,t,n){return Ln("commandes",{path:"/vente-cva?deb=".concat(e,"&fin=").concat(t,"&type=").concat(n),replace:!0})},tc=function(){return Object(w.jsx)("td",{className:"text-center p-1",children:Object(w.jsxs)("div",{children:[Object(w.jsx)("span",{className:"text-center  p-1",children:"-"}),Object(w.jsx)("span",{className:"text-center  p-1",children:"-"})]})})},nc=function(){var e=Object(j.h)(),t=function(t){return e.pathname==t};return Object(w.jsxs)("div",{className:"d-flex justify-content-center align-items-center",children:[Object(w.jsx)(u.b,{className:"btn btn-".concat(t("/")?"success":"default"," text-uppercase mr-2"),to:"/",children:"Journal Vente du magasin"}),Object(w.jsx)(u.b,{className:"btn btn-".concat(t(ae)?"success":"default"," text-uppercase mr-2"),to:ae,children:"Journal de facturation"}),Object(w.jsx)(u.b,{className:"btn btn-".concat(t(re)?"success":"default"," text-uppercase mr-2"),to:re,children:"Journal de Vente CBV"}),Object(w.jsx)(u.b,{className:"btn btn-".concat(t(ce)?"success":"default"," text-uppercase mr-2"),to:ce,children:"Journal de Depot vers magasin"})]})};var cc=function(){var e=Qe()().isoWeekday(1).startOf("week"),t=Qe()().endOf("week"),n=Object(a.useState)([]),c=Object(f.a)(n,2),r=c[0],i=c[1],s=Object(a.useState)([]),o=Object(f.a)(s,2),l=(o[0],o[1]),d=Object(a.useState)(e),u=Object(f.a)(d,2),j=u[0],b=u[1],m=Object(a.useState)(t),O=Object(f.a)(m,2),h=O[0],x=O[1],v=Object(a.useState)([e,t]),p=Object(f.a)(v,2),g=p[0],y=p[1],N=Object(a.useState)([]),C=Object(f.a)(N,2),S=C[0],q=C[1],E=Object(a.useState)([]),A=Object(f.a)(E,2),D=(A[0],A[1],Object(P.useSelector)(Jn("commandes").value)),V=Object(P.useSelector)(Jn("commandes").meta),F=Object(P.useDispatch)();Object(a.useEffect)((function(){null!==g?(g[0]&&b(g[0]),g[0]&&x(g[1])):(b(e),x(t))}),[g]),Object(a.useEffect)((function(){j&&h&&(i(function(e,t){for(var n=e.clone(),c=[];n.isSameOrBefore(t);)c.push(n.format("YYYY-MM-DD")),n.add(1,"days");return c}(Qe()(j),Qe()(h))),l(function(e,t){for(var n=[];t.diff(e,"months")>=0;)n.push(e.format("MMMM YYYY")),e.add(1,"month");return n}(Qe()(j),Qe()(h))),F($n("vente-cva",j,h)))}),[j,h]),Object(a.useEffect)((function(){V.isFetching||q(ot(D,"dateCom",j,h))}),[V]);var R,T,M=lt(S,"contenu").reduce((function(e,t){var n=t.id,c=t.name,r=t.type,a=t.category,i=t.fournisseur,s=t.quantityParProduct,o=t.quantityBruteCVA,l=t.quantityCCCVA,d=t.qttByCC,u=t.qttbylitre,j=e.find((function(e){return e.id===n}));return j?(j.quantityParProduct=parseInt(j.quantityParProduct)+parseInt(s),j.qttByCC=parseInt(j.qttByCC)+parseInt(d),j.qttbylitre=parseInt(j.qttbylitre)+parseInt(u)):e.push({id:n,name:c,type:r,category:a,fournisseur:i,quantityBruteCVA:o,quantityCCCVA:l,quantityParProduct:s,qttByCC:d,qttbylitre:u}),e}),[]).sort((function(e,t){return e.id>t.id})),B=function(e,t){var n;return Object(Ie.a)(new Set((n=[]).concat.apply(n,Object(Ie.a)(e.map((function(e){return e[t]}))))))},k=(R="dateCom",S.reduce((function(e,t){return T?(e[t[R][T]]=e[t[R][T]]||[]).push(t):(e[t[R]]=e[t[R]]||[]).push(t),e}),{}));return Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)(Xe,{children:[Object(w.jsx)(Ke,{title:"Journal de vente du magasin",children:Object(w.jsx)(We,{title:"Journal de vente du magasin"})}),Object(w.jsxs)($e,{children:[Object(w.jsx)(nc,{}),Object(w.jsxs)("div",{className:"date-range",children:[Object(w.jsxs)("div",{className:"d-flex justify-content-between my-3",children:[Object(w.jsxs)("div",{children:[j&&h&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsxs)("h2",{class:"text-uppercase my-1",children:["Journal de vente du magasin"," "]}),Object(w.jsxs)("span",{children:["Du: ",nt(j)," Au ",nt(h)]})]})," "]}),Object(w.jsx)("div",{children:Object(w.jsx)(et.a,{locale:"fr-FR",onChange:y,value:g})})]}),Object(w.jsxs)("div",{className:"bg-white py-3 px-2 mb-2",children:[Object(w.jsxs)("div",{children:[Object(w.jsx)("span",{className:"bg-secondary px-2",style:{width:5,height:5}}),Object(w.jsx)("span",{className:" ml-2",children:": Quantit\xe9 de commande en litre (special pour les PHYTO)"})]}),Object(w.jsxs)("div",{children:[Object(w.jsx)("span",{className:"bg-primary px-2",style:{width:5,height:5}}),Object(w.jsx)("span",{className:" ml-2",children:": Quantit\xe9 de commande en (FLACON,BOLUS,UNITE,SACHET)"})]}),Object(w.jsxs)("div",{children:[Object(w.jsx)("span",{className:"bg-warning px-2",style:{width:5,height:5}}),Object(w.jsx)("span",{className:" ml-2",children:": Quantit\xe9 de vente en ML"})]})]}),Object(w.jsx)("div",{className:"table-responsive",children:Object(w.jsxs)("table",{class:"table",children:[Object(w.jsxs)("tr",{className:"sticky-this",children:[Object(w.jsx)("td",{children:"Produit"}),r.map((function(e){return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(it,{date:e})})})),Object(w.jsx)("td",{className:"bg-thead text-uppercase text-center",children:"Total"}),Object(w.jsx)("td",{className:"bg-thead text-uppercase text-center",children:"Total ML"})]}),M.map((function(e){return Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)("tr",{class:"bg-white",children:[Object(w.jsx)("td",{className:"bg-thead",children:e.name}),r.map((function(t){return Object(w.jsx)(w.Fragment,{children:void 0!=k[t]?Object(w.jsx)(st,{flat:B(k[t],"contenu"),gr:t,quantityb:e.quantityBruteCVA,quantityc:e.quantityCCCVA,quantitycond:e.condval,id:e.id}):Object(w.jsx)(tc,{})})})),Object(w.jsx)("td",{className:"text-center",children:e.quantityParProduct}),Object(w.jsx)("td",{className:"text-center",children:e.qttByCC})]})})})),0==M.length&&Object(w.jsx)("tr",{children:Object(w.jsx)("td",{className:"text-center",colSpan:r.length+3,children:"Aucune enregistrement trouv\xe9"})})]})})]})]})]})})},rc=function(e){var t=e.product,n=Object(a.useState)(!1),c=Object(f.a)(n,2),r=c[0],i=c[1],s=Object(P.useSelector)(Jn("commandes").meta),o=Object(P.useDispatch)(),l=Object(a.useState)(1),d=Object(f.a)(l,2),u=d[0],j=d[1];Object(a.useEffect)((function(){o(Xn("commandes").fetch())}),[]);return Object(w.jsxs)("tr",{className:"product-card ".concat(t.id?"":"product-loading"),style:{border:t&&r?"1px solid #a6a5a5":"",boxShadow:t&&r?"0 10px 15px rgba(0, 0, 0, .07)":"none"},children:[Object(w.jsx)("td",{children:t.name}),Object(w.jsx)("td",{children:t.quantityBrute+u}),Object(w.jsx)("td",{className:"d-flex justify-content-center align-items-center",children:Object(w.jsxs)("div",{class:"input-group inline-group",children:[Object(w.jsx)("div",{class:"input-group-prepend",children:Object(w.jsx)("button",{class:"btn btn-sm btn-dark btn-minus",onClick:function(){u>0&&j(u-1)},children:"-"})}),Object(w.jsx)("input",{class:"form-control quantity text-center  p-0",min:"0",name:"quantity",value:u,type:"number"}),Object(w.jsx)("div",{class:"input-group-append",children:Object(w.jsx)("button",{class:"btn btn-sm btn-dark btn-plus mr-2",onClick:function(){return j(u+1)},children:"+"})}),Object(w.jsx)("div",{class:"input-group-append ml-2"})]})}),Object(w.jsx)("td",{children:t.id&&Object(w.jsx)("button",{className:"btn btn-success  btn-sm",onClick:function(){o(function(e,t,n){return function(){var c=Object(Q.a)(L.a.mark((function c(r){var a;return L.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,c.next=3,O.a.post("http://localhost:8100/api/update-product",{productId:e,newStockBrute:t,newStockCC:n});case 3:a=c.sent,r({type:W,payload:a.data}),c.next=10;break;case 7:c.prev=7,c.t0=c.catch(0),r({type:G,payload:c.t0});case 10:case"end":return c.stop()}}),c,null,[[0,7]])})));return function(e){return c.apply(this,arguments)}}()}(t.id,u,0)),o(Xn("commandes").create({id:s.nextId,contenu:[t],type:"approv",sorte:"entree",vaccinateurId:null,qtteBrute:u,qtteCC:0,status:!0,emprunterId:null,dateCom:new Date})),i(!0)},children:"Modifier le stock"})})]})};function ac(){var e=Object(P.useSelector)(Jn("products").value),t=Object(P.useDispatch)();return Object(a.useEffect)((function(){t(Xn("products").fetch())}),[]),Object(w.jsxs)(Xe,{children:[Object(w.jsx)(Ke,{title:"Approvisionnement",children:Object(w.jsx)(We,{title:"Approvisionnement"})}),Object(w.jsx)($e,{children:Object(w.jsxs)("table",{className:"table table-bordered table-striped",children:[Object(w.jsx)("thead",{children:Object(w.jsxs)("tr",{className:"text-center",children:[Object(w.jsx)("th",{children:"Nom de l'article"}),Object(w.jsx)("th",{style:{width:"15%"},children:"Qte"}),Object(w.jsx)("th",{style:{width:"15%"},children:"Nouvel"}),Object(w.jsx)("th",{style:{width:"20%"},children:"Actions"})]})}),Object(w.jsx)("tbody",{children:e.map((function(e){return Object(w.jsx)(rc,{product:e})}))})]})})]})}var ic=c(208),sc=c(1328),oc=["icon","className","filter","setData","name","value","data","placeholder","changeValue","invalid"],lc=Object(a.forwardRef)((function(e,t){var n=e.icon,c=e.className,r=e.filter,s=(e.setData,e.name),o=e.value,l=e.data,d=void 0===l?0:l,u=e.placeholder,j=e.changeValue,b=e.invalid,m=(Object(tt.a)(e,oc),i.a.useCallback((function(e){r&&!r.test(e.target.value)||Object(qn.isFunction)(j)&&j(e.target.value,e)}),[s]));return Object(a.useEffect)((function(){d&&j(d)}),[d]),Object(w.jsxs)("div",{className:c,children:[n&&Object(w.jsx)("i",{className:"fa fa-".concat(n)}),Object(w.jsx)(sc.a,{bg:"gray.100",boxShadow:"sm",isInvalid:b,color:"gray.700",placeholder:u,ref:t,defaultValue:o,onBlur:m})]})})),dc=c(342),uc=c(1359),jc=c(1330),bc=["name","className","options","radioValue","valueKey","direction","filter","setData","changeValue","setRadio"],mc=Object(a.forwardRef)((function(e,t){e.name;var n=e.className,c=e.options,r=e.radioValue,s=e.valueKey,o=e.direction,l=(e.filter,e.setData),d=e.changeValue,u=e.setRadio,j=Object(tt.a)(e,bc),b=Object(a.useState)(r),m=Object(f.a)(b,2),O=m[0],h=m[1],x=i.a.useState("".concat(O)),v=Object(f.a)(x,2),p=v[0],g=v[1];return i.a.useLayoutEffect((function(){d(p),l&&(l(p),h(p))}),[p]),i.a.useLayoutEffect((function(){u&&u(O)}),[O]),Object(w.jsx)(dc.a,{onChange:g,defaultValue:"".concat(O),className:n,children:Object(w.jsx)(uc.b,{spacing:4,direction:o,children:c.map((function(e){return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(jc.a,Object(dt.a)(Object(dt.a)({name:"".concat(e.id),isChecked:e.id==O},j),{},{value:"".concat(e.id),ref:t,children:e[s]}))})}))})})})),Oc=c(1331),hc=c(338),xc=["name","className","invalid","options","selectValue","valueKey","filter","isNumeric","emptyValue","setData","changeValue"],vc=Object(a.forwardRef)((function(e,t){var n=e.name,c=e.className,r=e.invalid,a=e.options,i=e.selectValue,s=e.valueKey,o=e.filter,l=e.isNumeric,d=void 0===l||l,u=e.emptyValue,j=void 0===u||u,b=e.setData,m=e.changeValue,O=Object(tt.a)(e,xc);return Object(w.jsx)("div",{className:c,children:Object(w.jsxs)(Oc.a,Object(dt.a)(Object(dt.a)({},O),{},{bg:"gray.200",boxShadow:"sm",defaultValue:"".concat(i),isRequired:!0,name:n,isInvalid:r,onChange:function(e){o&&!o.test(e.target.value)||(Object(hc.a)(m)&&m(d?Number(e.target.value):e.target.value,e),b&&b(d?Number(e.target.value):e.target.value))},ref:t,children:[j&&Object(w.jsx)("option",{value:"",children:"Selectionner"}),null===a||void 0===a?void 0:a.map((function(e){return Object(w.jsx)("option",{defaultChecked:"".concat(i),value:"".concat(s?e.id:e),children:s?e[s]:e})}))]}))})})),pc=c(1332),fc=["icon","className","filter","setData","placeholder","changeValue","invalid"],gc=Object(a.forwardRef)((function(e,t){e.icon;var n=e.className,c=e.filter,r=e.setData,a=e.placeholder,i=e.changeValue,s=e.invalid,o=Object(tt.a)(e,fc);return Object(w.jsx)("div",{className:n,children:Object(w.jsx)(pc.a,Object(dt.a)(Object(dt.a)({bg:"gray.200",boxShadow:"sm",isInvalid:s,placeholder:a},o),{},{onChange:function(e){c&&!c.test(e.target.value)||(Object(hc.a)(i)&&i(e.target.value,e),r&&r(e.target.value))},ref:t}))})})),yc=c(234),Nc=c(1337),Cc=c(202),Sc=c(46),qc=c(1360),wc=c(1333),Ec=c(1336),Ac=c(624),Dc=c.n(Ac),Pc=(c(950),["icon","className","filter","setData","tags","options","changeValue","invalid"]),Vc=Object(a.forwardRef)((function(e,t){var n=e.icon,c=e.className,r=(e.filter,e.setData),i=e.tags,s=e.options,o=e.changeValue,l=(e.invalid,Object(tt.a)(e,Pc),Object(a.useState)(!1)),d=Object(f.a)(l,2),u=d[0],j=d[1],b=Object(a.useState)(i||[]),m=Object(f.a)(b,2),O=m[0],h=m[1],x=Object(a.useCallback)((function(e){h(O.filter((function(t,n){return n!==e}))),j(!0)}),[O]);Object(a.useLayoutEffect)((function(){u&&o(O),r&&r(O),j(!1)}),[u]);var v=Object(a.useCallback)((function(e){h([].concat(Object(Ie.a)(O),[e])),j(!0)}),[O]);return Object(w.jsxs)("div",{className:c,children:[n&&Object(w.jsx)("i",{className:"fa fa-".concat(n)}),Object(w.jsx)(Dc.a,{as:sc.a,ref:t,tags:O,suggestions:s,onDelete:x,onAddition:v})]})})),Fc=["icon","className","filter","setData","name","placeholder","changeValue","invalid"],Rc=Object(a.forwardRef)((function(e,t){var n=e.icon,c=e.className,r=e.filter,a=(e.setData,e.name),s=e.placeholder,o=e.changeValue,l=e.invalid,d=(Object(tt.a)(e,Fc),i.a.useCallback((function(e){r&&!r.test(e.target.value)||Object(qn.isFunction)(o)&&o(e.target.value,e)}),[a]));return Object(w.jsxs)("div",{className:c,children:[n&&Object(w.jsx)("i",{className:"fa fa-".concat(n)}),Object(w.jsx)(sc.a,{bg:"gray.100",type:"date",boxShadow:"sm",locale:"fr-FR",isInvalid:l,color:"gray.700",placeholder:s,ref:t,onBlur:d})]})})),Tc=["name","className","invalid","isFieldArray","options","selectValue","valueKey","filter","setData","objectKey","index","inArray","changeValue","model","debug","array"],Mc=Object(a.forwardRef)((function(e,t){var n=e.name,c=e.className,r=e.invalid,i=e.isFieldArray,s=void 0===i||i,o=e.options,l=e.selectValue,d=e.valueKey,u=e.filter,j=e.setData,b=(e.objectKey,e.index,e.inArray,e.changeValue),m=(e.model,e.debug,e.array,Object(tt.a)(e,Tc)),O=Object(a.useState)(l),h=Object(f.a)(O,2),x=(h[0],h[1]);return Object(w.jsx)("div",{className:c,children:Object(w.jsxs)(Oc.a,Object(dt.a)(Object(dt.a)({},m),{},{bg:"gray.200",boxShadow:"sm",defaultValue:"".concat(l),isRequired:!0,name:n,isInvalid:r,onChange:function(e){u&&!u.test(e.target.value)||(Object(hc.a)(b)&&s&&b(Number(e.target.value,e)),j&&j(Number(e.target.value)),x(Number(e.target.value)))},ref:t,children:[Object(w.jsx)("option",{value:"",children:"Selectionner"}),o.map((function(e){return Object(w.jsx)("option",{defaultChecked:"".concat(l),value:"".concat(e.id),children:d?e[d]:e})}))]}))})})),Bc=c(643),kc=["name","className","options","radioValue","valueKey","direction","inArray","filter","setData","changeValue","setRadio","masterKey","filtrable","callback"],_c=Object(a.forwardRef)((function(e,t){var n=e.name,c=e.className,r=e.options,s=e.radioValue,o=e.valueKey,l=e.direction,d=(e.inArray,e.filter,e.setData,e.changeValue),u=e.setRadio,j=e.masterKey,b=e.filtrable,m=e.callback,O=void 0===m?null:m,h=Object(tt.a)(e,kc),x=Object(a.useState)(s),v=Object(f.a)(x,2),p=v[0],g=(v[1],i.a.useState("".concat(p))),y=Object(f.a)(g,2),N=y[0],C=y[1],S=Object(P.useDispatch)();return i.a.useEffect((function(){d(j?r.find((function(e){return e[j].id==N})):r.find((function(e){return e.id==N})))}),[N]),i.a.useLayoutEffect((function(){u&&u(p)}),[p]),Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(dc.a,{onChange:C,name:n,defaultValue:"".concat(p),className:c,children:Object(w.jsx)(uc.b,{spacing:4,direction:l,children:r.map((function(e){return Object(w.jsx)(w.Fragment,{children:j?Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(jc.a,Object(dt.a)(Object(dt.a)({},h),{},{value:"".concat(e[j].id),ref:t,children:e[j][o]})),1==b&&Object(w.jsx)(Bc.a,{variant:"solid",onClick:function(){return S(O(e[j].id))},colorScheme:"yellow",size:"xs",children:"Annuler"})]}):Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(jc.a,Object(dt.a)(Object(dt.a)({},h),{},{value:"".concat(e.id),ref:t,children:e[o]})),1==b&&Object(w.jsx)(Bc.a,{variant:"solid",onClick:function(){return S(O(e.id))},colorScheme:"yellow",size:"xs",children:"Annuler"})]})})}))})})})})),Ic=c(623),Lc=c(621),Qc=["name","className","options","radioValue","valueKey","direction","inArray","filter","setData","changeValue","setRadio","filtrable"];function Hc(e){var t=Object(Ic.a)(e),n=t.getInputProps,c=t.getCheckboxProps,r=n(),a=c();return Object(w.jsxs)(wc.a,{as:"label",children:[Object(w.jsx)("input",Object(dt.a)({},r)),Object(w.jsx)(wc.a,Object(dt.a)(Object(dt.a)({},a),{},{cursor:"pointer",borderWidth:"1px",borderRadius:"md",boxShadow:"md",_checked:{bg:"teal.600",color:"white",borderColor:"teal.600"},_focus:{boxShadow:"outline"},px:5,py:3,children:e.children}))]})}var Uc=Object(a.forwardRef)((function(e,t){var n=e.name,c=(e.className,e.options),r=e.radioValue,s=(e.valueKey,e.direction,e.inArray,e.filter,e.setData),o=e.changeValue,l=e.setRadio,d=(e.filtrable,Object(tt.a)(e,Qc),Object(a.useState)(r)),u=Object(f.a)(d,2),j=u[0],b=u[1],m=i.a.useState("".concat(j)),O=Object(f.a)(m,2),h=O[0];O[1];i.a.useEffect((function(){o(c.find((function(e){return e.id==h}))),s&&(s(h),b(h))}),[h]),i.a.useLayoutEffect((function(){l&&l(j)}),[j]);var x=Object(Lc.a)({name:n,defaultValue:1,onChange:function(e){console.log("hiii",e)}}),v=x.getRootProps,p=x.getRadioProps,g=v();return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(uc.a,Object(dt.a)(Object(dt.a)({},g),{},{children:c.map((function(e){var t=e.id,n=p({id:t});return Object(w.jsx)(Hc,Object(dt.a)(Object(dt.a)({},n),{},{children:t}),t)}))}))})})),Yc=["icon","className","filter","setData","name","value","placeholder","changeValue","invalid"],Kc=Object(a.forwardRef)((function(e,t){var n=e.icon,c=e.className,r=e.filter,a=(e.setData,e.name),s=e.value,o=e.placeholder,l=e.changeValue,d=e.invalid,u=(Object(tt.a)(e,Yc),i.a.useCallback((function(e){r&&!r.test(e.target.value)||Object(qn.isFunction)(l)&&l(e.target.value,e)}),[a]));return Object(w.jsxs)("div",{className:c,children:[n&&Object(w.jsx)("i",{className:"fa fa-".concat(n)}),Object(w.jsx)(sc.a,{bg:"gray.100",boxShadow:"sm",type:"password",isInvalid:d,color:"gray.700",placeholder:o,ref:t,defaultValue:s,onBlur:u})]})})),zc=c(1356),Wc=["icon","className","filter","setData","name","value","label","placeholder","changeValue","invalid"],Gc=Object(a.forwardRef)((function(e,t){var n=e.icon,c=e.className,r=e.filter,a=(e.setData,e.name),s=e.value,o=e.label,l=(e.placeholder,e.changeValue),d=(e.invalid,Object(tt.a)(e,Wc),i.a.useCallback((function(e){r&&!r.test(e.target.value)||Object(qn.isFunction)(l)&&l(e.target.value,e)}),[a]));return Object(w.jsxs)("div",{className:c,children:[n&&Object(w.jsx)("i",{className:"fa fa-".concat(n)}),Object(w.jsx)(zc.a,{colorScheme:"teal",ref:t,defaultValue:s,onChange:d,name:a,defaultIsChecked:!0,children:o})]})})),Xc=c(1354),Jc=["icon","className","filter","setData","name","value","data","min","placeholder","changeValue","invalid"],$c=Object(a.forwardRef)((function(e,t){var n=e.icon,c=e.className,r=e.filter,s=(e.setData,e.name),o=e.value,l=e.data,d=void 0===l?0:l,u=e.min,j=void 0===u?0:u,b=(e.placeholder,e.changeValue),m=e.invalid,O=(Object(tt.a)(e,Jc),i.a.useCallback((function(e){r&&!r.test(e)||Object(qn.isFunction)(b)&&b(Number(e))}),[s]));return Object(a.useEffect)((function(){d&&b(Number(d))}),[d]),Object(w.jsxs)("div",{className:c,children:[n&&Object(w.jsx)("i",{className:"fa fa-".concat(n)}),Object(w.jsx)(Xc.c,{inputMode:"numeric",bg:"gray.100",boxShadow:"sm",color:"gray.700",isInvalid:m,name:s,ref:t,step:1,onChange:O,min:j,defaultValue:o,children:Object(w.jsx)(Xc.d,{})})]})})),Zc=["className","label","labelSize","labelWeight","tip","info","isBool","options","optional","error","name","half"],er=function(e){return function(t){t.className;var n=t.label,c=t.labelSize,r=void 0===c?"13px":c,i=t.labelWeight,s=void 0===i?"400":i,o=t.tip,l=t.info,d=t.isBool,u=void 0!==d&&d,j=t.options,b=t.optional,m=t.error,O=t.name,h=t.half,x=void 0!==h&&h,v=Object(tt.a)(t,Zc),p=Object(a.useState)(""),g=Object(f.a)(p,2),y=g[0],N=g[1];return Object(a.useEffect)((function(){N(n)}),[n]),Object(w.jsx)(wc.a,{style:{width:x?"50%":"100%"},children:Object(w.jsxs)(yc.a,{isInvalid:!!m,children:[Object(w.jsx)(Ec.a,{justifyContent:"flex-start",alignItems:"center",children:!u&&Object(w.jsx)(w.Fragment,{children:y&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(Nc.a,{fontSize:r,fontWeight:s,mb:1,mr:1,color:"muted.400",htmlFor:n,children:y}),o&&Object(w.jsx)(qc.a,{placement:"bottom-end",label:o,bg:"gray.800","aria-label":"Guide d'utilisation",children:Object(w.jsx)(Cc.b,{fontSize:"11px",color:"gray"})}),b&&Object(w.jsxs)(Sc.a.small,{color:"blue.700",children:["("," facultatif ",")"]})]})})}),Object(w.jsx)(e,Object(dt.a)({invalid:!!m,options:j,name:O,label:n},v)),l&&Object(w.jsx)(Sc.a.small,{my:4,color:"muted.500",fontStyle:"italic",fontWeight:"medium",children:l}),m&&Object(w.jsx)("p",{style:{color:"red"},children:m})]})})}},tr={Input:er(lc),Number:er($c),Radio:er(mc),Select:er(vc),Textarea:er(gc),Tag:er(Vc),SelectObject:er(Mc),RadioObject:er(_c),RadioProduct:er(Uc),Date:er(Rc),Password:er(Kc),Checkbox:er(Gc)},nr=["validate","validations","children"],cr=["name","validate"],rr=function(e){e.validate;var t=e.validations,n=(e.children,Object(tt.a)(e,nr));return Object(w.jsx)(ic.d,Object(dt.a)(Object(dt.a)({},n),{},{enableReinitialize:!0,validationSchema:t,validateOnChange:!1,validateOnBlur:!1}))};rr.Element=function(e){return Object(w.jsx)(ic.c,Object(dt.a)({noValidate:!0},e))},rr.Field=Object(qn.mapValues)(tr,(function(e){return function(t){var n=t.name,c=t.validate,r=Object(tt.a)(t,cr);return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(ic.a,{name:n,validate:c,children:function(t){var c=t.field,a=t.form,i=a.touched,s=a.errors,o=a.setFieldValue;return Object(w.jsx)(e,Object(dt.a)(Object(dt.a)(Object(dt.a)({},c),r),{},{name:n,mb:2,error:Object(qn.get)(i,n)&&Object(qn.get)(s,n),changeValue:function(e){return o(n,e)}}))}})})}})),rr.initialValues=function(e,t){return t((function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",c=Object(qn.get)(e,t);return void 0===c||null===c?n:c}))};var ar=rr,ir=function(){Object(j.i)().id;var e=Object(P.useSelector)(Jn("fournisseurs").value),t=Object(P.useSelector)(Jn("categories").value),n=(Object(P.useSelector)(Jn("products").meta),Object(P.useDispatch)());Object(j.g)();return Object(a.useEffect)((function(){n(Xn("fournisseurs").fetch()),n(Xn("categories").fetch()),n(Xn("products").fetch())}),[]),Object(w.jsxs)(Xe,{children:[Object(w.jsx)(Ke,{title:"Ajouter un produit",children:Object(w.jsx)(We,{title:"Ajouter un produit"})}),Object(w.jsx)($e,{children:Object(w.jsx)(ar,{id:"add-form-product",enableReinitialize:!0,initialValues:{},validations:{},onSubmit:function(e,t){console.log(e)},children:Object(w.jsx)(ar.Element,{children:Object(w.jsxs)("div",{className:"row",children:[Object(w.jsx)("div",{className:"col-lg-6",children:Object(w.jsxs)("div",{className:"card",children:[Object(w.jsx)("div",{className:"card-header bg-dark text-white",children:Object(w.jsx)("h5",{children:"Information g\xe9n\xe9rale"})}),Object(w.jsxs)("div",{className:"card-body",children:[Object(w.jsx)(ar.Field.Select,{name:"categoryId",label:"Categorie",valueKey:"name",options:t}),Object(w.jsx)(ar.Field.Select,{name:"fournisseurId",label:"Fournisseur",valueKey:"name",options:e}),Object(w.jsx)(ar.Field.Input,{name:"name",label:"D\xe9signation",placeholder:"D\xe9signation"}),Object(w.jsx)(ar.Field.Radio,{radioValue:"1",valueKey:"name",label:"Type d'article",name:"type",options:[{id:"BOLUS",name:"BOLUS"},{id:"FLACON",name:"FLACON"},{id:"UNITE",name:"UNITE"},{id:"SACHET",name:"SACHET"}],direction:"row"}),Object(w.jsx)(ar.Field.Input,{name:"prixFournisseur",label:"prix unitaire",placeholder:"prix unitaire"}),Object(w.jsx)(ar.Field.Input,{name:"quantity",label:"Quantit\xe9",placeholder:"Quantit\xe9"}),Object(w.jsx)(ar.Field.Input,{type:"date",name:"datePer",label:"date de peremption",placeholder:"date de peremption"})]})]})}),Object(w.jsxs)("div",{className:"col-lg-6",children:[Object(w.jsxs)("div",{className:"card",children:[Object(w.jsx)("div",{className:"card-header bg-dark text-white",children:Object(w.jsx)("h5",{children:"Vente"})}),Object(w.jsxs)("div",{className:"card-body",children:[Object(w.jsx)(ar.Field.Input,{name:"prixVente",label:"Prix de vente",placeholder:"prix de vente"}),Object(w.jsx)(ar.Field.Input,{name:"prixVaccinateur",label:"Prix du vaccinateur",placeholder:"prix du vaccinateur"}),Object(w.jsx)(ar.Field.Input,{name:"prixParCC",label:"Prix de Vente en ml",placeholder:"Prix de Vente en ml"})]})]}),Object(w.jsx)("button",{className:"btn btn-green  btn-sm ",type:"submit",children:"Ajouter"})]})]})})})})]})},sr=c(229),or=c(45),lr=c(1362),dr=function(){var e,t,n,c,r,a,s,o,l=Object(j.i)().id,d=Object(P.useDispatch)(),u=Object(P.useSelector)(Jn("approvis").value);return i.a.useEffect((function(){d(Xn("approvis").get(l))}),[l]),Object(w.jsxs)(Xe,{children:[Object(w.jsx)(Ke,{title:"D\xe9tail du facture",children:Object(w.jsx)(We,{title:"Detail de facture"})}),Object(w.jsx)($e,{children:Object(w.jsx)("div",{className:"bg-white p-2",children:Object(w.jsxs)(lr.a,{children:[Object(w.jsxs)(lr.a.Header,{className:"d-flex justify-content-between align-items-center bg-dark text-white",children:["D\xe9tail du facture (",nt(null===(e=u[0])||void 0===e?void 0:e.dateApprov),")"]}),Object(w.jsxs)(lr.a.Body,{children:[Object(w.jsx)("p",{children:"Arr\xeat\xe9 \xe0 la somme de "}),Object(w.jsx)("p",{className:"text-uppercase my-2",children:Object(w.jsxs)("strong",{children:[Object(sr.NumberToLetter)(null===(t=u[0])||void 0===t?void 0:t.total)," ARIARY"]})}),Object(w.jsxs)("tr",{children:[Object(w.jsxs)("td",{children:[Object(w.jsx)("strong",{children:"Date Echeance"})," :"," ",nt(null===(n=u[0])||void 0===n?void 0:n.dateEcheance)]})," "]}),Object(w.jsxs)("td",{className:"mb-1",children:[Object(w.jsx)("h3",{children:"Remarque"}),Object(w.jsx)("p",{class:"text-info",children:null===(c=u[0])||void 0===c?void 0:c.remarque})]}),Object(w.jsx)("br",{}),Object(w.jsxs)("h3",{children:[" ",Object(w.jsx)("strong",{children:"ARTICLES"})]}),null===(r=u[0])||void 0===r?void 0:r.contenu.map((function(e){return Object(w.jsxs)("div",{className:"border mb-3 p-3",children:[Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:"Nom de l'article:"}),Object(w.jsx)("td",{children:null===e||void 0===e?void 0:e.name})]}),Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:"Quantit\xe9:"}),Object(w.jsx)("td",{children:null===e||void 0===e?void 0:e.quantityParProduct})]}),Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:"Prix unitaire:"}),Object(w.jsx)("td",{children:Object(w.jsx)(or.a,{value:null===e||void 0===e?void 0:e.prixFournisseur,displayType:"text",thousandSeparator:!0,suffix:"Ar",renderText:function(e,t){return Object(w.jsx)("div",Object(dt.a)(Object(dt.a)({},t),{},{children:e}))}})})]})]})})),Object(w.jsx)("tr",{children:Object(w.jsxs)("td",{children:[Object(w.jsx)("strong",{children:"Remise :"})," ",null===(a=u[0])||void 0===a?void 0:a.remise," Ar"]})}),Object(w.jsx)("tr",{children:Object(w.jsxs)("td",{class:"text-uppercase",children:[Object(w.jsx)("strong",{children:"Paiement en :"}),null===(s=u[0])||void 0===s?void 0:s.typePaye]})}),Object(w.jsx)("tr",{children:Object(w.jsxs)("td",{class:"text-uppercase",children:[Object(w.jsx)("strong",{children:"Total:"}),Object(w.jsx)(or.a,{value:null===(o=u[0])||void 0===o?void 0:o.total,displayType:"text",thousandSeparator:!0,suffix:"Ar",renderText:function(e,t){return Object(w.jsx)("div",Object(dt.a)(Object(dt.a)({},t),{},{children:e}))}})]})})," "]})]})})})]})},ur=c(209);function jr(e){var t=e.column,n=t.filterValue,c=t.preFilteredRows,r=t.setFilter;c.length;return Object(w.jsx)("input",{className:"form-control",value:n||"",onChange:function(e){r(e.target.value||void 0)},placeholder:"Rechercher..."})}function br(e){var t=e.preGlobalFilteredRows,n=e.globalFilter,c=e.setGlobalFilter,r=(t.length,i.a.useState(n)),a=Object(f.a)(r,2),s=a[0],o=a[1],l=Object(ur.useAsyncDebounce)((function(e){c(e||void 0)}),200);return Object(w.jsx)("div",{w:200,children:Object(w.jsx)("input",{className:"form-control",value:s||"",onChange:function(e){o(e.target.value),l(e.target.value)},placeholder:"Rechercher ..."})})}function mr(e){var t=e.columns,n=e.data,c=void 0===n?[]:n,r=e.scopes,a=void 0===r?[]:r,i=e.meta,s=e.addUrl,o=e.urlName,l=e.footer,d=e.tip,u=void 0===d?"":d,j=e.filter,b=void 0===j||j,m=e.paginate,O=void 0===m||m,h=e.guide;return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(Or,{columns:t,data:i.isFetching?[]:c,meta:i,scopes:a,addUrl:s,urlName:o,footer:l,tip:u,filter:b,paginate:O,guide:h})})}function Or(e){var t=e.columns,n=e.data,c=void 0===n?[]:n,r=e.scopes,a=void 0===r?[]:r,s=e.meta,o=e.addUrl,l=e.urlName,d=e.footer,j=e.tip,b=void 0===j?"":j,m=e.filter,O=void 0===m||m,h=e.paginate,x=void 0===h||h,v=e.guide,p=t.length,f=i.a.useMemo((function(){return{Filter:jr}}),[]),g=Object(ur.useTable)({columns:t,data:c,defaultColumn:f,initialState:{pageIndex:0,pageSize:10}},ur.useFilters,ur.useGlobalFilter,ur.useSortBy,ur.usePagination),y=g.getTableProps,N=g.getTableBodyProps,C=g.headerGroups,S=(g.rows,g.prepareRow),q=g.preGlobalFilteredRows,A=g.setGlobalFilter,D=g.page,P=g.canPreviousPage,V=g.canNextPage,F=g.pageOptions,R=(g.pageCount,g.gotoPage),T=g.nextPage,M=g.previousPage,B=g.setPageSize,k=g.state,_=k.pageIndex,I=k.pageSize,L=k.globalFilter;return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsxs)("div",{className:"d-flex my-2 justify-content-between align-items-center",children:[O&&Object(w.jsx)(br,{preGlobalFilteredRows:q,globalFilter:L,setGlobalFilter:A}),Object(w.jsx)("div",{children:o&&l&&Object(w.jsx)(E,{scopes:a,children:Object(w.jsx)(u.b,{className:"btn btn-sm btn-green",variant:"solid",to:o,children:l})})})]}),b&&Object(w.jsx)("h3",{children:b}),Object(w.jsxs)("table",Object(dt.a)(Object(dt.a)({},y()),{},{className:"table table-bordered striped",children:[Object(w.jsx)("thead",{className:"bg-thead ",children:C.map((function(e){return Object(w.jsx)("tr",Object(dt.a)(Object(dt.a)({},e.getHeaderGroupProps()),{},{children:e.headers.map((function(e){return Object(w.jsxs)("th",Object(dt.a)(Object(dt.a)({},e.getHeaderProps(e.getSortByToggleProps())),{},{children:[e.render("Header"),Object(w.jsx)("span",{children:e.isSorted?e.isSortedDesc?" \ud83d\udd3d":" \ud83d\udd3c":""})]}))}))}))}))}),Object(w.jsx)("tbody",Object(dt.a)(Object(dt.a)({},N()),{},{children:s.isFetching?Object(w.jsx)("td",{colSpan:p,className:"text-center",children:Object(w.jsx)("p",{children:"Chargement des donn\xe9es en cours ...."})}):Object(w.jsxs)(w.Fragment,{children:[0==D.length&&Object(w.jsx)("tr",{children:Object(w.jsx)("td",{colSpan:p,style:v?{textAlign:"left"}:{textAlign:"center"},children:v?Object(w.jsxs)("div",{style:{width:"100%",color:"blue.700",backgroundColor:"gray.200",padding:"10px"},children:[Object(w.jsx)("h3",{className:"py-3",children:b}),v]}):"Aucune enregistrement \xe0 afficher"})}),D.map((function(e){return S(e),Object(w.jsx)("tr",Object(dt.a)(Object(dt.a)({p:0},e.getRowProps()),{},{children:e.cells.map((function(e){return Object(w.jsx)("td",Object(dt.a)(Object(dt.a)({fontSize:"11px"},e.getCellProps()),{},{isNumeric:e.column.isNumeric,children:e.render("Cell")}))}))}))}))]})})),d&&Object(w.jsx)("tfoot",{bg:"blue.900",children:Object(w.jsx)("tr",{children:Object(w.jsx)("td",{colSpan:p,color:"white",children:d})})})]})),x&&Object(w.jsxs)("div",{className:"d-flex  justify-content-between align-items-center py-3",children:[Object(w.jsx)("div",{style:{width:"200px"},children:Object(w.jsxs)("div",{className:"d-flex justify-content-center align-items-center",children:[Object(w.jsx)("input",{className:"form-control  mr-2",type:"number",placeholder:"Page",value:_+1,onChange:function(e){var t=e.target.value?Number(e.target.value)-1:0;R(t)}}),Object(w.jsx)("select",{className:"form-control",value:I,onChange:function(e){B(Number(e.target.value))},size:"sm",children:[5,10,20,30,40,50,100,150,250].map((function(e){return Object(w.jsx)("option",{value:e,children:e},e)}))})]})}),Object(w.jsx)("div",{children:Object(w.jsxs)(w.Fragment,{children:["Page"," ",Object(w.jsxs)("strong",{children:[_>0?_+1:1," sur ",F.length]})," "]})}),Object(w.jsx)("div",{className:"mb-6",children:Object(w.jsxs)("div",{children:[Object(w.jsxs)("button",{className:"mr-2 btn btn-sm btn-green",onClick:function(){return M()},disabled:!P,children:["<<"," Pr\xe9cedent"]}),Object(w.jsxs)("button",{className:"mr-2 btn btn-sm btn-green",onClick:function(){return T()},disabled:!V,children:["Suivant ",">>"]})]})})]})]})}var hr=function(e){var t=e.model,n=e.entity,c=Object(P.useDispatch)();return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)("button",{className:"btn btn-danger btn-sm",onClick:function(e){e.preventDefault(),window.confirm("Vous voulez vraiment supprimer ce facture ?")&&c(Xn(t).deleteTransaction(n,"/delete-facture"))},children:"Supprimer"})})};function xr(){var e=Qe()().isoWeekday(1).startOf("week"),t=Qe()().endOf("week"),n=Object(a.useState)(e),c=Object(f.a)(n,2),r=c[0],s=c[1],o=Object(a.useState)(t),l=Object(f.a)(o,2),d=l[0],j=l[1],b=Object(a.useState)([e,t]),m=Object(f.a)(b,2),O=m[0],h=m[1],x=(Object(a.useRef)(null),Object(a.useRef)(null),Object(P.useSelector)(Jn("approvis").value)),v=Object(P.useSelector)(Jn("approvis").meta),p=Object(P.useDispatch)();Object(a.useEffect)((function(){p(Xn("approvis").fetch())}),[]),Object(a.useEffect)((function(){null!==O?(O[0]&&s(O[0]),O[1]&&j(O[1])):(s(e),j(t))}),[O]),Object(a.useEffect)((function(){p(function(e,t){return Ln("approvis",{path:"/get-approv-by-date?deb=".concat(e,"&fin=").concat(t),replace:!0})}(r,d))}),[r,d]);var g=i.a.useMemo((function(){return[{Header:"#",accessor:"id"},{Header:"Produit",Cell:function(e){var t,n;return Object(w.jsx)("div",{style:{width:"200px"},children:null===(t=e.row.original)||void 0===t||null===(n=t.contenu)||void 0===n?void 0:n.map((function(e){return Object(w.jsxs)("span",{children:[e.name,","]})}))})}},{Header:"Date du facture",Cell:function(e){var t;return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)("span",{className:"badge badge-primary",children:nt(null===(t=e.row.original)||void 0===t?void 0:t.dateApprov)})})}},{Header:"Date echeance",Cell:function(e){var t;return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)("span",{className:"badge badge-warning",children:nt(null===(t=e.row.original)||void 0===t?void 0:t.dateEcheance)})})}},{Header:"Mode de paiement",accessor:"typePaye"},{Header:"Total",Cell:function(e){var t;return Object(w.jsx)("div",{children:ct(null===(t=e.row.original)||void 0===t?void 0:t.total)})}},{Header:"Actions",Cell:function(e){var t,n;return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(E,{scopes:[S.canShowDetailFactures],children:Object(w.jsx)(u.b,{to:"/approvis/detail/".concat(null===(t=e.row.original)||void 0===t?void 0:t.id),className:"btn btn-green btn-sm mr-2",children:"D\xe9tails"})}),Object(w.jsx)(E,{scopes:[S.canShowEditFacture],children:Object(w.jsx)(u.b,{to:"/editer/facture/".concat(null===(n=e.row.original)||void 0===n?void 0:n.id),className:"btn btn-warning btn-sm mr-2",children:"Editer"})}),Object(w.jsx)(E,{scopes:[S.canShowDeleteFacture],children:Object(w.jsx)(hr,{model:"approvis",entity:e.row.original})})]})}}]}),[]);return Object(w.jsxs)(Xe,{children:[Object(w.jsx)(Ke,{title:"Factures",children:Object(w.jsx)(We,{title:"Factures"})}),Object(w.jsxs)($e,{children:[Object(w.jsxs)("div",{className:"row",children:[Object(w.jsx)("div",{className:"col-lg-6",children:Object(w.jsxs)("div",{children:[Object(w.jsx)("h3",{className:"text-uppercase",children:"Factures"}),Object(w.jsx)("p",{children:"".concat(nt(r)," ->  ").concat(nt(d))})]})}),Object(w.jsx)("div",{className:"col-lg-6 text-right",children:Object(w.jsx)(et.a,{locale:"fr-FR",onChange:h,value:O})})," "]}),Object(w.jsx)(mr,{filter:!1,scopes:[S.canShowAddFacture],data:x.sort((function(e,t){return t.id-e.id})),meta:v,columns:g,addUrl:pe,urlName:"Ajouter un facture"})]})]})}var vr=function(){return Object(w.jsxs)(Xe,{children:[Object(w.jsx)(Ke,{title:"Sortie",children:Object(w.jsx)(We,{title:"Sortie"})}),Object(w.jsx)($e,{})]})},pr=c(1363),fr=c(1339),gr=c(1340),yr="SET_BASKET_ITEMS",Nr="ADD_TO_BASKET",Cr="REMOVE_FROM_BASKET",Sr="CLEAR_BASKET",qr="ADD_QTY_ITEM",wr="MINUS_QTY_ITEM",Er="ADD_QTY_PORTION_ITEM",Ar="MINUS_QTY_PORTION_ITEM",Dr="SET_CHECKOUT_SHIPPING_DETAILS",Pr="SET_CHECKOUT_PAYMENT_DETAILS",Vr="RESET_CHECKOUT",Fr=c(1341);function Rr(e){return e.toString().replace(/\s/g,"").toLowerCase()}function Tr(e){var t,n,c;for(c in t=Array.isArray(e)?[]:{},e)n=e[c],t[c]="object"===typeof n?Tr(n):n;return t}var Mr=function(e,t){return Tr(e).filter((function(e){return""==t||Rr(e.name).includes(Rr(t))}))};var Br=c(73),kr=c.n(Br);var _r=function(e){var t=e.model,n=e.entity,c=Object(P.useDispatch)(),r=Object(j.g)();return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)("button",{className:"btn btn-danger btn-sm",onClick:function(e){e.preventDefault(),window.confirm("Vous voulez vraiment supprimer ce commande ?")&&(c(Xn(t).deleteTransaction(n,"/delete-from-depot")),r.goBack())},children:"Supprimer"})})};var Ir=function(e){var t=Qe()().isoWeekday(1).startOf("week"),n=Qe()().endOf("week"),c=Object(a.useState)(t),r=Object(f.a)(c,2),s=r[0],o=r[1],l=Object(a.useState)(n),d=Object(f.a)(l,2),j=d[0],b=d[1],m=Object(a.useState)([t,n]),O=Object(f.a)(m,2),h=O[0],x=O[1],v=Object(P.useSelector)(Jn("commandes").value),p=Object(P.useSelector)(Jn("commandes").meta),g=Object(P.useDispatch)();Object(a.useEffect)((function(){null!==h?(h[0]&&o(h[0]),h[1]&&b(h[1])):(o(t),b(n))}),[h]);var y=function(e){if(void 0==e||0===(null===e||void 0===e?void 0:e.length))return 0;var t=0;return e.forEach((function(e){t+=e.prixVente*e.quantityParProductDepot})),t};Object(a.useEffect)((function(){g(function(e,t){return Ln("commandes",{path:"/credit?deb=".concat(e,"&fin=").concat(t),replace:!0})}(s,j))}),[s,j]);var N=i.a.useMemo((function(){return[{Header:"Date de credit",Cell:function(e){var t;return Object(w.jsx)(w.Fragment,{children:nt(null===(t=e.row.original)||void 0===t?void 0:t.dateCom)})}},{Header:"Produits",Cell:function(e){var t,n,c,r;return Object(w.jsxs)("div",{style:{width:"350px"},children:[1==(null===(t=e.row.original)||void 0===t?void 0:t.isdeleted)&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("div",{className:"badge badge-danger",children:"Supprim\xe9"}),Object(w.jsxs)("div",{className:"text text-danger",children:["Date de suppression :"," ",nt(null===(n=e.row.original)||void 0===n?void 0:n.deletedat)]})]}),null===(c=e.row.original)||void 0===c||null===(r=c.contenu)||void 0===r?void 0:r.map((function(t){var n,c;return Object(w.jsxs)("span",{children:[Object(w.jsx)("span",{style:{background:"white",color:1==(null===(n=e.row.original)||void 0===n?void 0:n.isdeleted)?"red":"inherit",padding:2},children:t.name}),Object(w.jsxs)("span",{style:{color:1==(null===(c=e.row.original)||void 0===c?void 0:c.isdeleted)?"red":"inherit"},children:[" "," || "]})]})}))]})}},{Header:"Status",Cell:function(e){var t;return Object(w.jsx)("div",{children:1==(null===(t=e.row.original)||void 0===t?void 0:t.status)?Object(w.jsx)("h3",{className:"badge badge-success",children:"pay\xe9"}):Object(w.jsx)("h3",{className:"badge badge-danger",children:"non pay\xe9"})})}},{Header:"Nom de la personne",accessor:"emprunter.name"},{Header:"Contact",accessor:"emprunter.contact"},{Header:"Total",Cell:function(e){var t;return Object(w.jsx)("div",{children:ct(y(null===(t=e.row.original)||void 0===t?void 0:t.contenu))})}},{Header:"Actions",Cell:function(e){var t,n,c;return 1==(null===(t=e.row.original)||void 0===t?void 0:t.isdeleted)?null:Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(E,{scopes:[S.canShowDetailCreditDepot],children:Object(w.jsx)(u.b,{to:"/detail/".concat(null===(n=e.row.original)||void 0===n?void 0:n.id),className:"btn btn-green btn-sm mr-2",children:"D\xe9tails"})}),Object(w.jsx)(E,{scopes:[S.canShowEditCreditDepot],children:Object(w.jsx)(u.b,{to:"/editer/commande/".concat(null===(c=e.row.original)||void 0===c?void 0:c.id),className:"btn btn-warning btn-sm mr-2",children:"Editer"})}),Object(w.jsx)(E,{scopes:[S.canShowDeleteCreditDepot],children:Object(w.jsx)(_r,{model:"fromdepots",entity:e.row.original})})]})}}]}),[]);return Object(w.jsxs)(Xe,{children:[Object(w.jsx)(Ke,{title:"Cr\xe9dit",children:Object(w.jsx)(We,{title:"Cr\xe9dit"})}),Object(w.jsxs)($e,{children:[Object(w.jsxs)("div",{className:"row",children:[Object(w.jsx)("div",{className:"col-lg-6",children:Object(w.jsxs)("div",{children:[Object(w.jsx)("h3",{className:"text-uppercase",children:"Credit"}),Object(w.jsx)("p",{children:"".concat(nt(s)," ->  ").concat(nt(j))})]})}),Object(w.jsx)("div",{className:"col-lg-6 text-right",children:Object(w.jsx)(kr.a,{locale:"fr-FR",onChange:x,value:h})})," "]}),Object(w.jsx)(mr,{data:v.sort((function(e,t){return t.id-e.id})),meta:p,columns:N})]})]})};var Lr=function(e){var t=Qe()().isoWeekday(1).startOf("week"),n=Qe()().endOf("week"),c=Object(a.useState)(t),r=Object(f.a)(c,2),s=r[0],o=r[1],l=Object(a.useState)(n),d=Object(f.a)(l,2),j=d[0],b=d[1],m=Object(a.useState)([t,n]),O=Object(f.a)(m,2),h=O[0],x=O[1],v=Object(P.useSelector)(Jn("commandes").value),p=Object(P.useSelector)(Jn("commandes").meta),g=Object(P.useDispatch)();Object(a.useEffect)((function(){null!==h?(h[0]&&o(h[0]),h[1]&&b(h[1])):(o(t),b(n))}),[h]);var y=function(e){if(!e||0===(null===e||void 0===e?void 0:e.length))return 0;var t=0;return e.forEach((function(e){t+=e.prixVente*e.quantityParProductDepot})),t},N=function(e){if(!e||0===(null===e||void 0===e?void 0:e.length))return 0;var t=0;return e.forEach((function(e){t+=1*e.quantityParProductDepot})),t};Object(a.useEffect)((function(){g(Ln("commandes",{path:"/credit-vaccinateur",replace:!0}))}),[s,j]);var C=i.a.useMemo((function(){return[{Header:"Date du credit",Cell:function(e){var t;return Object(w.jsx)(w.Fragment,{children:nt(null===(t=e.row.original)||void 0===t?void 0:t.dateCom)})}},{Header:"Produits",Cell:function(e){var t,n;return Object(w.jsx)("div",{style:{width:"100px"},children:null===(t=e.row.original)||void 0===t||null===(n=t.contenu)||void 0===n?void 0:n.map((function(e){return Object(w.jsxs)("span",{children:[e.name,","]})}))})}},{Header:"Status",Cell:function(e){var t;return Object(w.jsx)("div",{children:1==(null===(t=e.row.original)||void 0===t?void 0:t.status)?Object(w.jsx)("h3",{className:"badge badge-success",children:"pay\xe9"}):Object(w.jsx)("h3",{className:"badge badge-danger",children:"non pay\xe9"})})}},{Header:"Nom du vaccinateur",accessor:"vaccinateur.name"},{Header:"Contact du vaccinateur",accessor:"vaccinateur.contact"},{Header:"Quantit\xe9",Cell:function(e){var t;return Object(w.jsx)("div",{children:N(null===(t=e.row.original)||void 0===t?void 0:t.contenu)})}},{Header:"Total",Cell:function(e){var t;return Object(w.jsx)("div",{children:ct(y(null===(t=e.row.original)||void 0===t?void 0:t.contenu))})}},{Header:"Actions",Cell:function(e){var t,n;return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(E,{scopes:[S.canShowDetailVaccinateurCreditDepot],children:Object(w.jsx)(u.b,{to:"/detail/".concat(null===(t=e.row.original)||void 0===t?void 0:t.id),className:"btn btn-green btn-sm mr-2",children:"D\xe9tails"})}),Object(w.jsx)(E,{scopes:[S.canShowDetailVaccinateurCreditDepot],children:Object(w.jsx)(u.b,{to:"/editer/commande/".concat(null===(n=e.row.original)||void 0===n?void 0:n.id),className:"btn btn-warning btn-sm mr-2",children:"Editer"})}),Object(w.jsxs)(E,{scopes:[S.canShowDeleteVaccinateurCreditDepot],children:[Object(w.jsx)(_r,{model:"fromdepots",entity:e.row.original})," "]})]})}}]}),[]);return Object(w.jsxs)(Xe,{children:[Object(w.jsx)(Ke,{title:"Cr\xe9dit  pour les vaccinateurs",children:Object(w.jsx)(We,{title:"Cr\xe9dit  pour les vaccinateurs"})}),Object(w.jsxs)($e,{children:[Object(w.jsxs)("div",{className:"row",children:[Object(w.jsx)("div",{className:"col-lg-6",children:Object(w.jsxs)("div",{children:[Object(w.jsx)("h3",{className:"text-uppercase",children:"Credit pour les vaccinateurs"}),Object(w.jsx)("p",{children:"".concat(nt(s)," ->  ").concat(nt(j))})]})}),Object(w.jsx)("div",{className:"col-lg-6 text-right",children:Object(w.jsx)(kr.a,{locale:"fr-FR",onChange:x,value:h})})," "]}),Object(w.jsx)(mr,{data:v.sort((function(e,t){return t.id-e.id})),meta:p,columns:C})]})]})},Qr=function(e){if(!e||0===(null===e||void 0===e?void 0:e.length))return 0;var t=0;return e.forEach((function(e){t+=e.prixVente*e.quantityParProductDepot*1})),t};var Hr=Object(j.j)((function(e){var t,n,c,r,i,s,o,l,d,u,b,m,O,h=Object(j.g)(),x=Object(j.i)().id,v=Object(P.useSelector)(Jn("commandes").value),p=Object(P.useDispatch)();return Object(a.useEffect)((function(){p(Xn("commandes").get(x))}),[x]),Object(w.jsxs)(Xe,{children:[Object(w.jsx)(Ke,{title:"D\xe9tail de sortie ou entr\xe9e",children:Object(w.jsx)(We,{title:"D\xe9tail de sortie ou entr\xe9e"})}),Object(w.jsxs)($e,{children:[Object(w.jsxs)("div",{className:"badge badge-info my-2",children:["vente-depot-credit"==(null===(t=v[0])||void 0===t?void 0:t.type)&&Object(w.jsx)("h3",{children:"Credit"}),"vente-depot-vaccinateur"==(null===(n=v[0])||void 0===n?void 0:n.type)&&Object(w.jsx)("h3",{children:"Credit pour vaccinateur"}),"direct"==(null===(c=v[0])||void 0===c?void 0:c.type)&&Object(w.jsx)("h3",{children:"Direct"})]}),"vente-depot-vaccinateur"==(null===(r=v[0])||void 0===r?void 0:r.type)&&Object(w.jsx)("div",{className:"border pl-3 py-3 bg-white",children:Object(w.jsxs)(w.Fragment,{children:[Object(w.jsxs)("h3",{className:"my-2",children:[" ","Nom du vaccinateur : ",null===(i=v[0])||void 0===i?void 0:i.vaccinateur.name]}),Object(w.jsxs)("h5",{children:["Contact : ",null===(s=v[0])||void 0===s?void 0:s.vaccinateur.contact]})]})}),"vente-depot-credit"==(null===(o=v[0])||void 0===o?void 0:o.type)&&Object(w.jsx)("div",{className:"border pl-3 py-3 bg-white",children:Object(w.jsxs)(w.Fragment,{children:[Object(w.jsxs)("h3",{className:"my-2",children:["Nom:",null===(l=v[0])||void 0===l?void 0:l.emprunter.name]}),Object(w.jsxs)("h5",{children:["Contact: ",null===(d=v[0])||void 0===d?void 0:d.emprunter.contact]})]})}),v.length>0&&Object(w.jsxs)("div",{className:"d-flex justify-content-between",children:[Object(w.jsxs)("p",{className:"text-uppercase",children:["Commande du : ",nt(null===(u=v[0])||void 0===u?void 0:u.dateCom)]}),1==(null===(b=v[0])||void 0===b?void 0:b.status)?Object(w.jsx)("p",{className:"btn btn-sm btn-green my-2 mt-4",children:"pay\xe9"}):Object(w.jsx)("button",{className:"btn btn-sm btn-warning my-3",onClick:function(){var e;p(function(e){return Ln("commandes",{path:"/set-payer-commande?cId=".concat(e),replace:!0})}(null===(e=v[0])||void 0===e?void 0:e.id)),h.goBack()},children:"Marquer comme pay\xe9"})]}),Object(w.jsxs)("table",{className:"table table-bordered ",children:[Object(w.jsxs)("tr",{className:"bg-thead",children:[Object(w.jsx)("td",{children:"Nom de l'article"}),Object(w.jsx)("td",{children:"Quantit\xe9"}),Object(w.jsx)("td",{children:"Sous total"})]}),v.length>0&&(null===(m=v[0])||void 0===m?void 0:m.contenu.map((function(e){return Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{style:{width:"40%"},children:e.name}),Object(w.jsxs)("td",{className:"d-flex align-items-center",children:[ct(e.prixVente),"(","x"," ",e.quantityParProductDepot,")"]}),Object(w.jsx)("td",{children:ct(e.prixVente*e.quantityParProductDepot)})]})})))]}),Object(w.jsxs)("div",{className:"d-flex justify-content-end",children:[Object(w.jsx)("strong",{children:"Total"}),":",ct(Qr(null===(O=v[0])||void 0===O?void 0:O.contenu))]})]})]})})),Ur=function(e){if(!e||0===(null===e||void 0===e?void 0:e.length))return 0;var t=0;return e.forEach((function(e){t+=e.prixVente*e.quantityParProductDepot*1})),t};var Yr=Object(j.j)((function(e){Object(j.h)();var t,n,c,r,i,s,o,l,d,u,b,m,O=Object(j.i)().id,h=Object(P.useSelector)(Jn("commandes").value),x=Object(P.useDispatch)();return Object(a.useEffect)((function(){x(Xn("commandes").get(O))}),[O]),Object(w.jsxs)(Xe,{children:[Object(w.jsx)(Ke,{title:"D\xe9tail de sortie ou entr\xe9e",children:Object(w.jsx)(We,{title:"D\xe9tail de sortie ou entr\xe9e"})}),Object(w.jsxs)($e,{children:[Object(w.jsxs)("p",{children:["credit"==(null===(t=h[0])||void 0===t?void 0:t.type)&&Object(w.jsx)("p",{children:"Credit"}),"vaccinateur"==(null===(n=h[0])||void 0===n?void 0:n.type)&&Object(w.jsx)("p",{children:"Sortie vaccinateur"}),"direct"==(null===(c=h[0])||void 0===c?void 0:c.type)&&Object(w.jsx)("p",{children:"Sortie Magasion"})]}),"vaccinateur"==(null===(r=h[0])||void 0===r?void 0:r.type)&&Object(w.jsx)("div",{className:"border",children:Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("h3",{children:null===(i=h[0])||void 0===i?void 0:i.vaccinateur.name}),Object(w.jsx)("h5",{children:null===(s=h[0])||void 0===s?void 0:s.vaccinateur.contact})]})}),"credit"==(null===(o=h[0])||void 0===o?void 0:o.type)&&Object(w.jsx)("div",{className:"border",children:Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("h3",{children:null===(l=h[0])||void 0===l?void 0:l.emprunter.name}),Object(w.jsx)("h5",{children:null===(d=h[0])||void 0===d?void 0:d.emprunter.contact})]})}),h.length>0&&Object(w.jsx)("div",{className:"d-flex justify-content-between",children:Object(w.jsxs)("p",{className:"text-uppercase",children:["Commande du : ",nt(null===(u=h[0])||void 0===u?void 0:u.dateCom)]})}),Object(w.jsxs)("table",{className:"table table-bordered ",children:[Object(w.jsxs)("tr",{className:"bg-thead",children:[Object(w.jsx)("td",{children:"Nom de l'article"}),Object(w.jsx)("td",{children:"Quantit\xe9"}),Object(w.jsx)("td",{children:"Sous total"})]}),h.length>0&&(null===(b=h[0])||void 0===b?void 0:b.contenu.map((function(e){return Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{style:{width:"40%"},children:e.name}),Object(w.jsxs)("td",{className:"d-flex align-items-center",children:[ct(e.prixVente),"(","x"," ",e.quantityParProductDepot,")"]}),Object(w.jsx)("td",{children:ct(e.prixVente*e.quantityParProductDepot)})]})})))]}),Object(w.jsxs)("div",{className:"d-flex justify-content-end",children:[Object(w.jsx)("strong",{children:"Total"}),":",ct(Ur(null===(m=h[0])||void 0===m?void 0:m.contenu))]})]})]})}));var Kr=function(e){var t=Object(P.useSelector)(Jn("commandes").value),n=Object(P.useDispatch)();Object(a.useEffect)((function(){n(Ln("commandes",{path:"/direct",replace:!0}))}),[]);var c=function(e){if(!e||0===(null===e||void 0===e?void 0:e.length))return 0;var t=0;return e.forEach((function(e){t+=e.prixVente})),t.toFixed(2)};return Object(w.jsxs)(Xe,{children:[Object(w.jsx)(Ke,{title:"Sortie pour le magasin",children:Object(w.jsx)(We,{title:"Sortie pour le magasin"})}),Object(w.jsx)($e,{children:Object(w.jsxs)("table",{className:"table table-bordered table-striped",children:[Object(w.jsx)("thead",{children:Object(w.jsxs)("tr",{children:[Object(w.jsx)("th",{children:"Date de commande"}),Object(w.jsx)("th",{children:"Nb"}),Object(w.jsx)("th",{children:"Montant"}),Object(w.jsx)("th",{children:"Actions"})]})}),Object(w.jsx)("tbody",{children:t.map((function(e){var t;return Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:null===e||void 0===e?void 0:e.createdAt}),Object(w.jsx)("td",{children:null===e||void 0===e||null===(t=e.contenu)||void 0===t?void 0:t.length}),Object(w.jsx)("td",{children:c(null===e||void 0===e?void 0:e.contenu)}),Object(w.jsx)("td",{className:"d-flex justify-content-around",children:Object(w.jsx)(u.b,{className:"btn btn-sm  btn-green",to:"detail/".concat(e.id),children:"Detail"})})]})}))})]})})]})},zr=function(){var e=Object(a.useState)(new Date),t=Object(f.a)(e,2),n=t[0],c=t[1],r=Object(a.useState)(new Date),i=Object(f.a)(r,2),s=i[0],o=i[1],l=Object(a.useRef)(null),d=Object(a.useRef)(null),j=Object(P.useSelector)(Jn("commandes").value),b=Object(P.useDispatch)();Object(a.useEffect)((function(){b(function(e,t){return Ln("commandes",{path:"/journal?deb=".concat(e,"&fin=").concat(t),replace:!0})}(n,s))}),[n,s]);var m=function(e){return e&&0!==(null===e||void 0===e?void 0:e.length)?e.reduce((function(e,t){return e+t}),0):0},O=function(e){return m(e.map((function(e){return e.prixVente*e.quantityParProduct})))+m(e.map((function(e){return e.prixParCC*e.qttByCC})))};return Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)(Xe,{children:[Object(w.jsx)(Ke,{title:"Journal de sortie",children:Object(w.jsx)(We,{title:"Journal de sortie"})}),Object(w.jsxs)($e,{children:[Object(w.jsxs)("div",{className:"row",children:[Object(w.jsx)("div",{className:"col-lg-8"}),Object(w.jsxs)("div",{className:"col-lg-4",children:[Object(w.jsxs)("div",{className:"d-flex align-items-center mb-3",children:[Object(w.jsx)("input",{type:"date",name:"datedeb",ref:l,placeholder:"date debut",className:"form-control mr-2"}),Object(w.jsx)("input",{type:"date",name:"datefin",ref:d,placeholder:"date fin",className:"form-control mr-2"}),Object(w.jsx)("button",{className:"btn btn-primary",onClick:function(){""==l.current.value?c(new Date):c(l.current.value),""==d.current.value?o(new Date):o(d.current.value)},children:"Filtrer"})]})," "]})," "]}),Object(w.jsx)("div",{className:"table-responsive",children:Object(w.jsxs)("table",{className:"table",children:[Object(w.jsx)("thead",{children:Object(w.jsxs)("tr",{children:[Object(w.jsx)("th",{children:"Date "}),Object(w.jsx)("th",{children:"Type de sortie"}),Object(w.jsx)("th",{children:"Montant Total"}),Object(w.jsx)("th",{children:"Actions"})]})}),Object(w.jsx)("tbody",{children:j.map((function(e){return Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:nt(null===e||void 0===e?void 0:e.createdAt)}),Object(w.jsx)("td",{children:Object(w.jsxs)(w.Fragment,{children:["cva"==(null===e||void 0===e?void 0:e.type)&&Object(w.jsx)("div",{className:"badge badge-info",children:"Approvisionnement du magasin"}),"vente-magasin-direct"==(null===e||void 0===e?void 0:e.type)&&Object(w.jsx)("div",{className:"badge badge-success",children:"Vente direct depuis le magasin"}),"vente-magasin-credit"==(null===e||void 0===e?void 0:e.type)&&Object(w.jsx)("div",{className:"badge badge-info",children:"credit client depuis magasin"}),"credit"==(null===e||void 0===e?void 0:e.type)&&Object(w.jsx)("div",{className:"badge badge-danger",children:"Credit personne"}),"vaccinateur"==(null===e||void 0===e?void 0:e.type)&&Object(w.jsx)("div",{className:"badge badge-warning",children:"Credit Vaccinateur"}),"direct"==(null===e||void 0===e?void 0:e.type)&&Object(w.jsx)("div",{className:"badge badge-dark",children:"Vente direct depuis le dep\xf4t"})]})}),Object(w.jsx)("td",{children:ct(O(null===e||void 0===e?void 0:e.contenu))}),Object(w.jsx)("td",{children:Object(w.jsx)(u.b,{className:"btn btn-sm  btn-green",to:"/detail/".concat(e.id),children:"Afficher le detail"})})]})}))})]})}),Object(w.jsxs)("h3",{children:["Total:",ct(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=e.filter((function(e){return 1!=e.isdeleted})),n=0;return j.length>0?t.map((function(e){n+=O(null===e||void 0===e?void 0:e.contenu)})):n=0,n}(j))]})]})]})})};var Wr=function(){var e,t,n=Object(P.useSelector)(Jn("parametres").value),c=Object(P.useDispatch)();return Object(a.useEffect)((function(){c(Xn("parametres").get(1))}),[]),Object(w.jsxs)("div",{children:[Object(w.jsx)("h3",{className:"mb-2 text-bold title",children:"Parametres supplementaires"}),Object(w.jsxs)("div",{className:"card mt-2",children:[Object(w.jsx)("div",{className:"card-body",children:Object(w.jsx)(ar,{id:"parametrage-form",enableReinitialize:!0,initialValues:{nb_mois:null===(e=n[0])||void 0===e?void 0:e.nbMois,nb_produit:null===(t=n[0])||void 0===t?void 0:t.nbProduits},validations:{},onSubmit:function(e,t){c(Xn("parametres").update({id:1,nb_mois:e.nb_mois,nb_produits:e.nb_produit}))},render:function(){return Object(w.jsxs)(ar.Element,{children:[Object(w.jsx)(ar.Field.Input,{name:"nb_mois",label:"Nombre de mois",placeholder:"Nombre de mois",type:"number"}),Object(w.jsx)(ar.Field.Input,{name:"nb_produit",label:"Nombre de produit",placeholder:"Nombre de produit",type:"number"}),Object(w.jsx)("button",{type:"submit",className:"btn btn-success mt-2 btn-sm",children:"Sauvegarder la modification"})]})}})})," "]})," "]})},Gr=function(){var e=Object(P.useSelector)(Jn("products").value),t=Object(P.useSelector)(Jn("products").meta),n=Object(P.useDispatch)();Object(a.useEffect)((function(){n(Ln("products",{path:"/perimer",replace:!0}))}),[]);var c=i.a.useMemo((function(){return[{Header:"Produit",accessor:"name"},{Header:"Quantit\xe9",accessor:"quantityBrute"},{Header:"Date de peremption",Cell:function(e){var t;return Object(w.jsx)("h3",{children:nt(null===(t=e.row.original)||void 0===t?void 0:t.datePer)})}}]}),[]);return Object(w.jsxs)(Xe,{children:[Object(w.jsx)(Ke,{title:"Article perim\xe9",children:Object(w.jsx)(We,{title:"Article perim\xe9"})}),Object(w.jsx)($e,{children:Object(w.jsx)(mr,{data:e,meta:t,columns:c})})]})},Xr=c(67);function Jr(){return Xr.b().shape({name:Xr.c().required("Le champ est requis")})}var $r=c(1364);var Zr=function(e){var t=e.message;return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)($r.a,{mb:3,status:"success",variant:"top-accent",children:"string"===typeof t&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)($r.b,{}),t]})})})},ea=c(1342),ta=c(235);var na=function(e){var t=e.error;return Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)($r.a,{mb:3,status:"error",variant:"top-accent",children:["object"===typeof t&&t.length>0&&Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(ea.a,{spacing:3,children:t.map((function(e,t){return Object(w.jsxs)(ea.c,{children:[Object(w.jsx)(ea.b,{as:ta.b,color:"red.500"},t),e.msg]},t)}))})}),"object"===typeof t&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(ta.c,{color:"red.500"}),t.message]}),"string"===typeof t&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)($r.b,{}),t.message]})]})})};var ca=function(){var e=Object(P.useSelector)(Jn("fournisseurs").value),t=Object(P.useSelector)(Jn("categories").value),n=Object(P.useSelector)(Jn("categories").meta),c=Object(P.useSelector)(Jn("fournisseurs").meta),r=Object(P.useSelector)(Jn("products").meta),i=Object(a.useState)(0),s=Object(f.a)(i,2),o=(s[0],s[1],Object(a.useState)(0)),l=Object(f.a)(o,2),d=(l[0],l[1],Object(P.useDispatch)()),u=Object(j.g)();return Object(a.useEffect)((function(){d(Xn("fournisseurs").fetch()),d(Xn("categories").fetch()),d(Xn("products").fetch())}),[u]),Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)(Xe,{children:[Object(w.jsx)(Ke,{title:"Ajouter un produit",children:Object(w.jsx)(We,{title:"Ajouter un produit"})}),Object(w.jsxs)($e,{children:[""!=r.success&&null!=r.success&&Object(w.jsx)(Zr,{message:r.success}),r.error&&Object(w.jsx)(na,{error:r.error}),Object(w.jsx)(ar,{id:"add-form-product",enableReinitialize:!0,initialValues:{name:"",type:"BOLUS",doseDefault:0,prixlitre:0,prixVente:0,prixFournisseur:0,prixVaccinateur:0,quantityParProduct:0,prixParCC:0,datePer:"",uniteMesure:"ml",qttByCC:0,newStockBrute:0,newStockCC:0,fournisseurId:1,qttyspecificmirror:0,quantityBruteCVA:0,categoryId:1,quantityBrute:0,quantityCCCVA:0,quantityCC:0,condml:0,condval:0,conditionnement:1,qttccpvente:0,prixqttccvente:0},validations:Jr,onSubmit:function(e,t){var n=e.name,c=e.type,r=e.doseDefault,a=e.prixVente,i=e.prixFournisseur,s=e.prixVaccinateur,o=e.prixParCC,l=(e.datePer,e.fournisseurId),j=e.categoryId,b=e.condml,m=(e.condval,e.qttccpvente),O=e.conditionnement,h=e.prixqttccvente,x=e.condsize,v=e.prixlitre;d(Xn("products").create({name:n,type:c,doseDefault:r,prixVente:parseFloat(a),prixlitre:parseFloat(v),prixFournisseur:parseFloat(i),prixVaccinateur:parseFloat(s),quantityParProduct:0,quantityBruteCVA:0,quantityBrute:0,quantityCCCVA:0,quantityCC:0,prixParCC:parseFloat(o),datePer:new Date,uniteMesure:"ml",qttByCC:0,newStockBrute:0,newStockCC:0,categoryId:parseInt(j),fournisseurId:parseInt(l),condml:parseFloat(b),condsize:parseFloat(x),conditionnement:O,qttccpvente:parseFloat(m),prixqttccvente:parseInt(h),refSortie:"0",refQtSortie:0,qttByCCDepot:0,condmldepot:0,condvaldepot:0,qttccpventedepot:0,prixqttccventedepot:0,quantityParProductDepot:0,condsizedepot:0,doseRestantEnMg:0,qttbylitre:0,remise:0,condval:0,correction:0,correctionml:0,correctionl:0,correctiontml:0,correctiontl:0,correctiontype:0,qttyspecificmirror:0,remisePerProduct:1})),u.push(se)},render:function(r){var a=r.values;return Object(w.jsx)(ar.Element,{children:Object(w.jsxs)("div",{className:"row",children:[Object(w.jsx)("div",{className:"col-lg-6",children:Object(w.jsxs)("div",{className:"card",children:[Object(w.jsx)("div",{className:"card-header bg-dark text-white",children:"Information g\xe9n\xe9rale"}),Object(w.jsxs)("div",{className:"card-body",children:[1==n.isFetching&&Object(w.jsx)("p",{children:"Recuperation des categories"}),Object(w.jsx)(ar.Field.Select,{name:"categoryId",label:"Categorie",emptyValue:!0,valueKey:"name",disabled:n.isFetching,defaultValue:1,options:t}),1==c.isFetching&&Object(w.jsx)("p",{children:"Recuperation des fournisseurs"}),Object(w.jsx)(ar.Field.Select,{name:"fournisseurId",label:"Fournisseur",emptyValue:!0,valueKey:"name",options:e,disabled:c.isFetching}),Object(w.jsx)(ar.Field.Input,{name:"name",label:"D\xe9signation",placeholder:"D\xe9signation (Tikaz 1L )"}),Object(w.jsx)(ar.Field.Select,{name:"type",label:"Type d'article",emptyValue:!1,isNumeric:!1,valueKey:"name",options:[{id:"BOLUS",name:"BOLUS"},{id:"FLACON",name:"FLACON"},{id:"UNITE",name:"UNITE"},{id:"SACHET",name:"SACHET"}]}),"FLACON"===a.type&&Object(w.jsxs)("div",{className:"ml-3",children:[Object(w.jsx)(ar.Field.Input,{name:"doseDefault",label:"Quantit\xe9 en ml ou dose ou en litre",placeholder:"Quantit\xe9 en ml ou dose ou en litre"}),Object(w.jsx)(ar.Field.Select,{name:"conditionnement",label:"Conditionnement",valueKey:"name",options:[{id:1,name:"Sans conditionnement"},{id:2,name:"Avec conditionnement"}]}),2==a.conditionnement&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(ar.Field.Input,{name:"condml",defaultValue:0,label:"Conditionnement (ML)",placeholder:"Conditionnement en ML"}),Object(w.jsx)(ar.Field.Input,{name:"condsize",defaultValue:0,label:"Diviser en combien de flacon",placeholder:"Diviser en combien de flacon"}),Object(w.jsx)(ar.Field.Input,{name:"qttccpvente",defaultValue:0,label:"Quantit\xe9 de vente en ML",placeholder:"Quantit\xe9 de vente en ML"}),Object(w.jsx)(ar.Field.Input,{name:"prixqttccvente",disabled:null==a.qttccpvente||""==a.qttccpvente,label:"Prix de vente equivalent \xe0 ".concat(a.qttccpvente," ML."),placeholder:"Prix de vente equivalent \xe0 ".concat(a.qttccpvente," ML.")})]})]})]})]})}),Object(w.jsxs)("div",{className:"col-lg-6",children:[Object(w.jsxs)("div",{className:"card",children:[Object(w.jsx)("div",{className:"card-header bg-dark text-white",children:"Vente"}),Object(w.jsxs)("div",{className:"card-body",children:[2==a.conditionnement&&Object(w.jsx)(ar.Field.Input,{name:"prixlitre",label:"Prix d'un litre",placeholder:"Prix d'un litre"}),Object(w.jsx)(ar.Field.Input,{name:"prixFournisseur",defaultValue:0,label:"prix unitaire",placeholder:"prix unitaire"}),Object(w.jsx)(ar.Field.Input,{name:"prixVente",defaultValue:0,label:"Prix de vente",placeholder:"prix de vente"}),Object(w.jsx)(ar.Field.Input,{name:"prixVaccinateur",defaultValue:0,label:"Prix du vaccinateur",placeholder:"prix du vaccinateur"}),Object(w.jsx)(w.Fragment,{children:"FLACON"===a.type&&Object(w.jsx)(ar.Field.Input,{data:0!=a.qttccpvente&&""!=a.qttccpvente&&a.prixqttccvente/a.qttccpvente!="Infinity"?a.prixqttccvente/a.qttccpvente:0,name:"prixParCC",label:"Prix de vente ml",placeholder:"Prix de vente ml"})})]})]}),Object(w.jsx)("button",{className:"btn btn-green  btn-sm ",type:"submit",children:"Ajouter"}),Object(w.jsx)("button",{className:"btn btn-danger ml-2  btn-sm ",type:"reset",children:"Annuler"})]})]})})}})]})]})})};var ra=function(){var e,t,n,c,r,i,s,o,l,d,b,m,O,h,x,v,p,f,g,y,N,C,S=Object(j.i)().id,q=Object(P.useDispatch)(),E=Object(P.useSelector)(Jn("products").value);return Object(a.useEffect)((function(){q(Xn("products").get(S))}),[]),Object(w.jsxs)(Xe,{children:[Object(w.jsx)(Ke,{title:"D\xe9tail du produit",children:Object(w.jsx)(We,{title:"D\xe9tail du produit"})}),Object(w.jsxs)($e,{children:[Object(w.jsx)("div",{className:"d-flex justify-content-end",children:Object(w.jsx)(u.b,{className:"btn btn-sm btn-warning mr-2 mb-2",to:"/price/change/".concat(S),children:"Rectification de prix"})}),2!=(null===(e=E[0])||void 0===e?void 0:e.conditionnement)||null!=(null===(t=E[0])||void 0===t?void 0:t.conditionnement)&&Object(w.jsxs)("div",{className:"card card-info",children:[Object(w.jsx)("div",{className:"card-header",children:"Conditionnement"}),Object(w.jsxs)("div",{className:"card-body",children:[Object(w.jsxs)("p",{children:["Prix d'un litre:"," ",Object(w.jsx)("span",{className:"badge badge-info",children:null===(n=E[0])||void 0===n?void 0:n.prixlitre})]}),Object(w.jsxs)("p",{children:["Conditionnement (ML):"," ",Object(w.jsx)("span",{className:"badge badge-info",children:null===(c=E[0])||void 0===c?void 0:c.condml})]}),Object(w.jsxs)("p",{children:["Division en flacon:"," ",Object(w.jsx)("span",{className:"badge badge-info",children:null===(r=E[0])||void 0===r?void 0:r.condsize})]}),Object(w.jsxs)("p",{children:["Quantit\xe9 de vente par ML:",Object(w.jsx)("span",{className:"badge badge-info",children:null===(i=E[0])||void 0===i?void 0:i.qttccpvente})]}),Object(w.jsxs)("p",{children:["Prix de vente pour ",null===(s=E[0])||void 0===s?void 0:s.qttccpvente," ML:"," ",Object(w.jsxs)("span",{className:"badge badge-info",children:[ct(null===(o=E[0])||void 0===o?void 0:o.prixqttccvente)," "]})]})]})]}),Object(w.jsxs)("table",{className:"table table-striped",children:[Object(w.jsxs)("tr",{className:"bg-thead",children:[Object(w.jsx)("td",{children:Object(w.jsx)("strong",{children:"Nom de l'article:"})}),Object(w.jsxs)("td",{children:[null===(l=E[0])||void 0===l?void 0:l.name," "]})]}),Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:Object(w.jsx)("strong",{children:"Fournisseur :"})}),Object(w.jsx)("td",{children:null===(d=E[0])||void 0===d||null===(b=d.fournisseur)||void 0===b?void 0:b.name})]}),Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:Object(w.jsx)("strong",{children:"Categorie :"})}),Object(w.jsx)("td",{children:null===(m=E[0])||void 0===m||null===(O=m.category)||void 0===O?void 0:O.name})]}),Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:Object(w.jsx)("strong",{children:"Type:"})}),Object(w.jsxs)("td",{children:[null===(h=E[0])||void 0===h?void 0:h.type," "]})]}),Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:Object(w.jsx)("strong",{children:"Dose:"})}),Object(w.jsxs)("td",{children:[null===(x=E[0])||void 0===x?void 0:x.doseDefault," ML "]})]}),Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:Object(w.jsx)("strong",{children:"Prix unitaire:"})}),Object(w.jsx)("td",{children:ct(null===(v=E[0])||void 0===v?void 0:v.prixFournisseur)})]}),Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:Object(w.jsx)("strong",{children:"Prix de vente:"})}),Object(w.jsx)("td",{children:ct(null===(p=E[0])||void 0===p?void 0:p.prixVente)})]}),Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:Object(w.jsx)("strong",{children:"Prix pour le vaccinateur:"})}),Object(w.jsx)("td",{children:ct(null===(f=E[0])||void 0===f?void 0:f.prixVaccinateur)})]}),Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:Object(w.jsx)("strong",{children:"Prix par ML:"})}),Object(w.jsx)("td",{children:0!=(null===(g=E[0])||void 0===g?void 0:g.qttccpvente)?ct((null===(y=E[0])||void 0===y?void 0:y.prixParCC)*(null===(N=E[0])||void 0===N?void 0:N.qttccpvente)):ct(null===(C=E[0])||void 0===C?void 0:C.prixParCC)})]})]})]})]})};var aa=function(){var e,t,n=Object(j.i)().id,c=Object(P.useSelector)(Jn("fournisseurs").value),r=Object(P.useSelector)(Jn("categories").value),i=Object(P.useSelector)(Jn("products").value),s=Object(P.useSelector)(Jn("products").meta),o=Object(a.useState)((e={name:"",type:"",doseDefault:"",prixlitre:"",prixVente:"",prixFournisseur:"",prixVaccinateur:"",prixParCC:"",datePer:"",uniteMesure:"ml",conditionnement:"",categoryId:""},Object(g.a)(e,"datePer",""),Object(g.a)(e,"fournisseurId",""),Object(g.a)(e,"condml",""),Object(g.a)(e,"condsize",""),Object(g.a)(e,"qttccpvente",""),Object(g.a)(e,"prixqttccvente",""),e)),l=Object(f.a)(o,2),d=l[0],u=l[1],b=Object(j.g)(),m=Object(a.useState)(1),O=Object(f.a)(m,2),h=(O[0],O[1],Object(a.useState)(1)),x=Object(f.a)(h,2),v=(x[0],x[1],Object(a.useState)(0)),p=Object(f.a)(v,2),y=p[0],N=p[1],C=Object(a.useState)(0),S=Object(f.a)(C,2),q=S[0],E=S[1],A=Object(P.useDispatch)(),D=Object(a.useState)({}),V=Object(f.a)(D,2),F=(V[0],V[1]),R=Object(a.useState)(d.type),T=Object(f.a)(R,2),M=(T[0],T[1]);return Object(a.useEffect)((function(){A(Xn("products").fetch()),M(d.type),E(d.prixqttccvente),N(d.qttccpvente)}),[n]),Object(a.useEffect)((function(){s.isFetching||(u(null===i||void 0===i?void 0:i.find((function(e){return e.id==n}))),F({name:d.name}))}),[s]),Object(a.useEffect)((function(){A(Xn("fournisseurs").fetch()),A(Xn("categories").fetch())}),[]),Object(w.jsxs)(Xe,{children:[Object(w.jsx)(Ke,{title:"Editer un produit",children:Object(w.jsx)(We,{title:"Editer un produit"})}),Object(w.jsxs)($e,{children:[""!=s.success&&null!=s.success&&Object(w.jsx)(Zr,{message:s.success}),i.name,s.error&&Object(w.jsx)(na,{error:s.error}),Object(w.jsx)(ar,{id:"add-form-product",initialValues:(t={name:d.name,type:d.type,doseDefault:d.doseDefault,prixlitre:d.prixlitre,prixVente:d.prixVente,prixFournisseur:null===d||void 0===d?void 0:d.prixFournisseur,prixVaccinateur:d.prixVaccinateur,prixParCC:d.prixParCC,datePer:d.datePer,uniteMesure:"ml",conditionnement:d.conditionnement,categoryId:d.categoryId},Object(g.a)(t,"datePer",d.datePer),Object(g.a)(t,"fournisseurId",d.fournisseurId),Object(g.a)(t,"condml",null==d.condml?0:d.condml),Object(g.a)(t,"condsize",null==d.condsize?0:d.condsize),Object(g.a)(t,"qttccpvente",null==d.qttccpvente?0:d.qttccpvente),Object(g.a)(t,"prixqttccvente",null==d.prixqttccvente?0:d.prixqttccvente),t),validations:Jr,onSubmit:function(e,t){var n=e.name,c=e.type,r=e.doseDefault,a=e.prixlitre,i=e.prixVente,s=e.prixFournisseur,o=e.prixVaccinateur,l=e.prixParCC,u=e.datePer,j=e.fournisseurId,m=e.categoryId,O=e.condml,h=(e.condval,e.qttccpvente),x=e.prixqttccvente,v=e.conditionnement,p=e.condsize;A(Xn("products").update({id:d.id,name:n,type:c,doseDefault:r,prixVente:parseFloat(i),prixFournisseur:parseFloat(s),prixVaccinateur:parseFloat(o),prixlitre:parseFloat(a),prixParCC:parseFloat(l),datePer:new Date(u),qttByCC:parseFloat(d.qttByCC),quantityBrute:parseFloat(d.quantityBrute),quantityBruteCVA:parseFloat(d.quantityBruteCVA),quantityCCCVA:parseFloat(d.quantityCCCVA),quantityCC:parseFloat(d.quantityCC),uniteMesure:"ml",condml:parseFloat(O),condsize:parseFloat(p),qttccpvente:parseFloat(h),fournisseurId:parseInt(j),categoryId:parseInt(m),conditionnement:parseInt(v),prixqttccvente:parseInt(x),updatedAt:new Date,refSortie:"0",refQtSortie:0,qttByCCDepot:0,condmldepot:0,condvaldepot:0,qttyspecificmirror:0,qttccpventedepot:0,prixqttccventedepot:0,quantityParProductDepot:0,condsizedepot:0,qttbylitre:0,remise:0,condval:0,correction:0,correctionml:0,correctionl:0,correctiontml:0,correctiontl:0,correctiontype:0})),b.push(se)},render:function(e){var t=e.values;return Object(w.jsx)(ar.Element,{children:Object(w.jsxs)("div",{className:"row",children:[Object(w.jsx)("div",{className:"col-lg-6",children:Object(w.jsxs)("div",{className:"card",children:[Object(w.jsx)("div",{className:"card-header bg-dark text-white",children:"Information g\xe9n\xe9rale"}),Object(w.jsxs)("div",{className:"card-body",children:[Object(w.jsx)(ar.Field.Select,{name:"categoryId",label:"Categorie",valueKey:"name",selectValue:d.categoryId,options:r}),Object(w.jsx)(ar.Field.Select,{name:"fournisseurId",label:"Fournisseur",valueKey:"name",selectValue:d.fournisseurId,options:c}),Object(w.jsx)(ar.Field.Input,{name:"name",value:null===t||void 0===t?void 0:t.name,label:"D\xe9signation",placeholder:"D\xe9signation"}),Object(w.jsx)(ar.Field.Select,{name:"type",label:"Type d'article",emptyValue:!1,isNumeric:!1,valueKey:"name",options:[{id:"BOLUS",name:"BOLUS"},{id:"FLACON",name:"FLACON"},{id:"UNITE",name:"UNITE"},{id:"SACHET",name:"SACHET"}]}),"FLACON"===t.type&&Object(w.jsxs)("div",{className:"ml-3",children:[Object(w.jsx)(ar.Field.Input,{name:"doseDefault",label:"Quantit\xe9 en ml ou dose ou litre",placeholder:"Quantit\xe9 en ml ou dose ou litre"}),Object(w.jsx)(ar.Field.Select,{name:"conditionnement",label:"Conditionnement",valueKey:"name",emptyValue:!1,options:[{id:1,name:"Sans conditionnement"},{id:2,name:"Avec conditionnement"}]}),2==t.conditionnement&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(ar.Field.Input,{name:"condml",label:"Conditionnement (ML)",placeholder:"Conditionnement en ML"}),Object(w.jsx)(ar.Field.Input,{name:"condsize",label:"Diviser en combien de flacon",placeholder:"Diviser en combien de flacon"}),Object(w.jsx)(ar.Field.Input,{name:"qttccpvente",label:"Quantit\xe9 de vente en ML",placeholder:"Quantit\xe9 de vente en ML"}),Object(w.jsx)(ar.Field.Input,{name:"prixqttccvente",value:null===t||void 0===t?void 0:t.prixqttccvente,disabled:null==t.qttccpvente||""==t.qttccpvente,label:"Prix de vente equivalent \xe0 ".concat(t.qttccpvente," ML."),placeholder:"Prix de vente equivalent \xe0 ".concat(t.qttccpvente," ML.")})]})]})]})]})}),Object(w.jsxs)("div",{className:"col-lg-6",children:[Object(w.jsxs)("div",{className:"card",children:[Object(w.jsx)("div",{className:"card-header bg-dark text-white",children:"Vente"}),Object(w.jsxs)("div",{className:"card-body",children:[Object(w.jsx)(ar.Field.Input,{name:"prixFournisseur",value:null===t||void 0===t?void 0:t.prixFournisseur,label:"prix unitaire",placeholder:"prix unitaire"}),2==t.conditionnement&&Object(w.jsx)(ar.Field.Input,{name:"prixlitre",value:null===t||void 0===t?void 0:t.prixlitre,label:"Prix d'un litre",placeholder:"Prix d'un litre"}),Object(w.jsx)(ar.Field.Input,{name:"prixVente",label:"Prix de vente",value:null===t||void 0===t?void 0:t.prixVente,placeholder:"prix de vente"}),"FLACON"===t.type&&Object(w.jsx)(ar.Field.Input,{type:"text",data:0!=y&&""!=y&&q/y!="Infinity"?q/y:0,name:"prixParCC",label:"Prix de vente ml",placeholder:"Prix de vente ml"}),Object(w.jsx)(ar.Field.Input,{value:null===t||void 0===t?void 0:t.prixVaccinateur,name:"prixVaccinateur",label:"Prix du vaccinateur",placeholder:"prix du vaccinateur"})]})]}),Object(w.jsx)("button",{className:"btn btn-green  btn-sm ",type:"submit",children:"Editer"}),Object(w.jsx)("button",{className:"btn btn-danger ml-2 btn-sm ",type:"reset",children:"Annuler"})]})]})})}})]})]})};c(408),c(409);var ia=function(e){var t=e.model,n=e.entity,c=e.attribute,r=Object(P.useDispatch)();return Object(j.g)(),Object(w.jsx)(w.Fragment,{children:Object(w.jsx)("button",{className:"btn btn-danger btn-sm",onClick:function(e){e.preventDefault(),window.confirm('Vous voulez vraiment supprimer "'.concat(n[c],'" ?'))&&r(Xn(t).destroy(n))},children:"Supprimer"})})};c(1343),c(1344),c(1345),c(1338),c(143);var sa=function(e){var t=e.route,n=e.edit,c=void 0===n?[]:n,r=e.detail,a=void 0===r?[]:r,i=e.remove,s=void 0===i?[]:i,o=e.model,l=e.modelKey,d=e.data;return Object(w.jsxs)("div",{children:[Object(w.jsx)(E,{scopes:a,children:Object(w.jsx)(u.b,{className:"btn btn-sm btn-primary mr-2",to:"/".concat(t,"/detail/").concat(d.row.original.id),children:"Detail"})}),Object(w.jsx)(E,{scopes:c,children:Object(w.jsx)(u.b,{className:"btn btn-sm btn-warning mr-2",to:"/".concat(t,"/edit/").concat(d.row.original.id),children:"Editer"})}),Object(w.jsx)(E,{scopes:s,children:Object(w.jsx)(ia,{model:o,entity:d.row.original,attribute:l})})]})},oa=function(){var e=Object(P.useSelector)(Jn("products").value)||[],t=Object(P.useSelector)(Jn("products").meta),n=(Object(a.useRef)(),Object(P.useDispatch)());Object(j.g)();Object(a.useEffect)((function(){n(Xn("products").fetch())}),[]);var c=[{Header:"Id",accessor:"id"},{Header:"Produit",accessor:"name"},{Header:"Fournisseur",Cell:function(e){var t,n,c;return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)("span",{className:"badge badge-primary",children:null!=(null===(t=e.row.original)||void 0===t?void 0:t.fournisseur)?null===(n=e.row.original)||void 0===n||null===(c=n.fournisseur)||void 0===c?void 0:c.name:""})})}},{Header:"Quantit\xe9",accessor:"quantityBrute"},{Header:"Reste en ML",accessor:"quantityCC"},{Header:"Prix unitaire",Cell:function(e){var t;return Object(w.jsx)("div",{children:ct(null===(t=e.row.original)||void 0===t?void 0:t.prixFournisseur)})}},{Header:"Prix de vente",Cell:function(e){var t;return Object(w.jsx)("div",{children:ct(null===(t=e.row.original)||void 0===t?void 0:t.prixVente)})}},{Header:"Prix en ML",Cell:function(e){var t,n,c,r;return Object(w.jsx)("div",{children:0!=(null===(t=e.row.original)||void 0===t?void 0:t.qttccpvente)?ct((null===(n=e.row.original)||void 0===n?void 0:n.prixParCC)*(null===(c=e.row.original)||void 0===c?void 0:c.qttccpvente)):ct(null===(r=e.row.original)||void 0===r?void 0:r.prixParCC)})}},{Header:"Actions",Cell:function(e){return Object(w.jsx)(sa,{edit:[S.canShowEditProduit],detail:[S.canShowDetailProduit],remove:[S.canShowDeleteProduit],route:"product",model:"products",modelKey:"name",data:e})}}];return Object(w.jsxs)(Xe,{children:[Object(w.jsx)(Ke,{title:"Tous les produits",children:Object(w.jsx)(We,{title:"Tous les produits"})}),Object(w.jsx)($e,{children:Object(w.jsx)(mr,{data:e,scopes:[S.canShowAddProduit],meta:t,columns:c,addUrl:ie,urlName:"Ajouter un produit"})})]})};var la=function(){var e=Object(P.useSelector)(Jn("products").value),t=Object(P.useSelector)(Jn("categories").value),n=Object(P.useDispatch)(),c=Object(a.useState)(1),r=Object(f.a)(c,2),i=r[0],s=r[1];return Object(a.useEffect)((function(){n(function(e){return Ln("products",{path:"/product/category?id=".concat(e),replace:!0})}(i)),n(Xn("categories").fetch())}),[i]),Object(w.jsxs)(Xe,{children:[Object(w.jsx)(Ke,{title:"Liste des articles par categories",children:Object(w.jsx)(We,{title:"Liste des articles par categories"})}),Object(w.jsxs)($e,{children:[Object(w.jsxs)("div",{className:"row",children:[Object(w.jsx)("div",{className:"col-lg-8"}),Object(w.jsx)("div",{className:"col-lg-4",children:Object(w.jsxs)("div",{className:"d-flex align-items-center mb-3",children:[Object(w.jsx)("label",{htmlFor:"",children:"Categorie:"}),Object(w.jsx)("select",{className:"form-control",onChange:function(e){s(e.target.value)},children:t.map((function(e){return Object(w.jsx)("option",{value:e.id,children:e.name})}))})]})})]}),Object(w.jsxs)("table",{className:"table table-bordered table-striped",children:[Object(w.jsx)("thead",{className:"bg-thead",children:Object(w.jsxs)("tr",{children:[Object(w.jsx)("th",{children:"Nom"}),Object(w.jsx)("th",{children:"Prix Unitaire"}),Object(w.jsx)("th",{children:"Categorie"}),Object(w.jsx)("th",{children:"Actions"})]})}),Object(w.jsx)("tbody",{children:e.map((function(e){var t;return Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:null===e||void 0===e?void 0:e.name}),Object(w.jsx)("td",{children:ct(null===e||void 0===e?void 0:e.prixFournisseur)}),Object(w.jsx)("td",{children:null===e||void 0===e||null===(t=e.category)||void 0===t?void 0:t.name}),Object(w.jsx)("td",{children:Object(w.jsx)(u.b,{className:"btn btn-sm btn-primary",to:"/product/detail/".concat(e.id),children:"Detail"})})]})}))})]})]})]})};var da=function(){var e=Object(P.useSelector)(Jn("products").value),t=Object(P.useSelector)(Jn("fournisseurs").value),n=Object(P.useDispatch)(),c=Object(a.useState)(1),r=Object(f.a)(c,2),i=r[0],s=r[1];return Object(a.useEffect)((function(){n(function(e){return Ln("products",{path:"/product/fournisseur?id=".concat(e),replace:!0})}(i)),n(Xn("fournisseurs").fetch())}),[i]),Object(w.jsxs)(Xe,{children:[Object(w.jsx)(Ke,{title:"Liste des articles par fournisseurs",children:Object(w.jsx)(We,{title:"Liste des articles par fournisseurs"})}),Object(w.jsxs)($e,{children:[Object(w.jsxs)("div",{className:"row",children:[Object(w.jsx)("div",{className:"col-lg-8"}),Object(w.jsx)("div",{className:"col-lg-4",children:Object(w.jsxs)("div",{className:"d-flex align-items-center mb-3",children:[Object(w.jsx)("label",{htmlFor:"",children:"Fournisseur:"}),Object(w.jsx)("select",{className:"form-control",onChange:function(e){s(e.target.value)},children:t.map((function(e){return Object(w.jsx)("option",{value:e.id,children:e.name})}))})]})})]}),Object(w.jsxs)("table",{className:"table table-bordered table-striped",children:[Object(w.jsx)("thead",{children:Object(w.jsxs)("tr",{children:[Object(w.jsx)("th",{children:"Nom"}),Object(w.jsx)("th",{children:"Prix"}),Object(w.jsx)("th",{children:"Fournisseur"}),Object(w.jsx)("td",{children:"Actions"})]})}),Object(w.jsx)("tbody",{children:e.map((function(e){var t;return Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:null===e||void 0===e?void 0:e.name}),Object(w.jsx)("td",{children:ct(null===e||void 0===e?void 0:e.prixFournisseur)}),Object(w.jsx)("td",{children:null===e||void 0===e||null===(t=e.fournisseur)||void 0===t?void 0:t.name}),Object(w.jsx)("td",{children:Object(w.jsx)(u.b,{className:"btn btn-sm btn-primary",to:"/product/detail/".concat(e.id),children:"Detail"})})]})}))})]})]})]})},ua=function(){var e=Object(P.useSelector)(Jn("products").value),t=Object(P.useSelector)(Jn("products").meta),n=Object(P.useDispatch)();Object(a.useEffect)((function(){n(Ln("products",{path:"/rupture/stock",replace:!0}))}),[]);var c=i.a.useMemo((function(){return[{Header:"Produit",accessor:"name"},{Header:"Quantit\xe9",accessor:"quantityBrute"},{Header:"Date de peremption",Cell:function(e){var t;return Object(w.jsx)("h3",{children:nt(null===(t=e.row.original)||void 0===t?void 0:t.datePer)})}}]}),[]);return Object(w.jsxs)(Xe,{children:[Object(w.jsx)(Ke,{title:"Article en rupture de stock",children:Object(w.jsx)(We,{title:"Article en rupture de stock"})}),Object(w.jsx)($e,{children:Object(w.jsx)(mr,{data:e,meta:t,columns:c})})]})},ja=c(1346);var ba=function(){var e=Object(a.useState)(new Date),t=Object(f.a)(e,2),n=t[0],c=t[1],r=Object(a.useState)(new Date),i=Object(f.a)(r,2),s=i[0],o=i[1],l=function(e){if(!e||0===(null===e||void 0===e?void 0:e.length))return 0;var t=0;return e.forEach((function(e){t+=e.prixVente})),t},d=function(e){if(!e||0===(null===e||void 0===e?void 0:e.length))return 0;var t=0;return e.forEach((function(e){t+=e.quantityBrute})),t},j=function(e){if(!e||0===(null===e||void 0===e?void 0:e.length))return 0;var t=0;return e.forEach((function(e){t+=e.quantityCC})),t},b=Object(a.useRef)(null),m=Object(a.useRef)(null),O=Object(P.useSelector)(Jn("commandes").value),h=Object(P.useDispatch)();return Object(a.useEffect)((function(){h(function(e,t){return Ln("commandes",{path:"/entree?deb=".concat(e,"&fin=").concat(t),replace:!0})}(n,s))}),[n,s]),Object(w.jsxs)(Xe,{children:[Object(w.jsx)(Ke,{title:"Factures",children:Object(w.jsx)(We,{title:"Factures"})}),Object(w.jsxs)($e,{children:[Object(w.jsxs)("div",{className:"row",children:[Object(w.jsx)("div",{className:"col-lg-4 mb-2",children:Object(w.jsx)(u.b,{to:"/approv",className:"btn  btn-primary",children:" Effectuer un approvisionnement"})}),Object(w.jsx)("div",{className:"col-lg-8"})]}),Object(w.jsxs)("div",{className:"border p-3 bg-white",children:[Object(w.jsxs)("div",{className:"row mb-3",children:[Object(w.jsx)("div",{className:"col-lg-7"}),Object(w.jsx)("div",{className:"col-lg-5",children:Object(w.jsxs)("div",{className:"d-flex justify-content-around",children:[Object(w.jsx)("input",{type:"date",name:"datedeb",className:"form-control mr-3",format:"DD-MM-YYYY",ref:b,placeholder:"D\xe9but"}),Object(w.jsx)("input",{type:"date",name:"datefin",className:"form-control mr-3",ref:m,placeholder:"Fin"}),Object(w.jsx)(ja.a,{onClick:function(){c(b.current.value),o(m.current.value)},children:"Filtrer"})]})})]}),Object(w.jsxs)("table",{className:"table table-bordered table-striped",children:[Object(w.jsx)("thead",{children:Object(w.jsxs)("tr",{children:[Object(w.jsx)("th",{children:"Date"}),Object(w.jsx)("th",{children:"Quantite Brute"}),Object(w.jsx)("th",{children:"Quantite en CC"}),Object(w.jsx)("th",{children:"Montant Total"}),Object(w.jsx)("th",{children:"Actions"})]})}),Object(w.jsx)("tbody",{children:O.map((function(e){return Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:null===e||void 0===e?void 0:e.createdAt}),Object(w.jsx)("td",{children:d(null===e||void 0===e?void 0:e.contenu)}),Object(w.jsx)("td",{children:j(null===e||void 0===e?void 0:e.contenu)}),Object(w.jsx)("td",{children:Object(w.jsx)(or.a,{value:l(null===e||void 0===e?void 0:e.contenu),displayType:"text",thousandSeparator:!0,suffix:"Ar",renderText:function(e,t){return Object(w.jsx)("div",Object(dt.a)(Object(dt.a)({},t),{},{children:e}))}})}),Object(w.jsx)("td",{className:"d-flex justify-content-around",children:Object(w.jsx)(u.b,{className:"btn btn-sm  btn-success",to:"detail/".concat(e.id),children:"Afficher le detail"})})]})}))})]})]})]})]})},ma="ROLE_VENDEUR",Oa=Object(b.a)(),ha=Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).SIGNUP_URL||"http://localhost:8100/api/signup",xa=(Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).SIGNIN_URL,Object(j.j)((function(){return Object(w.jsxs)(i.a.Fragment,{children:[Object(w.jsx)("div",{className:"bg-dark m-0  p-2  text-center",children:Object(w.jsx)("h3",{className:"m-0 p-2 text-white",children:"CABINET VETERINAIRE AMBALAVAO"})}),Object(w.jsxs)("ul",{className:"list-inline d-flex m-0  p-2 justify-content-center",children:[Object(w.jsx)("li",{className:"text-white  m-0  p-2",children:Object(w.jsx)(u.b,{className:"btn  btn-sm bg-success text-white",to:"/journal",children:"Journal d'entrees et sorties"})}),Object(w.jsx)("li",{className:"text-white  m-0  p-2",children:Object(w.jsx)(u.b,{className:"btn  btn-sm bg-success text-white",to:he,children:"Entree"})}),Object(w.jsx)("li",{className:"text-white  m-0  p-2",children:Object(w.jsx)(u.b,{className:"btn  btn-sm bg-success text-white",to:xe,children:"Sortie"})}),Object(w.jsx)("li",{className:"text-white m-0  p-2",children:Object(w.jsx)(u.b,{className:"btn btn-sm bg-success text-white",to:"/products",children:"Articles"})}),Object(w.jsx)("li",{className:"text-white m-0  p-2",children:Object(w.jsx)(u.b,{className:"btn bg-success btn-sm text-white",to:"/credit",children:"Credit"})}),Object(w.jsx)("li",{className:"text-white m-0  p-2",children:Object(w.jsx)(u.b,{className:"btn bg-success btn-sm text-white",to:ue,children:"Credit Vaccinateur"})}),Object(w.jsx)("li",{className:"text-white m-0  p-2",children:Object(w.jsx)(u.b,{className:"btn bg-success btn-sm text-white",to:je,children:"Commande direct"})}),Object(w.jsx)("li",{className:"text-white m-0  p-2",children:Object(w.jsx)(u.b,{className:"btn bg-success btn-sm text-white",to:me,children:"Produit par fournisseur"})}),Object(w.jsx)("li",{className:"text-white m-0  p-2",children:Object(w.jsx)(u.b,{className:"btn bg-success btn-sm text-white",to:Oe,children:"Produit par category"})}),Object(w.jsx)("li",{className:"text-white m-0  p-2",children:Object(w.jsx)(u.b,{className:"btn  btn-sm bg-success text-white",to:"/",children:"Bon de sortie"})}),Object(w.jsx)("li",{className:"text-white m-0  p-2",children:Object(w.jsx)(u.b,{className:"btn  btn-sm bg-success text-white",to:"/approv",children:"Article \xe0 approvisionner"})}),Object(w.jsx)("li",{className:"text-white m-0  p-2",children:Object(w.jsx)(u.b,{className:"btn  btn-sm bg-success text-white",to:"/perimes",children:"Article perim\xe9"})}),Object(w.jsx)("li",{className:"text-white m-0  p-2",children:Object(w.jsx)(u.b,{className:"btn  btn-sm bg-success text-white",to:be,children:"Parametres"})})]})]})})),"SET_APPROV_ITEMS"),va="ADD_TO_APPROV",pa="REMOVE_FROM_APPROV",fa="CLEAR_APPROV",ga="ADD_QTY_APPROV_ITEM",ya="MINUS_QTY_APPROV_ITEM",Na="ADD_NUMBER_QTY_ITEM",Ca="ADD_QTY_NUMBER_APPROV_ITEM",Sa="ADD_REMISE_PER_PRODUCT",qa="ADD_REMISE_PER_PRODUCT_PERCENT",wa=function(){return{type:fa}},Ea=function(e,t){return{type:Sa,payload:{id:e,value:t}}},Aa=function(e,t){var n=function(t){return!!(null===e||void 0===e?void 0:e.find((function(e){return(null===e||void 0===e?void 0:e.id)===t})))};return{approvisionnement:e,isItemOnApprov:n,addToApprov:function(e){n(e.id)?t(function(e){return{type:pa,payload:e}}(e.id)):t(function(e){return{type:va,payload:e}}(e))}}},Da=function(e){var t,n=e.key,c=e.product,r=e.isItemOnApprov,a=e.handleAddToApprov;return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(pr.a.Item,{children:Object(w.jsxs)(fr.a,{className:"product-card m-2 ".concat(c.id?"":"product-loading"),style:{border:c&&r(c.id)?"1px solid #a6a5a5":"",boxShadow:c&&r(c.id)?"0 10px 15px rgba(0, 0, 0, .07)":"none"},children:[Object(w.jsx)(gr.a,{xs:9,children:Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("p",{children:null===c||void 0===c?void 0:c.name}),Object(w.jsx)("div",{class:"badge badge-primary",children:null===c||void 0===c||null===(t=c.fournisseur)||void 0===t?void 0:t.name}),Object(w.jsx)("p",{children:Object(w.jsxs)("strong",{children:[" ",ct(null===c||void 0===c?void 0:c.prixFournisseur)]})})]})}),Object(w.jsx)(gr.a,{xs:3,children:(null===c||void 0===c?void 0:c.id)&&Object(w.jsx)("button",{className:" ".concat(r(c.id)?"btn btn-danger btn-sm":"btn btn-green btn-sm"),onClick:function(){return a(c)},children:r(c.id)?"Retirer":"Ajouter"})})]})},n)})},Pa=i.a.memo(Da),Va=function(e){var t=e.product,n=Object(P.useDispatch)(),c=function(e){n(function(e,t){return{type:Ca,payload:{id:e,value:t}}}(t.id,e))};return Object(w.jsx)("div",{className:"basket-item-control",children:Object(w.jsxs)(Xc.c,{w:28,bg:"whitesmoke",onChange:function(e){c(Number(e))},min:0,defaultValue:t.quantityParProduct,children:[Object(w.jsx)(Xc.d,{}),Object(w.jsxs)(Xc.e,{children:[Object(w.jsx)(Xc.b,{}),Object(w.jsx)(Xc.a,{})]})]})})},Fa=function(e){var t=e.product,n=e.isItemOnApprov,c=e.addToApprov,r=(Object(P.useDispatch)(),!!n&&n(t.id));return Object(w.jsx)("div",{children:Object(w.jsxs)("div",{className:"d-flex justify-content-between align-items-start border   mb-2 p-2",children:[Object(w.jsx)("div",{style:{width:"65%"},children:Object(w.jsxs)("table",{border:"1",children:[Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:"Nom du produit : "}),Object(w.jsx)("td",{children:null===t||void 0===t?void 0:t.name})]}),Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:"Prix unitaire:"}),Object(w.jsx)("td",{children:ct(t.prixFournisseur)})]}),Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:"Montant HT:"}),Object(w.jsx)("td",{children:ct(t.prixFournisseur*t.quantityParProduct-t.remise)})]})]})}),Object(w.jsx)("div",{className:"d-flex mt-3",children:Object(w.jsx)(Va,{product:t})}),Object(w.jsx)("div",{children:r&&Object(w.jsx)("button",{onClick:function(){c&&c(t)},className:"btn btn-danger btn-xs text-right",children:"X"})})]})})},Ra=function(e){return!(0==e.condml||0==e.condsize||0==e.qttccpvente||0==e.prixqttccvente)},Ta=function(e){return e&&0!==(null===e||void 0===e?void 0:e.length)?e.reduce((function(e,t){return e+t}),0):0};function Ma(e){var t,n,c;for(c in t=Array.isArray(e)?[]:{},e)n=e[c],t[c]="object"===typeof n?Ma(n):n;return t}var Ba=function(e,t){return Ta(e)-t},ka=function(e){e.setRegenerate;var t=Object(a.useState)(0),n=Object(f.a)(t,2),c=n[0],r=n[1],i=Object(a.useState)(new Date),s=Object(f.a)(i,2),o=s[0],l=s[1],d=Object(a.useState)(null),u=Object(f.a)(d,2),b=u[0],m=u[1],O=Object(a.useState)(""),h=Object(f.a)(O,2),x=h[0],v=h[1],p=Object(a.useState)("espece"),g=Object(f.a)(p,2),y=g[0],N=g[1],C=Object(P.useSelector)(Jn("approvis").meta),S=Object(P.useDispatch)(),q=Object(j.g)();Object(a.useEffect)((function(){S(Xn("approvis").fetch())}),[]);var E=Object(P.useSelector)((function(e){return{approvisionnements:e.approvisionnements}})).approvisionnements,A=Aa(E,S),D=A.isItemOnApprov,V=A.addToApprov,F=function(e){return Ma(e).map((function(e){return e.quantityBrute+=e.quantityParProduct,e}))};return Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)(lr.a,{children:[Object(w.jsx)(lr.a.Header,{className:"d-flex justify-content-between align-items-center bg-dark text-white",children:Object(w.jsxs)("div",{children:["Factures ("," ".concat(E.length," ").concat(E.length>1?"produits":"produit"),")"]})}),Object(w.jsxs)(lr.a.Body,{children:[Object(w.jsxs)("div",{class:"form-group",children:[Object(w.jsx)("label",{children:"Date du facture :"}),Object(w.jsx)("div",{children:Object(w.jsx)("input",{type:"date",onChange:function(e){return m(e.target.value)},value:b,className:"form-control"})})]}),E.length<=0&&Object(w.jsx)("div",{class:"alert alert-success ",children:"Aucune produit !!!"}),null===E||void 0===E?void 0:E.map((function(e,t){return Object(w.jsx)(Fa,{product:e,isItemOnApprov:D,addToApprov:V,approvisionnement:E,dispatch:S},"".concat(null===e||void 0===e?void 0:e.id,"_").concat(t))})),E.length>0&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("div",{className:"d-flex justify-content-end align-items-center my-3 ",children:Object(w.jsxs)("table",{children:[Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:"REMISE : (en Ariary)"}),Object(w.jsx)("td",{children:Object(w.jsx)("input",{type:"number",className:"form-control",placeholder:"Remise",min:0,value:c,max:100,onChange:function(e){r(e.target.value)}})})]}),Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:"PAIEMENT LE :"}),Object(w.jsx)("td",{children:Object(w.jsx)("input",{type:"date",onChange:function(e){return l(e.target.value)},value:o,className:"form-control"})})]}),Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:"TYPE DE PAIEMENT:"}),Object(w.jsx)("td",{children:Object(w.jsxs)("select",{className:"form-control",onChange:function(e){N(e.target.value)},children:[Object(w.jsx)("option",{value:"espece",selected:!0,children:"ESPECE"}),Object(w.jsx)("option",{value:"boa",children:"CHEQUE - BOA"}),Object(w.jsx)("option",{value:"bni",children:"CHEQUE - BNI"}),Object(w.jsx)("option",{value:"MVola",children:"VIREMENT - MVola"}),Object(w.jsx)("option",{value:"OrangeMoney",children:"VIREMENT - ORANGE MONEY"})]})})]}),Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:"REMARQUE :"}),Object(w.jsx)("td",{children:Object(w.jsx)("textarea",{className:"form-control",onChange:function(e){v(e.target.value)},placeholder:"Ecriver ici quelque chose d'autre \xe0 savoir sur l'approvisionnement"})})]})]})}),Object(w.jsxs)("div",{className:"d-flex flex-column  my-3 ",children:[" ",Object(w.jsxs)("p",{className:"approvisionnement-total-amount",children:["Total HT:",Object(w.jsx)("strong",{children:Object(w.jsx)(or.a,{value:Ta(E.map((function(e){return e.prixFournisseur*e.quantityParProduct}))),displayType:"text",thousandSeparator:!0,suffix:"Ar",renderText:function(e,t){return Object(w.jsx)("div",Object(dt.a)(Object(dt.a)({},t),{},{children:e}))}})})]}),Object(w.jsxs)("p",{className:"approvisionnement-total-amount",children:["Remise:",Object(w.jsx)("strong",{children:Object(w.jsx)(or.a,{value:Ta(E.map((function(e){return e.prixFournisseur*e.quantityParProduct-e.remise}))),displayType:"text",thousandSeparator:!0,suffix:"Ar",renderText:function(e,t){return Object(w.jsx)("div",Object(dt.a)(Object(dt.a)({},t),{},{children:e}))}})})]}),Object(w.jsxs)("p",{className:"approvisionnement-total-amount",children:["Total avec remise :",Object(w.jsx)("strong",{children:Object(w.jsx)(or.a,{value:Ba(E.map((function(e){return e.prixFournisseur*e.quantityParProduct})),c),displayType:"text",thousandSeparator:!0,suffix:"Ar",renderText:function(e,t){return Object(w.jsx)("div",Object(dt.a)(Object(dt.a)({},t),{},{children:e}))}})})]}),Object(w.jsx)("p",{children:"Arr\xeat\xe9 \xe0 la somme de "}),Object(w.jsx)("p",{className:"text-uppercase",children:Object(w.jsxs)("strong",{children:[Object(sr.NumberToLetter)(Ba(E.map((function(e){return e.prixFournisseur*e.quantityParProduct})),c))," ","ARIARY"]})})]}),Object(w.jsxs)("div",{className:"d-flex justify-content-end",children:[Object(w.jsx)("button",{className:"btn btn-green btn-sm mr-2",disabled:0===E.length,onClick:function(){S(Xn("approvis").createTransaction({id:Number(C.nextId),contenu:F(E),totalht:Ta(E.map((function(e){return e.prixFournisseur*e.quantityParProduct-e.remise}))),remise:c,total:Ba(E.map((function(e){return e.prixFournisseur*e.quantityParProduct-e.remise})),c),dateApprov:null==b?new Date:b,dateEcheance:o,remarque:x,typePaye:y,approvisionnements:E},"create-facture")),E.forEach((function(e){S(Xn("products").update(Object(dt.a)(Object(dt.a)({},e),{},{quantityBrute:e.quantityBrute+e.quantityParProduct,quantityParProduct:0})))})),S(wa()),q.push(fe),console.log(E)},type:"button",children:"Valider l'operation"}),Object(w.jsx)("button",{className:"btn btn-danger btn-sm",onClick:function(){0!==E.length&&S(wa())},type:"button",children:Object(w.jsx)("span",{children:"Annuler"})})]})]})]}),E.length>0&&Object(w.jsx)(lr.a.Footer,{className:"d-flex flex-column"})]})})};function _a(e){var t,n,c;for(c in t=Array.isArray(e)?[]:{},e)n=e[c],t[c]="object"===typeof n?_a(n):n;return t}var Ia=function(e,t){return _a(e).filter((function(e){return""==t||e.fournisseurId==t}))};function La(e){return e.toString().replace(/\s/g,"").toLowerCase()}function Qa(e){var t,n,c;for(c in t=Array.isArray(e)?[]:{},e)n=e[c],t[c]="object"===typeof n?Qa(n):n;return t}var Ha=function(e,t,n){return Qa(e).filter((function(e){return(""==t||La(e.name).includes(La(t)))&&(""==n||e.fournisseurId==n)}))},Ua=c(630),Ya=c.n(Ua),Ka=function(){var e=Object(P.useSelector)((function(e){return e.approvisionnements})),t=Object(P.useSelector)(Jn("products").value),n=Object(P.useSelector)(Jn("products").meta),c=Object(P.useDispatch)(),r=Aa(e,c),a=r.isItemOnApprov,s=r.addToApprov,o=i.a.useState([]),l=Object(f.a)(o,2),d=l[0],u=l[1],j=i.a.useState(!1),b=Object(f.a)(j,2),m=b[0],O=b[1];i.a.useEffect((function(){return 1==m&&(c(Xn("products").fetch()),O(!1)),function(){O(!1)}}),[m]),i.a.useEffect((function(){c(Xn("products").fetch())}),[]),i.a.useEffect((function(){n.isFetching||u(t)}),[n]);var h=i.a.useCallback((function(e){s&&s(e)}),[s]),x=i.a.useMemo((function(){return d.map((function(e){return Object(w.jsx)(Pa,{product:e,isItemOnApprov:a,handleAddToApprov:h},e.id)}))}),[d]),v=function(e){null!=e.target&&u(Mr(t,e.target.value))};i.a.useMemo((function(){return Ya()(v,300)}),[v]);return Object(w.jsxs)("div",{children:[Object(w.jsx)("input",{type:"text",onKeyDown:function(e){13==e.keyCode&&v(e)},placeholder:"Taper sur entrer pour valider votre recherche",className:"form-control mb-2"}),Object(w.jsxs)("div",{style:{overflowY:"auto",height:"350px",maxHeight:"350px",overflowX:"hidden"},children:[Object(w.jsxs)(w.Fragment,{children:[x,0==d.length&&"Aucun produit trouv\xe9"]})," "]})]})},za=i.a.memo(Ka,He.reactFastCompare),Wa=(Object(qn.debounce)((function(e){console.log("request: ".concat(e))}),1e3),function(){return Object(w.jsxs)(Xe,{children:[Object(w.jsx)(Ke,{title:"Nouvelle facture",children:Object(w.jsx)(We,{title:"Nouvelle Facture"})}),Object(w.jsx)($e,{children:Object(w.jsx)(Fr.a,{children:Object(w.jsxs)(fr.a,{children:[Object(w.jsx)(gr.a,{xs:5,children:Object(w.jsx)(pr.a,{children:Object(w.jsxs)(lr.a,{children:[Object(w.jsx)(lr.a.Header,{className:"d-flex justify-content-between align-items-center bg-dark text-white",children:"Produits"}),Object(w.jsx)(lr.a.Body,{children:Object(w.jsx)(za,{})})]})})}),Object(w.jsx)(gr.a,{xs:7,children:Object(w.jsx)(ka,{setRegenerate:[]})})]})})})]})}),Ga=i.a.memo(Wa),Xa=c(1357),Ja=c(1358);var $a=function(){var e=Object(P.useSelector)(Jn("categories").value),t=Object(P.useSelector)(Jn("categories").meta),n=Object(P.useDispatch)();i.a.useEffect((function(){n(Xn("categories").fetch())}),[]);var c=[{Header:"Nom",accessor:"name"},{Header:"Actions",Cell:function(e){return Object(w.jsx)(sa,{edit:[S.canEditCategory],detail:[S.canViewCategory],remove:[S.canDeleteCategory],route:"categories",model:"categories",modelKey:"name",data:e})}}];return Object(w.jsxs)(Xe,{children:[Object(w.jsx)(Ke,{title:"Categories",children:Object(w.jsx)(We,{title:"Categories"})}),Object(w.jsx)($e,{children:Object(w.jsx)(mr,{scopes:[S.canCreateCategory],data:e.sort((function(e,t){return t.id-e.id})),meta:t,columns:c,addUrl:Ve,urlName:"Ajouter une categorie"})})]})};var Za=function(){var e=Object(P.useSelector)(Jn("fournisseurs").value),t=Object(P.useSelector)(Jn("fournisseurs").meta),n=Object(P.useDispatch)();i.a.useEffect((function(){n(Xn("fournisseurs").fetch())}),[]);var c=[{Header:"Nom",accessor:"name"},{Header:"Actions",Cell:function(e){return Object(w.jsx)(sa,{edit:[S.canEditFournisseurs],detail:[S.canViewFournisseurs],remove:[S.canDeleteFournisseurs],route:"fournisseurs",model:"fournisseurs",modelKey:"name",data:e})}}];return Object(w.jsxs)(Xe,{children:[Object(w.jsx)(Ke,{title:"Fournisseurs",children:Object(w.jsx)(We,{title:"Fournisseurs"})}),Object(w.jsx)($e,{children:Object(w.jsx)(mr,{scopes:[S.canCreateFournisseurs],data:e.sort((function(e,t){return t.id-e.id})),meta:t,columns:c,addUrl:De,urlName:"Ajouter un fournisseur"})})]})};var ei=function(){var e=Object(P.useSelector)(Jn("vaccinateurs").value),t=Object(P.useSelector)(Jn("vaccinateurs").meta),n=Object(P.useDispatch)();i.a.useEffect((function(){n(Xn("vaccinateurs").fetch())}),[]);var c=[{Header:"Nom",accessor:"name"},{Header:"T\xe9l\xe9phone",accessor:"contact"},{Header:"Actions",Cell:function(e){return Object(w.jsx)(sa,{edit:[S.canEditVaccinateur],detail:[S.canViewVaccinateur],remove:[S.canDeleteVaccinateur],route:"vaccinateurs",model:"vaccinateurs",modelKey:"name",data:e})}}];return Object(w.jsxs)(Xe,{children:[Object(w.jsx)(Ke,{title:"Vaccinateurs",children:Object(w.jsx)(We,{title:"Vaccinateurs"})}),Object(w.jsx)($e,{children:Object(w.jsx)(mr,{scopes:[S.canCreateVaccinateur],data:e.sort((function(e,t){return t.id-e.id})),meta:t,columns:c,addUrl:Me,urlName:"Ajouter un vaccinateur"})})]})};var ti=function(){var e=Object(P.useSelector)(Jn("emprunters").value),t=Object(P.useSelector)(Jn("emprunters").meta),n=Object(P.useDispatch)();i.a.useEffect((function(){n(Xn("emprunters").fetch())}),[]);var c=[{Header:"Nom",accessor:"name"},{Header:"T\xe9l\xe9phone",accessor:"contact"},{Header:"Actions",Cell:function(e){return Object(w.jsx)(sa,{edit:[S.canEditEmprunter],detail:[S.canViewEmprunter],remove:[S.canDeleteEmprunter],route:"emprunters",model:"emprunters",modelKey:"name",data:e})}}];return Object(w.jsxs)(Xe,{children:[Object(w.jsx)(Ke,{title:"D\xe9mandeurs de cr\xe9dit",children:Object(w.jsx)(We,{title:"D\xe9mandeurs de cr\xe9dit"})}),Object(w.jsx)($e,{children:Object(w.jsx)(mr,{scopes:[S.canCreateEmprunter],data:e.sort((function(e,t){return t.id-e.id})),meta:t,columns:c,addUrl:Re,urlName:"Ajouter une personne"})})]})};var ni=function(e){var t=Object(P.useDispatch)(),n=Object(P.useSelector)(Jn("categories").value),c=Object(P.useSelector)(Jn("fournisseurs").value),r=Object(P.useSelector)(Jn("vaccinateurs").value),i=Object(P.useSelector)(Jn("emprunters").value),s=Object(P.useSelector)(Jn("categories").meta),o=Object(P.useSelector)(Jn("fournisseurs").meta),l=Object(P.useSelector)(Jn("vaccinateurs").meta),d=Object(P.useSelector)(Jn("emprunters").meta);return Object(a.useEffect)((function(){t(Xn("fournisseurs").fetch()),t(Xn("categories").fetch()),t(Xn("vaccinateurs").fetch()),t(Xn("emprunters").fetch())}),[]),Object(w.jsxs)(Xe,{children:[Object(w.jsx)(Ke,{title:"Parametres g\xe9n\xe9rales",children:Object(w.jsx)(We,{title:"Parametres g\xe9n\xe9rales"})}),Object(w.jsx)($e,{children:Object(w.jsx)(Xa.a.Container,{id:"left-tabs-example",defaultActiveKey:"first",children:Object(w.jsxs)(fr.a,{children:[Object(w.jsxs)(Ja.a,{variant:"pills",className:"flex-row justify-content-center",children:[Object(w.jsx)(Ja.a.Item,{className:"border ml-2",children:Object(w.jsx)(Ja.a.Link,{eventKey:"first",className:"py-2 px-3 text-uppercase bg-white",children:"Categories de produits"})}),Object(w.jsx)(Ja.a.Item,{className:"border  ml-2",children:Object(w.jsx)(Ja.a.Link,{eventKey:"second",className:"py-2 px-3 text-uppercase  bg-white",children:"Fournisseurs"})}),Object(w.jsx)(Ja.a.Item,{className:"border  ml-2",children:Object(w.jsx)(Ja.a.Link,{eventKey:"three",className:"py-2 px-3 text-uppercase  bg-white",children:"Vaccinateurs"})}),Object(w.jsx)(Ja.a.Item,{className:"border  ml-2",children:Object(w.jsx)(Ja.a.Link,{eventKey:"four",className:"py-2 px-3 text-uppercase  bg-white",children:"Demandeur de credit"})})]}),Object(w.jsx)(gr.a,{sm:12,children:Object(w.jsxs)(Xa.a.Content,{children:[Object(w.jsx)(Xa.a.Pane,{eventKey:"first",children:Object(w.jsx)($a,{categories:n,meta:s})}),Object(w.jsx)(Xa.a.Pane,{eventKey:"second",children:Object(w.jsx)(Za,{fournisseurs:c,meta:o})}),Object(w.jsx)(Xa.a.Pane,{eventKey:"three",children:Object(w.jsx)(ei,{vaccinateurs:r,meta:l})}),Object(w.jsx)(Xa.a.Pane,{eventKey:"four",children:Object(w.jsx)(ti,{emprunters:i,meta:d})})]})})]})})})]})};var ci=function(){var e=Qe()().isoWeekday(1).startOf("week"),t=Qe()().endOf("week"),n=Object(a.useState)(e),c=Object(f.a)(n,2),r=c[0],s=c[1],o=Object(a.useState)(t),l=Object(f.a)(o,2),d=l[0],j=l[1],b=Object(a.useState)([e,t]),m=Object(f.a)(b,2),O=m[0],h=m[1];Object(a.useEffect)((function(){null!==O?(O[0]&&s(O[0]),O[1]&&j(O[1])):(s(e),j(t))}),[O]);var x=function(e){if(!e||0===(null===e||void 0===e?void 0:e.length))return 0;var t=0;return e.forEach((function(e){t+=e.prixVente*e.quantityParProductDepot})),t},v=function(e){if(!e||0===(null===e||void 0===e?void 0:e.length))return 0;var t=0;return e.forEach((function(e){t+=1*e.quantityParProductDepot})),t},p=Object(P.useSelector)(Jn("commandes").value),g=Object(P.useSelector)(Jn("commandes").meta),y=Object(P.useDispatch)();Object(a.useEffect)((function(){y(function(e,t){return Ln("commandes",{path:"/sortie?deb=".concat(e,"&fin=").concat(t),replace:!0})}(r,d))}),[r,d]);var N=i.a.useMemo((function(){return[{Header:"Date de commande",Cell:function(e){var t;return Object(w.jsx)(w.Fragment,{children:nt(null===(t=e.row.original)||void 0===t?void 0:t.dateCom)})}},{Header:"Produits",Cell:function(e){var t,n,c,r;return Object(w.jsxs)("div",{style:{width:"350px"},children:[1==(null===(t=e.row.original)||void 0===t?void 0:t.isdeleted)&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("div",{className:"badge badge-danger",children:"Supprim\xe9"}),Object(w.jsxs)("div",{className:"text text-danger",children:["Date de suppression :"," ",nt(null===(n=e.row.original)||void 0===n?void 0:n.deletedat)]})]}),null===(c=e.row.original)||void 0===c||null===(r=c.contenu)||void 0===r?void 0:r.map((function(t){var n,c;return Object(w.jsxs)("span",{children:[Object(w.jsx)("span",{style:{background:"white",color:1==(null===(n=e.row.original)||void 0===n?void 0:n.isdeleted)?"red":"inherit",padding:2},children:t.name}),Object(w.jsxs)("span",{style:{color:1==(null===(c=e.row.original)||void 0===c?void 0:c.isdeleted)?"red":"inherit"},children:[" "," || "]})]})}))]})}},{Header:"Quantit\xe9",Cell:function(e){var t;return Object(w.jsx)("div",{children:v(null===(t=e.row.original)||void 0===t?void 0:t.contenu)})}},{Header:"Total",Cell:function(e){var t;return Object(w.jsx)("div",{children:ct(x(null===(t=e.row.original)||void 0===t?void 0:t.contenu))})}},{Header:"Actions",Cell:function(e){var t,n,c;return 1==(null===(t=e.row.original)||void 0===t?void 0:t.isdeleted)?null:Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(E,{scopes:[S.canShowDeleteHistoricDeSortieDepot],children:Object(w.jsx)(u.b,{to:"/depot/detail/".concat(null===(n=e.row.original)||void 0===n?void 0:n.id),className:"btn btn-green btn-sm mr-2",children:"D\xe9tails"})}),Object(w.jsx)(E,{scopes:[S.canShowEditHistoricDeSortieDepot],children:Object(w.jsx)(u.b,{to:"/editer/commande/".concat(null===(c=e.row.original)||void 0===c?void 0:c.id),className:"btn btn-warning btn-sm mr-2",children:"Editer"})}),Object(w.jsx)(E,{scopes:[S.canShowDeleteHistoricDeSortieDepot],children:Object(w.jsx)(_r,{model:"fromdepots",entity:e.row.original})})]})}}]}),[]);return Object(w.jsxs)(Xe,{children:[Object(w.jsx)(Ke,{title:"Historique de sortie",children:Object(w.jsx)(We,{title:"Historique de sortie"})}),Object(w.jsxs)($e,{children:[" ",Object(w.jsxs)("div",{className:"row",children:[Object(w.jsx)("div",{className:"col-lg-6",children:Object(w.jsxs)("div",{children:[Object(w.jsx)("h3",{className:"text-uppercase",children:"Historique de sortie"}),Object(w.jsx)("p",{children:"".concat(nt(r)," ->  ").concat(nt(d))})]})}),Object(w.jsx)("div",{className:"col-lg-6 text-right",children:Object(w.jsx)(et.a,{locale:"fr-FR",onChange:h,value:O})})," "]}),Object(w.jsx)(mr,{filter:!1,data:p.sort((function(e,t){return t.id-e.id})),meta:g,columns:N})]})]})},ri=i.a.createContext();function ai(e){var t=e.model,n=e.options,c=e.children,r=Object(P.useSelector)(Jn(t).value),a=Object(P.useSelector)(Jn(t).meta),s=Object(P.useDispatch)();i.a.useEffect((function(){s(Xn(t).fetch(n))}),[n]);var o={data:r,meta:a};return Object(w.jsx)(ri.Provider,{value:o,children:c})}function ii(e){var t=e.children;return Object(w.jsx)(ri.Consumer,{children:function(e){if(void 0===e)throw new Error("Data  must be used within a GetDataContext");return t(e)}})}var si="SET_FROM_DEPOT_ITEMS",oi="ADD_FROM_DEPOT",li="REMOVE_FROM_TO_DEPOT",di="CLEAR_FROM_DEPOT",ui="ADD_QTY_FROM_DEPOT_ITEM",ji="ADD_QTY_PORTION_FROM_DEPOT_ITEM",bi="ADD_QTY_NUMBER_FROM_DEPOT_ITEM",mi="ADD_QTY_PORTION_DOSE_ITA_NEW_FROM_DEPOT_ITEM",Oi="ADD_QTY_PORTION_DOSE_SOVAX_FROM_DEPOT_ITEM",hi="ADD_QTY_PORTION_PHYTO_COND_FROM_DEPOT_ITEM",xi="MINUS_QTY_PORTION_PHYTO_COND_FROM_DEPOT_ITEM",vi=function(){return{type:di}},pi=function(e){var t=e.product,n=(e.setRealQttCC,e.setRealQtt),c=(e.realQtt,e.realQttCC,Object(P.useDispatch)()),r=function(e){c(function(e,t){return{type:bi,payload:{id:e,value:t}}}(t.id,e))},a=function(){return t.quantityBrute-1-1*t.quantityParProductDepot<0};return Object(w.jsx)("div",{className:"basket-item-control",children:Object(w.jsxs)(Xc.c,{inputMode:"numeric",w:28,disabled:0!=(null===t||void 0===t?void 0:t.condmldepot)&&0!=(null===t||void 0===t?void 0:t.qttccpventedepot),step:1,bg:"whitesmoke",onChange:function(e){r(Number(e)),n(Number(e)),1==a()&&alert("Le reste du stock est : "+t.quantityBrute+" < "+e+" demand\xe9")},min:0,defaultValue:null===t||void 0===t?void 0:t.quantityParProductDepot,max:(a(),1*(null===t||void 0===t?void 0:t.quantityBrute)),children:[Object(w.jsx)(Xc.d,{}),Object(w.jsxs)(Xc.e,{children:[Object(w.jsx)(Xc.b,{}),Object(w.jsx)(Xc.a,{})]})]})})},fi="SET_FROM_MAGASIN_ITEMS",gi="ADD_FROM_MAGASIN",yi="REMOVE_FROM_TO_MAGASIN",Ni="CLEAR_FROM_MAGASIN",Ci="ADD_QTY_FROM_MAGASIN_ITEM",Si="ADD_QTY_PORTION_FROM_MAGASIN_ITEM",qi="ADD_QTY_NUMBER_FROM_MAGASIN_ITEM",wi="ADD_QTY_PORTION_DOSE_ITA_NEW_FROM_MAGASIN_ITEM",Ei="ADD_QTY_PORTION_DOSE_SOVAX_FROM_MAGASIN_ITEM",Ai="ADD_QTY_PORTION_PHYTO_COND_FROM_MAGASIN_ITEM",Di="MINUS_QTY_PORTION_PHYTO_COND_FROM_MAGASIN_ITEM",Pi="ADD_QTY_LITRE_NUMBER_FROM_MAGASIN_ITEM",Vi="ADD_TO_QTT_BRUTE",Fi=function(e,t){return{type:wi,payload:{id:e,value:t}}},Ri=function(e,t){return{type:Ei,payload:{id:e,value:t}}},Ti=function(e,t){return{type:Ai,payload:{id:e,value:t}}},Mi=function(e,t){var n=function(t){return!!(null===e||void 0===e?void 0:e.find((function(e){return(null===e||void 0===e?void 0:e.id)===t})))};return{fromdepot:e,isItemFromDepot:n,addFromDepot:function(e){n(e.id)?t(function(e){return{type:li,payload:e}}(e.id)):t(function(e){return{type:oi,payload:e}}(e))}}},Bi=function(e){var t=e.product,n=Object(a.useState)(null),c=Object(f.a)(n,2),r=c[0],i=c[1],s=Object(a.useState)(null),o=Object(f.a)(s,2),l=o[0],d=o[1],u=Object(P.useSelector)((function(e){return e.fromdepots})),j=Object(P.useDispatch)(),b=Mi(u,j),m=b.isItemFromDepot,O=b.addFromDepot,h=!!m&&m(t.id);return Object(w.jsx)("div",{children:Object(w.jsxs)("div",{className:"d-flex justify-content-between align-items-center border   mb-2 p-2",children:[Object(w.jsxs)("div",{style:{width:"45%"},children:[Object(w.jsx)("p",{className:"text-blue",children:t.name}),Object(w.jsx)("span",{className:"text-lowercase",children:Object(w.jsxs)("strong",{children:[0!=t.quantityParProductDepot&&ct(Ra(t)?t.prixlitre*t.quantityParProductDepot:t.prixVente*t.quantityParProductDepot),0==t.quantityParProductDepot&&0!=t.prixParCC&&Object(w.jsx)(w.Fragment,{children:null!=t.prixqttccventedepot&&0!=t.prixqttccventedepot?ct(t.prixqttccventedepot):ct(t.prixParCC)}),0!=t.quantityParProductDepot&&" x "+t.quantityParProductDepot+" "+t.type," ",null==t.prixqttccventedepot&&0==t.prixqttccventedepot&&Object(w.jsx)(w.Fragment,{children:0!=t.qttByCCDepot&&(0==t.quantityParProductDepot?" x ":"+")+t.qttByCCDepot+"ML"})]})})]}),Object(w.jsxs)("div",{className:"text-inline text-center",children:[Object(w.jsx)("h5",{className:"mb-1",children:t.type}),Object(w.jsx)(pi,{product:t,setRealQttCC:i,setRealQtt:d,realQtt:l,realQttCC:r})]}),Object(w.jsx)("div",{children:h&&Object(w.jsx)("button",{onClick:function(){O&&O(t)},className:"btn btn-danger btn-xs text-right",children:"X"})})]})})},ki=function(e){return!!e.quantityBrute>0},_i=function(e){return!!e.quantityBrute<0},Ii=function(e){return!!(e.qttByCCDepot>e.quantityCC)},Li=function(e){return Ii(e)?e.qttByCCDepot-e.quantityCC:e.quantityCC-e.qttByCCDepot},Qi=function(e){return ki(e)?e.quantityBrute-=1:e.quantityBrute=0,e},Hi=function(e,t){return e.quantityCC=t,e},Ui=function(e){return function(e){ki(e)?(console.log("hello ici"),Ii(e)?(Qi(e),Hi(e,e.doseDefault-Li(e))):function(e){return!(e.qttByCCDepot!=e.quantityCC)}(e)?Hi(e,0):Hi(e,e.quantityCC-e.qttByCCDepot)):e.quantityCC>0?Hi(e,e.quantityCC-e.qttByCCDepot):Hi(e,0)}(e),e},Yi=function(e){return!function(e){return!!e.condvaldepot>=0}(e)?ki(e)?(Qi(e),Hi(e,e.condmldepot-Li(e)),0==e.condvaldepot&&(e.condvaldepot=e.condsizedepot-1)):e.quantityCC-=e.qttByCCDepot:Ii(e)?(!function(e){e.condvaldepot>0?e.condvaldepot-=1:e.quantityBrute>0?(Qi(e),e.condvaldepot=e.condsizedepot-1):e.condvaldepot=0}(e),Hi(e,e.condmldepot-Li(e))):!function(e){return!!e.quantityCC>0}(e)?e.quantityCC=0:e.quantityCC-=e.qttByCCDepot,e},Ki=function(e){var t=e.product,n=e.index,c=e.state,r=e.setState,a=(e.setRealQttCC,e.setRealQtt),i=(e.realQtt,e.realQttCC,Object(P.useDispatch)(),function(e){!function(e,t,n){var a=Object(Ie.a)(c);a[e]=Object(dt.a)(Object(dt.a)({},a[e]),{},Object(g.a)({},t,n)),r(a)}(n,"quantityParProductDepot",e)}),s=function(){return t.quantityCC-t.qttByCCDepot<0&&t.quantityBrute-1-1*t.quantityParProductDepot<0};return Object(w.jsx)("div",{className:"basket-item-control",children:Object(w.jsxs)(Xc.c,{inputMode:"numeric",w:28,disabled:0!=(null===t||void 0===t?void 0:t.condmldepot)&&0!=(null===t||void 0===t?void 0:t.qttccpventedepot),step:1,bg:"whitesmoke",onChange:function(e){i(Number(e)),a(Number(e)),s()&&alert("Le stock ne satisfait pas votre commande")},min:0,defaultValue:null===t||void 0===t?void 0:t.quantityParProductDepot,max:1==s()?1*(null===t||void 0===t?void 0:t.quantityBrute)-1:1*(null===t||void 0===t?void 0:t.quantityBrute),children:[Object(w.jsx)(Xc.d,{}),Object(w.jsxs)(Xc.e,{children:[Object(w.jsx)(Xc.b,{}),Object(w.jsx)(Xc.a,{})]})]})})},zi=function(e){var t=e.state,n=e.index,c=e.setState,r=e.product,i=Object(a.useState)(null),s=Object(f.a)(i,2),o=s[0],l=s[1],d=Object(a.useState)(null),u=Object(f.a)(d,2),j=u[0],b=u[1];return Object(w.jsx)("div",{children:Object(w.jsxs)("div",{className:"d-flex justify-content-between align-items-center border   mb-2 p-2",children:[Object(w.jsxs)("div",{style:{width:"45%"},children:[Object(w.jsx)("p",{className:"text-blue",children:r.name}),Object(w.jsx)("span",{className:"text-lowercase",children:Object(w.jsxs)("strong",{children:[0!=r.quantityParProductDepot&&ct(Ra(r)?r.prixlitre:r.prixVente),0==r.quantityParProductDepot&&0!=r.prixParCC&&Object(w.jsx)(w.Fragment,{children:null!=r.prixqttccventedepot&&0!=r.prixqttccventedepot?ct(r.prixqttccventedepot):ct(r.prixParCC)}),0!=r.quantityParProductDepot&&" x "+r.quantityParProductDepot+" "+r.type," ",null==r.prixqttccventedepot&&0==r.prixqttccventedepot&&Object(w.jsx)(w.Fragment,{children:0!=r.qttByCCDepot&&(0==r.quantityParProductDepot?" x ":"+")+r.qttByCCDepot+"ML"})]})})]}),Object(w.jsxs)("div",{className:"text-inline text-center",children:[Object(w.jsx)("h5",{className:"mb-1",children:r.type}),Object(w.jsx)(Ki,{index:n,state:t,setState:c,product:r,setRealQttCC:l,setRealQtt:b,realQtt:j,realQttCC:o})]})]})})},Wi=function(e){return!(0==e.condml||0==e.condsize||0==e.qttccpvente||0==e.prixqttccvente)},Gi=function(e){return Wi(e)?0==e.quantityBruteCVA&&0==e.quantityCCCVA&&0==e.condval:0==e.quantityBruteCVA&&0==e.quantityCCCVA},Xi=function(e){return e.filter((function(e){return Wi(t=e)?0==t.quantityParProduct&&0==t.qttByCC&&0==t.qttbylitre:0==t.quantityParProduct&&0==t.qttByCC;var t})).length>0},Ji=function(e){return e&&0!==(null===e||void 0===e?void 0:e.length)?e.reduce((function(e,t){return e+t}),0):0};function $i(e){var t,n,c;for(c in t=Array.isArray(e)?[]:{},e)n=e[c],t[c]="object"===typeof n?$i(n):n;return t}var Zi=function(e){var t,n,c=e.state,r=(e.meta,e.setState),i=(e.products,e.commandes),s=e.disabled,o=Object(a.useState)("vente-depot"),l=Object(f.a)(o,2),d=l[0],u=l[1],b=Object(a.useState)(1),m=Object(f.a)(b,2),O=(m[0],m[1],Object(a.useState)(null)),h=Object(f.a)(O,2),x=h[0],v=h[1],p=Object(a.useState)(null),y=Object(f.a)(p,2),N=y[0],C=y[1],S=Object(j.g)(),q=Object(a.useState)([]),E=Object(f.a)(q,2),A=E[0],D=E[1],V=Object(P.useSelector)((function(e){return{fromdepots:e.fromdepots}})),F=V.fromdepots;Object(a.useEffect)((function(){D(null===i||void 0===i?void 0:i.contenu)}),[i]);var R=Object(P.useDispatch)(),T=Object(P.useSelector)(Jn("emprunters").value),M=Object(P.useSelector)(Jn("vaccinateurs").value),B=new Date,k=Object(a.useState)(B),_=Object(f.a)(k,2),I=_[0],L=_[1];Object(a.useEffect)((function(){R(Xn("emprunters").fetch())}),[]);return Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)(lr.a,{children:[Object(w.jsxs)(lr.a.Header,{className:" bg-dark py-2 text-white d-flex justify-content-between align-items-center",children:[Object(w.jsx)("div",{style:{width:"60%"},children:"BON DE SORTIE"}),Object(w.jsx)("div",{style:{width:"30%"},className:"text-right",children:Object(w.jsxs)("select",{disabled:s,className:"form-control input-sm",onChange:function(e){u(e.target.value)},children:[Object(w.jsx)("option",{value:"vente-depot",children:"Comptant"}),Object(w.jsx)("option",{value:"vente-depot-credit",children:"Credit"}),Object(w.jsx)("option",{value:"vente-depot-vaccinateur",children:"Vaccinateur"})]})})]}),Object(w.jsxs)("div",{className:"commande-vente",children:[Object(w.jsx)(lr.a.Body,{style:{padding:12,marginTop:3,marginRight:2,marginLeft:2},children:Object(w.jsxs)("div",{style:{overflowY:"auto",height:"350px",maxHeight:"350px",overflowX:"hidden"},children:[Object(w.jsxs)("div",{class:"form-group",children:[Object(w.jsx)("label",{children:"Date de sortie :"}),Object(w.jsx)("div",{children:Object(w.jsx)("input",{disabled:s,type:"date",onChange:function(e){return L(e.target.value)},value:I,className:"form-control"})})]}),"vente-depot-credit"===d&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("label",{children:"Crediteur:"}),Object(w.jsxs)("select",{disabled:s,className:"form-control",onChange:function(e){C(e.target.value)},children:[Object(w.jsx)("option",{value:""}),T.map((function(e){return Object(w.jsx)("option",{value:e.id,children:e.name})}))]})]}),"vente-depot-vaccinateur"===d&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("label",{children:"Vaccinateur:"}),Object(w.jsxs)("select",{className:"form-control",onChange:function(e){v(e.target.value)},children:[Object(w.jsx)("option",{children:"Selectionner un vaccinateur"}),M.map((function(e){return Object(w.jsx)("option",{value:e.id,children:e.name})}))]})]}),(null===c||void 0===c?void 0:c.length)<=0&&Object(w.jsx)("div",{className:"alert alert-success ",children:"Aucune enregistrement trouv\xe9"}),null===c||void 0===c?void 0:c.map((function(e,t){return Object(w.jsx)(zi,{product:e,state:c,index:t,setState:r,basket:F,dispatch:R},"".concat(null===e||void 0===e?void 0:e.id,"_").concat(t))}))]})}),(null===c||void 0===c?void 0:c.length)>0&&Object(w.jsxs)(lr.a.Footer,{className:"d-flex align-items-center justify-content-between",children:[Object(w.jsx)("div",{style:{width:"30%"},children:Object(w.jsx)("h2",{className:"p-2 text-uppercase bg-primary",children:Object(w.jsxs)("strong",{"data-test-id":"total-price-orders",children:["Total:",ct(Ji(null===c||void 0===c?void 0:c.map((function(e){return Wi(e)?e.prixlitre*e.quantityParProductDepot:e.prixVente*e.quantityParProductDepot})))+Ji(null===c||void 0===c||null===(t=c.state)||void 0===t?void 0:t.map((function(e){return e.prixParCC*e.qttByCCDepot}))))]})})}),Object(w.jsx)("div",{style:{width:"70%"},children:(null===c||void 0===c?void 0:c.length)>0&&Object(w.jsxs)("div",{className:"d-flex text-right align-items-end justify-content-end",children:[Object(w.jsx)("button",(n={disabled:s,className:"btn btn-green btn-sm mr-2"},Object(g.a)(n,"disabled",0===(null===c||void 0===c?void 0:c.length)),Object(g.a)(n,"onClick",(function(){var e=function(){var e=$i(A).filter((function(e){return!c.find((function(t){return e.id===t.id}))})),t=$i(A).filter((function(e){return!c.find((function(t){return e.id===t.id}))}));return{exist:$i(A).map((function(e){return c.find((function(t){return t.id==e.id}))})).filter((function(e){return null!=e})),added:t,missing:e}}(),t=e.exist,n=e.added,r=e.missing;R(Xn("commandes").updateTransaction({id:null===i||void 0===i?void 0:i.id,contenu:c,type:"vente-depot",sorte:"sortie",vaccinateurId:x,status:"direct"===d,emprunterId:N,dateCom:null!=I?I:B,exist:t,added:n,missing:r},"update-from-depot")),S.push(xe)})),Object(g.a)(n,"type","button"),Object(g.a)(n,"children","Valider l'operation"),n)),Object(w.jsx)("button",{disabled:s,className:"btn btn-danger btn-sm",onClick:function(){null===c||void 0===c||c.forEach((function(e){e.quantityParProductDepot=0,e.qttByCCDepot=0})),R(vi())},type:"button",children:Object(w.jsx)("span",{children:"Annuler"})})]})})]})]})]})})},es=function(e){var t,n=e.state,c=e.setState,r=e.product,a=(Object(P.useSelector)((function(e){return e.fromdepots})),Object(P.useDispatch)(),!!(null===n||void 0===n?void 0:n.find((function(e){return(null===e||void 0===e?void 0:e.id)===r.id}))));return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(pr.a.Item,{className:"mb-2 mr-3",style:{border:"1px solid gray"},children:Object(w.jsx)("div",{className:" d-flex justify-content-between align-items-center",children:Object(w.jsxs)("div",{className:" ".concat(r.id?"":"product-loading"),style:{boxShadow:r&&a?"15px 10px 15px rgba(0, 0, 0, .07)":"none"},children:[Object(w.jsxs)("div",{children:[r.name," ",Object(w.jsx)("div",{class:"badge badge-primary",children:null===r||void 0===r||null===(t=r.fournisseur)||void 0===t?void 0:t.name}),Object(w.jsx)("br",{})]})," ",Object(w.jsx)("div",{children:(null===r||void 0===r?void 0:r.id)&&Object(w.jsx)(w.Fragment,{children:a?Object(w.jsx)("button",{disabled:0===r.quantityBrute&&(0==r.quantityCC||null==r.quantityCC),className:"btn btn-danger btn-sm",onClick:function(){return function(e){c(n.filter((function(t){return t.id!==e})))}(null===r||void 0===r?void 0:r.id)},children:"Retirer"}):Object(w.jsx)("button",{disabled:0===r.quantityBrute&&(0==r.quantityCC||null==r.quantityCC),className:"btn btn-green btn-sm",onClick:function(){c(n.some((function(e){return e.id===r.id}))?n:[r].concat(Object(Ie.a)(n)))},children:"Ajouter"})})})]})})})})},ts=function(){var e=Object(j.i)().id,t=Object(a.useState)(!1),n=Object(f.a)(t,2),c=n[0],r=n[1],s=Object(P.useDispatch)(),o=Object(P.useSelector)(Jn("commandes").value),l=Object(P.useSelector)(Jn("commandes").meta),d=Object(P.useSelector)(Jn("products").value),u=Object(P.useSelector)(Jn("products").meta),b=Object(a.useState)([]),m=Object(f.a)(b,2),O=m[0],h=m[1];i.a.useEffect((function(){s(Xn("commandes").get(e))}),[e]);var x=Object(a.useState)(""),v=Object(f.a)(x,2),p=v[0],g=v[1],y=Object(a.useState)([]),N=Object(f.a)(y,2),C=N[0],S=N[1];i.a.useEffect((function(){return 1==c&&(s(Xn("products").fetch()),r(!1)),function(){r(!1)}}),[c]),i.a.useEffect((function(){h(Mr(d,p))}),[p]),i.a.useEffect((function(){s(Xn("products").fetch())}),[]),i.a.useEffect((function(){var e;l.isFetching||S(null===(e=o[0])||void 0===e?void 0:e.contenu)}),[l]),i.a.useEffect((function(){u.isFetching||h(d)}),[u]);return Object(w.jsxs)(Xe,{children:[Object(w.jsx)(Ke,{title:"Editer un bon de commande",children:Object(w.jsx)(We,{title:"Editer un bon de commande"})}),Object(w.jsx)($e,{children:Object(w.jsx)(Fr.a,{children:Object(w.jsxs)(fr.a,{children:[Object(w.jsx)(gr.a,{xs:6,children:Object(w.jsx)(pr.a,{children:Object(w.jsxs)(lr.a,{children:[Object(w.jsx)(lr.a.Header,{className:"d-flex justify-content-between align-items-center bg-dark text-white",children:"Produits"}),Object(w.jsxs)(lr.a.Body,{children:[Object(w.jsx)("input",{type:"text",onChange:function(e){g(e.target.value)},placeholder:"Rechercher un produit",className:"form-control mb-2"}),Object(w.jsxs)("div",{style:{overflowY:"auto",height:"350px",maxHeight:"350px",overflowX:"hidden"},children:[Object(w.jsxs)(w.Fragment,{children:[O.map((function(e){return Object(w.jsx)(es,{state:C,setState:S,product:e})})),0==O.length&&"Aucune enregistrement trouv\xe9"]})," "]})]})]})})}),Object(w.jsx)(gr.a,{xs:6,children:Object(w.jsx)(Zi,{disabled:u.isFetching,state:C,meta:l,setState:S,products:d,commandes:o[0]})})]})})})]})},ns=c(230),cs=c.n(ns),rs="SET_SEARCH_BY_DATE",as="RESET_SEARCH_BY_DATE",is=function(e,t){return{type:rs,payload:{deb:e,fin:t}}},ss=function(e,t){return{type:as}},os=(c(356),function(e){var t=e.product,n=e.update,c=e.index,r=(e.state,e.setState,e.setRealQttCC),a=e.realQttCC;return Object(w.jsx)("div",{className:"basket-item-control",children:Object(w.jsxs)(Xc.c,{inputMode:"decimal",w:28,step:1,bg:"whitesmoke",onChange:function(e){!function(e){n(c,"prixParCC",e)}(e),r(e)},min:0,value:a,defaultValue:null===t||void 0===t?void 0:t.prixParCC,children:[Object(w.jsx)(Xc.d,{}),Object(w.jsxs)(Xc.e,{children:[Object(w.jsx)(Xc.b,{}),Object(w.jsx)(Xc.a,{})]})]})})}),ls=function(e){var t=e.product,n=e.update,c=e.index,r=(e.state,e.setState,e.setRealQttCC),a=e.realQttCC;return Object(w.jsx)("div",{className:"basket-item-control",children:Object(w.jsxs)(Xc.c,{inputMode:"numeric",w:28,step:1,bg:"whitesmoke",onChange:function(e){""==e?r(null===t||void 0===t?void 0:t.prixParCC):(!function(e){n(c,"prixParCC",e)}(Number(e)),r(Number(e)))},min:0,value:a,defaultValue:null===t||void 0===t?void 0:t.prixParCC,children:[Object(w.jsx)(Xc.d,{}),Object(w.jsxs)(Xc.e,{children:[Object(w.jsx)(Xc.b,{}),Object(w.jsx)(Xc.a,{})]})]})})},ds=function(){return{type:Ni}},us=function(e,t){return{type:qi,payload:{id:e,value:t}}},js=function(e,t){return{type:Pi,payload:{id:e,value:t}}},bs=function(e,t){return{type:Si,payload:{id:e,value:t}}},ms=function(e){return!(0==e.condml||0==e.condsize||0==e.qttccpvente||0==e.prixqttccvente)},Os=function(e){e.data,e.setData,e.date;var t=e.index,n=e.commandes;Object(P.useDispatch)();return console.log("item",t,n),Object(w.jsx)(w.Fragment,{children:Object(w.jsx)("div",{className:"commande-vente",children:null===n||void 0===n?void 0:n.map((function(e,t){return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)("p",{children:t})})}))})})},hs=c(156);c(231),c(210),c(631);Symbol.iterator;var xs=c(632),vs="shape",ps="arrayOf",fs="any",gs="string",ys="boolean",Ns="function",Cs="number",Ss="date",qs="array",ws="object";var Es={fontFamily:"monospace"},As=Object(dt.a)(Object(dt.a)({},Es),{},{color:"#b966b1"}),Ds=function(e){Object(v.a)(n,e);var t=Object(p.a)(n);function n(){var e;Object(h.a)(this,n);for(var c=arguments.length,r=new Array(c),a=0;a<c;a++)r[a]=arguments[a];return(e=t.call.apply(t,[this].concat(r))).state={expanded:!1},e}return Object(x.a)(n,[{key:"toggleExpanded",value:function(){this.setState({expanded:!this.state.expanded})}},{key:"render",value:function(){var e,t=(e=this.props.schema)._isSchemaType?e._type:vs;switch(t){case fs:case gs:case ys:case Ns:case Cs:case Ss:case qs:case ws:return"string"===typeof this.props.keyName?Object(w.jsx)(Rs,{preview:Object(w.jsx)(Ps,{schemaTypeName:t}),schemaElement:Object(w.jsx)(Ps,{schemaTypeName:t}),keyName:this.props.keyName}):Object(w.jsx)(Ps,{schemaTypeName:t});case vs:return"string"===typeof this.props.keyName?Object(w.jsx)(Rs,{schemaElement:Object(w.jsx)(Vs,{schema:this.props.schema}),keyName:this.props.keyName,onToggleExpanded:this.toggleExpanded.bind(this),preview:"Shape",expanded:this.state.expanded}):Object(w.jsx)(Vs,{schema:this.props.schema});case ps:return"string"===typeof this.props.keyName?Object(w.jsx)(Rs,{schemaElement:Object(w.jsx)(n,{schema:this.props.schema._elementType}),keyName:this.props.keyName,onToggleExpanded:this.toggleExpanded.bind(this),preview:"ArrayOf",expanded:this.state.expanded}):Object(w.jsxs)("div",{style:{display:"flex",cursor:"default"},children:[Object(w.jsx)("div",{style:{width:Fs}}),Object(w.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[Object(w.jsx)("div",{style:Object(dt.a)({},Es),children:"ArrayOf"}),Object(w.jsx)(n,{schema:this.props.schema._elementType})]})]});default:throw new Error("invalid schema type identifier")}}}]),n}(i.a.Component);Ds.displayName="SchemaView";var Ps=function(e){Object(v.a)(n,e);var t=Object(p.a)(n);function n(){return Object(h.a)(this,n),t.apply(this,arguments)}return Object(x.a)(n,[{key:"render",value:function(){return Object(w.jsx)("div",{style:Object(dt.a)({},Es),children:this.props.schemaTypeName})}}]),n}(i.a.Component);Ps.displayName="LeafSchema";var Vs=function(e){Object(v.a)(n,e);var t=Object(p.a)(n);function n(){return Object(h.a)(this,n),t.apply(this,arguments)}return Object(x.a)(n,[{key:"render",value:function(){return Object(w.jsx)("div",{children:xs.toPairs(this.props.schema).map((function(e){var t=Object(f.a)(e,2),n=t[0],c=t[1];return Object(w.jsx)(Ds,{schema:c,keyName:n},n)}))})}}]),n}(i.a.Component);Vs.displayName="ShapeSchema";var Fs="16px",Rs=function(e){Object(v.a)(n,e);var t=Object(p.a)(n);function n(){return Object(h.a)(this,n),t.apply(this,arguments)}return Object(x.a)(n,[{key:"render",value:function(){var e=""===this.props.keyName?'""':this.props.keyName;if(!this.props.onToggleExpanded)return Object(w.jsxs)("div",{style:{display:"flex",cursor:"default"},children:[Object(w.jsx)("div",{style:{width:Fs}}),Object(w.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[Object(w.jsxs)("div",{style:Object(dt.a)(Object(dt.a)({},As),{},{marginRight:"10px"}),onClick:this.props.onToggleExpanded,children:[e,":"]}),Object(w.jsx)("div",{style:Object(dt.a)({},Es),children:this.props.preview})]})]});var t=this.props.expanded?"\u25bc":"\u25b6";return Object(w.jsxs)("div",{style:{display:"flex",cursor:"default"},children:[Object(w.jsx)("div",{style:{display:"flex",width:Fs},onClick:this.props.onToggleExpanded,children:Object(w.jsx)("span",{style:{fontSize:"9px",padding:"2px"},children:t})}),Object(w.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[Object(w.jsxs)("div",{style:{display:"flex",flexDirection:"row"},onClick:this.props.onToggleExpanded,children:[Object(w.jsxs)("div",{style:Object(dt.a)(Object(dt.a)({},As),{},{marginRight:"10px"}),children:[e,":"]}),Object(w.jsx)("div",{style:Object(dt.a)({},Es),children:this.props.preview})]}),this.props.expanded&&Object(w.jsx)("div",{children:this.props.schemaElement})]})]})}}]),n}(i.a.Component);Rs.displayName="KeyValueSchemaView";var Ts=c(27),Ms=c.n(Ts);function Bs(e){return function(t){return typeof t===e}}function ks(e){return function(t){return Array.isArray(t)&&function(e,t){if(!Array.isArray(e))throw new Error('Expected "array" to be an Array, but got '.concat(Object.prototype.toString.call(e)));return e.reduce((function(n,c,r){return n&&t(c,r,e)}),!0)}(t,(function(t){return function(e,t){try{Us(e)}catch(n){throw new Error('Expected "schema" to be a valid schema')}return Ys(e,t)}(e,t)}))}}var _s=function(e){return function(t){return function(n){return!t&&"undefined"===typeof n||e(n)}}};function Is(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},c=e;return c.__proto__=Object(dt.a)({_isSchemaType:!0,_type:t},n),c}var Ls=function(e,t){return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Is(e(!!n.required),t,n)}},Qs={any:Ls(_s((function(e){return"undefined"!==typeof e})),"any"),string:Ls(_s(Bs("string")),"string"),boolean:Ls(_s(Bs("boolean")),"boolean"),function:Ls(_s(Bs("function")),"function"),number:Ls(_s(Bs("number")),"number"),date:Ls(_s((function(e){return"[object Date]"===Object.prototype.toString.call(e)&&!isNaN(e.getTime())})),"date"),array:Ls(_s((function(e){return Array.isArray(e)})),"array"),object:Ls(_s((function(e){return"[object Object]"===Object.prototype.toString.call(e)})),"object"),arrayOf:function(e){return function(t){return Ls(_s(ks(e)),"arrayOf")(Object(dt.a)(Object(dt.a)({},t),{},{_elementType:e}))}}};function Hs(e,t){return"(At ".concat(t,"): Expected a SchemaType, but got ").concat(e,":").concat(typeof e)}function Us(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(e._isSchemaType)return null;if("object"===typeof e&&Object.keys(e).length>0)return Object.keys(e).forEach((function(n){return Us(e[n],t+"."+n)})),null;throw new Error(Hs(e,t))}function Ys(e,t){return e._isSchemaType?e(t):Object.keys(e).map((function(n){return Ys(e[n],t&&t[n])})).reduce((function(e,t){return e&&t}),!0)}function Ks(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e+t}}var zs={Editor:Ks("editor"),Cell:Ks("cell"),ElementRow:Ks("editor__row"),AddObjectRow:Ks("editor__add-object"),ColumnTitles:Ks("editor__column-titles"),ColumnTitle:Ks("column-title"),EditorInput:Ks("editor__input")},Ws=c(66),Gs=c(52),Xs=new WeakMap;function Js(e,t){Object(s.findDOMNode)(this).contains(t.target)||e(t)}var $s=function(e){var t,n;return n=t=function(t){Object(v.a)(c,t);var n=Object(p.a)(c);function c(e){var t;return Object(h.a)(this,c),t=n.call(this,e),Xs.set(Object(hs.a)(t),Js.bind(Object(hs.a)(t),e.onClickScrim)),t}return Object(x.a)(c,[{key:"componentWillReceiveProps",value:function(e){document.documentElement.removeEventListener("click",Xs.get(this)),Xs.set(this,Js.bind(this,e.onClickScrim)),document.documentElement.addEventListener("click",Xs.get(this))}},{key:"componentDidMount",value:function(){Object(Ws.a)(Object(Gs.a)(c.prototype),"componentDidMount",this)&&Object(Ws.a)(Object(Gs.a)(c.prototype),"componentDidMount",this).apply(this,arguments),document.documentElement.addEventListener("click",Xs.get(this))}},{key:"componentWillUnmount",value:function(){Object(Ws.a)(Object(Gs.a)(c.prototype),"componentWillUnmount",this)&&Object(Ws.a)(Object(Gs.a)(c.prototype),"componentWillUnmount",this).apply(this,arguments),document.documentElement.removeEventListener("click",Xs.get(this))}},{key:"render",value:function(){return Object(w.jsx)(e,Object(dt.a)({},this.props))}}]),c}(i.a.Component),t.displayName="Scrim",n},Zs={prixVente:"(FLACON,BOLUS,UNITE)",prixParCC:"ML",name:"NOM DU PRODUIT",prixqttccvente:"PRIX CONDITIONNEMENT",contenu:"COMMANDES",dateCom:"DATE DE COMMANDES"},eo=function(){return null};var to=function(e){var t=Ms()(zs.ColumnTitle(),e.className);return Object(w.jsx)("th",{className:t,children:e.children})};to.displayName="ColumnTitle";var no=function(e){Object(v.a)(n,e);var t=Object(p.a)(n);function n(){var e;Object(h.a)(this,n);for(var c=arguments.length,r=new Array(c),a=0;a<c;a++)r[a]=arguments[a];return(e=t.call.apply(t,[this].concat(r))).renderObjectColumns=function(t){return Object.keys(e.props.type).map((function(e){return Object(w.jsx)(to,{children:Zs[e]})}))},e}return Object(x.a)(n,[{key:"render",value:function(){return Object(w.jsxs)("table",{className:Ms()(zs.Editor(),"bg-white table table-bordered",this.props.className),children:[Object(w.jsx)("thead",{className:"bg-thead",children:Object(w.jsx)("tr",{className:zs.ColumnTitles(),children:this.renderObjectColumns(this.props.object)})}),Object(w.jsx)("tbody",{children:this.props.children})]})}}]),n}(i.a.Component);no.displayName="BaseTable";var co=function(e){Object(v.a)(n,e);var t=Object(p.a)(n);function n(){return Object(h.a)(this,n),t.apply(this,arguments)}return Object(x.a)(n,[{key:"render",value:function(){return Object(w.jsx)(no,{object:this.props.object,type:this.props.type,trad:this.props.trad,className:Ms()(zs.Editor("--object"),this.props.className),children:Object(w.jsx)(jo,{className:zs.ElementRow("--object"),icon:this.props.icon||void 0,trash:eo,type:this.props.type,object:this.props.object,onChange:this.props.onUpdateElement,onRemove:eo})})}}]),n}(i.a.Component);co.displayName="ObjectEditor";var ro=$s(co),ao=function(e){var t=e.object,n=e.type,c=e.trad,r=e.icon,i=e.onUpdateElement,s=e.onRemoveElement,o=e.className,l=Object(a.useState)(t),d=Object(f.a)(l,2);d[0],d[1];return console.log("mirendere fona le array editor"),Object(w.jsx)(no,{object:t,type:n,trad:c,className:Ms()(zs.Editor("--array"),o),children:wn.a.map(t,(function(e,t){return Object(w.jsx)(jo,{className:zs.ElementRow("--array"),icon:r||void 0,type:n,object:e,onChange:function(e){return i(e,t)},onRemove:function(){return s(e,t)}},t)}))})};(function(e){Object(v.a)(n,e);var t=Object(p.a)(n);function n(e){var c;return Object(h.a)(this,n),(c=t.call(this,e)).add=function(){},c.addButton=function(){return Object(w.jsx)("button",{onClick:c.add,children:"Add"})},c.updateObject=function(e){c.setState({object:e})},c.state={object:null},c}return Object(x.a)(n,[{key:"render",value:function(){var e=Ms()(zs.AddObjectRow());return Object(w.jsx)(jo,{className:e,type:this.props.type,icon:eo,trash:this.addButton,object:this.state.object,onChange:this.updateObject,onRemove:eo})}}]),n}(i.a.Component)).displayName="AddObjectRow";var io=$s(ao),so=["string","boolean","number","date"],oo=function(e){Object(v.a)(n,e);var t=Object(p.a)(n);function n(){return Object(h.a)(this,n),t.apply(this,arguments)}return Object(x.a)(n,[{key:"render",value:function(){return Object(w.jsx)("td",{className:"text-center",children:"-"})}}]),n}(i.a.Component);oo.displayName="EmptyCell";var lo=function(e){var t,n=e.value,c=e.type,r=e.onChange,i=Ms()("form-control",zs.EditorInput(),zs.EditorInput("--value")),s=Object(a.useState)(n||""),o=Object(f.a)(s,2),l=o[0],d=o[1];return Object(a.useEffect)((function(){d(n)}),[n]),console.log("type",c,"value",n),Object(w.jsx)("td",{className:zs.Cell("--value"),children:wn.a.isUndefined(c.disabled)?Object(w.jsx)("input",{className:i,type:wn.a.isUndefined(c.numeric)&&1==c.numeric?"number":"text",value:l,required:!!c.required,onChange:function(e){d(e.target.value),r(Number(e.target.value))}}):(t=l,"Invalid Date"===new Date(t)||isNaN(new Date(t))?l:nt(l))})},uo=function(e){Object(v.a)(n,e);var t=Object(p.a)(n);function n(){var e;Object(h.a)(this,n);for(var c=arguments.length,r=new Array(c),a=0;a<c;a++)r[a]=arguments[a];return(e=t.call.apply(t,[this].concat(r))).state={open:!1},e.clickEdit=function(t){e.setState({open:!e.state.open})},e.close=function(t){e.setState({open:!1})},e.renderEditor=function(){var t=e.props.type._type&&null!==e.props.type._type.match(/array/)||Array.isArray(e.props.value),n=t?io:ro,c=t?e.props.type._elementType||Qs.any:e.props.type,r=e.props.value||[];return Object(w.jsx)(n,{onClickScrim:e.close,className:zs.Editor("--inside"),type:c,object:e.props.value,onUpdateElement:function(t,n){return"undefined"!==typeof n?e.props.onChange(cs()(r,Object(g.a)({},n,{$set:t}))):e.props.onChange(t)},onRemoveElement:function(e,t){},onAddElement:function(e){}})},e}return Object(x.a)(n,[{key:"render",value:function(){return Object(w.jsx)("td",{className:zs.Cell("--object"),children:this.renderEditor()})}}]),n}(i.a.Component);uo.displayName="ObjectCell";var jo=function(e){e.onRemove;var t=function(e,t,n){return wn.a.includes(so,e)?wn.a.isUndefined(t.type)||"UNITE"==t.type||"BOLUS"==t.type?function(e){return"prixParCC"==e||"prixqttccvente"==e?oo:lo}(n):"FLACON"==t.type?function(e,t){return 0==e.condml&&0==e.qttccpvente&&"prixqttccvente"==t?oo:lo}(t,n):lo:uo},n=Ms()(zs.ElementRow(),e.className||"");return Object(w.jsx)("tr",{className:n,children:wn.a.map(Object.keys(e.type),(function(n){var c=e.object?e.object[n]:null;return function(e,n,c,r,a){var i=t(e._type,n,c);return Object(w.jsx)(i,{type:e,value:r,onChange:a})}(e.type[n],e.object,n,c,function(t){return function(n){return e.object?e.onChange(cs()(e.object,Object(g.a)({},t,{$set:n}))):e.onChange(Object(g.a)({},t,n))}}(n))}))})};jo.displayName="ElementRow";var bo=function(e){var t=e.object,n=e.onChange,c=e.trad,r=e.type,i=Object(a.useState)([]),s=Object(f.a)(i,2),o=(s[0],s[1]);Object(a.useEffect)((function(){o(t)}),[t]);var l=Object(a.useCallback)((function(e){}),[]),d=Object(a.useCallback)((function(e,t){}),[]),u=Array.isArray(t)?ao:co;return console.log("state",t),Object(w.jsx)("div",{style:{display:"flex",alignItems:"flex-start",marginBottom:"20px"},children:Object(w.jsx)(u,{className:"editor--outside",object:t,trad:c,type:r,onUpdateElement:function(e,c){"undefined"!==typeof c&&n(cs()(t,Object(g.a)({},c,{$set:e})))},onAddElement:l,onRemoveElement:d})})},mo={dateCom:Qs.string({disabled:!0}),contenu:Qs.arrayOf({name:Qs.string({disabled:!0}),prixVente:Qs.number({numeric:!0}),prixParCC:Qs.number({numeric:!0}),prixqttccvente:Qs.number({numeric:!0})})()},Oo=function(){Object(j.g)();var e,t,n,c,r,i,s=Object(P.useSelector)((function(e){return e.searchbydate})),o=Qe()().isoWeekday(1).startOf("week"),l=Qe()().endOf("week"),d=Object(a.useState)([]),u=Object(f.a)(d,2),b=(u[0],u[1],Object(a.useState)([])),m=Object(f.a)(b,2),O=(m[0],m[1],Object(a.useState)(o)),h=Object(f.a)(O,2),x=h[0],v=h[1],p=Object(a.useState)(l),g=Object(f.a)(p,2),y=g[0],N=g[1],C=Object(a.useState)([s.deb,s.fin]),S=Object(f.a)(C,2),q=S[0],E=S[1],A=Object(j.i)().id,D=Object(P.useDispatch)(),V=Object(P.useSelector)(Jn("commandes").value),F=(Object(P.useSelector)(Jn("commandes").meta),Object(P.useSelector)(Jn("products").value));Object(a.useEffect)((function(){D(Xn("products").get(A))}),[]),Object(a.useEffect)((function(){null!==q?(q[0]&&v(q[0]),q[0]&&N(q[1])):(v(o),N(l))}),[q]),Object(a.useEffect)((function(){null!==q&&q[0]&&D(is(q[0],q[1]))}),[q]),Object(a.useEffect)((function(){x&&y&&(console.log("get vente"),D(Zn("vente-cva",x,y,A)))}),[x,y]);var R=Object(a.useCallback)((function(e){console.log("changed",e),D(Xn("commandes").setItems(e))}),[]);return console.log("render change",V),Object(w.jsxs)(Xe,{children:[Object(w.jsx)(Ke,{title:"Historique de commande  ".concat((null===(e=F[0])||void 0===e?void 0:e.name)?null===(t=F[0])||void 0===t?void 0:t.name:""),children:Object(w.jsx)(We,{title:"Historique de commande ".concat((null===(n=F[0])||void 0===n?void 0:n.name)?null===(c=F[0])||void 0===c?void 0:c.name:"")})}),Object(w.jsxs)($e,{children:[Object(w.jsxs)("div",{className:"d-flex flex-row justify-content-between",children:[Object(w.jsx)("div",{children:Object(w.jsxs)("div",{children:[x&&y&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsxs)("h2",{class:"text-uppercase my-1",children:['Commande de  "',(null===(r=F[0])||void 0===r?void 0:r.name)?null===(i=F[0])||void 0===i?void 0:i.name:"",'"']}),Object(w.jsxs)("span",{children:["Du: ",nt(x)," Au ",nt(y)]})]})," "]})}),Object(w.jsxs)("div",{className:"d-flex flex-row",children:[Object(w.jsx)("div",{className:"mr-3",children:Object(w.jsx)(et.a,{locale:"fr-FR",onChange:E,value:q})}),Object(w.jsx)("div",{children:Object(w.jsx)("button",{className:"btn bg-thead text-white mb-1 btn-sm",onClick:function(){D(Xn("commandes").updateData({commandes:V},"update-many-commandes")),Object(En.b)("Modification des prix appliqu\xe9s !!!",{autoClose:5e3})},children:"Enregistrer"})})]})]}),V.length>0?Object(w.jsx)(bo,{object:V,onChange:R,type:mo}):Object(w.jsx)("div",{className:"alert bg-thead text-white mt-2 text-center",children:" Aucune resultat trouv\xe9 "})]})]})},ho=function(){Object(a.useEffect)((function(){window.scrollTo(0,0)}),[])},xo=["isAuth","role","component","path"],vo=function(e){var t=e.isAuth,n=e.role,c=e.component,r=e.path,a=Object(tt.a)(e,xo);return ho(),Object(w.jsx)(j.b,Object(dt.a)(Object(dt.a)({},a),{},{render:function(e){var a=(e.location.state||{from:{pathname:"/"}}).from;return!t||n!==ma||r!==ge&&r!==ye?Object(w.jsx)("div",{children:Object(w.jsx)(_e,{title:"CBV AMBALAVAO",children:Object(w.jsx)(c,Object(dt.a)({},e))})}):Object(w.jsx)(j.a,{to:a})}}))};vo.defaultProps={isAuth:!1,role:ma,path:"/"};Object(P.connect)((function(e){var t,n=e.auth;return{isAuth:null===n||void 0===n?void 0:n.isLoggedIn,role:(null===n||void 0===n||null===(t=n.user)||void 0===t?void 0:t.role)||""}}))(vo);function po(){return Xr.b().shape({username:Xr.c().required("Le nom d'utilisateur ne doit pas etre vide")})}var fo=function(){Object(P.useDispatch)(),Object(b.a)();return Object(w.jsx)("div",{children:Object(w.jsx)(ar,{id:"login-form",enableReinitialize:!0,initialValues:{username:"",password:""},validations:po,onSubmit:function(e,t){e.username,e.password},render:function(e){e.values;return Object(w.jsx)(ar.Element,{children:Object(w.jsx)("div",{className:"login-box",children:Object(w.jsx)("div",{className:"login-container  col-4",children:Object(w.jsxs)("div",{className:"card",children:[Object(w.jsx)("div",{className:"card-header d-flex flex-row justify-content-center bg-dark  text-white",children:Object(w.jsx)("div",{className:"card-title text-uppercase",children:"Connexion"})}),Object(w.jsxs)("div",{className:"card-body login-card-body",children:[Object(w.jsx)(ar.Field.Input,{name:"username",label:"Nom d'utilisateur",placeholder:"Nom d'utilisateur"}),Object(w.jsx)(ar.Field.Password,{name:"password",label:"Mot de passe",placeholder:"Mot de passe"}),Object(w.jsx)("div",{className:"d-flex flex-row justify-content-end mt-3",children:Object(w.jsx)("button",{className:"btn btn-green btn-md",type:"submit",children:"Se connecter"})})]})]})})})})}})})},go=i.a.createContext();function yo(e){var t=e.children,n=Object(P.useSelector)((function(e){var t,n;return{user:null===(t=e.auth)||void 0===t?void 0:t.user,auth:e.auth,isLoggedIn:null===(n=e.auth)||void 0===n?void 0:n.isLoggedIn}})),c={user:n.user,auth:n.auth,isLoggedIn:n.isLoggedIn};return Object(w.jsx)(go.Provider,{value:c,children:t})}function No(e){var t=e.children;return Object(w.jsx)(go.Consumer,{children:function(e){if(void 0===e)throw new Error("Data  must be used within a AuthContext");return t(e)}})}var Co=function(){var e=Object(P.useDispatch)();return Object(w.jsx)("div",{children:Object(w.jsx)(yo,{children:Object(w.jsx)(No,{children:function(t){var n=t.user,c=t.isLoggedIn;return Object(w.jsxs)(w.Fragment,{children:[c&&Object(w.jsx)(j.a,{to:{pathname:"/",state:{notification:{message:"Vous vous  etes connect\xe9 avec succes",type:"success"}}}}),null!=(null===n||void 0===n?void 0:n.error)&&Object(w.jsx)("div",{children:null===n||void 0===n?void 0:n.error.message}),Object(w.jsx)("h3",{children:"creer un compte"}),Object(w.jsxs)("div",{borderTop:"4px",boxShadow:"md",bg:"white",px:8,py:3,w:400,children:[c&&Object(w.jsx)(j.a,{to:"/"}),Object(w.jsx)(ar,{enableReinitialize:!0,initialValues:{username:"",password:"",role:"ROLE_VENDEUR"},validations:{},onSubmit:function(t,n){var c=t.username,r=t.password,a=t.role;e(function(e){var t=e.username,n=e.password,c=e.role;return function(){var e=Object(Q.a)(L.a.mark((function e(r){return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.post(ha,{username:t,password:n,role:c}).then((function(e){e.data.token&&localStorage.setItem("user-veto",JSON.stringify(e.data.token)),r({type:H,payload:{user:e.data,success:"success operation",error:null}}),Oa.push("/")})).catch((function(e){r({type:U,payload:{user:null,success:null,error:e}})}));case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),r({type:U,payload:{user:null,success:null,error:e.t0}});case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}()}({username:c,password:r,role:a}))},children:Object(w.jsxs)(ar.Element,{children:[Object(w.jsx)(ar.Field.Input,{border:"1px",name:"username",label:"Nom d'utilisateur",placeholder:"ex: Nom d'utilisateur",mb:3}),Object(w.jsx)(ar.Field.Input,{name:"password",label:"Mot de passe",placeholder:"Mot de passe",type:"password"}),Object(w.jsx)(ar.Field.Select,{label:"Role",name:"role",valueKey:"name",options:[{id:"ROLE_VENDEUR",name:"VENDEUR"},{id:"ROLE_ADMIN",name:"ADMIN"},{id:"ROLE_SEMI_ADMIN",name:"ROLE_SEMI_ADMIN"}]}),Object(w.jsx)("div",{children:Object(w.jsx)("button",{color:"white",type:"submit",mt:4,children:"Se connecter"})})]})})]})]})}})})})},So=["isAuth","role","component"],qo=function(e){e.isAuth,e.role;var t=e.component,n=Object(tt.a)(e,So);return ho(),Object(w.jsx)(j.b,Object(dt.a)(Object(dt.a)({},n),{},{component:function(e){return Object(w.jsx)(t,Object(dt.a)({},e))}}))};qo.defaultProps={isAuth:!1,role:ma};var wo=Object(P.connect)((function(e){var t,n=e.auth;return{isAuth:null===n||void 0===n?void 0:n.isLoggedIn,role:(null===n||void 0===n||null===(t=n.user)||void 0===t?void 0:t.role)||""}}))(qo),Eo="SET_TO_MAGASIN_ITEMS",Ao="ADD_TO_MAGASIN",Do="REMOVE_FROM_MAGASIN",Po="CLEAR_MAGASIN",Vo="ADD_QTY_MAGASIN_ITEM",Fo="MINUS_QTY_MAGASIN_ITEM",Ro="ADD_QTY_NUMBER_MAGASIN_ITEM",To=function(){return{type:Po}},Mo=function(e,t){var n=function(t){return!!(null===e||void 0===e?void 0:e.find((function(e){return(null===e||void 0===e?void 0:e.id)===t})))};return{tomagasin:e,isItemOnDepotToMagasin:n,addToMagasin:function(e){n(e.id)?t(function(e){return{type:Do,payload:e}}(e.id)):t(function(e){return{type:Ao,payload:e}}(e))}}},Bo=function(e){var t,n=e.product,c=Object(P.useSelector)((function(e){return e.tomagasins})),r=Object(P.useDispatch)(),a=Mo(c,r),i=a.isItemOnDepotToMagasin,s=a.addToMagasin,o=!!i&&i(n.id);return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(pr.a.Item,{children:Object(w.jsxs)(fr.a,{className:"product-card m-2 ".concat(n.id?"":"product-loading"),style:{border:n&&o?"1px solid #a6a5a5":"",paddingTop:n&&o?"5px":"0px",boxShadow:n&&o?"0 10px 15px rgba(0, 0, 0, .07)":"none"},children:[Object(w.jsxs)(gr.a,{xs:9,children:[Object(w.jsxs)("div",{children:[n.name," "]}),Object(w.jsx)("div",{class:"badge badge-primary",children:null===n||void 0===n||null===(t=n.fournisseur)||void 0===t?void 0:t.name})]}),Object(w.jsx)(gr.a,{xs:3,children:n.id&&Object(w.jsx)("button",{disabled:n.quantityBrute<=0,className:" ".concat(o?"btn btn-danger btn-sm":"btn btn-green btn-sm"),onClick:function(){s&&s(n)},children:o?"Retirer":"Ajouter"})})]})})})},ko=function(e){var t=e.product,n=Object(P.useDispatch)(),c=function(e){n(function(e,t){return{type:Ro,payload:{id:e,value:t}}}(t.id,e))};return Object(w.jsx)("div",{className:"basket-item-control",children:Object(w.jsxs)(Xc.c,{w:28,bg:"whitesmoke",onChange:function(e){c(e)},min:0,defaultValue:t.quantityParProduct,step:1,max:t.quantityBrute,children:[Object(w.jsx)(Xc.d,{}),Object(w.jsxs)(Xc.e,{children:[Object(w.jsx)(Xc.b,{}),Object(w.jsx)(Xc.a,{})]})]})})},_o=function(e){var t=e.product,n=Object(P.useDispatch)(),c=Object(P.useSelector)((function(e){return e.tomagasins})),r=Mo(c,n),a=r.isItemOnDepotToMagasin,i=r.addToMagasin,s=!!a&&a(t.id);return Object(w.jsx)("div",{children:Object(w.jsxs)("div",{className:"d-flex justify-content-between align-items-center border   mb-2 p-2",children:[Object(w.jsxs)("div",{style:{width:"45%"},children:[Object(w.jsx)("p",{children:t.name}),Object(w.jsx)("span",{children:Object(w.jsxs)("strong",{children:[" ",ct(t.prixVente)]})})]}),Object(w.jsxs)("div",{className:"text-inline",children:[Object(w.jsxs)("small",{children:[t.type," "]}),Object(w.jsx)(ko,{product:t})]}),Object(w.jsx)("div",{children:s&&Object(w.jsx)("button",{onClick:function(){i&&i(t)},className:"btn btn-danger btn-xs text-right",children:"X"})})]})})},Io=function(){var e=Object(P.useSelector)((function(e){return{tomagasins:e.tomagasins}})).tomagasins,t=new Date,n=Object(a.useState)(t),c=Object(f.a)(n,2),r=c[0],i=c[1],s=Object(j.g)(),o=Object(P.useSelector)(Jn("commandes").meta),l=(Object(P.useSelector)(Jn("sortiedepots").meta),Object(P.useDispatch)());Object(a.useEffect)((function(){l(To()),l(Xn("commandes").fetch()),l(Xn("sortiedepots").fetch())}),[]);var d;t.getDate(),t.getMonth(),t.getFullYear(),t.getHours(),t.getMinutes(),t.getSeconds();return Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)(lr.a,{children:[Object(w.jsx)(lr.a.Header,{className:"bg-dark text-white d-flex justify-content-between align-items-center",children:Object(w.jsxs)("div",{children:["Depot to Magasin ("," ".concat(e.length," ").concat(e.length>1?"articles":"article"),")"]})}),Object(w.jsxs)(lr.a.Body,{children:[Object(w.jsxs)("div",{class:"form-group",children:[Object(w.jsx)("label",{children:"Date de sortie :"}),Object(w.jsx)("div",{children:Object(w.jsx)("input",{type:"date",onChange:function(e){return i(e.target.value)},value:r,className:"form-control"})})]}),e.length<=0&&Object(w.jsx)("div",{class:"alert alert-success ",children:'Choississez un produit sur la section "Produits" puis cliquez sur "Ajouter"'}),null===e||void 0===e?void 0:e.map((function(t,n){return Object(w.jsx)(_o,{product:t,tomagasin:e,dispatch:l},"".concat(null===t||void 0===t?void 0:t.id,"_").concat(n))})),e.length>0&&Object(w.jsxs)("div",{className:"d-flex justify-content-end",children:[Object(w.jsx)("button",{className:"btn btn-green btn-sm mr-2",disabled:0===e.length,onClick:function(){l(Xn("commandes").createTransaction({id:Number(o.nextId),contenu:e,type:"cva",sorte:"sortie",status:!0,dateCom:null!=r?r:t},"add-to-magasin")),l(To()),s.push(Ce)},type:"button",children:"Valider l'operation"}),Object(w.jsx)("button",{className:"btn btn-danger btn-sm",onClick:function(){0!==e.length&&l(To())},type:"button",children:Object(w.jsx)("span",{children:"Annuler"})})]})]}),e.length>0&&Object(w.jsx)(lr.a.Footer,{className:"d-flex justify-content-between",children:Object(w.jsx)("div",{children:Object(w.jsxs)("h3",{style:{fontSize:"14px"},children:[Object(w.jsx)("strong",{children:"Total : "}),ct((d=e.map((function(e){return e.prixVente*e.quantityParProduct})),d&&0!==(null===d||void 0===d?void 0:d.length)?d.reduce((function(e,t){return e+t}),0):0))]})})})]})})},Lo=function(){var e=Object(a.useState)([]),t=Object(f.a)(e,2),n=t[0],c=t[1],r=Object(a.useState)(!1),i=Object(f.a)(r,2),s=(i[0],i[1],Object(P.useSelector)(Jn("products").value)),o=Object(P.useSelector)(Jn("products").meta),l=Object(P.useDispatch)(),d=Object(a.useState)(""),u=Object(f.a)(d,2),j=u[0],b=u[1];return Object(a.useEffect)((function(){l(Xn("products").fetch())}),[]),Object(a.useEffect)((function(){o.isFetching||c(s)}),[o]),Object(a.useEffect)((function(){c(Mr(s,j))}),[j]),Object(w.jsx)(Fr.a,{children:Object(w.jsxs)(fr.a,{children:[Object(w.jsx)(gr.a,{xs:6,children:Object(w.jsxs)(lr.a,{children:[Object(w.jsx)(lr.a.Header,{className:"bg-dark p-2 text-white d-flex text-uppercase justify-content-between align-items-center",children:"Produits"}),Object(w.jsxs)(lr.a.Body,{children:[Object(w.jsxs)(pr.a,{children:[Object(w.jsx)("input",{type:"text",onChange:function(e){b(e.target.value)},placeholder:"Nom du produit",className:"form-control mb-2"}),Object(w.jsxs)("div",{style:{overflowY:"auto",height:"350px",maxHeight:"350px",overflowX:"hidden"},children:[n.map((function(e){return Object(w.jsx)(Bo,{product:e})})),0===s.length&&"Aucune enregistrement trouv\xe9"]})]})," "]})," "]})}),Object(w.jsx)(gr.a,{xs:6,children:Object(w.jsx)(Io,{})})]})})},Qo=function(){return Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)(Xe,{children:[Object(w.jsx)(Ke,{title:"Depot vers magasin",children:Object(w.jsx)(We,{title:"Depot vers magasin"})}),Object(w.jsx)($e,{children:Object(w.jsx)(Lo,{})})]})})};var Ho=function(e){var t=e.model,n=e.isDisabled,c=e.entity,r=Object(P.useDispatch)(),a=Object(j.g)();return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)("button",{className:"btn btn-danger btn-sm",disabled:n,onClick:function(e){e.preventDefault(),window.confirm("Vous voulez vraiment supprimer le produit ?")&&(r(Xn(t).deleteTransaction(c,"/delete-to-magasin")),a.goBack())},children:"Supprimer"})})},Uo=function(e){for(var t=0;t<e.length;++t)return e[t].correction>0},Yo=function(){var e=Qe()().isoWeekday(1).startOf("week"),t=Qe()().endOf("week"),n=Object(a.useState)(e),c=Object(f.a)(n,2),r=c[0],i=c[1],s=Object(a.useState)(t),o=Object(f.a)(s,2),l=o[0],d=o[1],j=Object(a.useState)([e,t]),b=Object(f.a)(j,2),m=b[0],O=b[1],h=(Object(a.useRef)(null),Object(a.useRef)(null),Object(P.useSelector)(Jn("commandes").value)),x=Object(P.useSelector)(Jn("commandes").meta),v=Object(P.useDispatch)();Object(a.useEffect)((function(){v(function(e,t){return Ln("commandes",{path:"/cva?deb=".concat(e,"&fin=").concat(t),replace:!0})}(r,l))}),[r,l]),Object(a.useEffect)((function(){null!==m?(m[0]&&i(m[0]),m[1]&&d(m[1])):(i(e),d(t))}),[m]);var p=function(e){if(!e||0===(null===e||void 0===e?void 0:e.length))return 0;var t=0;return e.forEach((function(e){t+=e.prixVente*e.quantityParProduct*1})),t},g=function(e){var t=0;return null===e||void 0===e||e.forEach((function(e){t+=1*e.quantityParProduct})),t},y=[{Header:"Date",Cell:function(e){var t;return Object(w.jsx)("div",{children:nt(null===(t=e.row.original)||void 0===t?void 0:t.dateCom)})}},{Header:"Produits",Cell:function(e){var t,n,c,r,a,i;return Object(w.jsxs)("div",{style:{width:"350px"},children:[1==(null===(t=e.row.original)||void 0===t?void 0:t.isdeleted)&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("div",{className:"badge badge-danger",children:"Supprim\xe9"}),Object(w.jsxs)("div",{className:"text text-danger",children:["Date de suppression :"," ",nt(null===(n=e.row.original)||void 0===n?void 0:n.deletedat)]})]}),null==(null===(c=e.row.original)||void 0===c?void 0:c.isdeleted)&&Object(w.jsx)("p",{children:Uo(null===(r=e.row.original)||void 0===r?void 0:r.contenu)&&Object(w.jsx)("div",{className:"badge badge-warning",children:"Modifi\xe9"})}),null===(a=e.row.original)||void 0===a||null===(i=a.contenu)||void 0===i?void 0:i.map((function(t){var n,c;return Object(w.jsxs)("span",{children:[Object(w.jsx)("span",{style:{background:"white",color:1==(null===(n=e.row.original)||void 0===n?void 0:n.isdeleted)?"red":"inherit",padding:2},children:t.name}),Object(w.jsxs)("span",{style:{color:1==(null===(c=e.row.original)||void 0===c?void 0:c.isdeleted)?"red":"inherit"},children:[" "," || "]})]})}))]})}},{Header:"Qt\xe9",Cell:function(e){var t;return Object(w.jsx)("div",{children:g(null===(t=e.row.original)||void 0===t?void 0:t.contenu)})}},{Header:"Total",Cell:function(e){var t;return Object(w.jsx)("div",{children:ct(p(null===(t=e.row.original)||void 0===t?void 0:t.contenu))})}},{Header:"Actions",Cell:function(e){var t,n,c,r=1==(null===(t=e.row.original)||void 0===t?void 0:t.isdeleted);return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(u.b,{to:"/depot/to/magasin/detail/".concat(null===(n=e.row.original)||void 0===n?void 0:n.id),className:"btn btn-green btn-sm mr-2",disabled:r,children:"D\xe9tails"}),Object(w.jsx)(u.b,{to:"/depot/to/magasin/edit/".concat(null===(c=e.row.original)||void 0===c?void 0:c.id),className:"btn btn-warning btn-sm mr-2",disabled:r,children:"Editer"}),Object(w.jsx)(Ho,{model:"tomagasins",isDisabled:r,entity:e.row.original})]})}}];return Object(w.jsxs)(Xe,{children:[Object(w.jsx)(Ke,{title:"Historique sortie vers Magasin",children:Object(w.jsx)(We,{title:"Historique sortie vers Magasin"})}),Object(w.jsxs)($e,{children:[Object(w.jsxs)("div",{className:"row",children:[Object(w.jsx)("div",{className:"col-lg-6",children:Object(w.jsxs)("div",{children:[Object(w.jsx)("h3",{className:"text-uppercase",children:"Historique de sortie vers Magasin"}),Object(w.jsx)("p",{children:"".concat(nt(r)," ->  ").concat(nt(l))})]})}),Object(w.jsx)("div",{className:"col-lg-6 text-right",children:Object(w.jsx)(kr.a,{locale:"fr-FR",onChange:O,value:m})})," "]}),Object(w.jsx)(mr,{filter:!1,data:h.sort((function(e,t){return t.id-e.id})),meta:x,columns:y})]})," "]})};var Ko=function(e){var t=e.model,n=e.entity,c=Object(P.useDispatch)();return Object(j.g)(),Object(w.jsx)(w.Fragment,{children:Object(w.jsx)("button",{className:"btn btn-danger btn-sm",onClick:function(e){e.preventDefault(),window.confirm("Vous voulez vraiment supprimer ce commande ?")&&c(Xn(t).createTransaction({commande:n,original:n},"/delete-from-magasin"))},children:"Supprimer"})})},zo=new Date;function Wo(){var e=Object(a.useState)({hours:zo.getHours(),minutes:zo.getMinutes(),seconds:zo.getSeconds()}),t=Object(f.a)(e,2),n=t[0],c=t[1];return Object(a.useEffect)((function(){var e=setInterval((function(){var e=new Date;c({hours:e.getHours()<10?"0"+e.getHours():e.getHours(),minutes:e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes(),seconds:e.getSeconds()<10?"0"+e.getSeconds():e.getSeconds()})}),1e3);return function(){return clearInterval(e)}}),[]),Object(w.jsxs)("div",{className:"bg-dark py-1 px-4 text-center",children:[Object(w.jsxs)("h1",{style:{fontSize:"20px"},children:[n.hours," : ",n.minutes," : ",n.seconds]}),Object(w.jsx)("h4",{className:"bg-thead p-1",children:nt(zo)})]})}var Go=i.a.memo(Wo,He.reactFastCompare);function Xo(){var e=Object(j.h)();return console.log(e.pathname),Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("div",{className:"bg-dark text-white py-3 d-flex justify-content-center align-items-center",children:Object(w.jsx)("h1",{className:"",children:"CABINET VETERINAIRE AMBALAVAO"})}),Object(w.jsxs)("div",{className:"py-2",children:[Object(w.jsxs)("div",{class:"d-flex justify-content-between align-items-center",children:[Object(w.jsx)("div",{}),Object(w.jsx)("div",{children:Object(w.jsx)(Go,{})}),Object(w.jsx)("div",{className:"bg-thead"})]}),Object(w.jsxs)("div",{class:"d-flex justify-content-center mt-2 align-items-center",children:[Object(w.jsx)(u.b,{className:"btn bg-".concat("/vendeur"==e.pathname||"/Vendeur"==e.pathname?"thead":"dark"," text-white mb-2 mr-2 btn-sm"),to:"/Vendeur",children:"Vente"}),Object(w.jsx)(u.b,{className:"btn bg-".concat("/historique/vente/vendeur/vente-cva"==e.pathname?"thead":"dark"," text-white mb-2 mr-2 btn-sm"),to:"/historique/vente/vendeur/vente-cva",children:"Historique de vente"}),Object(w.jsx)(u.b,{className:"btn bg-".concat("/stock-cva"==e.pathname?"thead":"dark"," text-white mb-2 mr-2 btn-sm"),to:"/stock-cva",children:"Stocks"}),Object(w.jsx)(u.b,{className:"btn bg-".concat("/historique/vente/vendeur/credit-cva"==e.pathname?"thead":"dark"," text-white mb-2 mr-2 btn-sm"),to:"/historique/vente/vendeur/credit-cva",children:"Credits"})]})]})]})}var Jo=function(){var e=Object(P.useSelector)((function(e){return e.searchbydate})),t=Object(j.i)().type,n=Object(a.useState)([e.deb,e.fin]),c=Object(f.a)(n,2),r=c[0],s=c[1],o=(Object(a.useRef)(null),Object(a.useRef)(null),Object(P.useSelector)(Jn("commandes").value)),l=Object(P.useSelector)(Jn("commandes").meta),d=Object(P.useDispatch)();Object(a.useEffect)((function(){d(ec(e.deb,e.fin,t))}),[e.deb,e.fin]),Object(a.useEffect)((function(){null!==r&&r[0]&&d(is(r[0],r[1]))}),[r]);var b=function(e){return e&&0!==(null===e||void 0===e?void 0:e.length)?e.reduce((function(e,t){return e+t}),0):0},m=function(e){return b(null===e||void 0===e?void 0:e.map((function(e){return Wi(e)?e.prixqttccvente*e.quantityParProduct*e.qttccpvente+e.prixlitre*e.qttbylitre:e.prixVente*e.quantityParProduct})))+b(null===e||void 0===e?void 0:e.map((function(e){return e.prixParCC*e.qttByCC})))},O=i.a.useMemo((function(){return[{Header:"Date",Cell:function(e){var t;return Object(w.jsx)(w.Fragment,{children:nt(null===(t=e.row.original)||void 0===t?void 0:t.dateCom)})}},{Header:"Produits",Cell:function(e){var t,n;return Object(w.jsxs)("div",{style:{width:"350px"},children:[1==e.row.original.isdeleted&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("div",{className:"badge badge-danger",children:"Supprim\xe9"}),Object(w.jsxs)("div",{className:"text text-danger",children:["Date de suppression :"," ",nt(e.row.original.deletedat)]})]}),null===(t=e.row.original)||void 0===t||null===(n=t.contenu)||void 0===n?void 0:n.map((function(t){var n,c;return Object(w.jsxs)("span",{children:[Object(w.jsx)("span",{style:{background:"white",color:1==(null===(n=e.row.original)||void 0===n?void 0:n.isdeleted)?"red":"inherit",padding:2},children:t.name}),Object(w.jsxs)("span",{style:{color:1==(null===(c=e.row.original)||void 0===c?void 0:c.isdeleted)?"red":"inherit"},children:[" "," || "]})]})}))]})}},{Header:"Total",Cell:function(e){var t;return Object(w.jsx)("div",{children:ct(m(null===(t=e.row.original)||void 0===t?void 0:t.contenu))})}},{Header:"Actions",Cell:function(e){var t;return Object(w.jsx)(w.Fragment,{children:!e.row.original.isdeleted&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(u.b,{to:"/detailvendeur/".concat(null===(t=e.row.original)||void 0===t?void 0:t.id),className:"btn btn-green btn-sm mr-2",children:"D\xe9tails"}),Object(w.jsx)(Ko,{model:"fromagasins",entity:e.row.original})]})})}}]}),[]);return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)("div",{children:Object(w.jsxs)(Fr.a,{children:[Object(w.jsx)(Xo,{}),Object(w.jsxs)("div",{className:"row",children:[Object(w.jsx)("div",{className:"col-lg-6",children:Object(w.jsxs)("div",{children:[Object(w.jsx)("h3",{className:"text-uppercase",children:"vente-cva"==t?"Historique de vente":"CREDIT"}),Object(w.jsx)("p",{children:"".concat(nt(e.deb)," ->  ").concat(nt(e.fin))}),Object(w.jsx)("div",{className:"bg-thead p-3 my-2",style:{width:"30%"},children:Object(w.jsxs)("h2",{children:["Recette: ",ct(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=e.filter((function(e){return 1!=e.isdeleted})),n=0;return o.length>0?t.map((function(e){n+=m(null===e||void 0===e?void 0:e.contenu)})):n=0,n}(o))]})})]})}),Object(w.jsx)("div",{className:"col-lg-6 text-right",children:Object(w.jsx)(kr.a,{locale:"fr-FR",onChange:s,value:r})})," "]}),Object(w.jsx)(mr,{data:o.sort((function(e,t){return t.id-e.id})),meta:l,columns:O,filter:!1})]})})})},$o=function(e){return!(0==e.condml||0==e.condsize||0==e.qttccpvente||0==e.prixqttccvente)},Zo=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,c=arguments.length>3?arguments[3]:void 0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"inc",a=0,i=0,s=0,o=0,l=0,d=0,u=!0,j=e.condml,b=e.condsize;if(console.log(t),"mcinc"==r){var m=Number(e.quantityCCCVA)+Number(t);Number(m)>=Number(j)?(a=Math.floor(m/Number(j)),o=Number(t)-Number(j)*a,e.quantityCCCVA+o>=Number(j)&&(a+=1)):e.quantityCCCVA+Number(t)>=Number(j)&&(a+=1);var O=Number(a)+Number(n);Number(O)>=Number(b)?(i=Math.floor(O/Number(b)),d=Number(O)-Number(b)*i,e.condval+d>=Number(b)&&(i+=1)):e.condval+Number(O)>=Number(b)&&(i+=1),e.quantityBruteCVA+i-c<0&&(u=!1)}else if("mdecinc"==r){Number(t)>=Number(j)?(a=Math.floor(Number(t)/Number(j)),o=Number(t)-Number(j)*a,e.quantityCCCVA-o<0&&(a+=1)):e.quantityCCCVA-Number(t)<0&&(a+=1);var h=Number(a);Number(h)>=Number(b)?(s=Math.floor(Number(h)/Number(b)),l=Number(h)-Number(b)*s,e.condval-l<0&&(s+=1)):e.condval-Number(h)<0&&(s+=1);var x=Number(n);Number(x)>=Number(b)?(i=Math.floor(x/Number(b)),d=Number(x)-Number(b)*i,e.condval+d>=Number(b)?i+=1:e.condval=Number(e.condval)+d):e.condval+Number(x)>=Number(b)&&(i+=1);var v=e.quantityBruteCVA+c+i;v-s<0&&(u=!1)}else if("decinc"==r){Number(t)>=Number(j)?(a=Math.floor(Number(t)/Number(j)),o=Number(t)-Number(j)*a,e.quantityCCCVA-o<0&&(a+=1)):e.quantityCCCVA-Number(t)<0&&(a+=1);var p=Number(a);Number(p)>=Number(b)?(s=Math.floor(Number(p)/Number(b)),l=Number(p)-Number(b)*s,e.condval-l<0&&(s+=1)):e.condval-Number(p)<0&&(s+=1);var f=Number(n);Number(f)>=Number(b)?(i=Math.floor(f/Number(b)),d=Number(f)-Number(b)*i,e.condval+d>=Number(b)&&(i+=1)):e.condval+Number(f)>=Number(b)&&(i+=1),e.quantityBruteCVA+i-(c+s)<0&&(u=!1)}else{var g=Number(e.quantityCCCVA)+Number(t);Number(g)>=Number(j)?(a=Math.floor(g/Number(j)),o=Number(t)-Number(j)*a,e.quantityCCCVA+o>=Number(j)&&(a+=1)):(e.quantityCCCVA+Number(t)>=Number(j)&&(a+=1),u=!0)}return u},el=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,c=arguments.length>3?arguments[3]:void 0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"dec",a=0,i=0,s=0,o=0,l=!0,d=e.condml,u=e.condsize;if("pcdec"==r){Number(t)>=Number(d)?(a=Math.floor(Number(t)/Number(d)),s=Number(t)-Number(d)*a,e.quantityCCCVA-s<0&&(a+=1)):e.quantityCCCVA-Number(t)<0&&(a+=1);var j=Number(a)+Number(n);Number(j)>=Number(u)?(i=Math.floor(Number(j)/Number(u)),o=Number(j)-Number(u)*i,e.condval-o<0&&(i+=1)):e.condval-Number(j)<0&&(i+=1),e.quantityBruteCVA+c-i<0&&(l=!1)}else if("mincdec"==r){var b=0,m=0,O=0,h=0,x=e.condml,v=e.condsize,p=Number(e.quantityCCCVA)+Number(t);Number(p)>=Number(x)?(b=Math.floor(p/Number(x)),O=Number(t)-Number(x)*b,e.quantityCCCVA+O>=Number(x)&&(b+=1)):e.quantityCCCVA+Number(t)>=Number(x)&&(b+=1);var f=Number(b);Number(f)>=Number(v)?(m=Math.floor(f/Number(v)),h=Number(f)-Number(v)*m,e.condval+h>=Number(v)&&(m+=1)):e.condval+Number(f)>=Number(v)&&(m+=1);var g=Number(n);Number(g)>=Number(v)?(i=Math.floor(Number(g)/Number(v)),o=Number(g)-Number(v)*b,e.condval-o<0&&(i+=1)):e.condval-Number(g)<0?i+=1:e.condval=e.condval-Number(g);var y=e.quantityBruteCVA+m+c;y-i&&(l=!1)}else if("incdec"==r){var N=0,C=0,S=0,q=0,w=e.condml,E=e.condsize,A=Number(e.quantityCCCVA)+Number(t);Number(A)>=Number(w)?(N=Math.floor(A/Number(w)),S=Number(t)-Number(w)*N,e.quantityCCCVA+S>=Number(w)&&(N+=1)):e.quantityCCCVA+Number(t)>=Number(w)&&(N+=1);var D=Number(N);Number(D)>=Number(E)?(C=Math.floor(D/Number(E)),q=Number(D)-Number(E)*C,e.condval+q>=Number(E)&&(C+=1)):e.condval+Number(D)>=Number(E)&&(C+=1);var P=Number(n);Number(P)>=Number(E)?(i=Math.floor(Number(P)/Number(E)),o=Number(P)-Number(E)*N,e.condval-o<0&&(i+=1)):e.condval-Number(P)<0&&(i+=1);var V=e.quantityBruteCVA+C,F=i+c;V-F<0&&(l=!1)}else{Number(t)>=Number(d)?(a=Math.floor(Number(t)/Number(d)),s=Number(t)-Number(d)*a,e.quantityCCCVA-s<0&&(a+=1)):e.quantityCCCVA-Number(t)<0&&(a+=1);var R=Number(a)+Number(n);Number(R)>=Number(u)?(i=Math.floor(Number(R)/Number(u)),o=Number(R)-Number(u)*i,e.condval-o<0&&(i+=1)):e.condval-Number(R)<0&&(i+=1);var T=i+c;e.quantityBruteCVA-T<0&&(l=!1)}return l},tl=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"dec",r=0,a=0,i=e.doseDefault,s=!0;if("incdec"!=c){Number(t)>=Number(i)?(r=Math.floor(Number(t)/Number(i)),a=Number(t)-Number(i)*r,e.quantityCCCVA-a<0&&(r+=1)):e.quantityCCCVA-Number(t)<0&&(r+=1);var o=r+n;e.quantityBruteCVA-o<0&&(s=!1)}else{var l=Number(e.quantityCCCVA)+Number(t);Number(l)>=Number(i)?(r=Math.floor(l/Number(i)),a=Number(t)-Number(i)*r,e.quantityCCCVA+a>=Number(i)&&(r+=1)):e.quantityCCCVA+Number(t)>=Number(i)&&(r+=1),e.quantityBruteCVA+r-n<0&&(s=!1)}return s},nl=function(e,t,n){var c=t.contenu.find((function(t){return t.id==e.id}));console.log("minitial",t);var r=!1,a=0,i=0,s=0,o=!0,l="none",d=n.quantityParProduct,u=n.qttByCC,j=n.qttbylitre;if($o(e)){r=!0,r=!1;var b=n.quantityParProduct,m=n.qttByCC,O=n.qttbylitre;console.log(b,m);var h=void 0!=c?null===c||void 0===c?void 0:c.quantityParProduct:n.condval,x=void 0!=c?null===c||void 0===c?void 0:c.qttByCC:n.quantityCCCVA,v=void 0!=c?null===c||void 0===c?void 0:c.qttbylitre:n.quantityBruteCVA;console.log(h,x,v),O==v&&b==h&&m==x&&(l="qttlitre == cmdqttlitre && qtt == cmdqtt && qttcc == cmdqttcc"),O==v&&b==h&&m>x&&(l="qttlitre == cmdqttlitre && qtt == cmdqtt && qttcc > cmdqttcc",0==(o=el(e,i=m-x,a,s))&&(u=x)),O==v&&b==h&&m<x&&(l="qttlitre == cmdqttlitre && qtt == cmdqtt && qttcc < cmdqttcc",i=x-m,o=!0),O==v&&b>h&&m==x&&(l="qttlitre == cmdqttlitre && qtt > cmdqtt && qttcc == cmdqttcc",0==(o=el(e,i,a=b-h,s))&&(d=h)),O==v&&b<h&&m==x&&(l="qttlitre == cmdqttlitre && qtt < cmdqtt && qttcc == cmdqttcc",a=h-b,o=!0),O==v&&b>h&&m>x&&(l="qttlitre == cmdqttlitre && qtt > cmdqtt && qttcc > cmdqttcc",0==(o=el(e,i=m-x,a=b-h,s))&&(u=x,d=h)),O==v&&b<h&&m<x&&(l="qttlitre == cmdqttlitre && qtt < cmdqtt && qttcc < cmdqttcc",a=h-b,i=x-m,o=!0),O==v&&b>h&&m<x&&(l="qttlitre == cmdqttlitre && qtt > cmdqtt && qttcc < cmdqttcc",0==(o=el(e,i=x-m,a=b-h,s,"incdec"))&&(u=x,d=h)),O==v&&b<h&&m>x&&(l="qttlitre == cmdqttlitre && qtt < cmdqtt && qttcc > cmdqttcc",0==(o=Zo(e,i=m-x,a=h-b,s,"decinc"))&&(u=x,d=h)),O>v&&b==h&&m==x&&(l="qttlitre > cmdqttlitre && qtt == cmdqtt && qttcc == cmdqttcc",0==(o=el(e,i,a,s=O-v))&&(j=v)),O<v&&b==h&&m==x&&(l="qttlitre < cmdqttlitre && qtt == cmdqtt && qttcc == cmdqttcc",s=v-O,o=!0),O>v&&b>h&&m>x&&(l="qttlitre > cmdqttlitre && qtt > cmdqtt && qttcc > cmdqttcc",0==(o=el(e,i=m-x,a=b-h,s=O-v))&&(u=x,d=h,j=v)),O>v&&b>h&&m<x&&(l="qttlitre > cmdqttlitre && qtt > cmdqtt && qttcc < cmdqttcc",0==(o=el(e,i=x-m,a=b-h,s=O-v,"incdec"))&&(u=x,d=h,j=v)),O>v&&b<h&&m>x&&(l="qttlitre > cmdqttlitre && qtt < cmdqtt && qttcc > cmdqttcc",0==(o=Zo(e,i=m-x,a=h-b,s=O-v,"decinc"))&&(u=x,d=h,j=v)),O>v&&b<h&&m<x&&(l="qttlitre > cmdqttlitre && qtt < cmdqtt && qttcc < cmdqttcc",0==(o=Zo(e,i=x-m,a=h-b,s=O-v,"mcinc"))&&(u=x,d=h,j=v)),O<v&&b>h&&m>x&&(l="qttlitre < cmdqttlitre && qtt > cmdqtt && qttcc > cmdqttcc",0==(o=el(e,i=m-x,a=b-h,s=v-O,"pcdec"))&&(u=x,d=h,j=v)),O<v&&b>h&&m<x&&(l="qttlitre < cmdqttlitre && qtt > cmdqtt && qttcc < cmdqttcc",0==(o=el(e,i=x-m,a=b-h,s=v-O,"mincdec"))&&(u=x,d=h,j=v)),O<v&&b<h&&m>x&&(l="qttlitre < cmdqttlitre && qtt < cmdqtt && qttcc > cmdqttcc",0==(o=Zo(e,i=m-x,a=h-b,s=v-O,"mdecinc"))&&(u=x,d=h,j=v)),O<v&&b<h&&m<x&&(l="qttlitre < cmdqttlitre && qtt < cmdqtt && qttcc < cmdqttcc",a=h-b,i=x-m,s=v-O,o=!0)}else{r=!1;var p=n.quantityParProduct,f=n.qttByCC;console.log(p,f);var g=void 0!=c?null===c||void 0===c?void 0:c.quantityParProduct:n.quantityBruteCVA,y=void 0!=c?null===c||void 0===c?void 0:c.qttByCC:n.quantityCCCVA;console.log(g,y),p>g&&f==y&&(l="qtt > cmdqtt && qttcc == cmdqttcc",a=p-g,console.log(e.quantityBruteCVA,a),e.quantityBruteCVA-a>=0?o=!0:(o=!1,d=g)),p<g&&f==y&&(l="qtt < cmdqtt && qttcc == cmdqttcc",a=g-p,o=!0),p==g&&f==y&&(l="qtt == cmdqtt && qttcc == cmdqttcc",o=!0),p==g&&f>y&&(l="qtt == cmdqtt && qttcc > cmdqttcc",o=tl(e,i=f-y),u=y),p==g&&f<y&&(l="qtt == cmdqtt && qttcc < cmdqttcc",i=y-f,o=!0),p>g&&f<y&&(l="qtt > cmdqtt && qttcc < cmdqttcc",o=tl(e,i=y-f,a=p-g,"incdec"),d=g,u=y),p<g&&f>y&&(l="qtt < cmdqtt && qttcc > cmdqttcc",a=g-p,i=f-y,o=!0),p<g&&f<y&&(a=g-p,i=y-f,l="qtt < cmdqtt && qttcc < cmdqttcc",o=!0),p>g&&f>y&&(l="qtt > cmdqtt && qttcc > cmdqttcc",o=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,c=0,r=0,a=e.doseDefault,i=!0;Number(t)>=Number(a)?(c=Math.floor(Number(t)/Number(a)),r=Number(t)-Number(a)*c,e.quantityCCCVA-r<0&&(c+=1)):e.quantityCCCVA-Number(t)<0&&(c+=1);var s=c+Number(n);return e.quantityBruteCVA-s<0&&(i=!1),i}(e,i=f-y,a=p-g),d=g,u=y)}return console.log("--------"+l+"---------"),{normalQtt:d,normalQttCC:u,normalQttLitre:j,isSpecific:r,isValid:o}},cl=function(e){return $o(e)?0==e.quantityBruteCVA&&0==e.quantityCCCVA&&0==e.condval:0==e.quantityBruteCVA&&0==e.quantityCCCVA},rl=function(e){return e.filter((function(e){return $o(t=e)?0==t.quantityParProduct&&0==t.qttByCC&&0==t.qttbylitre:0==t.quantityParProduct&&0==t.qttByCC;var t})).length>0};var al=function(e){var t=e.model,n=e.entity,c=Object(P.useDispatch)();return Object(j.g)(),Object(w.jsx)(w.Fragment,{children:Object(w.jsx)("button",{className:"btn btn-danger btn-sm",onClick:function(e){e.preventDefault(),window.confirm("Vous voulez vraiment supprimer ce commande ?")&&c(Xn(t).createTransaction({commande:n,original:n},"/delete-from-magasin"))},children:"Supprimer"})})},il=function(e){for(var t=0;t<e.length;++t)return e[t].correction>0||e[t].correctionml>0},sl=function(){var e=Object(P.useSelector)((function(e){return e.searchbydate})),t=Object(j.i)().type,n=Object(a.useState)([e.deb,e.fin]),c=Object(f.a)(n,2),r=c[0],s=c[1],o=(Object(a.useRef)(null),Object(a.useRef)(null),Object(P.useSelector)(Jn("commandes").value)),l=Object(P.useSelector)(Jn("commandes").meta),d=Object(P.useDispatch)();Object(a.useEffect)((function(){d(ec(e.deb,e.fin,t))}),[e.deb,e.fin]),Object(a.useEffect)((function(){null!==r&&r[0]&&d(is(r[0],r[1]))}),[r]);var b=function(e){return e&&0!==(null===e||void 0===e?void 0:e.length)?e.reduce((function(e,t){return e+t}),0):0},m=function(e){return b(null===e||void 0===e?void 0:e.map((function(e){return $o(e)?e.prixqttccvente*e.quantityParProduct*e.qttccpvente+e.prixVente*e.qttbylitre:e.prixVente*e.quantityParProduct})))+b(null===e||void 0===e?void 0:e.map((function(e){return e.prixParCC*e.qttByCC})))},O=i.a.useMemo((function(){return[{Header:"Date",Cell:function(e){var t;return Object(w.jsx)(w.Fragment,{children:nt(null===(t=e.row.original)||void 0===t?void 0:t.dateCom)})}},{Header:"Produits",Cell:function(e){var t,n,c,r,a,i;return Object(w.jsxs)("div",{style:{width:"350px"},children:[1==(null===(t=e.row.original)||void 0===t?void 0:t.isdeleted)&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("div",{className:"badge badge-danger",children:"Supprim\xe9"}),Object(w.jsxs)("div",{className:"text text-danger",children:["Date de suppression :"," ",nt(null===(n=e.row.original)||void 0===n?void 0:n.deletedat)]})]}),null==(null===(c=e.row.original)||void 0===c?void 0:c.isdeleted)&&Object(w.jsx)("p",{children:il(null===(r=e.row.original)||void 0===r?void 0:r.contenu)&&Object(w.jsx)("div",{className:"badge badge-warning",children:"Modifi\xe9"})}),null===(a=e.row.original)||void 0===a||null===(i=a.contenu)||void 0===i?void 0:i.map((function(t){var n,c;return Object(w.jsxs)("span",{children:[Object(w.jsx)("span",{style:{background:"white",color:1==(null===(n=e.row.original)||void 0===n?void 0:n.isdeleted)?"red":"inherit",padding:2},children:t.name}),Object(w.jsxs)("span",{style:{color:1==(null===(c=e.row.original)||void 0===c?void 0:c.isdeleted)?"red":"inherit"},children:[" "," || "]})]})}))]})}},{Header:"Total",Cell:function(e){var t;return Object(w.jsx)("div",{children:ct(m(null===(t=e.row.original)||void 0===t?void 0:t.contenu))})}},{Header:"Actions",Cell:function(e){var t,n;return Object(w.jsx)(w.Fragment,{children:!(null===(t=e.row.original)||void 0===t?void 0:t.isdeleted)&&Object(w.jsxs)(w.Fragment,{children:[" ",Object(w.jsx)(u.b,{to:"/detailvendeuradmin/".concat(null===(n=e.row.original)||void 0===n?void 0:n.id),className:"btn btn-green btn-sm mr-2",children:"D\xe9tails"}),Object(w.jsx)(al,{model:"fromagasins",entity:e.row.original})]})})}}]}),[]);return Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)(Xe,{children:[Object(w.jsx)(Ke,{title:"Historique de vente du magasin",children:Object(w.jsx)(We,{title:"Historique de vente du magasin"})}),Object(w.jsxs)($e,{children:[Object(w.jsxs)("div",{className:"row",children:[Object(w.jsx)("div",{className:"col-lg-6",children:Object(w.jsxs)("div",{children:[Object(w.jsx)("h3",{className:"text-uppercase",children:"vente-cva"==t?"Historique de vente":"CREDIT"}),Object(w.jsx)("p",{children:"".concat(nt(e.deb)," ->  ").concat(nt(e.fin))}),Object(w.jsx)("div",{className:"bg-thead p-3 my-2",style:{width:"30%"},children:Object(w.jsxs)("h2",{children:["Recette: ",ct(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=e.filter((function(e){return 1!=e.isdeleted})),n=0;return o.length>0?t.map((function(e){n+=m(null===e||void 0===e?void 0:e.contenu)})):n=0,n}(o))]})})]})}),Object(w.jsx)("div",{className:"col-lg-6 text-right",children:Object(w.jsx)(kr.a,{locale:"fr-FR",onChange:s,value:r})})," "]}),Object(w.jsx)(mr,{data:o.sort((function(e,t){return t.id-e.id})),meta:l,columns:O,filter:!1})]})," "]})})},ol=function(){var e=Object(P.useSelector)(Jn("products").value),t=Object(P.useSelector)(Jn("products").meta),n=Object(P.useDispatch)();Object(a.useEffect)((function(){n(Xn("products").fetch())}),[]);var c=i.a.useMemo((function(){return[{Header:"Nom de l'article",accessor:"name"},{Header:"Fournisseur",Cell:function(e){var t,n;return Object(w.jsx)("div",{children:Object(w.jsx)("h3",{className:"badge badge-primary",children:null===(t=e.row.original)||void 0===t||null===(n=t.fournisseur)||void 0===n?void 0:n.name})})}},{Header:"Quantit\xe9",accessor:"quantityBruteCVA"},{Header:"Conditionnement (ML)",accessor:"condval"},{Header:"Reste en ML",accessor:"quantityCC",Cell:function(e){var t,n;return Object(w.jsx)("div",{children:null==(null===(t=e.row.original)||void 0===t?void 0:t.quantityCCCVA)?0:null===(n=e.row.original)||void 0===n?void 0:n.quantityCCCVA})}}]}));return Object(w.jsxs)(Xe,{children:[Object(w.jsx)(Ke,{title:"Etat de stock du Magasin",children:Object(w.jsx)(We,{title:"Etat de stock du Magasin"})}),Object(w.jsxs)($e,{children:[Object(w.jsxs)("div",{className:"row",children:[Object(w.jsx)("div",{className:"col-lg-6",children:Object(w.jsx)("div",{children:Object(w.jsx)("h3",{className:"text-uppercase",children:"Etat de stock du Magasin"})})}),Object(w.jsx)("div",{className:"col-lg-6 text-right"})," "]}),Object(w.jsx)(mr,{data:e,meta:t,columns:c})]})]})},ll=function(e){for(var t=0;t<e.length;++t)return e[t].correction>0||e[t].correctionml>0},dl=function(){var e=Qe()().isoWeekday(1).startOf("week"),t=Qe()().endOf("week"),n=Object(a.useState)(e),c=Object(f.a)(n,2),r=c[0],s=c[1],o=Object(a.useState)(t),l=Object(f.a)(o,2),d=l[0],j=l[1],b=(Object(a.useRef)(null),Object(a.useRef)(null),Object(P.useSelector)(Jn("commandes").value)),m=Object(P.useSelector)(Jn("commandes").meta),O=Object(a.useState)([e,t]),h=Object(f.a)(O,2),x=h[0],v=h[1],p=Object(P.useDispatch)();Object(a.useEffect)((function(){p(ec(r,d))}),[r,d]),Object(a.useEffect)((function(){null!==x?(x[0]&&s(x[0]),x[1]&&j(x[1])):(s(e),j(t))}),[x]);var g=function(e){return e&&0!==(null===e||void 0===e?void 0:e.length)?e.reduce((function(e,t){return e+t}),0):0},y=function(e){return g(null===e||void 0===e?void 0:e.map((function(e){if(1!=e.isdeleted)return Wi(e)?e.prixqttccvente*e.quantityParProduct*e.qttccpvente+e.prixVente*e.qttbylitre:e.prixVente*e.quantityParProduct})))+g(null===e||void 0===e?void 0:e.map((function(e){return 1!=e.isdeleted&&e.prixParCC*e.qttByCC})))},N=i.a.useMemo((function(){return[{Header:"Date",Cell:function(e){var t;return Object(w.jsx)(w.Fragment,{children:nt(null===(t=e.row.original)||void 0===t?void 0:t.dateCom)})}},{Header:"Produits",Cell:function(e){var t,n,c,r,a,i;return Object(w.jsxs)("div",{style:{width:"350px"},children:[1==(null===(t=e.row.original)||void 0===t?void 0:t.isdeleted)&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("div",{className:"badge badge-danger",children:"Supprim\xe9"}),Object(w.jsxs)("div",{className:"text text-danger",children:["Date de suppression :"," ",nt(null===(n=e.row.original)||void 0===n?void 0:n.deletedat)]})]}),null==(null===(c=e.row.original)||void 0===c?void 0:c.isdeleted)&&Object(w.jsx)("p",{children:ll(null===(r=e.row.original)||void 0===r?void 0:r.contenu)&&Object(w.jsx)("div",{className:"badge badge-warning",children:"Modifi\xe9"})}),null===(a=e.row.original)||void 0===a||null===(i=a.contenu)||void 0===i?void 0:i.map((function(t){var n,c;return Object(w.jsxs)("span",{children:[Object(w.jsx)("span",{style:{background:"white",color:1==(null===(n=e.row.original)||void 0===n?void 0:n.isdeleted)?"red":"inherit",padding:2},children:t.name}),Object(w.jsxs)("span",{style:{color:1==(null===(c=e.row.original)||void 0===c?void 0:c.isdeleted)?"red":"inherit"},children:[" "," || "]})]})}))]})}},{Header:"Total",Cell:function(e){var t;return Object(w.jsx)("div",{children:ct(y(null===(t=e.row.original)||void 0===t?void 0:t.contenu))})}},{Header:"Actions",Cell:function(e){var t;return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(u.b,{className:"btn btn-sm  btn-green",to:"/magasin/detail/vente/".concat(null===(t=e.row.original)||void 0===t?void 0:t.id),children:"D\xe9tails"})})}}]}),[]);return Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)(Xe,{children:[Object(w.jsx)(Ke,{title:"Historique de vente du magasin",children:Object(w.jsx)(We,{title:"Historique de vente du magasin"})}),Object(w.jsxs)($e,{children:[Object(w.jsxs)("div",{className:"row my-2",children:[Object(w.jsx)("div",{className:"col-lg-8",children:Object(w.jsxs)("div",{children:[r&&d&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("h2",{children:"Historique de vente du magasin"}),Object(w.jsxs)("span",{children:["Du: ",nt(r)," Au ",nt(d)]})]})," "]})}),Object(w.jsx)("div",{className:"col-lg-4 text-right",children:Object(w.jsx)("div",{children:Object(w.jsx)(et.a,{locale:"fr-FR",onChange:v,value:x})})})]}),Object(w.jsx)(mr,{filter:!1,data:b,meta:m,columns:N})]})]})})},ul=function(e){return e&&0!==(null===e||void 0===e?void 0:e.length)?e.reduce((function(e,t){return e+t}),0):0};var jl=Object(j.j)((function(e){var t,n,c,r,i,s,o,l,d,u,b=Object(j.g)(),m=Object(j.i)().id,O=Object(P.useSelector)(Jn("commandes").value),h=Object(a.useState)((null===(t=O[0])||void 0===t?void 0:t.dateCom)||Qe()(new Date)),x=Object(f.a)(h,2),v=x[0],p=x[1],g=Object(a.useState)(!1),y=Object(f.a)(g,2),N=y[0],C=y[1],S=Object(P.useDispatch)();Object(a.useEffect)((function(){S(Xn("commandes").get(m))}),[m]);var q=function(e){C(e)};return Object(w.jsxs)("div",{children:[Object(w.jsx)("div",{className:"bg-dark text-white p-3 d-flex justify-content-center align-items-center",children:Object(w.jsx)("h1",{className:"",children:"CABINET VETERINAIRE AMBALAVAO"})}),Object(w.jsxs)("div",{className:"py-5 container",children:[Object(w.jsx)("div",{class:"d-flex justify-content-start",children:Object(w.jsx)("button",{class:"btn btn-primary btn-sm ",onClick:function(){return b.goBack()},children:"Revenir en arriere"})}),Object(w.jsxs)("div",{children:["credit-cva"==(null===(n=O[0])||void 0===n?void 0:n.type)&&Object(w.jsx)("div",{className:"bg-info my-3 py-2",children:Object(w.jsxs)(w.Fragment,{children:[Object(w.jsxs)("h3",{className:"p-2",children:["Nom:",null===(c=O[0])||void 0===c?void 0:c.emprunter.name]}),Object(w.jsxs)("h5",{className:"p-2",children:["Contact:",null===(r=O[0])||void 0===r?void 0:r.emprunter.contact]})]})}),O.length>0&&Object(w.jsxs)("div",{className:"d-flex justify-content-between",children:[1==N?Object(w.jsxs)("div",{className:"my-2",children:[Object(w.jsx)("h5",{className:"mb-1 mt-2 text-md",children:"Changement de date"}),Object(w.jsxs)("div",{class:"d-flex justify-content-between",children:[Object(w.jsx)("div",{children:Object(w.jsx)("input",{type:"date",onChange:function(e){return p(e.target.value)},value:v,className:"form-control"})}),Object(w.jsxs)("div",{className:"ml-2",children:[Object(w.jsx)("button",{onClick:function(){S(Xn("commandes").updateData({id:m,dateCom:v},"update-price")),Object(En.b)("Modification de la date appliqu\xe9 !!!",{autoClose:5e3}),b.push("/historique/vente/vendeur/vente-cva")},className:"btn btn-primary mr-1",children:"Appliquer"}),Object(w.jsx)("button",{onClick:function(){return q(!1)},className:"btn btn-danger",children:"Annuler"})]})]})]}):Object(w.jsxs)("div",{className:"my-2",children:[Object(w.jsxs)("h3",{className:"p-2",children:["Date de commande :",nt(null===(i=O[0])||void 0===i?void 0:i.dateCom)]}),Object(w.jsx)("button",{onClick:function(){return q(!0)},className:"btn btn-warning btn-sm",children:"Changer la date"})]}),Object(w.jsx)("div",{className:"d-flex justify-content-end",children:Object(w.jsxs)("div",{className:"bg-thead p-1 mb-1",children:[Object(w.jsx)("strong",{children:"Recette:"}),":",Object(w.jsx)("h3",{className:"text-lg",children:ct(ul(null===(s=O[0])||void 0===s||null===(o=s.contenu)||void 0===o?void 0:o.map((function(e){return Ra(e)?e.prixqttccvente*e.quantityParProduct*e.qttccpvente+e.prixlitre*e.qttbylitre:e.prixVente*e.quantityParProduct})))+ul(null===(l=O[0])||void 0===l||null===(d=l.contenu)||void 0===d?void 0:d.map((function(e){return e.prixParCC*e.qttByCC}))))})]})})]}),Object(w.jsxs)("table",{className:"table table-bordered",children:[Object(w.jsxs)("tr",{className:"bg-thead",children:[Object(w.jsx)("td",{children:"Nom de l'article"}),Object(w.jsx)("td",{children:"Quantit\xe9"}),Object(w.jsx)("td",{children:"Sous total"})]}),O.length>0&&(null===(u=O[0])||void 0===u?void 0:u.contenu.map((function(e){return Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{style:{width:"40%"},children:e.name}),Object(w.jsxs)(w.Fragment,{children:[Ra(e)&&Object(w.jsx)(w.Fragment,{children:0!=e.qttbylitre&&Object(w.jsxs)("div",{className:"d-flex align-items-center py-0 px-2",children:[Object(w.jsx)("strong",{children:"Litre :"}),ct(e.prixlitre)," (","x"," ",e.qttbylitre,")"," "," = ",ct(e.prixlitre*e.qttbylitre)]})}),0!=e.quantityParProduct&&Object(w.jsxs)("div",{className:"d-flex align-items-center py-0",children:[Object(w.jsxs)("strong",{className:"text-lowercase",children:[e.type,":"]}),ct(e.prixVente)," (","x"," ",e.quantityParProduct,") "," = ",ct(e.prixVente*e.quantityParProduct)]})]}),"FLACON"==e.type&&Object(w.jsx)(w.Fragment,{children:0!=e.qttByCC&&Object(w.jsxs)("div",{className:"d-flex align-items-center  py-0",children:[Object(w.jsx)("strong",{children:"ml:"})," ",ct(e.prixParCC)," ","x"," ",0!=e.qttyspecificmirror?e.qttyspecificmirror+" Dose":e.qttByCC+" ml"," "," = "," ",ct(e.prixParCC*e.qttByCC)]})}),Object(w.jsx)("td",{children:Ra(e)?ct(e.prixqttccvente*e.quantityParProduct*e.qttccpvente+e.prixlitre*e.qttbylitre+e.prixParCC*e.qttByCC):ct(e.prixVente*e.quantityParProduct+e.prixParCC*e.qttByCC)})]})})))]})]})," "]})," "]})})),bl=function(e){return e&&0!==(null===e||void 0===e?void 0:e.length)?e.reduce((function(e,t){return e+t}),0):0};var ml=Object(j.j)((function(e){Object(j.g)();var t,n,c,r,i,s,o,l,d,b,m=Object(j.i)().id,O=Object(P.useSelector)(Jn("commandes").value),h=Object(P.useDispatch)();return Object(a.useEffect)((function(){h(Xn("commandes").get(m))}),[m]),Object(w.jsxs)(Xe,{children:[Object(w.jsx)(Ke,{title:"Detail de vente du magasin",children:Object(w.jsx)(We,{title:"Detail de vente du magasin"})}),Object(w.jsxs)($e,{children:[Object(w.jsxs)("div",{className:"py-5 container",children:[Object(w.jsxs)("div",{children:["credit-cva"==(null===(t=O[0])||void 0===t?void 0:t.type)&&Object(w.jsx)("div",{className:"bg-info my-3 py-2",children:Object(w.jsxs)(w.Fragment,{children:[Object(w.jsxs)("h3",{className:"p-2",children:["Nom:",null===(n=O[0])||void 0===n?void 0:n.emprunter.name]}),Object(w.jsxs)("h5",{className:"p-2",children:["Contact:",null===(c=O[0])||void 0===c?void 0:c.emprunter.contact]})]})}),O.length>0&&Object(w.jsxs)("div",{className:"d-flex justify-content-between",children:[Object(w.jsxs)("div",{className:"my-2",children:[Object(w.jsxs)("h2",{className:"my-2",children:["Date : ",nt(null===(r=O[0])||void 0===r?void 0:r.dateCom)]}),Object(w.jsx)(u.b,{to:"/vendeur-admin-commande/".concat(null===(i=O[0])||void 0===i?void 0:i.id),className:"btn btn-warning btn-sm mr-2",children:"Editer le commande"})]}),Object(w.jsx)("div",{className:"d-flex justify-content-end",children:Object(w.jsxs)("div",{className:"bg-thead p-1 mb-1",children:[Object(w.jsx)("strong",{children:"Recette:"}),":",Object(w.jsx)("h3",{className:"text-lg",children:ct(bl(null===(s=O[0])||void 0===s||null===(o=s.contenu)||void 0===o?void 0:o.map((function(e){return Ra(e)?e.prixqttccvente*e.quantityParProduct*e.qttccpvente+e.prixlitre*e.qttbylitre:e.prixVente*e.quantityParProduct})))+bl(null===(l=O[0])||void 0===l||null===(d=l.contenu)||void 0===d?void 0:d.map((function(e){return e.prixParCC*e.qttByCC}))))})]})})]}),Object(w.jsxs)("table",{className:"table table-bordered",children:[Object(w.jsxs)("tr",{className:"bg-thead",children:[Object(w.jsx)("td",{children:"Nom de l'article"}),Object(w.jsx)("td",{children:"Quantit\xe9"}),Object(w.jsx)("td",{children:"Sous total"})]}),O.length>0&&(null===(b=O[0])||void 0===b?void 0:b.contenu.map((function(e){return Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{style:{width:"40%"},children:e.name}),Object(w.jsxs)(w.Fragment,{children:[Ra(e)&&Object(w.jsx)(w.Fragment,{children:0!=e.qttbylitre&&Object(w.jsxs)("div",{className:"d-flex align-items-center py-0 px-2",children:[Object(w.jsx)("strong",{children:"Litre :"}),ct(e.prixlitre)," (","x"," ",e.qttbylitre,")"," "," = ",ct(e.prixlitre*e.qttbylitre)]})}),0!=e.quantityParProduct&&Object(w.jsxs)("div",{className:"d-flex align-items-center py-0",children:[Object(w.jsxs)("strong",{className:"text-lowercase",children:[e.type,":"]}),ct(e.prixVente)," (","x"," ",e.quantityParProduct,") "," = ",ct(e.prixVente*e.quantityParProduct)]})]}),"FLACON"==e.type&&Object(w.jsx)(w.Fragment,{children:0!=e.qttByCC&&Object(w.jsxs)("div",{className:"d-flex align-items-center  py-0",children:[Object(w.jsx)("strong",{children:"ml:"})," ",ct(e.prixParCC)," ","x"," ",0!=e.qttyspecificmirror?e.qttyspecificmirror+" Dose":e.qttByCC+" ml"," "," = "," ",ct(e.prixParCC*e.qttByCC)]})}),Object(w.jsx)("td",{children:Ra(e)?ct(e.prixqttccvente*e.quantityParProduct*e.qttccpvente+e.prixVente*e.qttbylitre+e.prixParCC*e.qttByCC):ct(e.prixVente*e.quantityParProduct+e.prixParCC*e.qttByCC)})]})})))]})]})," "]})," "]})]})})),Ol=(c(646),c(1347));c(1365),c(1348),c(1366),c(1353),c(633),c(1305),c(634);c(188);c(1349);var hl=["isAuth","role","component"],xl=function(e){e.isAuth,e.role;var t=e.component,n=Object(tt.a)(e,hl);return ho(),Object(w.jsx)(j.b,Object(dt.a)(Object(dt.a)({},n),{},{component:function(e){return Object(w.jsx)(_e,{title:"CBV AMBALAVAO",children:Object(w.jsx)(t,Object(dt.a)({},e))})}}))};xl.defaultProps={isAuth:!1,role:ma};var vl=Object(P.connect)((function(e){var t,n=e.auth;return{isAuth:null===n||void 0===n?void 0:n.isLoggedIn,role:(null===n||void 0===n||null===(t=n.user)||void 0===t?void 0:t.role)||""}}))(xl),pl=function(e){var t=e.product,n=e.index,c=e.state,r=e.setState,a=(Object(P.useDispatch)(),function(e){!function(e,t,n){var a=Object(Ie.a)(c);a[e]=Object(dt.a)(Object(dt.a)({},a[e]),{},Object(g.a)({},t,n)),r(a)}(n,"quantityParProduct",e)});return Object(w.jsx)("div",{className:"basket-item-control",children:Object(w.jsxs)(Xc.c,{w:28,bg:"whitesmoke",onChange:function(e){a(Number(e))},min:0,defaultValue:t.quantityParProduct,step:1,children:[Object(w.jsx)(Xc.d,{}),Object(w.jsxs)(Xc.e,{children:[Object(w.jsx)(Xc.b,{}),Object(w.jsx)(Xc.a,{})]})]})})},fl=function(e){var t=e.product,n=Object(P.useDispatch)();return Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:"Remise : (en Ariary)"}),Object(w.jsxs)("td",{className:"d-flex",children:[" ",Object(w.jsxs)(Xc.c,{bg:"whitesmoke",onChange:function(e){!function(e){n(Ea(t.id,e))}(Number(e))},min:0,defaultValue:t.remise,children:[Object(w.jsx)(Xc.d,{}),Object(w.jsxs)(Xc.e,{children:[Object(w.jsx)(Xc.b,{}),Object(w.jsx)(Xc.a,{})]})]})]})]})},gl=function(e){var t=e.product,n=e.index,c=e.isItemOnApprov,r=(e.addToApprov,e.state),a=e.setState;Object(P.useDispatch)(),!!c&&c(t.id);return Object(w.jsx)("div",{children:Object(w.jsxs)("div",{className:"d-flex justify-content-between align-items-start border   mb-2 p-2",children:[Object(w.jsx)("div",{style:{width:"65%"},children:Object(w.jsxs)("table",{border:"1",children:[Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:"Nom de l'article : "}),Object(w.jsx)("td",{children:null===t||void 0===t?void 0:t.name})]}),Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:"Prix unitaire:"}),Object(w.jsx)("td",{children:ct(t.prixFournisseur)})]}),Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:"Montant HT:"}),Object(w.jsx)("td",{children:ct(t.prixFournisseur*t.quantityParProduct)})]}),Object(w.jsx)(fl,{product:t})]})}),Object(w.jsx)("div",{className:"d-flex mt-3",children:Object(w.jsx)(pl,{product:t,index:n,state:r,setState:a})}),Object(w.jsx)("div",{children:Object(w.jsx)("button",{onClick:function(){return function(e){a(r.filter((function(t){return t.id!==e})))}(null===t||void 0===t?void 0:t.id)},className:"btn btn-danger btn-xs text-right",children:"X"})})]})})};var yl=function(e){return e&&0!==(null===e||void 0===e?void 0:e.length)?e.reduce((function(e,t){return e+t}),0):0},Nl=function(e,t){return yl(e)*t/100},Cl=function(e,t){return yl(e)-Nl(e,t)},Sl=function(e){var t=e.state,n=e.meta,c=e.setState,r=e.approv,i=e.disabled,s=Object(a.useState)(null===t||void 0===t?void 0:t.remise),o=Object(f.a)(s,2),l=o[0],d=o[1],u=Object(a.useState)(null===t||void 0===t?void 0:t.dateEcheance),b=Object(f.a)(u,2),m=b[0],O=b[1],h=Object(a.useState)(null===t||void 0===t?void 0:t.dateApprov),x=Object(f.a)(h,2),v=x[0],p=x[1],g=Object(a.useState)(null===r||void 0===r?void 0:r.contenu),y=Object(f.a)(g,2),N=y[0],C=(y[1],Object(a.useState)(null===t||void 0===t?void 0:t.remarque)),S=Object(f.a)(C,2),q=S[0],E=S[1],A=Object(a.useState)(""),D=Object(f.a)(A,2),V=(D[0],D[1],Object(a.useState)(null===t||void 0===t?void 0:t.typePaye)),F=Object(f.a)(V,2),R=F[0],T=F[1],M=Object(P.useDispatch)(),B=Object(j.g)();function k(e){var t,n,c;for(c in t=Array.isArray(e)?[]:{},e)n=e[c],t[c]="object"===typeof n?k(n):n;return t}return Object(w.jsxs)(w.Fragment,{children:[" ",Object(w.jsxs)(lr.a,{children:[Object(w.jsx)(lr.a.Header,{className:"d-flex justify-content-between align-items-center bg-dark text-white",children:Object(w.jsxs)("div",{children:["Approvisionenement ("," ".concat(null===t||void 0===t?void 0:t.length," ").concat((null===t||void 0===t?void 0:t.length)>1?"articles":"article"),")"]})}),Object(w.jsxs)(lr.a.Body,{style:{height:"500px",maxHeight:"500px",overflowY:"auto",overflowX:"hidden"},children:[Object(w.jsxs)("div",{class:"form-group",children:[Object(w.jsx)("label",{children:"Date de l'approvisionnement :"}),Object(w.jsx)("div",{children:Object(w.jsx)("input",{type:"date",disabled:i,onChange:function(e){return p(e.target.value)},value:v,className:"form-control"})})]}),!n.isFetching&&(null===t||void 0===t?void 0:t.length)<=0&&Object(w.jsxs)(w.Fragment,{children:[" ",Object(w.jsx)("div",{class:"alert alert-success ",children:"Aucune enregistrement trouv\xe9 !!!"})]}),n.isFetching&&Object(w.jsx)("p",{children:"Chargement en cours ..."}),null===t||void 0===t?void 0:t.map((function(e,n){return Object(w.jsx)(gl,{product:e,state:t,index:n,setState:c,dispatch:M},"".concat(null===e||void 0===e?void 0:e.id,"_").concat(n))})),(null===t||void 0===t?void 0:t.length)>0&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("div",{className:"d-flex justify-content-end align-items-center my-3 ",children:Object(w.jsxs)("table",{children:[Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:"REMISE :"}),Object(w.jsx)("td",{children:Object(w.jsx)("input",{type:"number",className:"form-control",placeholder:"Remise",min:0,disabled:i,value:l,onChange:function(e){d(e.target.value)}})})]}),Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:"PAIEMENT LE :"}),Object(w.jsx)("td",{children:Object(w.jsx)("input",{type:"date",disabled:i,onChange:function(e){return O(e.target.value)},value:m,className:"form-control"})})]}),Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:"TYPE DE PAIEMENT:"}),Object(w.jsx)("td",{children:Object(w.jsxs)("select",{className:"form-control",onChange:function(e){T(e.target.value)},children:[Object(w.jsx)("option",{value:"espece",selected:!0,children:"ESPECE"}),Object(w.jsx)("option",{value:"boa",children:"CHEQUE - BOA"}),Object(w.jsx)("option",{value:"bni",children:"CHEQUE - BNI"}),Object(w.jsx)("option",{value:"MVola",children:"VIREMENT - MVola"}),Object(w.jsx)("option",{value:"OrangeMoney",children:"VIREMENT - ORANGE MONEY"})]})})]}),Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:"REMARQUE :"}),Object(w.jsx)("td",{children:Object(w.jsx)("textarea",{disabled:i,className:"form-control",onChange:function(e){E(e.target.value)},placeholder:"Ecriver ici quelque chose d'autre \xe0 savoir sur l'approvisionnement",children:q})})]})]})}),Object(w.jsxs)("div",{className:"d-flex flex-column  my-3 ",children:[" ",Object(w.jsxs)("p",{className:"approvisionnement-total-amount",children:["Total HT:",Object(w.jsx)("strong",{children:Object(w.jsx)(or.a,{value:yl(null===t||void 0===t?void 0:t.map((function(e){return e.prixFournisseur*e.quantityParProduct}))),displayType:"text",thousandSeparator:!0,suffix:"Ar",renderText:function(e,t){return Object(w.jsx)("div",Object(dt.a)(Object(dt.a)({},t),{},{children:e}))}})})]}),Object(w.jsxs)("p",{className:"approvisionnement-total-amount",children:["Remise:",Object(w.jsx)("strong",{children:Object(w.jsx)(or.a,{value:Nl(null===t||void 0===t?void 0:t.map((function(e){return e.prixFournisseur*e.quantityParProduct})),l),displayType:"text",thousandSeparator:!0,suffix:"Ar",renderText:function(e,t){return Object(w.jsx)("div",Object(dt.a)(Object(dt.a)({},t),{},{children:e}))}})})]}),Object(w.jsxs)("p",{className:"approvisionnement-total-amount",children:["Total avec remise :",Object(w.jsx)("strong",{children:Object(w.jsx)(or.a,{value:Cl(null===t||void 0===t?void 0:t.map((function(e){return e.prixFournisseur*e.quantityParProduct})),l),displayType:"text",thousandSeparator:!0,suffix:"Ar",renderText:function(e,t){return Object(w.jsx)("div",Object(dt.a)(Object(dt.a)({},t),{},{children:e}))}})})]}),Object(w.jsx)("p",{children:"Arr\xeat\xe9 \xe0 la somme de "}),Object(w.jsx)("p",{className:"text-uppercase",children:Object(w.jsxs)("strong",{children:[Object(sr.NumberToLetter)(Cl(null===t||void 0===t?void 0:t.map((function(e){return e.prixFournisseur*e.quantityParProduct})),l))," ","ARIARY"]})})]})]})]}),Object(w.jsx)(lr.a.Footer,{children:Object(w.jsxs)("div",{className:"d-flex justify-content-end",children:[Object(w.jsx)("button",{disabled:i,className:"btn btn-green btn-sm mr-2",onClick:function(){var e=function(){var e=k(N).filter((function(e){return!t.find((function(t){return e.id===t.id}))})),n=k(N).filter((function(e){return!t.find((function(t){return e.id===t.id}))}));return{exist:k(N).map((function(e){return t.find((function(t){return t.id==e.id}))})).filter((function(e){return null!=e})),added:n,missing:e}}(),n=e.exist,c=e.added,a=e.missing;M(Xn("approvis").updateTransaction({id:null===r||void 0===r?void 0:r.id,contenu:t,totalht:yl(t.map((function(e){return e.prixFournisseur*e.quantityParProduct-e.remise}))),remise:l,total:Cl(t.map((function(e){return e.prixFournisseur*e.quantityParProduct-e.remise})),l),dateApprov:v,dateEcheance:m,remarque:q,typePaye:R,exist:n,missing:a,added:c},"update-facture")),B.push(fe)},type:"button",children:"Valider l'operation"}),Object(w.jsx)("button",{disabled:i,className:"btn btn-danger btn-sm",onClick:function(){return c(null===r||void 0===r?void 0:r.contenu)},type:"button",children:Object(w.jsx)("span",{children:"Annuler"})})]})})]})]})},ql=function(e){var t,n=e.product,c=e.state,r=e.setState,a=(Object(P.useSelector)((function(e){return e.approvisionnements})),Object(P.useDispatch)(),!!(null===c||void 0===c?void 0:c.find((function(e){return(null===e||void 0===e?void 0:e.id)===n.id}))));return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(pr.a.Item,{children:Object(w.jsxs)(fr.a,{className:"product-card m-2 ".concat(n.id?"":"product-loading"),style:{border:n&&a?"1px solid #a6a5a5":"",boxShadow:n&&a?"0 10px 15px rgba(0, 0, 0, .07)":"none"},children:[Object(w.jsx)(gr.a,{xs:9,children:Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("p",{children:null===n||void 0===n?void 0:n.name}),Object(w.jsx)("div",{class:"badge badge-primary",children:null===n||void 0===n||null===(t=n.fournisseur)||void 0===t?void 0:t.name}),Object(w.jsx)("p",{children:Object(w.jsxs)("strong",{children:[" ",ct(null===n||void 0===n?void 0:n.prixFournisseur)]})})]})}),Object(w.jsx)(gr.a,{xs:3,children:(null===n||void 0===n?void 0:n.id)&&Object(w.jsx)(w.Fragment,{children:a?Object(w.jsx)("button",{className:"btn btn-danger btn-sm",onClick:function(){return function(e){r(c.filter((function(t){return t.id!==e})))}(null===n||void 0===n?void 0:n.id)},children:"Retirer"}):Object(w.jsx)("button",{className:"btn btn-green btn-sm",onClick:function(){r(c.some((function(e){return e.id===n.id}))?c:[n].concat(Object(Ie.a)(c)))},children:"Ajouter"})})})]})})})},wl=function(){var e=Object(j.i)().id,t=Object(a.useState)(!1),n=Object(f.a)(t,2),c=n[0],r=n[1],s=Object(P.useDispatch)(),o=Object(P.useSelector)(Jn("approvis").value),l=Object(P.useSelector)(Jn("approvis").meta),d=Object(P.useSelector)(Jn("products").value),u=Object(P.useSelector)(Jn("products").meta),b=Object(a.useState)([]),m=Object(f.a)(b,2),O=m[0],h=m[1];i.a.useEffect((function(){s(Xn("approvis").get(e))}),[e]);var x=Object(a.useState)(""),v=Object(f.a)(x,2),p=v[0],g=v[1],y=Object(a.useState)([]),N=Object(f.a)(y,2),C=N[0],S=N[1];Object(a.useEffect)((function(){return 1==c&&(s(Xn("products").fetch()),r(!1)),function(){r(!1)}}),[c]);var q=Object(a.useState)(),E=Object(f.a)(q,2),A=E[0],D=E[1];return Object(a.useEffect)((function(){h(null!=A?Ha(d,p,A):Mr(d,p))}),[p]),Object(a.useEffect)((function(){h(""!=p?Ha(d,p,A):Ia(d,A))}),[A]),Object(a.useEffect)((function(){s(Xn("products").fetch())}),[]),i.a.useEffect((function(){var e;l.isFetching||S(null===(e=o[0])||void 0===e?void 0:e.contenu)}),[l]),Object(a.useEffect)((function(){u.isFetching||h(d)}),[u]),console.log(e),Object(w.jsxs)(Xe,{children:[Object(w.jsx)(Ke,{title:"Edition de facture",children:Object(w.jsx)(We,{title:"Edition de facture"})}),Object(w.jsx)($e,{children:Object(w.jsx)(Fr.a,{children:Object(w.jsxs)(fr.a,{children:[Object(w.jsx)(gr.a,{xs:5,children:Object(w.jsx)(pr.a,{children:Object(w.jsxs)(lr.a,{children:[Object(w.jsx)(lr.a.Header,{className:"d-flex justify-content-between align-items-center bg-dark text-white",children:"Produits"}),Object(w.jsxs)(lr.a.Body,{children:[Object(w.jsx)("input",{type:"text",onChange:function(e){g(e.target.value)},placeholder:"Rechercher un produit",className:"form-control mb-2"}),Object(w.jsx)(ai,{model:"fournisseurs",children:Object(w.jsx)(ii,{children:function(e){var t=e.data;e.meta;return Object(w.jsx)("div",{className:"my-2",children:Object(w.jsxs)("select",{className:"form-control",selected:2==A,onChange:function(e){D(e.target.value)},children:[Object(w.jsx)("option",{value:"",children:"Selectionner un fournisseur"}),t.map((function(e){return Object(w.jsx)("option",{value:e.id,children:e.name})}))]})})}})}),Object(w.jsxs)("div",{style:{overflowY:"auto",height:"350px",maxHeight:"350px",overflowX:"hidden"},children:[Object(w.jsxs)(w.Fragment,{children:[O.map((function(e){return Object(w.jsx)(ql,{state:C,setState:S,product:e})})),0==O.length&&"Aucune enregistrement trouv\xe9"]})," "]})]})]})})}),Object(w.jsx)(gr.a,{xs:7,children:Object(w.jsx)(Sl,{disabled:1==u.isFetching,state:C,meta:l,setState:S,products:d,approv:o[0]})})]})})})]})},El=function(e){var t,n=e.key,c=e.product,r=Object(P.useSelector)((function(e){return e.fromdepots})),i=Object(P.useDispatch)(),s=Mi(r,i),o=s.isItemFromDepot,l=s.addFromDepot,d=!!o&&o(c.id);Object(a.useEffect)((function(){d||(c.qttByCC=0,c.quantityParProduct=0)}),[d]);return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(pr.a.Item,{style:{width:"100%"},children:Object(w.jsxs)(fr.a,{className:" ".concat(c.id?"":"product-loading"),style:{boxShadow:c&&d?"15px 10px 15px rgba(0, 0, 0, .07)":"none"},children:[Object(w.jsx)(gr.a,{xs:9,children:Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("p",{children:null===c||void 0===c?void 0:c.name}),Object(w.jsx)("div",{class:"badge badge-primary",children:null===c||void 0===c||null===(t=c.fournisseur)||void 0===t?void 0:t.name})]})}),Object(w.jsx)(gr.a,{xs:3,children:(null===c||void 0===c?void 0:c.id)&&Object(w.jsx)("button",{disabled:0===c.quantityBrute,className:"mt-3 ".concat(d?"btn btn-danger btn-sm":"btn btn-green btn-sm"),onClick:function(){l&&l(c)},children:d?"Retirer":"Ajouter"})})]})},n)})},Al=function(e){return e&&0!==(null===e||void 0===e?void 0:e.length)?e.reduce((function(e,t){return e+t}),0):0},Dl=function(e){e.setRegenerate;var t=Object(a.useState)("vente-depot"),n=Object(f.a)(t,2),c=n[0],r=n[1],i=Object(a.useState)(1),s=Object(f.a)(i,2),o=(s[0],s[1],Object(a.useState)(null)),l=Object(f.a)(o,2),d=l[0],u=l[1],b=Object(a.useState)(null),m=Object(f.a)(b,2),O=m[0],h=m[1],x=Object(j.g)(),v=Object(P.useSelector)((function(e){return{fromdepots:e.fromdepots}})).fromdepots,p=Object(P.useDispatch)(),g=Object(P.useSelector)(Jn("emprunters").value),y=Object(P.useSelector)(Jn("vaccinateurs").value),N=(Object(P.useSelector)(Jn("commandes").meta),Object(P.useSelector)(Jn("commandes").value),new Date),C=Object(a.useState)(N),S=Object(f.a)(C,2),q=S[0],E=S[1];Object(a.useEffect)((function(){p(vi()),p(Xn("commandes").fetch()),p(Xn("emprunters").fetch()),p(Xn("vaccinateurs").fetch())}),[]);return Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)(lr.a,{children:[Object(w.jsxs)(lr.a.Header,{className:" bg-dark py-2 text-white d-flex justify-content-between align-items-center",children:[Object(w.jsx)("div",{style:{width:"60%"},children:"BON DE SORTIE "}),Object(w.jsx)("div",{style:{width:"30%"},className:"text-right",children:Object(w.jsxs)(Oc.a,{onChange:function(e){r(e.target.value)},children:[Object(w.jsx)("option",{value:"vente-depot",selected:!0,children:"Comptant"}),Object(w.jsx)("option",{value:"vente-depot-credit",children:"Credit"}),Object(w.jsx)("option",{value:"vente-depot-vaccinateur",children:"Vaccinateur"})]})})]}),Object(w.jsxs)("div",{className:"commande-vente",children:[Object(w.jsx)(lr.a.Body,{style:{padding:12,marginTop:3,marginRight:2,marginLeft:2},children:Object(w.jsxs)("div",{style:{overflowY:"auto",height:"350px",maxHeight:"350px",overflowX:"hidden"},children:[Object(w.jsxs)("div",{class:"form-group",children:[Object(w.jsx)("label",{children:"Date de sortie :"}),Object(w.jsx)("div",{children:Object(w.jsx)("input",{type:"date",onChange:function(e){return E(e.target.value)},value:q,className:"form-control"})})]}),"vente-depot-credit"===c&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("label",{children:"Nom du persone:"}),Object(w.jsxs)("select",{className:"form-control mb-2",onChange:function(e){h(e.target.value)},children:[Object(w.jsx)("option",{children:"Selectionner une personne"}),g.map((function(e){return Object(w.jsx)("option",{value:e.id,children:e.name})}))]})]}),"vente-depot-vaccinateur"===c&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("label",{children:"Nom du vaccinateur:"}),Object(w.jsxs)("select",{className:"form-control mb-2",onChange:function(e){u(e.target.value)},children:[Object(w.jsx)("option",{children:"Selectionner un vaccinateur"}),y.map((function(e){return Object(w.jsx)("option",{value:e.id,children:e.name})}))]})]}),(null===v||void 0===v?void 0:v.length)<=0&&Object(w.jsx)("div",{className:"alert alert-success",children:'Choississez un produit sur la section "Produits" puis cliquez sur "Ajouter"'}),null===v||void 0===v?void 0:v.map((function(e,t){return Object(w.jsx)(Bi,{product:e,basket:v,dispatch:p},"".concat(null===e||void 0===e?void 0:e.id,"_").concat(t))}))]})}),(null===v||void 0===v?void 0:v.length)>0&&Object(w.jsxs)(lr.a.Footer,{className:"d-flex align-items-center justify-content-between",children:[Object(w.jsx)("div",{style:{width:"30%"},children:Object(w.jsx)("h2",{className:"p-2 text-uppercase bg-primary",children:Object(w.jsxs)("strong",{"data-test-id":"total-price-orders",children:["Total:",ct(Al(v.map((function(e){return Wi(e)?e.prixlitre*e.quantityParProductDepot:e.prixVente*e.quantityParProductDepot})))+Al(v.map((function(e){return e.prixParCC*e.qttByCCDepot}))))]})})}),Object(w.jsx)("div",{style:{width:"70%"},children:v.length>0&&Object(w.jsxs)("div",{className:"d-flex text-right align-items-end justify-content-end",children:[Object(w.jsx)("button",{className:"btn btn-green btn-sm mr-2",disabled:0===v.length,onClick:function(){if(null!=q&&""!=q){for(var e=0;e<v.length;++e)if(0==v[e].quantityParProductDepot)return void alert("Commande non conforme:"+v[e].name+" : 0");v.forEach((function(e){var t;delete e.busy,delete e.pendingCreate,ki(t=e)?t.quantityBrute-=t.quantityParProductDepot:_i(t)&&(t.quantityBrute=0),0!=e.condmldepot&&0!=e.qttccpventedepot?function(e){Yi(e)}(e):Ui(e)})),p(Xn("commandes").createTransaction({id:Math.floor(Date.now()/1e3),contenu:v,type:c,sorte:"sortie",vaccinateurId:d,status:"vente-depot"===c,emprunterId:O,dateCom:null!=q||""!=q?q:N},"add-from-depot")),p(vi()),"vente-depot-credit"===c?x.push(de):"vente-depot-vaccinateur"===c?x.push(ue):x.push(xe)}else alert("Vous avez oubli\xe9 de mettre la date de l'operation !!!")},type:"button",children:"Valider l'operation"}),Object(w.jsx)("button",{className:"btn btn-danger btn-sm",onClick:function(){v.forEach((function(e){e.quantityParProductDepot=0,e.qttByCCDepot=0})),p(vi())},type:"button",children:Object(w.jsx)("span",{children:"Annuler"})})]})})]})]})]})})},Pl=function(){var e=Object(P.useSelector)(Jn("products").value),t=Object(P.useSelector)(Jn("products").meta),n=Object(P.useDispatch)(),c=Object(a.useState)(""),r=Object(f.a)(c,2),i=r[0],s=r[1],o=Object(a.useState)(2),l=Object(f.a)(o,2),d=(l[0],l[1],Object(a.useState)(!1)),u=Object(f.a)(d,2),j=u[0],b=u[1],m=(Object(a.useRef)(null),Object(a.useRef)(null),Object(a.useState)([])),O=Object(f.a)(m,2),h=O[0],x=O[1],v=(Object(P.useSelector)(Jn("commandes").value),Object(P.useSelector)(Jn("commandes").meta),Object(a.useState)(new Date)),p=Object(f.a)(v,2),g=p[0],y=p[1],N=Object(a.useState)(new Date),C=Object(f.a)(N,2),S=C[0],q=C[1];Object(a.useEffect)((function(){n(ec(g,S))}),[g,S]),Object(a.useEffect)((function(){y(new Date),q(new Date),n(Xn("products").fetch())}),[]),Object(a.useEffect)((function(){return 1==j&&(n(Xn("products").fetch()),b(!1)),function(){b(!1)}}),[j]),Object(a.useEffect)((function(){t.isFetching||x(e)}),[t]),Object(a.useEffect)((function(){x(Mr(e,i))}),[i]);return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(Fr.a,{fluid:!0,children:Object(w.jsx)("div",{className:"py-2",children:Object(w.jsxs)(fr.a,{children:[Object(w.jsx)(gr.a,{xs:6,children:Object(w.jsxs)(lr.a,{className:"mt-2",children:[Object(w.jsxs)(lr.a.Header,{className:"bg-dark p-2 text-white d-flex text-uppercase justify-content-between align-items-center",children:[Object(w.jsx)("div",{style:{width:"80%"},children:"Produits"}),Object(w.jsx)("div",{children:Object(w.jsx)("button",{className:"btn btn-green btn-sm",onClick:function(){s(""),b(!0)},children:"Mettre \xe0 jour"})})]}),Object(w.jsxs)(lr.a.Body,{children:[Object(w.jsxs)("div",{children:[Object(w.jsx)("input",{type:"text",onChange:function(e){s(e.target.value)},placeholder:"Nom du produit",className:"form-control mb-2"})," "]}),Object(w.jsx)(pr.a,{children:Object(w.jsxs)("div",{style:{overflowY:"auto",height:"350px",maxHeight:"350px",overflowX:"hidden"},children:[Object(w.jsxs)("div",{class:"d-flex justify-content-start flex-wrap",children:[h.map((function(e){return Object(w.jsx)(El,{product:e})})),0==h.length&&"Aucune enregistrement trouv\xe9"]})," "]})})]})]})}),Object(w.jsx)(gr.a,{xs:6,children:Object(w.jsx)("div",{className:" py-2",children:Object(w.jsx)(Dl,{setRegenerate:b})})})]})})})})},Vl=function(){return Object(w.jsxs)(Xe,{children:[Object(w.jsx)(Ke,{title:"Bon de sortie du d\xe9pot",children:Object(w.jsx)(We,{title:"Bon de sortie du d\xe9pot"})}),Object(w.jsxs)($e,{children:[Object(w.jsxs)("div",{children:[Object(w.jsx)("button",{disabled:!0,className:"btn btn-green btn-xs ml-3 mb-2",children:"Ajouter"})," ",": ",Object(w.jsx)("span",{children:"Le produit n'a pas de stock disponible"}),Object(w.jsx)("button",{className:"btn btn-green btn-xs ml-3 mb-2",children:"Mettre \xe0 jour"})," ",": ",Object(w.jsx)("span",{children:"Mettre \xe0 jour la liste des produits"})]}),Object(w.jsx)("select",{disabled:!0,className:"  ml-3 bg-white py-2 input-xs",children:Object(w.jsx)("option",{children:"Comptant"})})," ",": ",Object(w.jsx)("span",{children:"Choix du mode sortie ( Comptant,credit,vaccinateur)"}),Object(w.jsx)(Pl,{})]})]})},Fl=function(e){var t=e.flat,n=(e.gr,e.id),c=t.filter((function(e){return e.id==n})),r=(void 0!=c[c.length-1]&&c[c.length-1],0);return r=c?c.map((function(e){return 1*e.quantityParProduct})).reduce((function(e,t){return e+t}),0):0,Object(w.jsx)("td",{className:"text-center p-1",children:0!=r?r:"-"})},Rl=function(){return Object(w.jsx)("td",{className:"text-center p-1",children:Object(w.jsx)("div",{children:Object(w.jsx)("span",{className:"text-center  p-1",children:"-"})})})},Tl=function(e){var t=e.flat,n=(e.gr,e.id),c=t.filter((function(e){return e.id==n})),r=void 0!=c[c.length-1]?c[c.length-1]:{},a={bruteCva:r.hasOwnProperty("id")?r.quantityBrute:0,ccCva:r.hasOwnProperty("id")?r.quantityCC:0};return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)("td",{className:"text-center",children:0!=c.length?a.bruteCva:0})})};function Ml(e){return e[e.length-1]}var Bl=function(){var e=Qe()().isoWeekday(1).startOf("week"),t=Qe()().endOf("week"),n=Object(a.useState)([]),c=Object(f.a)(n,2),r=c[0],i=c[1],s=Object(a.useState)([]),o=Object(f.a)(s,2),l=(o[0],o[1]),d=Object(a.useState)(e),u=Object(f.a)(d,2),j=u[0],b=u[1],m=Object(a.useState)(t),O=Object(f.a)(m,2),h=O[0],x=O[1],v=Object(a.useState)([e,t]),p=Object(f.a)(v,2),g=p[0],y=p[1],N=Object(a.useState)([]),C=Object(f.a)(N,2),S=C[0],q=C[1],E=Object(a.useState)([]),A=Object(f.a)(E,2),D=(A[0],A[1],Object(P.useSelector)(Jn("approvis").value)),V=Object(P.useSelector)(Jn("approvis").meta),F=Object(P.useDispatch)();Object(a.useEffect)((function(){null!==g?(g[0]&&b(g[0]),g[0]&&x(g[1])):(b(e),x(t))}),[g]),Object(a.useEffect)((function(){var e;j&&h&&(i(function(e,t){for(var n=e.clone(),c=[];n.isSameOrBefore(t);)c.push(n.format("YYYY-MM-DD")),n.add(1,"days");return c}(Qe()(j),Qe()(h))),l(function(e,t){for(var n=[];t.diff(e,"months")>=0;)n.push(e.format("MMMM YYYY")),e.add(1,"month");return n}(Qe()(j),Qe()(h))),F((e=h,Ln("approvis",{path:"/get-approv-by-date?deb=".concat(j,"&fin=").concat(e),replace:!0}))))}),[j,h]),Object(a.useEffect)((function(){V.isFetching||q(ot(D,"dateApprov",j,h))}),[V]);var R,T,M=lt(S,"contenu").reduce((function(e,t){var n=t.id,c=t.name,r=t.type,a=t.category,i=t.fournisseur,s=t.quantityBrute,o=t.quantityCC,l=t.quantityParProduct,d=e.find((function(e){return e.id===n}));return d?d.quantityParProduct=parseInt(d.quantityParProduct)+parseInt(l):e.push({id:n,name:c,type:r,category:a,fournisseur:i,quantityBrute:s,quantityCC:o,quantityParProduct:l}),e}),[]).sort((function(e,t){return e.id>t.id})),B=function(e,t){var n;return Object(Ie.a)(new Set((n=[]).concat.apply(n,Object(Ie.a)(e.map((function(e){return e[t]}))))))},k=(R="dateApprov",S.reduce((function(e,t){return T?(e[t[R][T]]=e[t[R][T]]||[]).push(t):(e[t[R]]=e[t[R]]||[]).push(t),e}),{}));return Object(w.jsxs)(Xe,{children:[Object(w.jsx)(Ke,{title:"Journal de facturation",children:Object(w.jsx)(We,{title:"Journal de facturation"})}),Object(w.jsxs)($e,{children:[Object(w.jsx)(nc,{}),Object(w.jsxs)("div",{className:"date-range",children:[Object(w.jsxs)("div",{className:"d-flex justify-content-between my-3",children:[Object(w.jsxs)("div",{children:[j&&h&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("h2",{class:"text-uppercase my-1",children:"Journal de facturation "}),Object(w.jsxs)("span",{children:["Du: ",nt(j)," Au ",nt(h)]})]})," "]}),Object(w.jsx)("div",{children:Object(w.jsx)(kr.a,{locale:"fr-FR",onChange:y,value:g})})]}),Object(w.jsx)("div",{className:"bg-white py-3 px-2 mb-2",children:Object(w.jsx)("div",{className:"table-responsive",children:Object(w.jsxs)("table",{class:"table",children:[Object(w.jsxs)("tr",{className:"sticky-this",children:[Object(w.jsx)("td",{children:"Produit"}),r.map((function(e){return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(it,{date:e})})})),Object(w.jsx)("td",{className:"bg-thead text-uppercase text-center",children:"Total"}),Object(w.jsx)("td",{className:"bg-thead text-uppercase text-center",children:"Stock"})]}),M.map((function(e){return Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)("tr",{class:"bg-white",children:[Object(w.jsx)("td",{className:"bg-thead",children:e.name}),r.map((function(t){return Object(w.jsx)(w.Fragment,{children:void 0!=k[t]?Object(w.jsx)(Fl,{flat:B(k[t],"contenu"),gr:t,id:e.id}):Object(w.jsx)(Rl,{})})})),Object(w.jsx)("td",{className:"text-center",children:e.quantityParProduct}),Object(w.jsx)(Tl,{flat:B(k[Ml(Object.keys(k))],"contenu"),gr:Ml(Object.keys(k)),id:e.id})]})})})),0==M.length&&Object(w.jsx)("tr",{children:Object(w.jsx)("td",{className:"text-center",colSpan:r.length+3,children:"Aucune enregistrement trouv\xe9"})})]})})})," "]})]})]})},kl=function(){return Object(w.jsx)("td",{className:"text-center p-1",children:Object(w.jsx)("div",{children:Object(w.jsx)("span",{className:"text-center  p-1",children:"-"})})})},_l=function(e){var t=e.flat,n=(e.gr,e.id),c=t.filter((function(e){return e.id==n})),r=(void 0!=c[c.length-1]&&c[c.length-1],0);return r=c?c.map((function(e){return 1*e.quantityParProductDepot})).reduce((function(e,t){return e+t}),0):0,Object(w.jsx)("td",{className:"text-center p-1",children:0!=r?r:"-"})},Il=function(e){var t=e.flat,n=(e.gr,e.id),c=t.filter((function(e){return e.id==n})),r=void 0!=c[c.length-1]?c[c.length-1]:{},a={bruteCva:r.hasOwnProperty("id")?r.quantityBrute:0,ccCva:r.hasOwnProperty("id")?r.quantityCC:0};return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)("td",{className:"text-center",children:0!=c.length?a.bruteCva:0})})};function Ll(e){return e[e.length-1]}var Ql=function(){var e=Qe()().isoWeekday(1).startOf("week"),t=Qe()().endOf("week"),n=Object(a.useState)([]),c=Object(f.a)(n,2),r=c[0],i=c[1],s=Object(a.useState)([]),o=Object(f.a)(s,2),l=(o[0],o[1]),d=Object(a.useState)(e),u=Object(f.a)(d,2),j=u[0],b=u[1],m=Object(a.useState)(t),O=Object(f.a)(m,2),h=O[0],x=O[1],v=Object(a.useState)([e,t]),p=Object(f.a)(v,2),g=p[0],y=p[1],N=Object(a.useState)([]),C=Object(f.a)(N,2),S=C[0],q=C[1],E=Object(a.useState)([]),A=Object(f.a)(E,2),D=(A[0],A[1],Object(P.useSelector)(Jn("commandes").value)),V=Object(P.useSelector)(Jn("commandes").meta),F=Object(P.useDispatch)();Object(a.useEffect)((function(){null!==g?(g[0]&&b(g[0]),g[0]&&x(g[1])):(b(e),x(t))}),[g]),Object(a.useEffect)((function(){j&&h&&(i(function(e,t){for(var n=e.clone(),c=[];n.isSameOrBefore(t);)c.push(n.format("YYYY-MM-DD")),n.add(1,"days");return c}(Qe()(j),Qe()(h))),l(function(e,t){for(var n=[];t.diff(e,"months")>=0;)n.push(e.format("MMMM YYYY")),e.add(1,"month");return n}(Qe()(j),Qe()(h))),F($n("vente-depot",j,h)))}),[j,h]),Object(a.useEffect)((function(){V.isFetching||q(ot(D,"dateCom",j,h))}),[V]);var R,T,M=lt(S,"contenu").reduce((function(e,t){var n=t.id,c=t.name,r=t.type,a=t.category,i=t.fournisseur,s=t.quantityParProductDepot,o=t.quantityBruteCVA,l=t.quantityCCCVA,d=(t.qttByCC,e.find((function(e){return e.id===n})));return d?d.quantityParProductDepot=parseInt(d.quantityParProductDepot)+parseInt(s):e.push({id:n,name:c,type:r,category:a,fournisseur:i,quantityBruteCVA:o,quantityCCCVA:l,quantityParProductDepot:s}),e}),[]).sort((function(e,t){return e.id>t.id})),B=function(e,t){var n;return Object(Ie.a)(new Set((n=[]).concat.apply(n,Object(Ie.a)(e.map((function(e){return e[t]}))))))},k=(R="dateCom",S.reduce((function(e,t){return T?(e[t[R][T]]=e[t[R][T]]||[]).push(t):(e[t[R]]=e[t[R]]||[]).push(t),e}),{}));return Object(w.jsxs)(Xe,{children:[Object(w.jsx)(Ke,{title:"Journal de vente",children:Object(w.jsx)(We,{title:"Journal de vente"})}),Object(w.jsxs)($e,{children:[Object(w.jsx)(nc,{}),Object(w.jsxs)("div",{className:"date-range",children:[Object(w.jsxs)("div",{className:"d-flex justify-content-between my-3",children:[Object(w.jsxs)("div",{children:[j&&h&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("h2",{class:"text-uppercase my-1",children:"Journal de vente"}),Object(w.jsxs)("span",{children:["Du: ",nt(j)," Au ",nt(h)]})]})," "]}),Object(w.jsx)("div",{children:Object(w.jsx)(kr.a,{locale:"fr-FR",onChange:y,value:g})})]}),Object(w.jsx)("div",{className:"table-responsive",children:Object(w.jsxs)("table",{class:"table",children:[Object(w.jsxs)("tr",{className:"sticky-this",children:[Object(w.jsx)("td",{children:"Produit"}),r.map((function(e){return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(it,{date:e})})})),Object(w.jsx)("td",{className:"bg-thead text-uppercase text-center",children:"Total"}),Object(w.jsx)("td",{className:"bg-thead text-uppercase text-center",children:"Stock"})]}),M.map((function(e){return Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)("tr",{class:"bg-white",children:[Object(w.jsx)("td",{className:"bg-thead",children:e.name}),r.map((function(t){return Object(w.jsx)(w.Fragment,{children:void 0!=k[t]?Object(w.jsx)(_l,{flat:B(k[t],"contenu"),gr:t,id:e.id}):Object(w.jsx)(kl,{})})})),Object(w.jsx)("td",{className:"text-center",children:e.quantityParProductDepot}),Object(w.jsx)(Il,{flat:B(k[Ll(Object.keys(k))],"contenu"),gr:Ll(Object.keys(k)),id:e.id})]})})})),0==M.length&&Object(w.jsx)("tr",{children:Object(w.jsx)("td",{className:"text-center",colSpan:r.length+3,children:"Aucune enregistrement trouv\xe9"})})]})})]})]})]})};function Hl(e){return e[e.length-1]}var Ul=function(){var e=Qe()().isoWeekday(1).startOf("week"),t=Qe()().endOf("week"),n=Object(a.useState)([]),c=Object(f.a)(n,2),r=c[0],i=c[1],s=Object(a.useState)([]),o=Object(f.a)(s,2),l=(o[0],o[1]),d=Object(a.useState)(e),u=Object(f.a)(d,2),j=u[0],b=u[1],m=Object(a.useState)(t),O=Object(f.a)(m,2),h=O[0],x=O[1],v=Object(a.useState)([e,t]),p=Object(f.a)(v,2),g=p[0],y=p[1],N=Object(a.useState)([]),C=Object(f.a)(N,2),S=C[0],q=C[1],E=Object(a.useState)([]),A=Object(f.a)(E,2),D=(A[0],A[1],Object(P.useSelector)(Jn("commandes").value)),V=Object(P.useSelector)(Jn("commandes").meta),F=Object(P.useDispatch)();Object(a.useEffect)((function(){null!==g?(g[0]&&b(g[0]),g[0]&&x(g[1])):(b(e),x(t))}),[g]),Object(a.useEffect)((function(){j&&h&&(i(function(e,t){for(var n=e.clone(),c=[];n.isSameOrBefore(t);)c.push(n.format("YYYY-MM-DD")),n.add(1,"days");return c}(Qe()(j),Qe()(h))),l(function(e,t){for(var n=[];t.diff(e,"months")>=0;)n.push(e.format("MMMM YYYY")),e.add(1,"month");return n}(Qe()(j),Qe()(h))),F($n("cva",j,h)))}),[j,h]),Object(a.useEffect)((function(){V.isFetching||q(ot(D,"dateCom",j,h))}),[V]);var R,T,M=lt(S,"contenu").reduce((function(e,t){var n=t.id,c=t.name,r=t.type,a=t.category,i=t.fournisseur,s=t.quantityBrute,o=t.quantityCC,l=t.quantityParProduct,d=e.find((function(e){return e.id===n}));return d?d.quantityParProduct=parseInt(d.quantityParProduct)+parseInt(l):e.push({id:n,name:c,type:r,category:a,fournisseur:i,quantityBrute:s,quantityCC:o,quantityParProduct:l}),e}),[]).sort((function(e,t){return e.id>t.id})),B=function(e,t){var n;return Object(Ie.a)(new Set((n=[]).concat.apply(n,Object(Ie.a)(e.map((function(e){return e[t]}))))))},k=(R="dateCom",S.reduce((function(e,t){return T?(e[t[R][T]]=e[t[R][T]]||[]).push(t):(e[t[R]]=e[t[R]]||[]).push(t),e}),{}));return Object(w.jsxs)(Xe,{children:[Object(w.jsx)(Ke,{title:"Journal de dep\xf4t vers magasin",children:Object(w.jsx)(We,{title:"Journal de dep\xf4t vers magasin"})}),Object(w.jsxs)($e,{children:[Object(w.jsx)(nc,{}),Object(w.jsxs)("div",{className:"date-range",children:[Object(w.jsxs)("div",{className:"d-flex justify-content-between my-3",children:[Object(w.jsxs)("div",{children:[j&&h&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("h2",{class:"text-uppercase my-1",children:"Journal de dep\xf4t vers magasin "}),Object(w.jsxs)("span",{children:["Du: ",nt(j)," Au ",nt(h)]})]})," "]}),Object(w.jsx)("div",{children:Object(w.jsx)(kr.a,{locale:"fr-FR",onChange:y,value:g})})]}),Object(w.jsx)("div",{className:"bg-white py-3 px-2 mb-2",children:Object(w.jsx)("div",{className:"table-responsive",children:Object(w.jsxs)("table",{class:"table",children:[Object(w.jsxs)("tr",{className:"sticky-this",children:[Object(w.jsx)("td",{children:"Produit"}),r.map((function(e){return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(it,{date:e})})})),Object(w.jsx)("td",{className:"bg-thead text-uppercase text-center",children:"Total"}),Object(w.jsx)("td",{className:"bg-thead text-uppercase text-center",children:"Stock"})]}),M.map((function(e){return Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)("tr",{class:"bg-white",children:[Object(w.jsx)("td",{className:"bg-thead",children:e.name}),r.map((function(t){return Object(w.jsx)(w.Fragment,{children:void 0!=k[t]?Object(w.jsx)(Fl,{flat:B(k[t],"contenu"),gr:t,id:e.id}):Object(w.jsx)(Rl,{})})})),Object(w.jsx)("td",{className:"text-center",children:e.quantityParProduct}),Object(w.jsx)(Tl,{flat:B(k[Hl(Object.keys(k))],"contenu"),gr:Hl(Object.keys(k)),id:e.id})]})})})),0==M.length&&Object(w.jsx)("tr",{children:Object(w.jsx)("td",{className:"text-center",colSpan:r.length+3,children:"Aucune enregistrement trouv\xe9"})})]})})})," "]})]})]})},Yl=function(e){if(!e||0===(null===e||void 0===e?void 0:e.length))return 0;var t=0;return e.forEach((function(e){t+=e.prixVente*e.quantityParProduct*1})),t},Kl=function(e,n,c){return 1==e[t]?{text:"plus (+"+e[n]+")("+c+")",textStyle:"text text-info",date:nt(e.datedecorrection),style:"badge badge-info"}:2==e[t]?{text:"moins (-"+e[n]+")("+c+")",textStyle:"text text-warning",date:nt(e.datedecorrection),style:"badge badge-warning"}:3==e[t]?{text:"ajouter au commande ( + "+e[n]+"("+c+")",textStyle:"text text-success",date:nt(e.datedecorrection),style:"badge badge-success"}:4==e[t]?{text:"supprimer du commande ( - "+e[n]+"("+c+")",textStyle:"text text-danger",date:nt(e.datedecorrection),style:"badge badge-danger"}:void 0};var zl=Object(j.j)((function(e){Object(j.g)();var t,n,c=Object(j.i)().id,r=Object(P.useSelector)(Jn("commandes").value),i=Object(P.useDispatch)();return Object(a.useEffect)((function(){i(Xn("commandes").get(c))}),[c]),Object(w.jsxs)(Xe,{children:[Object(w.jsx)(Ke,{title:"D\xe9tail de sortie vers magasin",children:Object(w.jsx)(We,{title:"D\xe9tail de sortie vers magasin"})}),Object(w.jsxs)($e,{children:[Object(w.jsxs)("table",{className:"table table-bordered ",children:[Object(w.jsxs)("tr",{className:"bg-thead",children:[Object(w.jsx)("td",{children:"Nom de l'article"}),Object(w.jsx)("td",{children:"Quantit\xe9"}),Object(w.jsx)("td",{children:"Sous total"})]}),r.length>0&&(null===(t=r[0])||void 0===t?void 0:t.contenu.map((function(e){return Object(w.jsxs)("tr",{children:[Object(w.jsxs)("td",{style:{width:"40%"},children:[Object(w.jsx)("h2",{children:e.name}),e.correction>0&&Object(w.jsx)("div",{children:Object(w.jsx)("div",{className:Kl(e,"correction","correctiontype").style,children:Object(w.jsx)("p",{children:Kl(e).text})})}),e.correctionml>0&&Object(w.jsx)("div",{children:Object(w.jsx)("div",{className:Kl(e,"correctionml","correctiontml").style,children:Object(w.jsx)("p",{children:Kl(e,"correctionml","correctiontml").text})})}),e.correctionl>0&&Object(w.jsx)("div",{children:Object(w.jsx)("div",{className:Kl(e,"correctionl","correctiontl").style,children:Object(w.jsx)("p",{children:Kl(e,"correctionl","correctiontl").text})})}),Object(w.jsxs)("p",{children:["Date de modification:",nt(e.datedecorrection)]})]}),Object(w.jsxs)("td",{className:"d-flex align-items-center",children:[ct(Ra(e)?e.prixlitre:e.prixVente),"(","x"," ",e.quantityParProduct,")"]}),Object(w.jsx)("td",{children:ct(Ra(e)?e.prixlitre:e.prixVente*e.quantityParProduct)})]})})))]}),Object(w.jsxs)("div",{className:"d-flex justify-content-end",children:[Object(w.jsx)("strong",{children:"Total"}),":",ct(Yl(null===(n=r[0])||void 0===n?void 0:n.contenu))]})]})]})})),Wl=function(e){return e&&0!==(null===e||void 0===e?void 0:e.length)?e.reduce((function(e,t){return e+t}),0):0};var Gl=Object(j.j)((function(e){Object(j.h)();var t,n,c,r,i,s,o,l,d=Object(j.i)().id,u=Object(P.useSelector)(Jn("commandes").value),b=Object(P.useDispatch)();return Object(a.useEffect)((function(){b(Xn("commandes").get(d))}),[d]),Object(w.jsxs)(Xe,{children:[Object(w.jsx)(Ke,{title:"D\xe9tail de vente du magasin",children:Object(w.jsx)(We,{title:"D\xe9tail de vente du magasin"})}),Object(w.jsxs)($e,{children:[Object(w.jsxs)("div",{children:[Object(w.jsxs)("div",{children:[Object(w.jsx)("p",{children:"credit-cva"==(null===(t=u[0])||void 0===t?void 0:t.type)&&Object(w.jsx)("p",{children:"Credit"})}),"credit-cva"==(null===(n=u[0])||void 0===n?void 0:n.type)&&Object(w.jsx)("div",{className:"border",children:Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("h3",{children:null===(c=u[0])||void 0===c?void 0:c.emprunter.name}),Object(w.jsx)("h5",{children:null===(r=u[0])||void 0===r?void 0:r.emprunter.contact})]})}),u.length>0&&Object(w.jsxs)("div",{className:"d-flex justify-content-between",children:[Object(w.jsxs)("h2",{className:"my-2",children:["Date : ",nt(null===(i=u[0])||void 0===i?void 0:i.dateCom)]}),Object(w.jsx)("div",{className:"d-flex justify-content-end",children:Object(w.jsxs)("div",{className:"bg-thead p-1 mb-1",children:[Object(w.jsx)("strong",{children:"Recette:"}),":",Object(w.jsx)("h3",{className:"text-lg",children:ct(Wl(null===(s=u[0])||void 0===s?void 0:s.contenu.map((function(e){return Ra(e)?e.prixlitre*e.quantityParProduct:e.prixVente*e.quantityParProduct})))+Wl(null===(o=u[0])||void 0===o?void 0:o.contenu.map((function(e){return e.prixParCC*e.qttByCC}))))})]})})]}),Object(w.jsxs)("table",{className:"table table-bordered",children:[Object(w.jsxs)("tr",{className:"bg-thead",children:[Object(w.jsx)("td",{children:"Nom de l'article"}),Object(w.jsx)("td",{children:"Quantit\xe9"}),Object(w.jsx)("td",{children:"Sous total"})]}),u.length>0&&(null===(l=u[0])||void 0===l?void 0:l.contenu.map((function(e){return Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{style:{width:"40%"},children:e.name}),Object(w.jsx)(w.Fragment,{children:0!=e.quantityParProduct&&Object(w.jsxs)("div",{className:"d-flex align-items-center py-0",children:[Object(w.jsxs)("strong",{children:[e.type,":"]}),ct(e.prixVente)," (","x"," ",e.quantityParProduct,") "," = ",ct(e.prixVente*e.quantityParProduct)]})}),"FLACON"==e.type&&Object(w.jsx)(w.Fragment,{children:0!=e.qttByCC&&Object(w.jsxs)("div",{className:"d-flex align-items-center  py-0",children:[Object(w.jsx)("strong",{children:"ML:"})," ",ct(e.prixParCC)," ","x"," ",0!=e.qttyspecificmirror?e.qttyspecificmirror+" Dose":e.qttByCC+" Ml"," "," = "," ",ct(e.prixParCC*e.qttByCC)]})}),Object(w.jsx)("td",{children:ct(e.prixVente*e.quantityParProduct+e.prixParCC*e.qttByCC)})]})})))]})]})," "]})," "]})]})})),Xl=function(){var e=Object(j.i)().id,t=Object(a.useState)(!1),n=Object(f.a)(t,2),c=n[0],r=n[1],s=Object(P.useDispatch)(),o=Object(P.useSelector)(Jn("commandes").value),l=Object(P.useSelector)(Jn("commandes").meta),d=Object(P.useSelector)(Jn("products").value),u=Object(P.useSelector)(Jn("products").meta),b=Object(a.useState)([]),m=Object(f.a)(b,2),O=(m[0],m[1]);i.a.useEffect((function(){s(Xn("commandes").get(e))}),[e]);var h=Object(a.useState)(""),x=Object(f.a)(h,2),v=x[0],p=(x[1],Object(a.useState)([])),g=Object(f.a)(p,2),y=g[0],N=g[1];i.a.useEffect((function(){return 1==c&&(s(Xn("products").fetch()),r(!1)),function(){r(!1)}}),[c]);var C=Object(a.useState)(),S=Object(f.a)(C,2);S[0],S[1];return i.a.useEffect((function(){O(Mr(d,v))}),[v]),i.a.useEffect((function(){var e;l.isFetching||N(null===(e=o[0])||void 0===e?void 0:e.contenu)}),[l]),i.a.useEffect((function(){u.isFetching||O(d)}),[u]),Object(w.jsxs)("div",{children:[Object(w.jsx)("div",{className:"bg-dark text-white p-3 d-flex justify-content-center align-items-center",children:Object(w.jsx)("h1",{className:"",children:"CABINET VETERINAIRE AMBALAVAO"})}),Object(w.jsx)(Fr.a,{className:"mt-3",children:Object(w.jsx)(fr.a,{children:Object(w.jsx)(gr.a,{xs:12,children:Object(w.jsx)(Os,{state:y,meta:l,disabled:u.isFetching,setState:N,products:d,commandes:o[0]})})})})]})},Jl=function(e){return e&&0!==(null===e||void 0===e?void 0:e.length)?e.reduce((function(e,t){return e+t}),0):0};Object(j.j)((function(e){Object(j.h)();var t,n,c,r,i,s,o,l,d=Object(j.i)().id,u=Object(P.useSelector)(Jn("commandes").value),b=Object(P.useDispatch)();return Object(a.useEffect)((function(){b(Xn("commandes").get(d))}),[d]),Object(w.jsxs)(Xe,{children:[Object(w.jsx)(Ke,{title:"D\xe9tail de vente du magasin",children:Object(w.jsx)(We,{title:"D\xe9tail de vente du magasin"})}),Object(w.jsxs)($e,{children:[Object(w.jsxs)("div",{children:[Object(w.jsxs)("div",{children:[Object(w.jsx)("p",{children:"credit-cva"==(null===(t=u[0])||void 0===t?void 0:t.type)&&Object(w.jsx)("p",{children:"Credit"})}),"credit-cva"==(null===(n=u[0])||void 0===n?void 0:n.type)&&Object(w.jsx)("div",{className:"border",children:Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("h3",{children:null===(c=u[0])||void 0===c?void 0:c.emprunter.name}),Object(w.jsx)("h5",{children:null===(r=u[0])||void 0===r?void 0:r.emprunter.contact})]})}),u.length>0&&Object(w.jsxs)("div",{className:"d-flex justify-content-between",children:[Object(w.jsxs)("h2",{className:"my-2",children:["Date : ",nt(null===(i=u[0])||void 0===i?void 0:i.dateCom)]}),Object(w.jsx)("div",{className:"d-flex justify-content-end",children:Object(w.jsxs)("div",{className:"bg-thead p-1 mb-1",children:[Object(w.jsx)("strong",{children:"Recette:"}),":",Object(w.jsx)("h3",{className:"text-lg",children:ct(Jl(null===(s=u[0])||void 0===s?void 0:s.contenu.map((function(e){return Ra(e)?e.prixlitre*e.quantityParProduct:e.prixVente*e.quantityParProduct})))+Jl(null===(o=u[0])||void 0===o?void 0:o.contenu.map((function(e){return e.prixParCC*e.qttByCC}))))})]})})]}),Object(w.jsxs)("table",{className:"table table-bordered",children:[Object(w.jsxs)("tr",{className:"bg-thead",children:[Object(w.jsx)("td",{children:"Nom de l'article"}),Object(w.jsx)("td",{children:"Quantit\xe9"}),Object(w.jsx)("td",{children:"Sous total"})]}),u.length>0&&(null===(l=u[0])||void 0===l?void 0:l.contenu.map((function(e){return Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{style:{width:"40%"},children:e.name}),Object(w.jsx)(w.Fragment,{children:0!=e.quantityParProduct&&Object(w.jsxs)("div",{className:"d-flex align-items-center py-0",children:[Object(w.jsxs)("strong",{children:[e.type,":"]}),ct(e.prixVente)," (","x"," ",e.quantityParProduct,") "," = ",ct(e.prixVente*e.quantityParProduct)]})}),"FLACON"==e.type&&Object(w.jsx)(w.Fragment,{children:0!=e.qttByCC&&Object(w.jsxs)("div",{className:"d-flex align-items-center  py-0",children:[Object(w.jsx)("strong",{children:"ML:"})," ",ct(e.prixParCC)," ","x"," ",0!=e.qttyspecificmirror?e.qttyspecificmirror+" Dose":e.qttByCC+" Ml"," "," = "," ",ct(e.prixParCC*e.qttByCC)]})}),Object(w.jsx)("td",{children:ct(e.prixVente*e.quantityParProduct+e.prixParCC*e.qttByCC)})]})})))]})]})," "]})," "]})]})}));var $l=function(e){var t,n=e.state,c=e.setState,r=e.product,a=(Object(P.useDispatch)(),!!(null===n||void 0===n?void 0:n.find((function(e){return(null===e||void 0===e?void 0:e.id)===r.id})))),s=i.a.useCallback((function(){return r.quantityBruteCVA>15&&r.quantityBruteCVA<=20?"yellow":r.quantityBruteCVA>10&&r.quantityBruteCVA<=15?"#ffdb4c":r.quantityBruteCVA>5&&r.quantityBruteCVA<=10?" orange":r.quantityBruteCVA>0&&r.quantityBruteCVA<=5?"#c44e14b8":0==r.quantityBruteCVA?"red":"green"}),[r]),o=i.a.useCallback((function(){return r.quantityCCCVA>15&&r.quantityCCCVA<=20?"yellow":r.quantityCCCVA>10&&r.quantityCCCVA<=15?"#ffdb4c":r.quantityCCCVA>5&&r.quantityCCCVA<=10?" orange":r.quantityCCCVA>0&&r.quantityCCCVA<=5?"#c44e14b8":0==r.quantityCCCVA?"red":"green"}),[r]);return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(pr.a.Item,{className:"mb-2 mr-3",style:{width:"100%",border:"1px solid gray",background:"whitesmoke",borderLeft:"10px solid ".concat(s())},children:Object(w.jsxs)("div",{className:" d-flex justify-content-between align-items-center",children:[Object(w.jsxs)("div",{className:" ".concat(r.id?"":"product-loading"),style:{boxShadow:r&&a?"15px 10px 15px rgba(0, 0, 0, .07)":"none"},children:[Object(w.jsxs)("div",{children:[Object(w.jsx)("div",{style:{width:10,height:4,background:"".concat(o())}}),Object(w.jsxs)("div",{children:[r.name," "]}),Object(w.jsx)("div",{class:"badge badge-primary",children:null===r||void 0===r||null===(t=r.fournisseur)||void 0===t?void 0:t.name}),Object(w.jsx)("br",{})]})," "]}),Object(w.jsx)("div",{children:(null===r||void 0===r?void 0:r.id)&&Object(w.jsx)(w.Fragment,{children:a?Object(w.jsx)("button",{disabled:0===r.quantityBruteCVA&&(0==r.quantityCCCVA||null==r.quantityCCCVA),className:"btn btn-danger btn-sm",onClick:function(){!function(e){c(n.filter((function(t){return t.id!==e})))}(null===r||void 0===r?void 0:r.id)},children:"Retirer"}):Object(w.jsx)("button",{disabled:0===r.quantityBruteCVA&&(0==r.quantityCCCVA||null==r.quantityCCCVA),className:"btn btn-green btn-sm",onClick:function(){c(n.some((function(e){return e.id===r.id}))?n:[r].concat(Object(Ie.a)(n)))},children:"Ajouter"})})})]})})})},Zl=function(e){var t=e.product,n=e.index,c=e.state,r=e.setState,a=e.setRealQtt,i=e.realQtt,s=(e.maxRealQtt,function(e){!function(e,t,n){var a=Object(Ie.a)(c);a[e]=Object(dt.a)(Object(dt.a)({},a[e]),{},Object(g.a)({},t,n)),r(a)}(n,"quantityParProduct",e)});return Object(w.jsx)("div",{className:"basket-item-control",children:Object(w.jsxs)(Xc.c,{inputMode:"numeric",w:28,bg:"whitesmoke",onChange:function(e){""==e?(a(null===t||void 0===t?void 0:t.quantityParProduct),s(null===t||void 0===t?void 0:t.quantityParProduct)):(a(Number(e)),s(Number(e)))},min:0,value:i,defaultValue:null===t||void 0===t?void 0:t.quantityParProduct,children:[Object(w.jsx)(Xc.d,{}),Object(w.jsxs)(Xc.e,{children:[Object(w.jsx)(Xc.b,{}),Object(w.jsx)(Xc.a,{})]})]})})},ed=function(e){var t=e.product,n=e.setRealQttCC,c=e.realQttCC,r=e.maxRealQttCC,a=Object(P.useDispatch)();return Object(w.jsx)("div",{className:"basket-item-control",children:Object(w.jsxs)(Xc.c,{inputMode:"decimal",w:28,step:1,bg:"whitesmoke",onChange:function(e){!function(e){a(Fi(t.id,e))}(e),n(e)},min:0,value:c,defaultValue:null===t||void 0===t?void 0:t.qttByCC,max:r,children:[Object(w.jsx)(Xc.d,{}),Object(w.jsxs)(Xc.e,{children:[Object(w.jsx)(Xc.b,{}),Object(w.jsx)(Xc.a,{})]})]})})},td=function(e){var t=e.product,n=e.setRealQttCC,c=e.realQttCC,r=e.maxRealQttCC,a=Object(P.useDispatch)(),i=function(e){a(Ti(t.id,e))};return Object(w.jsx)("div",{className:"basket-item-control",children:Object(w.jsxs)(Xc.c,{inputMode:"decimal",w:28,bg:"whitesmoke",onChange:function(e){""==e?(i(0),n(0)):(i(Number(e)),n(Number(e)))},min:0,value:c,defaultValue:null===t||void 0===t?void 0:t.qttByCC,max:r,children:[Object(w.jsx)(Xc.d,{}),Object(w.jsxs)(Xc.e,{children:[Object(w.jsx)(Xc.b,{}),Object(w.jsx)(Xc.a,{})]})]})})},nd=function(e){var t=e.product,n=e.setRealQttCC,c=e.maxRealQttCC,r=e.realQttCC,a=Object(P.useDispatch)();return Object(w.jsx)("div",{className:"basket-item-control",children:Object(w.jsxs)(Xc.c,{inputMode:"numeric",w:28,step:1,bg:"whitesmoke",onChange:function(e){!function(e){a(Ri(t.id,e))}(Number(e)),n(Number(e))},min:0,value:r,defaultValue:null===t||void 0===t?void 0:t.qttByCC,max:c,children:[Object(w.jsx)(Xc.d,{}),Object(w.jsxs)(Xc.e,{children:[Object(w.jsx)(Xc.b,{}),Object(w.jsx)(Xc.a,{})]})]})})},cd=function(e){var t=e.product,n=e.setRealQttCC,c=(e.maxRealQttCC,e.index),r=e.setState,a=e.state,i=e.realQttCC,s=function(e){!function(e,t,n){var c=Object(Ie.a)(a);c[e]=Object(dt.a)(Object(dt.a)({},c[e]),{},Object(g.a)({},t,n)),r(c)}(c,"qttByCC",e)};return Object(w.jsx)("div",{className:"basket-item-control",children:Object(w.jsxs)(Xc.c,{inputMode:"numeric",w:28,bg:"whitesmoke",onChange:function(e){""==e?(s(null===t||void 0===t?void 0:t.qttByCC),n(null===t||void 0===t?void 0:t.qttByCC)):(n(1*e),s(1*e))},min:0,value:i,children:[Object(w.jsx)(Xc.d,{}),Object(w.jsxs)(Xc.e,{children:[Object(w.jsx)(Xc.b,{}),Object(w.jsx)(Xc.a,{})]})]})})},rd=function(e){var t=e.product,n=e.setRealQttLitre,c=e.setState,r=e.state,a=e.realQttLitre,i=e.index,s=function(e){!function(e,t,n){var a=Object(Ie.a)(r);a[e]=Object(dt.a)(Object(dt.a)({},a[e]),{},Object(g.a)({},t,n)),c(a)}(i,"qttbylitre",e)};return Object(w.jsx)("div",{className:"basket-item-control",children:Object(w.jsxs)(Xc.c,{inputMode:"numeric",w:28,step:1,bg:"whitesmoke",min:0,value:a,defaultValue:null===t||void 0===t?void 0:t.qttbylitre,onChange:function(e){""==e?(n(null===t||void 0===t?void 0:t.qttbylitre),s(null===t||void 0===t?void 0:t.qttbylitre)):(n(Number(e)),s(Number(e)))},children:[Object(w.jsx)(Xc.d,{}),Object(w.jsxs)(Xc.e,{children:[Object(w.jsx)(Xc.b,{}),Object(w.jsx)(Xc.a,{})]})]})})},ad=function(e){var t=e.product,n=e.state,c=e.setState,r=e.realQttCC,a=e.setRealQttCC,i=(e.maxRealQttCC,e.index),s=(Object(P.useDispatch)(),function(e){!function(e,t,r){var a=Object(Ie.a)(n);a[e]=Object(dt.a)(Object(dt.a)({},a[e]),{},Object(g.a)({},t,r)),c(a)}(i,"qttByCC",e)});return Object(w.jsx)("div",{className:"basket-item-control",children:Object(w.jsxs)(Xc.c,{inputMode:"decimal",w:28,bg:"whitesmoke",onChange:function(e){""==e?(s(0),a(0)):(a(Number(e)),s(Number(e)))},min:0,value:r,defaultValue:null===t||void 0===t?void 0:t.qttByCC,children:[Object(w.jsx)(Xc.d,{}),Object(w.jsxs)(Xc.e,{children:[Object(w.jsx)(Xc.b,{}),Object(w.jsx)(Xc.a,{})]})]})})},id=function(e){return!(0==e.condml||0==e.condsize||0==e.qttccpvente||0==e.prixqttccvente)},sd=function(e){return 1==e.correctiontype?{text:"plus (+"+e.correction+") et ("+e.correctionml+")",textStyle:"text text-info",date:nt(e.datedecorrection),style:"badge badge-info"}:2==e.correctiontype?{text:"moins (-"+e.correction+")  et ("+e.correctionml+")",textStyle:"text text-warning",date:nt(e.datedecorrection),style:"badge badge-warning"}:3==e.correctiontype?{text:"ajouter au commande ( + "+e.correction+")  et ("+e.correctionml+")",textStyle:"text text-success",date:nt(e.datedecorrection),style:"badge badge-success"}:4==e.correctiontype?{text:"supprimer du commande ( - "+e.correction+")  et ("+e.correctionml+")",textStyle:"text text-danger",date:nt(e.datedecorrection),style:"badge badge-danger"}:void 0},od=function(e){var t=e.state,n=e.index,c=e.setState,r=e.product,s=e.products,o=(Object(P.useDispatch)(),Object(a.useState)(null===r||void 0===r?void 0:r.qttByCC)),l=Object(f.a)(o,2),d=l[0],u=l[1],j=Object(a.useState)(null===r||void 0===r?void 0:r.quantityParProduct),b=Object(f.a)(j,2),m=b[0],O=b[1],h=Object(a.useState)(null===r||void 0===r?void 0:r.qttbylitre),x=Object(f.a)(h,2),v=x[0],p=x[1],g=Object(a.useState)(2e3),y=Object(f.a)(g,2),N=y[0],C=y[1],S=Object(a.useState)(2e3),q=Object(f.a)(S,2),E=q[0],A=q[1],D=Object(a.useState)(2e3),V=Object(f.a)(D,2),F=V[0],R=V[1],T=Object(P.useSelector)(Jn("commandes").value);return i.a.useEffect((function(){if(void 0!=s&&void 0!=t&&T.length>0){var e=null===t||void 0===t?void 0:t.find((function(e){return null===r||void 0===r?void 0:r.id})),n=nl(s,T[0],e),c=n.normalQtt,a=n.normalQttCC,i=n.normalQttLitre,o=n.isSpecific;0==n.isValid&&(alert("stock insuffisant :("),o?(p(i),R(i),O(c),C(c),u(a),A(a)):(O(c),C(c),u(a),A(a))),console.log(v)}}),[m,d,v,s]),Object(w.jsx)("div",{children:Object(w.jsxs)("div",{className:"d-flex justify-content-between align-items-center border mt-3  mb-2 p-2",children:[Object(w.jsxs)("div",{style:{width:"45%"},children:[r.correction>0&&Object(w.jsxs)("div",{children:[Object(w.jsx)("div",{className:sd(r).style,children:Object(w.jsx)("p",{children:sd(r).text})}),Object(w.jsxs)("p",{className:sd(r).textStyle,children:["Date de modification:",sd(r).date]})]}),Object(w.jsx)("p",{className:"text-blue",children:r.name}),id(r)?Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("p",{className:"text-lowercase",children:Object(w.jsx)("strong",{children:0!=r.qttbylitre&&Object(w.jsx)("span",{style:{marginRight:"30px"},children:ct(r.prixVente)+" x "+r.qttbylitre+" Litre(s)"})})}),Object(w.jsx)("p",{className:"text-lowercase",children:Object(w.jsx)("strong",{children:0!=r.quantityParProduct&&Object(w.jsx)("span",{style:{marginRight:"30px"},children:ct(r.prixqttccvente*r.qttccpvente)+" x "+r.quantityParProduct+" "+r.type})})})]}):Object(w.jsx)("p",{className:"text-lowercase",children:Object(w.jsx)("strong",{children:0!=r.quantityParProduct&&Object(w.jsx)("span",{style:{marginRight:"30px"},children:ct(r.prixVente)+" x "+r.quantityParProduct+" "+r.type})})}),Object(w.jsx)("p",{className:"text-lowercase",children:Object(w.jsx)("strong",{children:0!=r.qttByCC&&Object(w.jsx)("span",{style:{marginRight:"30px"},children:ct(r.prixParCC)+" x "+r.qttByCC+" ML"})})})]}),0!==r.condml&&0!==r.qttccpvente&&Object(w.jsxs)("div",{className:"text-inline text-center mr-3",children:[Object(w.jsx)("h5",{className:"mb-1 text-uppercase",children:"Litre"}),Object(w.jsx)(rd,{product:r,setState:c,state:t,index:n,realQttLitre:v,setRealQttLitre:p,maxRealQttByLitre:F})," "]}),Object(w.jsxs)("div",{className:"d-flex  justify-content-between align-items-center ",children:[Object(w.jsxs)("div",{className:"text-center mr-2",children:[Object(w.jsx)("h5",{className:"mb-1",children:r.type}),Object(w.jsx)(Zl,{index:n,state:t,setState:c,product:r,setRealQtt:O,realQtt:m,maxRealQtt:N})]}),"FLACON"===r.type&&Object(w.jsxs)("div",{className:"text-inline text-center",children:[Object(w.jsx)("h5",{className:"mb-1",children:3==r.categoryId?"DOSE":"ML"}),at(r.name,"ita new")&&Object(w.jsx)(ed,{product:r,index:n,state:t,setState:c,setRealQttCC:u,realQttCC:d,maxRealQttCC:E}),at(r.name,"sovax")&&Object(w.jsx)(nd,{index:n,state:t,setState:c,realQttCC:d,setRealQttCC:u,product:r,maxRealQttCC:E}),0==r.condml&&0==r.qttccpvente&&!at(r.name,"sovax")&&!at(r.name,"ita new")&&Object(w.jsx)(cd,{index:n,realQttCC:d,setRealQttCC:u,state:t,setState:c,product:r,maxRealQttCC:E}),0!==r.condml&&0!==r.qttccpvente&&Object(w.jsx)(ad,{product:r,state:t,realQttCC:d,setRealQttCC:u,maxRealQttCC:E,setState:c,index:n})]})]})]})})},ld=function(e){return e&&0!==(null===e||void 0===e?void 0:e.length)?e.reduce((function(e,t){return e+t}),0):0};function dd(e){var t,n,c;for(c in t=Array.isArray(e)?[]:{},e)n=e[c],t[c]="object"===typeof n?dd(n):n;return t}var ud=function(e){var t=e.state,n=(e.meta,e.setState),c=e.disabled,r=e.products,i=e.commandes,s=Object(a.useState)("direct"),o=Object(f.a)(s,2),l=o[0],d=(o[1],Object(a.useState)(1)),b=Object(f.a)(d,2),m=(b[0],b[1],Object(a.useState)(null)),O=Object(f.a)(m,2),h=(O[0],O[1],Object(a.useState)(null)),x=Object(f.a)(h,2),v=(x[0],x[1]),p=Object(j.g)(),y=Object(a.useState)([]),N=Object(f.a)(y,2),C=N[0],S=N[1],q=Object(P.useSelector)((function(e){return{fromdepots:e.fromdepots}})),E=q.fromdepots;Object(a.useEffect)((function(){S(null===i||void 0===i?void 0:i.contenu)}),[i]);var A=Object(P.useDispatch)(),D=Object(P.useSelector)(Jn("emprunters").value),V=new Date,F=Object(a.useState)(V),R=Object(f.a)(F,2),T=R[0],M=R[1];Object(a.useEffect)((function(){A(Xn("emprunters").fetch())}),[]);return Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)(lr.a,{children:[Object(w.jsx)(lr.a.Header,{className:" bg-dark py-3 text-white d-flex justify-content-between align-items-center",children:Object(w.jsx)("div",{style:{width:"60%"},children:"BON DE SORTIE"})}),Object(w.jsxs)("div",{className:"commande-vente",children:[Object(w.jsxs)(lr.a.Body,{style:{padding:12,marginTop:3,marginRight:2,marginLeft:2},children:[Object(w.jsx)("div",{className:"d-flex justify-content-end",children:Object(w.jsx)(u.b,{className:"btn btn-primary mb-2 btn-sm",to:Be,children:"Voir l'historique de vente"})}),Object(w.jsxs)("div",{style:{overflowY:"auto",height:"350px",maxHeight:"350px",overflowX:"hidden"},children:[Object(w.jsxs)("div",{class:"form-group",children:[Object(w.jsxs)("label",{children:["Date de sortie : ",nt(T)]}),Object(w.jsx)("div",{children:Object(w.jsx)("input",{type:"date",disabled:c,onChange:function(e){return M(e.target.value)},value:T,className:"form-control"})})]}),"credit"===l&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("label",{children:"Crediteur:"}),Object(w.jsxs)("select",{disabled:c,className:"form-control",onChange:function(e){v(e.target.value)},children:[Object(w.jsx)("option",{value:""}),D.map((function(e){return Object(w.jsx)("option",{value:e.id,children:e.name})}))]})]}),(null===t||void 0===t?void 0:t.length)<=0&&Object(w.jsx)("div",{className:"alert alert-success ",children:"Aucune enregistrement trouv\xe9"}),null===t||void 0===t?void 0:t.sort((function(e,t){return t.quantityBruteCVA-e.quantityBruteCVA})).map((function(e,c){var a;return Object(w.jsx)(od,{product:e,realcommande:null===(a=i[0])||void 0===a?void 0:a.find((function(t){return t.id==e.id})),state:t,index:c,products:null===r||void 0===r?void 0:r.find((function(t){return t.id==e.id})),setState:n,basket:E,dispatch:A},"".concat(null===e||void 0===e?void 0:e.id,"_").concat(c))}))]})]}),(null===t||void 0===t?void 0:t.length)>0&&Object(w.jsxs)(lr.a.Footer,{className:"d-flex align-items-center justify-content-between",children:[Object(w.jsx)("div",{style:{width:"40%"},children:Object(w.jsx)("h2",{className:"p-2 text-uppercase bg-primary",children:Object(w.jsxs)("strong",{"data-test-id":"total-price-orders",children:["Total:",ct(ld(null===t||void 0===t?void 0:t.map((function(e){return $o(e)?e.prixqttccvente*e.quantityParProduct*e.qttccpvente+e.prixlitre*e.qttbylitre:e.prixVente*e.quantityParProduct})))+ld(null===t||void 0===t?void 0:t.map((function(e){return e.prixParCC*e.qttByCC}))))]})})}),Object(w.jsx)("div",{style:{width:"60%"},children:(null===t||void 0===t?void 0:t.length)>0&&Object(w.jsxs)("div",{className:"d-flex text-right align-items-end justify-content-end",children:[Object(w.jsx)("button",{className:"btn btn-green btn-sm mr-2",disabled:0===(null===t||void 0===t?void 0:t.length),onClick:function(){var e,n=function(){var e=dd(C).filter((function(e){return!t.find((function(t){return e.id===t.id}))})),n=dd(C).filter((function(e){return!t.find((function(t){return e.id===t.id}))}));return{exist:dd(C).map((function(e){return t.find((function(t){return t.id===e.id}))})).filter((function(e){return null!=e})),added:n,missing:e}}(),c=n.exist,r=n.added,a=n.missing;rl(t)?alert("modification non conforme,veuillez verifier"):A(Xn("commandes").updateTransaction((e={id:null===i||void 0===i?void 0:i.id,contenu:t,commande:t,type:"vente-cva",sorte:"sortie"},Object(g.a)(e,"sorte","sortie"),Object(g.a)(e,"status",!0),Object(g.a)(e,"dateCom",null!=T?T:V),Object(g.a)(e,"exist",c),Object(g.a)(e,"added",r),Object(g.a)(e,"missing",a),e),"update-from-magasin"))},type:"button",children:"Valider l'operation"}),Object(w.jsx)("button",{className:"btn btn-danger btn-sm",onClick:function(){return p.goBack()},type:"button",children:Object(w.jsx)("span",{children:"Annuler"})})]})})]})]})]})})},jd=function(){var e=Object(j.i)().id,t=Object(a.useState)(!1),n=Object(f.a)(t,2),c=n[0],r=n[1],s=Object(P.useDispatch)(),o=Object(P.useSelector)(Jn("commandes").value),l=Object(P.useSelector)(Jn("commandes").meta),d=Object(P.useSelector)(Jn("products").value),u=Object(P.useSelector)(Jn("products").meta),b=Object(a.useState)([]),m=Object(f.a)(b,2),O=m[0],h=m[1];i.a.useEffect((function(){s(Xn("commandes").get(e))}),[e]);var x=Object(a.useState)(""),v=Object(f.a)(x,2),p=v[0],g=v[1],y=Object(a.useState)([]),N=Object(f.a)(y,2),C=N[0],S=N[1];i.a.useEffect((function(){return 1==c&&(s(Xn("products").fetch()),r(!1)),function(){r(!1)}}),[c]);var q=Object(a.useState)(),E=Object(f.a)(q,2);E[0],E[1];return i.a.useEffect((function(){h(Mr(d,p))}),[p]),i.a.useEffect((function(){s(Xn("products").fetch())}),[]),i.a.useEffect((function(){var e;l.isFetching||S(null===(e=o[0])||void 0===e?void 0:e.contenu)}),[l]),i.a.useEffect((function(){u.isFetching||h(d)}),[u]),Object(w.jsx)("div",{children:Object(w.jsxs)(Xe,{children:[Object(w.jsx)(Ke,{title:"Editer une vente du magasin",children:Object(w.jsx)(We,{title:"Editer une vente du magasin"})}),Object(w.jsx)($e,{children:Object(w.jsxs)(fr.a,{children:[Object(w.jsx)(gr.a,{xs:6,children:Object(w.jsx)(pr.a,{children:Object(w.jsxs)(lr.a,{children:[Object(w.jsx)(lr.a.Header,{className:"d-flex justify-content-between align-items-center bg-dark text-white",children:"Produits"}),Object(w.jsxs)(lr.a.Body,{children:[Object(w.jsx)("input",{type:"text",onChange:function(e){g(e.target.value)},placeholder:"Rechercher un produit",className:"form-control mb-2"}),Object(w.jsxs)("div",{style:{overflowY:"auto",height:"350px",maxHeight:"350px",overflowX:"hidden"},children:[Object(w.jsxs)(w.Fragment,{children:[O.map((function(e){return Object(w.jsx)($l,{state:C,realproduct:d,setState:S,product:e})})),0==O.length&&"Aucune enregistrement trouv\xe9"]})," "]})]})]})})}),Object(w.jsx)(gr.a,{xs:6,children:Object(w.jsx)(ud,{state:C,meta:l,disabled:u.isFetching,setState:S,products:d,commandes:o[0]})})]})})]})})},bd=function(e){var t=e.product,n=e.index,c=e.state,r=e.setState,a=(e.setRealQttCC,e.setRealQtt),i=e.stock,s=e.realcommand,o=(e.realQtt,e.realQttCC,function(e){console.log(e),function(e,t,n){var a=Object(Ie.a)(c);a[e]=Object(dt.a)(Object(dt.a)({},a[e]),{},Object(g.a)({},t,n)),console.log(a),r(a)}(n,"quantityParProduct",e)});return Object(w.jsx)("div",{className:"basket-item-control",children:(null===i||void 0===i?void 0:i.quantityBruteCVA)<(null===s||void 0===s?void 0:s.quantityParProduct)?Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("div",{children:Object(w.jsxs)(Xc.c,{inputMode:"numeric",w:28,step:1,disabled:!0,bg:"whitesmoke",onChange:function(e){o(Number(e)),a(Number(e)),(null===i||void 0===i?void 0:i.quantityBruteCVA)-(null===s||void 0===s?void 0:s.quantityParProduct)<0&&alert("Le stock ne satisfait pas votre commande")},defaultValue:null===s||void 0===s?void 0:s.quantityParProduct,children:[Object(w.jsx)(Xc.d,{}),Object(w.jsxs)(Xc.e,{children:[Object(w.jsx)(Xc.b,{}),Object(w.jsx)(Xc.a,{})]})]})}),4==(null===s||void 0===s?void 0:s.correctiontype)?Object(w.jsx)("div",{children:Object(w.jsx)(Ol.a,{textTransform:"uppercase",className:"text text-danger",children:"CE PRODUIT A ETE RETIR\xc9"})}):Object(w.jsxs)("div",{children:[Object(w.jsx)(Ol.a,{textTransform:"uppercase",children:"Restituable"}),Object(w.jsxs)(Xc.c,{inputMode:"numeric",w:28,step:1,bg:"whitesmoke",min:0,onChange:function(e){o(Number(e)),a(Number(e))},defaultValue:null===i||void 0===i?void 0:i.quantityBruteCVA,max:null===i||void 0===i?void 0:i.quantityBrute,children:[Object(w.jsx)(Xc.d,{}),Object(w.jsxs)(Xc.e,{children:[Object(w.jsx)(Xc.b,{}),Object(w.jsx)(Xc.a,{})]})]})]})]}):Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)(Xc.c,{inputMode:"numeric",w:28,step:1,bg:"whitesmoke",onChange:function(e){o(Number(e)),a(Number(e)),(null===i||void 0===i?void 0:i.quantityBruteCVA)-(null===s||void 0===s?void 0:s.quantityParProduct)<0&&alert("Le stock ne satisfait pas votre commande")},min:0,defaultValue:null===t||void 0===t?void 0:t.quantityParProduct,max:null===i||void 0===i?void 0:i.quantityBrute,children:[Object(w.jsx)(Xc.d,{}),Object(w.jsxs)(Xc.e,{children:[Object(w.jsx)(Xc.b,{}),Object(w.jsx)(Xc.a,{})]})]})})})},md=function(e){return 1==e.correctiontype?{text:"plus (+"+e.correction+")",textStyle:"text text-info",date:nt(e.datedecorrection),style:"badge badge-info"}:2==e.correctiontype?{text:"moins (-"+e.correction+")",textStyle:"text text-warning",date:nt(e.datedecorrection),style:"badge badge-warning"}:3==e.correctiontype?{text:"ajouter au commande ( + "+e.correction+")",textStyle:"text text-success",date:nt(e.datedecorrection),style:"badge badge-success"}:4==e.correctiontype?{text:"supprimer du commande ( - "+e.correction+")",textStyle:"text text-danger",date:nt(e.datedecorrection),style:"badge badge-danger"}:void 0},Od=function(e){var t=e.state,n=e.index,c=e.setState,r=e.cloneCommandes,i=e.product,s=e.realstock,o=(e.realcommand,Object(a.useState)(null)),l=Object(f.a)(o,2),d=l[0],u=l[1],j=Object(a.useState)(null),b=Object(f.a)(j,2),m=b[0],O=b[1],h=s.find((function(e){return e.id==i.id})),x=null===r||void 0===r?void 0:r.contenu.find((function(e){return e.id==i.id}));return Object(w.jsxs)("div",{className:" mb-2 p-2",style:{opacity:(null===h||void 0===h?void 0:h.quantityBruteCVA)<(null===x||void 0===x?void 0:x.quantityParProduct)?.8:1,border:(null===h||void 0===h?void 0:h.quantityBruteCVA)<(null===x||void 0===x?void 0:x.quantityParProduct)?"1px solid red":"1px solid gray"},children:[(null===h||void 0===h?void 0:h.quantityBruteCVA)<(null===x||void 0===x?void 0:x.quantityParProduct)&&Object(w.jsx)("div",{className:"text-danger text-sm",children:"** Des operations ont \xeate d\xe9ja faite apres la sortie vers magasin et vous ne pourrez pas retourner tous les produits au dep\xf4t**"}),Object(w.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[Object(w.jsxs)("div",{style:{width:"45%"},children:[i.correction>0&&Object(w.jsxs)("div",{children:[Object(w.jsx)("div",{className:md(i).style,children:Object(w.jsx)("p",{children:md(i).text})}),Object(w.jsxs)("p",{className:md(i).textStyle,children:["Date de modification:",md(i).date]})]}),Object(w.jsx)("p",{className:"text-blue",children:i.name}),Object(w.jsx)("span",{className:"text-lowercase",children:Object(w.jsxs)("strong",{children:[0!=i.quantityParProduct&&ct(i.prixVente),0==i.quantityParProduct&&0!=i.prixParCC&&Object(w.jsx)(w.Fragment,{children:null!=i.prixqttccvente&&0!=i.prixqttccvente?ct(i.prixqttccvente):ct(i.prixParCC)}),0!=i.quantityParProduct&&" x "+i.quantityParProduct+" "+i.type," ",null==i.prixqttccvente&&0==i.prixqttccvente&&Object(w.jsx)(w.Fragment,{children:0!=i.qttByCC&&(0==i.quantityParProduct?" x ":"+")+i.qttByCC+"ML"})]})})]}),Object(w.jsxs)("div",{className:"text-inline text-center",children:[Object(w.jsx)("h5",{className:"mb-1",children:i.type}),Object(w.jsx)(bd,{index:n,state:t,setState:c,product:i,realcommand:x,setRealQttCC:u,setRealQtt:O,realQtt:m,stock:h,realQttCC:d})]})]})]})},hd=function(e){return e&&0!==(null===e||void 0===e?void 0:e.length)?e.reduce((function(e,t){return e+t}),0):0};function xd(e){var t,n,c;for(c in t=Array.isArray(e)?[]:{},e)n=e[c],t[c]="object"===typeof n?xd(n):n;return t}var vd=function(e){var t,n,c=e.state,r=(e.meta,e.setState),i=e.realstock,s=e.disabled,o=e.cloneCommandes,l=e.commandes,d=Object(a.useState)("direct"),u=Object(f.a)(d,2),b=u[0],m=(u[1],Object(a.useState)(1)),O=Object(f.a)(m,2),h=(O[0],O[1],Object(a.useState)(null)),x=Object(f.a)(h,2),v=(x[0],x[1],Object(a.useState)(null)),p=Object(f.a)(v,2),y=(p[0],p[1]),N=Object(j.g)(),C=Object(a.useState)([]),S=Object(f.a)(C,2),q=S[0],E=S[1],A=Object(P.useSelector)((function(e){return{tomagasins:e.tomagasins}})),D=A.tomagasins;Object(a.useEffect)((function(){E(null===l||void 0===l?void 0:l.contenu)}),[l]);var V=Object(P.useDispatch)(),F=Object(P.useSelector)(Jn("emprunters").value),R=new Date,T=Object(a.useState)(R),M=Object(f.a)(T,2),B=M[0],k=M[1];Object(a.useEffect)((function(){}),[]);return Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)(lr.a,{children:[Object(w.jsx)(lr.a.Header,{className:" bg-dark py-3 text-white d-flex justify-content-between align-items-center",children:Object(w.jsx)("div",{style:{width:"60%"},children:"BON DE SORTIE"})}),Object(w.jsxs)("div",{className:"commande-vente",children:[Object(w.jsx)(lr.a.Body,{style:{padding:12,marginTop:3,marginRight:2,marginLeft:2},children:Object(w.jsxs)("div",{style:{overflowY:"auto",height:"350px",maxHeight:"350px",overflowX:"hidden"},children:[Object(w.jsxs)("div",{className:"alert alert-warning",children:[Object(w.jsx)("span",{className:"text-uppercase",children:"Attention !!!"})," , la modification d'un bon de sortie entraine aussi la mis \xe0 jour de stock du produit"]}),Object(w.jsxs)("div",{class:"form-group",children:[Object(w.jsxs)("label",{children:["Date de sortie : ",nt(B)]}),Object(w.jsx)("div",{children:Object(w.jsx)("input",{disabled:s,type:"date",onChange:function(e){return k(e.target.value)},value:B,className:"form-control"})})]}),"credit"===b&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("label",{children:"Crediteur:"}),Object(w.jsxs)("select",{disabled:s,className:"form-control",onChange:function(e){y(e.target.value)},children:[Object(w.jsx)("option",{value:""}),F.map((function(e){return Object(w.jsx)("option",{value:e.id,children:e.name})}))]})]}),(null===c||void 0===c?void 0:c.length)<=0&&Object(w.jsx)("div",{className:"alert alert-success ",children:"Aucune enregistrement trouv\xe9"}),null===c||void 0===c?void 0:c.map((function(e,t){return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(Od,{product:wn.a.cloneDeep(e),state:c,index:t,realcommand:e,cloneCommandes:o,realstock:i,setState:r,basket:D,dispatch:V},"".concat(null===e||void 0===e?void 0:e.id,"_").concat(t))})}))]})}),(null===c||void 0===c?void 0:c.length)>0&&Object(w.jsxs)(lr.a.Footer,{className:"d-flex align-items-center justify-content-between",children:[Object(w.jsx)("div",{style:{width:"30%"},children:Object(w.jsx)("h2",{className:"p-2 text-uppercase bg-primary",children:Object(w.jsxs)("strong",{"data-test-id":"total-price-orders",children:["Total:",ct(hd(null===c||void 0===c?void 0:c.map((function(e){return e.prixVente*e.quantityParProduct})))+hd(null===c||void 0===c||null===(t=c.state)||void 0===t?void 0:t.map((function(e){return e.prixParCC*e.qttByCC}))))]})})}),Object(w.jsx)("div",{style:{width:"70%"},children:(null===c||void 0===c?void 0:c.length)>0&&Object(w.jsxs)("div",{className:"d-flex text-right align-items-end justify-content-end",children:[Object(w.jsx)("button",(n={disabled:s,className:"btn btn-green btn-sm mr-2"},Object(g.a)(n,"disabled",0===(null===c||void 0===c?void 0:c.length)),Object(g.a)(n,"onClick",(function(){var e=function(){var e=xd(q).filter((function(e){return!c.find((function(t){return e.id===t.id}))})),t=c.filter((function(e){return!xd(q).find((function(t){return e.id===t.id}))}));return{exist:xd(q).map((function(e){return c.find((function(t){return t.id===e.id}))})).filter((function(e){return null!=e})),added:t,missing:e}}(),t=e.exist,n=e.added,r=e.missing;V(Xn("commandes").updateTransaction({id:null===l||void 0===l?void 0:l.id,contenu:c,type:"cva",sorte:"sortie",status:!0,dateCom:null!=B?B:R,exist:t,added:n,missing:r},"update-to-magasin")),N.push(Ce)})),Object(g.a)(n,"type","button"),Object(g.a)(n,"children","Valider l'operation"),n)),Object(w.jsx)("button",{disabled:s,className:"btn btn-danger btn-sm",onClick:function(){null===c||void 0===c||c.forEach((function(e){e.quantityParProduct=0,e.qttByCC=0})),V(vi())},type:"button",children:Object(w.jsx)("span",{children:"Annuler"})})]})})]})]})]})})},pd=function(e){var t,n=e.state,c=e.setState,r=e.product,a=e.cloneCommandes,i=(Object(P.useDispatch)(),!!(null===n||void 0===n?void 0:n.find((function(e){return(null===e||void 0===e?void 0:e.id)===r.id})))),s=null===a||void 0===a?void 0:a.contenu.find((function(e){return e.id==r.id})),o=(null===r||void 0===r?void 0:r.quantityBruteCVA)<(null===s||void 0===s?void 0:s.quantityParProduct);return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(pr.a.Item,{className:"mb-2 mr-3",style:{border:"1px solid gray"},children:Object(w.jsx)("div",{className:" d-flex justify-content-between align-items-center",children:Object(w.jsxs)("div",{className:" ".concat(r.id?"":"product-loading"),style:{boxShadow:r&&i?"15px 10px 15px rgba(0, 0, 0, .07)":"none"},children:[Object(w.jsxs)("div",{children:[4==(null===s||void 0===s?void 0:s.correctiontype)&&Object(w.jsx)("div",{className:"badge badge-danger",children:Object(w.jsx)("h2",{textTransform:"uppercase",children:"CE PRODUIT A ETE RETIR\xc9"})}),Object(w.jsxs)("div",{children:[r.name," "]}),Object(w.jsx)("div",{class:"badge badge-primary",children:null===r||void 0===r||null===(t=r.fournisseur)||void 0===t?void 0:t.name}),Object(w.jsx)("br",{})]})," ",Object(w.jsx)("div",{children:(null===r||void 0===r?void 0:r.id)&&Object(w.jsx)(w.Fragment,{children:i?Object(w.jsx)("button",{disabled:o,className:"btn btn-danger btn-sm",onClick:function(){return function(e){c(n.filter((function(t){return t.id!==e})))}(null===r||void 0===r?void 0:r.id)},children:"Retirer"}):Object(w.jsx)("button",{className:"btn btn-green btn-sm",onClick:function(){c(n.some((function(e){return e.id===r.id}))?n:[r].concat(Object(Ie.a)(n)))},children:"Ajouter"})})})]})})})})},fd=function(){var e=Object(j.i)().id,t=(Object(j.g)(),Object(a.useState)(!1)),n=Object(f.a)(t,2),c=n[0],r=n[1],s=Object(P.useDispatch)(),o=Object(P.useSelector)(Jn("commandes").value),l=Object(P.useSelector)(Jn("commandesclone").value),d=Object(P.useSelector)(Jn("commandes").meta),u=Object(P.useSelector)(Jn("products").value),b=Object(P.useSelector)(Jn("products").meta),m=Object(a.useState)([]),O=Object(f.a)(m,2),h=O[0],x=O[1];i.a.useEffect((function(){s(Xn("commandesclone").get(e)),s(Xn("commandes").get(e))}),[e]);var v=Object(a.useState)(""),p=Object(f.a)(v,2),g=p[0],y=p[1],N=Object(a.useState)([]),C=Object(f.a)(N,2),S=C[0],q=C[1];i.a.useEffect((function(){return 1==c&&(s(Xn("products").fetch()),r(!1)),function(){r(!1)}}),[c]);var E=Object(a.useState)(),A=Object(f.a)(E,2),D=A[0],V=A[1];i.a.useEffect((function(){x(null!=D?Ha(u,g,D):Mr(u,g))}),[g]),i.a.useEffect((function(){x(""!=g?Ha(u,g,D):Ia(u,D))}),[D]),i.a.useEffect((function(){s(Xn("products").fetch())}),[]),i.a.useEffect((function(){}),[D]),i.a.useEffect((function(){var e;d.isFetching||q(null===(e=o[0])||void 0===e?void 0:e.contenu)}),[d]),i.a.useEffect((function(){b.isFetching||x(u)}),[b]);return Object(w.jsxs)(Xe,{children:[Object(w.jsx)(Ke,{title:"Edition d'un sortie vers magasin",children:Object(w.jsx)(We,{title:"Edition d'un sortie vers magasin"})}),Object(w.jsx)($e,{children:Object(w.jsxs)(fr.a,{className:"py-2",children:[Object(w.jsx)(gr.a,{xs:6,children:Object(w.jsx)(pr.a,{children:Object(w.jsxs)(lr.a,{children:[Object(w.jsx)(lr.a.Header,{className:"d-flex justify-content-between align-items-center bg-dark text-white",children:"Produits"}),Object(w.jsxs)(lr.a.Body,{children:[Object(w.jsx)("input",{type:"text",onChange:function(e){y(e.target.value)},placeholder:"Rechercher un produit",className:"form-control mb-2"}),Object(w.jsx)(ai,{model:"fournisseurs",children:Object(w.jsx)(ii,{children:function(e){var t=e.data;e.meta;return Object(w.jsx)("div",{className:"my-2",children:Object(w.jsxs)("select",{className:"form-control",selected:2==D,onChange:function(e){V(e.target.value)},children:[Object(w.jsx)("option",{value:"",children:"Selectionner un fournisseur"}),t.map((function(e){return Object(w.jsx)("option",{value:e.id,children:e.name})}))]})})}})}),Object(w.jsxs)("div",{style:{overflowY:"auto",height:"350px",maxHeight:"350px",overflowX:"hidden"},children:[Object(w.jsxs)(w.Fragment,{children:[h.map((function(e){return Object(w.jsx)(pd,{state:S,setState:q,cloneCommandes:l[0],product:e})})),0==h.length&&"Aucune enregistrement trouv\xe9"]})," "]})]})]})})}),Object(w.jsx)(gr.a,{xs:6,children:Object(w.jsx)(vd,{disabled:b.isFetching,state:S,meta:d,cloneCommandes:l[0],setState:q,realstock:u,commandes:o[0]})})]})})]})},gd=function(e,t){var n=function(t){return!!(null===e||void 0===e?void 0:e.find((function(e){return(null===e||void 0===e?void 0:e.id)===t})))};return{frommagasin:e,isItemFromMagasin:n,addFromMagasin:function(e){n(e.id)?t(function(e){return{type:yi,payload:e}}(e.id)):t(function(e){return{type:gi,payload:e}}(e))}}},yd=function(e){var t,n=e.product,c=Object(P.useSelector)((function(e){return e.frommagasins})),r=Object(P.useDispatch)(),a=gd(c,r),s=a.isItemFromMagasin,o=a.addFromMagasin,l=!!s&&s(n.id),d=i.a.useCallback((function(){return n.quantityBruteCVA>15&&n.quantityBruteCVA<=20?"yellow":n.quantityBruteCVA>10&&n.quantityBruteCVA<=15?"#ffdb4c":n.quantityBruteCVA>5&&n.quantityBruteCVA<=10?" orange":n.quantityBruteCVA>0&&n.quantityBruteCVA<=5?"#c44e14b8":0==n.quantityBruteCVA?"red":"green"}),[n]);i.a.useCallback((function(){return n.quantityCCCVA>15&&n.quantityCCCVA<=20?"yellow":n.quantityCCCVA>10&&n.quantityCCCVA<=15?"#ffdb4c":n.quantityCCCVA>5&&n.quantityCCCVA<=10?" orange":n.quantityCCCVA>0&&n.quantityCCCVA<=5?"#c44e14b8":0==n.quantityCCCVA?"red":"green"}),[n]),i.a.useCallback((function(){return Ra(n)?0==n.quantityBruteCVA&&(0==n.quantityCCCVA||null==n.quantityCCCVA)&&0==n.condval:0==n.quantityBruteCVA&&(0==n.quantityCCCVA||null==n.quantityCCCVA)}),[n]);return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(pr.a.Item,{className:"mb-2",style:{width:"100%",border:"1px solid gray",padding:"10px",background:"whitesmoke",borderLeft:"10px solid ".concat(d())},children:Object(w.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[Object(w.jsx)("div",{className:" ".concat(n.id?"":"product-loading"),style:{boxShadow:n&&l?"15px 10px 15px rgba(0, 0, 0, .07)":"none"},children:Object(w.jsxs)("div",{className:"d-flex justify-content-center align-items-center",children:[Object(w.jsxs)("div",{className:"d-flex flex-column mr-2 align-items-center w-20",children:[Object(w.jsx)("div",{class:"badge badge-success mb-1",style:{borderRadius:"100%"},children:n.quantityBruteCVA}),Object(w.jsx)("div",{class:"badge badge-warning mb-1",style:{borderRadius:"100%"},children:n.condval}),Object(w.jsx)("div",{class:"badge badge-info mb-1",style:{borderRadius:"100%"},children:n.quantityCC})]}),Object(w.jsx)("div",{children:Object(w.jsxs)("div",{children:[Object(w.jsx)("div",{children:n.name}),Object(w.jsx)("div",{class:"badge badge-primary",children:null===n||void 0===n||null===(t=n.fournisseur)||void 0===t?void 0:t.name})]})})]})}),Object(w.jsx)("div",{children:n.id&&Object(w.jsx)(w.Fragment,{children:Object(w.jsx)("button",{disabled:Gi(n),className:"mt-3 ".concat(l?"btn btn-danger btn-sm":"btn btn-green btn-sm"),onClick:function(){o&&o(n)},children:l?"Retirer":"Ajouter"})})})]})})})},Nd=i.a.memo(yd),Cd=function(e){var t=e.product,n=e.setRealQtt,c=(e.maxRealQtt,e.realQtt),r=Object(P.useDispatch)(),a=function(e){r(us(t.id,e))};return Object(w.jsx)("div",{className:"basket-item-control",children:Object(w.jsxs)(Xc.c,{inputMode:"numeric",w:28,bg:"whitesmoke",min:0,value:c,defaultValue:null===t||void 0===t?void 0:t.quantityParProduct,onChange:function(e){""==e?(n(0),a(0)):(n(e),a(e))},children:[Object(w.jsx)(Xc.d,{}),Object(w.jsxs)(Xc.e,{children:[Object(w.jsx)(Xc.b,{}),Object(w.jsx)(Xc.a,{})]})]})})},Sd=function(e){var t=e.product,n=e.setRealQttCC,c=(e.setRealQtt,e.setMaxRealQttCC,e.maxRealQttCC,e.realQtt,e.realQttCC),r=Object(P.useDispatch)(),i=(Object(a.useRef)(),Object(P.useSelector)((function(e){return{frommagasins:e.frommagasins}})).frommagasins,function(e){r(bs(t.id,e))});return Object(w.jsx)("div",{className:"basket-item-control",children:Object(w.jsxs)(Xc.c,{inputMode:"numeric",w:28,bg:"whitesmoke",onChange:function(e){""==e?(i(0),n(0)):(n(1*e),i(1*e))},min:0,value:c,defaultValue:null===t||void 0===t?void 0:t.qttByCC,children:[Object(w.jsx)(Xc.d,{}),Object(w.jsxs)(Xc.e,{children:[Object(w.jsx)(Xc.b,{}),Object(w.jsx)(Xc.a,{})]})]})})},qd=function(e){var t=e.product,n=e.setRealQttCC,c=e.realQttCC,r=e.maxRealQttCC,a=Object(P.useDispatch)(),i=function(e){a(Ti(t.id,e))};return Object(w.jsx)("div",{className:"basket-item-control",children:Object(w.jsxs)(Xc.c,{inputMode:"decimal",w:28,bg:"whitesmoke",onChange:function(e){""==e?(i(0),n(0)):(i(Number(e)),n(Number(e)))},min:0,value:c,defaultValue:null===t||void 0===t?void 0:t.qttByCC,max:r,children:[Object(w.jsx)(Xc.d,{}),Object(w.jsxs)(Xc.e,{children:[Object(w.jsx)(Xc.b,{}),Object(w.jsx)(Xc.a,{})]})]})})},wd=function(e){var t=e.product,n=e.setRealQttLitre,c=e.realQttLitre,r=e.maxRealQttByLitre,a=Object(P.useDispatch)(),i=function(e){a(js(t.id,e))};return Object(w.jsx)("div",{className:"basket-item-control",children:Object(w.jsxs)(Xc.c,{inputMode:"numeric",w:28,step:1,bg:"whitesmoke",min:0,value:c,defaultValue:0,onChange:function(e){""==e?(n(0),i(0)):(n(Number(e)),i(Number(e)))},max:r,children:[Object(w.jsx)(Xc.d,{}),Object(w.jsxs)(Xc.e,{children:[Object(w.jsx)(Xc.b,{}),Object(w.jsx)(Xc.a,{})]})]})})},Ed=function(e){var t=e.product,n=Object(a.useState)(null===t||void 0===t?void 0:t.qttByCC),c=Object(f.a)(n,2),r=c[0],i=c[1],s=Object(a.useState)(null===t||void 0===t?void 0:t.quantityParProduct),o=Object(f.a)(s,2),l=o[0],d=o[1],u=Object(a.useState)(0),j=Object(f.a)(u,2),b=j[0],m=j[1],O=Object(a.useState)(2e3),h=Object(f.a)(O,2),x=h[0],v=h[1],p=Object(a.useState)(2e3),g=Object(f.a)(p,2),y=g[0],N=g[1],C=Object(a.useState)(2e3),S=Object(f.a)(C,2),q=S[0],E=S[1],A=Object(P.useSelector)((function(e){return e.frommagasins})),D=Object(P.useDispatch)(),V=gd(A,D),F=V.isItemFromMagasin,R=V.addFromMagasin;Object(a.useEffect)((function(){var e=function(e,t,n,c){var r=!1;if(Wi(c)){r=!0;var a=e,i=t,s=n,o=c.condval,l=c.quantityCCCVA,d=c.quantityBruteCVA,u=c.condsize,j=c.doseDefault,b=c.condml,m=!0;if(s>0&&0==a&&0==i&&s>d&&(m=!1,o=a,l=i),0==s&&a>0&&0==i){var O=0;Number(a)>Number(u)&&(O=Math.floor(Number(a)/Number(u)),o-(Number(a)-Number(u)*O)<0&&(O+=1)),d-O<0&&(m=!1,d=s,l=i)}if(0==s&&0==a&&i>0&&l-i<0){var h=0,x=0;Number(i)>Number(j)&&(h=Math.floor(Number(i)/Number(j)),l-(Number(i)-Number(j)*h)<0&&(h+=1)),Number(h)>Number(u)&&(x=Math.floor(Number(h)/Number(u)),o-(Number(h)-Number(u)*h)<0&&(x+=1)),d-x<0&&(m=!1,d=s,o=a)}if(0==s&&a>0&&i>0){var v=0,p=0;Number(i)>Number(b)?(v=Math.floor(Number(i)/Number(b)),l-(Number(i)-Number(b)*v)<0&&(v+=1)):l-Number(i)<0&&(v=1);var f=Number(a)+v;f>Number(u)?(p=Math.floor(f/Number(u)),o-(f-Number(u)*p)<0&&(p+=1)):o-f<0&&(p=1),d-p<0&&(m=!1,d=s,o=a)}if(s>0&&a>0&&0==i){var g=0;Number(a)>Number(u)?(g=Math.floor(Number(a)/Number(u)),o-(Number(a)-Number(u)*g+a)<0&&(g+=1)):o-Number(a)<0&&(g=1),d-(g+s)<0&&(m=!1,d=s,o=a)}if(s>0&&0==a&&i>0){var y=0,N=0;Number(i)>Number(b)?(y=Math.floor(Number(i)/Number(b)),l-(Number(i)-Number(b)*y)<0&&(y+=1)):l-Number(i)<0&&(y=1),Number(y)>Number(u)?(N=Math.floor(Number(y)/Number(u)),o-(Number(y)-Number(u)*N)<0&&(N+=1)):o-y<0&&(N=1),d-(N+s)<0&&(m=!1,o=a)}if(s>0&&a>0&&i>0){var C=0,S=0;Number(i)>Number(b)?(C=Math.floor(Number(i)/Number(b)),l-(Number(i)-Number(b)*C)<0&&(C+=1)):l-Number(i)<0&&(C=1);var q=Number(C)+Number(a);q>Number(u)?(S=Math.floor(q/Number(u)),o-(q-Number(u)*S)<0&&(S+=1)):o-q<0&&(S=1),d-(S+s)<0&&(m=!1)}return{normalQtt:o,normalQttCC:l,normalQttLitre:d,isSpecific:r,isValid:m}}var w=e,E=t,A=c.quantityBruteCVA,D=c.quantityCCCVA,P=c.doseDefault,V=c.quantityBruteCVA;r=!1;var F=!0;if(0==w&&E>0){var R=0,T=0;Number(E)>Number(P)?(R=Math.floor(Number(E)/Number(P)),T=Number(E)-Number(P)*R,console.log(T),D-T<0&&(R+=1)):D-Number(E)<0&&(R=1),E>D&&A-R<0&&(F=!1,A=w)}if(w>0&&0==E&&w>A&&(F=!1,D=E),w>0&&E>0){var M,B=0;Number(E)>Number(P)?(M=Math.floor(Number(E)/Number(P)),B=Number(E)-Number(P)*M,console.log(B),D-B<0&&(M+=1)):D-Number(E)<0&&(M=1),Number(A)-(Number(M)+Number(w))<0&&(F=!1),w>A&&(F=!1,D=E)}return{normalQtt:A,normalQttCC:D,normalQttLitre:V,isValid:F,isSpecific:r}}(l,r,b,t),n=e.normalQtt,c=e.normalQttCC,a=e.normalQttLitre,s=e.isSpecific;e.isValid||(alert("stock insuffisant :("),s?(m(a),E(a),d(n),v(n),i(c),N(c)):(d(n),v(n),i(c),N(c)))}),[l,r,b]);var T=!!F&&F(t.id);return Object(w.jsx)("div",{children:Object(w.jsxs)("div",{className:"d-flex justify-content-between align-items-center border   mb-2 p-2",children:[Object(w.jsxs)("div",{style:{width:"45%"},children:[Object(w.jsx)("p",{className:"text-blue",children:t.name}),Wi(t)?Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("p",{className:"text-lowercase",children:Object(w.jsx)("strong",{children:0!=t.qttbylitre&&Object(w.jsx)("span",{style:{marginRight:"30px"},children:ct(t.prixlitre)+" x "+t.qttbylitre+" Litre(s)"})})}),Object(w.jsx)("p",{className:"text-lowercase",children:Object(w.jsx)("strong",{children:0!=t.quantityParProduct&&Object(w.jsx)("span",{style:{marginRight:"30px"},children:ct(t.prixqttccvente*t.qttccpvente)+" x "+t.quantityParProduct+" "+t.type})})})]}):Object(w.jsx)("p",{className:"text-lowercase",children:Object(w.jsx)("strong",{children:0!=t.quantityParProduct&&Object(w.jsx)("span",{style:{marginRight:"30px"},children:ct(t.prixVente)+" x "+t.quantityParProduct+" "+t.type})})}),Object(w.jsx)("p",{className:"text-lowercase",children:Object(w.jsx)("strong",{children:0!=t.qttByCC&&Object(w.jsx)("span",{style:{marginRight:"30px"},children:ct(t.prixParCC)+" x "+t.qttByCC+" ML"})})})]}),0!==t.condml&&0!==t.qttccpvente&&Object(w.jsxs)("div",{className:"text-inline text-center mr-3",children:[Object(w.jsx)("h5",{className:"mb-1 text-uppercase",children:"Litre"}),Object(w.jsx)(wd,{product:t,setRealQttLitre:m,realQttLitre:b,maxRealQttByLitre:q})," "]}),Object(w.jsxs)("div",{className:"text-inline text-center mr-2",children:[Object(w.jsx)("h5",{className:"mb-1",children:t.type}),Object(w.jsx)(Cd,{product:t,setRealQtt:d,setMaxRealQtt:v,maxRealQtt:x,realQtt:l})]}),"FLACON"===t.type&&Object(w.jsxs)("div",{className:"text-inline text-center",children:[Object(w.jsx)("h5",{className:"mb-1",children:3==t.categoryId?"DOSE":"ML"}),at(t.name,"ita new")&&Object(w.jsx)(os,{product:t,setRealQttCC:i,realQttCC:r}),at(t.name,"sovax")&&Object(w.jsx)(ls,{setRealQttCC:i,realQttCC:r,product:t}),0==t.condml&&0==t.qttccpvente&&!at(t.name,"sovax")&&!at(t.name,"ita new")&&Object(w.jsx)(Sd,{setRealQttCC:i,realQttCC:r,maxRealQttCC:y,product:t}),0!==t.condml&&0!==t.qttccpvente&&Object(w.jsx)(qd,{product:t,setRealQttCC:i,realQttCC:r,maxRealQttCC:y})]}),Object(w.jsx)("div",{className:"ml-2",children:T&&Object(w.jsx)("button",{onClick:function(){R&&R(t)},className:"btn btn-danger btn-xs text-right",children:"X"})})]})})},Ad={fromMagasin:{emptyOrder:"Aucune commande"}},Dd=function(e){return e&&0!==(null===e||void 0===e?void 0:e.length)?e.reduce((function(e,t){return e+t}),0):0},Pd=function(){var e=Object(a.useState)("vente-cva"),t=Object(f.a)(e,2),n=t[0],c=t[1],r=Object(a.useState)(null),i=Object(f.a)(r,2),s=i[0],o=(i[1],Object(a.useState)(null)),l=Object(f.a)(o,2),d=l[0],u=l[1],b=Object(j.g)(),m=Object(P.useSelector)((function(e){return{frommagasins:e.frommagasins}})).frommagasins,O=Object(P.useDispatch)(),h=Object(P.useSelector)(Jn("emprunters").value),x=Object(a.useState)(!1),v=Object(f.a)(x,2),p=(v[0],v[1],new Date),g=Object(a.useState)(p),y=Object(f.a)(g,2),N=y[0],C=y[1];Object(a.useEffect)((function(){O(Xn("emprunters").fetch())}),[]);return Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)(lr.a,{children:[Object(w.jsxs)(lr.a.Header,{className:" bg-dark py-2 text-white d-flex justify-content-between align-items-center",children:[Object(w.jsxs)("div",{style:{width:"60%"},children:["BON DE SORTIE ("," ".concat(null===m||void 0===m?void 0:m.length," ").concat((null===m||void 0===m?void 0:m.length)>1?"articles":"article"),")"]}),Object(w.jsx)("div",{style:{width:"40%"},className:"text-right",children:Object(w.jsxs)("select",{className:"form-control input-sm",onChange:function(e){c(e.target.value)},children:[Object(w.jsx)("option",{value:"vente-cva",selected:!0,children:"Comptant"}),Object(w.jsx)("option",{value:"credit-cva",children:"Credit"})]})})]}),Object(w.jsxs)("div",{className:"commande-vente",children:[Object(w.jsxs)(lr.a.Body,{style:{padding:2,marginTop:3,marginRight:2,marginLeft:2},children:[Object(w.jsx)("div",{className:"d-flex justify-content-end"}),Object(w.jsxs)("div",{style:{overflowY:"auto",height:"350px",maxHeight:"350px",overflowX:"hidden"},children:[Object(w.jsxs)("div",{class:"form-group",children:[Object(w.jsx)("label",{children:"Date de sortie :"}),Object(w.jsx)("div",{children:Object(w.jsx)("input",{type:"date",onChange:function(e){return C(e.target.value)},value:N,className:"form-control"})})]}),"credit-cva"===n&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("label",{children:"Crediteur:"}),Object(w.jsxs)("select",{className:"form-control",onChange:function(e){u(e.target.value)},children:[Object(w.jsx)("option",{value:""}),h.map((function(e){return Object(w.jsx)("option",{value:e.id,children:e.name})}))]})]}),(null===m||void 0===m?void 0:m.length)<=0&&Object(w.jsx)("div",{className:"alert alert-success ",children:Ad.fromMagasin.emptyOrder}),null===m||void 0===m?void 0:m.map((function(e,t){return Object(w.jsx)(Ed,{product:e,basket:m,dispatch:O},"".concat(null===e||void 0===e?void 0:e.id,"_").concat(t))}))]})]}),(null===m||void 0===m?void 0:m.length)>0&&Object(w.jsxs)(lr.a.Footer,{className:"d-flex align-items-center justify-content-between",children:[Object(w.jsx)("div",{style:{width:"40%"},children:Object(w.jsx)("h2",{className:"p-2 text-uppercase bg-primary",children:Object(w.jsxs)("strong",{"data-test-id":"total-price-orders",children:["Total:",ct(Dd(m.map((function(e){return Ra(e)?e.prixqttccvente*e.quantityParProduct*e.qttccpvente+e.prixlitre*e.qttbylitre:e.prixVente*e.quantityParProduct})))+Dd(m.map((function(e){return e.prixParCC*e.qttByCC}))))]})})}),Object(w.jsx)("div",{style:{width:"60%"},children:m.length>0&&Object(w.jsxs)("div",{className:"d-flex text-right align-items-end justify-content-end",children:[Object(w.jsx)("button",{className:"btn btn-green btn-sm mr-2",disabled:0===m.length,onClick:function(){Xi(m)?alert("commande non-conforme,veuillez verifier!!"):(m.forEach((function(e){!function(e){if(ms(e)){var t=e.quantityParProduct,n=e.qttByCC,c=e.qttbylitre,r=e.condval,a=e.quantityCCCVA,i=e.condsize,s=(e.doseDefault,e.condml);if(c>0&&0==t&&0==n&&(e.quantityBruteCVA-=c),0==c&&t>0&&0==n){var o=0,l=0;if(Number(t)>=Number(i))if(o=Math.floor(Number(t)/Number(i)),r-(l=Number(t)-Number(i)*o)<0){var d=Number(l)-Number(r);e.condval=Number(i)-Number(d),o+=1}else e.condval=r-l;else if(e.condval-Number(t)<0){var u=Number(t)-Number(e.condval),j=Number(i)-Number(u);e.condval=j,o+=1}else e.condval-=Number(t);e.quantityBruteCVA-=o}if(0==c&&0==t&&n>0){var b=0,m=0,O=0,h=0;if(Number(n)>=Number(s))if(b=Math.floor(Number(n)/Number(s)),a-(h=Number(n)-Number(s)*b)<0){var x=Number(h)-Number(a);e.quantityCCCVA=Number(s)-Number(x),b+=1}else e.quantityCCCVA=a-h;else if(Number(n)>=e.quantityCCCVA){b+=1;var v=Number(n)-e.quantityCCCVA;e.quantityCCCVA=Number(s)-v}else e.quantityCCCVA-=Number(n);if(Number(b)>=Number(i))if(m=Math.floor(Number(b)/Number(i)),r-(O=Number(b)-Number(i)*O)<0){var p=Number(O)-Number(r);e.condval=Number(i)-Number(p),m+=1}else e.condval=r-O;else if(e.condval-Number(b)<0){var f=Number(b)-Number(e.condval),g=Number(i)-Number(f);e.condval=g,m+=1}else e.condval-=Number(b);e.quantityBruteCVA-=m}if(0==c&&t>0&&n>0){var y=0,N=0,C=0,S=0;if(Number(n)>=Number(s))if(y=Math.floor(Number(n)/Number(s)),a-(S=Number(n)-Number(s)*y)<0){var q=Number(S)-Number(a);e.quantityCCCVA=Number(s)-Number(q),y+=1}else e.quantityCCCVA=Number(a)-S;else if(Number(n)>=e.quantityCCCVA){y+=1;var w=Number(n)-e.quantityCCCVA;e.quantityCCCVA=Number(s)-w}else e.quantityCCCVA-=Number(n);var E=Number(t)+y;if(E>=Number(i))if(N=Math.floor(E/Number(i)),r-(C=E-Number(i)*y)<0){var A=Number(C)-Number(r);e.condval=Number(i)-Number(A),N+=1}else e.condval=r-C;else if(e.condval-Number(E)<0){var D=Number(E)-Number(e.condval),P=Number(i)-Number(D);e.condval=P,N+=1}else e.condval-=Number(E);e.quantityBruteCVA-=N}if(c>0&&t>0&&0==n){var V=0,F=0;if(Number(t)>=Number(i))if(V=Math.floor(Number(t)/Number(i)),r-(F=Number(t)-Number(i)*V)<0){var R=Number(F)-Number(r);e.condval=Number(i)-Number(R),V+=1}else e.condval=r-F;else if(e.condval-Number(t)<0){var T=Number(t)-Number(e.condval),M=Number(i)-Number(T);e.condval=M,V+=1}else e.condval-=Number(t);e.quantityBruteCVA-=V+c}if(c>0&&0==t&&n>0){var B=0,k=0,_=0,I=0;if(Number(n)>=Number(s))if(B=Math.floor(Number(n)/Number(s)),a-(I=Number(n)-Number(s)*B)<0){var L=Number(I)-Number(a);e.quantityCCCVA=Number(s)-Number(L),B+=1}else e.quantityCCCVA=a-I;else if(Number(n)>=e.quantityCCCVA){B+=1;var Q=Number(n)-e.quantityCCCVA;e.quantityCCCVA=Number(s)-Q}else e.quantityCCCVA-=Number(n);if(Number(B)>=Number(i))if(k=Math.floor(Number(B)/Number(i)),r-(_=Number(B)-Number(i)*k)<0){var H=Number(_)-Number(r);e.condval=Number(i)-Number(H),k+=1}else e.condval=r-I;else if(e.condval-Number(B)<0){var U=Number(B)-Number(e.condval),Y=Number(i)-Number(U);e.condval=Y,k+=1}else e.condval-=Number(B);e.quantityBruteCVA-=k+c}if(c>0&&t>0&&n>0){var K=0,z=0,W=0,G=0;if(Number(n)>=Number(s))if(K=Math.floor(Number(n)/Number(s)),a-(G=Number(n)-Number(s)*K)<0){var X=Number(G)-Number(a);e.quantityCCCVA=Number(s)-Number(X),K+=1}else e.quantityCCCVA=a-G;else if(Number(n)>=e.quantityCCCVA){K+=1;var J=Number(n)-e.quantityCCCVA;e.quantityCCCVA=Number(s)-J}else e.quantityCCCVA-=Number(n);var $=Number(K)+Number(t);if($>=Number(i))if(z=Math.floor($/Number(i)),r-(W=$-Number(i)*z)<0){var Z=Number(W)-Number(r);e.condval=Number(i)-Number(Z),z+=1}else e.condval=r-G;else if(e.condval-Number($)<0){var ee=Number($)-Number(e.condval),te=Number(i)-Number(ee);e.condval=te,z+=1}else e.condval-=Number($);e.quantityBruteCVA-=z+c}}else{var ne=e.quantityParProduct,ce=e.qttByCC,re=(e.quantityBruteCVA,e.quantityCCCVA),ae=e.doseDefault;if(0==ne&&ce>0){var ie=0,se=0;if(Number(ce)>=Number(ae))if(ie=Math.floor(Number(ce)/Number(ae)),re-(se=Number(ce)-Number(ae)*ie)<0){var oe=Number(se)-Number(re);e.quantityCCCVA=Number(ae)-Number(oe),ie+=1}else e.quantityCCCVA=Number(re)-se;else if(e.quantityCCCVA-Number(ce)<0){var le=Number(ce)-Number(e.quantityCCCVA);e.quantityCCCVA=Number(ae)-Number(le),ie+=1}else e.quantityCCCVA-=Number(ce);console.log(ie),e.quantityBruteCVA-=ie}if(ne>0&&0==ce&&(e.quantityBruteCVA-=ne),ne>0&&ce>0){var de=0,ue=0;if(Number(ce)>=Number(ae))if(de=Math.floor(Number(ce)/Number(ae)),re-(ue=Number(ce)-Number(ae)*de)<0){var je=Number(ue)-Number(re);e.quantityCCCVA=Number(ae)-Number(je),de+=1}else e.quantityCCCVA=Number(re)-ue;else if(e.quantityCCCVA-Number(ce)<0){var be=Number(ce)-Number(e.quantityCCCVA);e.quantityCCCVA=Number(ae)-Number(be),de+=1}else e.quantityCCCVA-=Number(ce);var me=de+Number(ne);e.quantityBruteCVA-=me}}}(e)})),O(Xn("commandes").createTransaction({id:Math.floor(Date.now()/1e3),contenu:m,type:n,sorte:"sortie",vaccinateurId:s,status:"vente-cva"===n,emprunterId:d,dateCom:null!=N?N:p},"add-from-magasin")),O(ds()),b.push("/historique/vente/vendeur/vente-cva"))},type:"button",children:"Valider l'operation"}),Object(w.jsx)("button",{className:"btn btn-danger btn-sm",onClick:function(){m.forEach((function(e){e.quantityParProduct=0,e.qttByCC=0})),O(ss()),O(ds())},type:"button",children:Object(w.jsx)("span",{children:"Annuler"})})]})})]})]})]})})},Vd=function(){var e=Object(P.useSelector)(Jn("products").value),t=Object(P.useSelector)(Jn("products").meta),n=Object(P.useDispatch)(),c=Object(a.useState)(""),r=Object(f.a)(c,2),i=r[0],s=r[1],o=Object(a.useState)(2),l=Object(f.a)(o,2),d=(l[0],l[1],Object(a.useState)(!1)),u=Object(f.a)(d,2),j=u[0],b=u[1],m=(Object(a.useRef)(null),Object(a.useRef)(null),Object(a.useState)([])),O=Object(f.a)(m,2),h=O[0],x=O[1];Object(a.useEffect)((function(){n(Xn("products").fetch())}),[]),Object(a.useEffect)((function(){return 1==j&&(n(Xn("products").fetch()),b(!1)),function(){b(!1)}}),[j]),Object(a.useEffect)((function(){t.isFetching||x(e.filter((function(e){return!Gi(e)})))}),[t]),Object(a.useEffect)((function(){x(Mr(e.filter((function(e){return!Gi(e)})),i))}),[i]);return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(Fr.a,{children:Object(w.jsx)(Xo,{})}),Object(w.jsxs)(Fr.a,{children:[Object(w.jsxs)("div",{className:"d-flex align-items-center flex-row mr-2",children:[Object(w.jsx)("div",{class:"badge badge-success",style:{borderRadius:"100%"},children:"30"}),Object(w.jsx)("div",{className:"mx-2",children:":Quantit\xe9"}),Object(w.jsx)("div",{class:"badge badge-warning",style:{borderRadius:"100%"},children:"3"}),Object(w.jsx)("div",{className:"mx-2",children:":Conditionnement (ML)"}),Object(w.jsx)("div",{class:"badge badge-info",style:{borderRadius:"100%"},children:"200"}),Object(w.jsx)("div",{className:"mx-2",children:":Reste en ML"})]}),Object(w.jsxs)(fr.a,{children:[Object(w.jsx)(gr.a,{xs:6,children:Object(w.jsxs)(lr.a,{className:"mt-2",children:[Object(w.jsxs)(lr.a.Header,{className:"bg-dark p-2 text-white d-flex text-uppercase justify-content-between align-items-center",children:[Object(w.jsx)("div",{style:{width:"60%"},children:"Produits"}),Object(w.jsx)("div",{children:Object(w.jsx)("button",{className:"btn btn-green btn-sm",onClick:function(){b(!0)},children:"Mettre \xe0 jour"})})]}),Object(w.jsxs)(lr.a.Body,{children:[Object(w.jsx)("div",{class:"d-flex justify-content-between align-items-center",children:Object(w.jsx)("input",{type:"text",onChange:function(e){s(e.target.value)},placeholder:"Nom du produit",className:"form-control mb-2"})}),Object(w.jsx)(pr.a,{children:Object(w.jsxs)("div",{style:{overflowY:"auto",width:"100%",height:"350px",maxHeight:"350px",overflowX:"hidden"},children:[Object(w.jsxs)("div",{class:"d-flex justify-content-start flex-wrap",children:[h.sort((function(e,t){return t.quantityBruteCVA-e.quantityBruteCVA})).map((function(e){return Object(w.jsx)(Nd,{product:e})})),0==h.length&&"Aucune enregistrement trouv\xe9"]})," "]})})]})]})}),Object(w.jsx)(gr.a,{xs:6,children:Object(w.jsx)("div",{className:" py-2",children:Object(w.jsx)(Pd,{setRegenerate:b})})})]})]})]})},Fd=function(){return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(Vd,{})})},Rd=function(e){var t,n=e.product,c=Object(P.useSelector)((function(e){return e.frommagasins})),r=Object(P.useDispatch)(),a=gd(c,r),s=a.isItemFromMagasin,o=a.addFromMagasin,l=!!s&&s(n.id),d=i.a.useCallback((function(){return n.quantityBruteCVA>15&&n.quantityBruteCVA<=20?"yellow":n.quantityBruteCVA>10&&n.quantityBruteCVA<=15?"#ffdb4c":n.quantityBruteCVA>5&&n.quantityBruteCVA<=10?" orange":n.quantityBruteCVA>0&&n.quantityBruteCVA<=5?"#c44e14b8":0==n.quantityBruteCVA?"red":"green"}),[n]),u=i.a.useCallback((function(){return n.quantityCCCVA>15&&n.quantityCCCVA<=20?"yellow":n.quantityCCCVA>10&&n.quantityCCCVA<=15?"#ffdb4c":n.quantityCCCVA>5&&n.quantityCCCVA<=10?" orange":n.quantityCCCVA>0&&n.quantityCCCVA<=5?"#c44e14b8":0==n.quantityCCCVA?"red":"green"}),[n]);i.a.useCallback((function(){return Ra(n)?0==n.quantityBruteCVA&&(0==n.quantityCCCVA||null==n.quantityCCCVA)&&0==n.condval:0==n.quantityBruteCVA&&(0==n.quantityCCCVA||null==n.quantityCCCVA)}),[n]);return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(pr.a.Item,{className:"mb-2 mr-3",style:{width:"100%",border:"1px solid gray",background:"whitesmoke",borderLeft:"10px solid ".concat(d())},children:Object(w.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[Object(w.jsxs)("div",{className:" ".concat(n.id?"":"product-loading"),style:{boxShadow:n&&l?"15px 10px 15px rgba(0, 0, 0, .07)":"none"},children:[Object(w.jsx)("div",{style:{width:10,height:4,background:"".concat(u())}}),Object(w.jsxs)("div",{children:[Object(w.jsx)("div",{children:n.name}),Object(w.jsx)("div",{class:"badge badge-primary",children:null===n||void 0===n||null===(t=n.fournisseur)||void 0===t?void 0:t.name}),Object(w.jsx)("br",{})]})," "]}),Object(w.jsx)("div",{children:n.id&&Object(w.jsx)(w.Fragment,{children:Object(w.jsx)("button",{className:"mt-3 ".concat(l?"btn btn-danger btn-sm":"btn btn-green btn-sm"),onClick:function(){o&&o(n)},children:l?"Retirer":"Ajouter"})})})]})})})},Td=i.a.memo(Rd),Md=function(e){var t=e.product,n=(e.setRealQttCC,e.setRealQtt),c=(e.realQtt,e.realQttCC,Object(P.useDispatch)()),r=function(e){c(us(t.id,e))};return Object(w.jsx)("div",{className:"basket-item-control",children:Object(w.jsxs)(Xc.c,{inputMode:"numeric",w:28,bg:"whitesmoke",min:0,defaultValue:Ra(t)?null===t||void 0===t?void 0:t.condval:null===t||void 0===t?void 0:t.quantityBruteCVA,onChange:function(e){""==e?(n(Ra(t)?null===t||void 0===t?void 0:t.condval:null===t||void 0===t?void 0:t.quantityBruteCVA),r(Ra(t)?null===t||void 0===t?void 0:t.condval:null===t||void 0===t?void 0:t.quantityBruteCVA)):(n(e),r(e))},children:[Object(w.jsx)(Xc.d,{}),Object(w.jsxs)(Xc.e,{children:[Object(w.jsx)(Xc.b,{}),Object(w.jsx)(Xc.a,{})]})]})})},Bd=function(e){var t=e.product,n=e.setRealQttCC,c=(e.setRealQtt,e.realQtt,e.realQttCC,Object(P.useDispatch)()),r=Object(a.useRef)(),i=(Object(P.useSelector)((function(e){return{frommagasins:e.frommagasins}})).frommagasins,function(e){c(bs(t.id,e))});return Object(w.jsx)("div",{className:"basket-item-control",children:Object(w.jsxs)(Xc.c,{inputMode:"numeric",w:28,step:1,ref:r,bg:"whitesmoke",defaultValue:t.quantityCCCVA,onChange:function(e){""==e?(i(t.quantityCCCVA),n(t.quantityCCCVA)):(n(1*e),i(1*e))},min:0,max:Wi(t)?null===t||void 0===t?void 0:t.condml:null===t||void 0===t?void 0:t.doseDefault,children:[Object(w.jsx)(Xc.d,{}),Object(w.jsxs)(Xc.e,{children:[Object(w.jsx)(Xc.b,{}),Object(w.jsx)(Xc.a,{})]})]})})},kd=function(e){var t=e.product,n=e.setRealQttCC,c=(e.setRealQtt,e.realQtt,e.realQttCC,Object(P.useDispatch)());return Object(w.jsx)("div",{className:"basket-item-control",children:Object(w.jsxs)(Xc.c,{inputMode:"decimal",w:28,step:1,bg:"whitesmoke",onChange:function(e){!function(e){c(Fi(t.id,e))}(e),n(e)},min:0,defaultValue:t.quantityCCCVA,children:[Object(w.jsx)(Xc.d,{}),Object(w.jsxs)(Xc.e,{children:[Object(w.jsx)(Xc.b,{}),Object(w.jsx)(Xc.a,{})]})]})})},_d=function(e){var t=e.product,n=Object(P.useDispatch)();return Object(w.jsx)("div",{className:"basket-item-control",children:Object(w.jsxs)(Xc.c,{inputMode:"decimal",w:28,bg:"whitesmoke",onChange:function(e){!function(e){n(Ti(t.id,e))}(e)},min:0,defaultValue:t.quantityCCCVA,children:[Object(w.jsx)(Xc.d,{}),Object(w.jsxs)(Xc.e,{children:[Object(w.jsx)(Xc.b,{}),Object(w.jsx)(Xc.a,{})]})]})})},Id=function(e){var t=e.product,n=e.setRealQttCC,c=(e.setRealQtt,e.realQtt,e.realQttCC,Object(P.useDispatch)());return Object(w.jsx)("div",{className:"basket-item-control",children:Object(w.jsxs)(Xc.c,{inputMode:"numeric",w:28,step:1,bg:"whitesmoke",onChange:function(e){!function(e){c(Ri(t.id,e))}(e),n(e)},min:0,defaultValue:t.quantityCCCVA,children:[Object(w.jsx)(Xc.d,{}),Object(w.jsxs)(Xc.e,{children:[Object(w.jsx)(Xc.b,{}),Object(w.jsx)(Xc.a,{})]})]})})},Ld=function(e){var t=e.product,n=(e.setRealQttCC,e.setRealQtt,e.realQtt,e.realQttCC,Object(P.useDispatch)()),c=function(e){n(js(t.id,e))};return Object(w.jsx)("div",{className:"basket-item-control",children:Object(w.jsxs)(Xc.c,{inputMode:"numeric",w:28,step:1,bg:"whitesmoke",min:0,defaultValue:null===t||void 0===t?void 0:t.quantityBruteCVA,onChange:function(e){c(""==e?0:e)},children:[Object(w.jsx)(Xc.d,{}),Object(w.jsxs)(Xc.e,{children:[Object(w.jsx)(Xc.b,{}),Object(w.jsx)(Xc.a,{})]})]})})},Qd=function(e){var t,n=e.product,c=Object(a.useState)(null),r=Object(f.a)(c,2),i=r[0],s=r[1],o=Object(a.useState)(null),l=Object(f.a)(o,2),d=l[0],u=l[1],j=Object(P.useSelector)((function(e){return e.frommagasins})),b=Object(P.useDispatch)(),m=gd(j,b),O=m.isItemFromMagasin,h=m.addFromMagasin,x=!!O&&O(n.id);return Object(w.jsx)("div",{children:Object(w.jsxs)("div",{className:"d-flex justify-content-between align-items-center border   mb-2 p-2",children:[Object(w.jsxs)("div",{style:{width:"45%"},children:[Object(w.jsx)("p",{className:"text-blue",children:n.name}),Object(w.jsx)("div",{class:"badge badge-primary",children:null===n||void 0===n||null===(t=n.fournisseur)||void 0===t?void 0:t.name})]}),0!==n.condml&&0!==n.qttccpvente&&Object(w.jsxs)("div",{className:"text-inline text-center mr-3",children:[Object(w.jsx)("h5",{className:"mb-1 text-uppercase",children:"Litre"}),Object(w.jsx)(Ld,{product:n,setRealQttCC:s,setRealQtt:u,realQtt:d,realQttCC:i})," "]}),Object(w.jsxs)("div",{className:"text-inline text-center mr-2",children:[Object(w.jsx)("h5",{className:"mb-1",children:n.type}),Object(w.jsx)(Md,{product:n,setRealQttCC:s,setRealQtt:u,realQtt:d,realQttCC:i})]}),"FLACON"===n.type&&Object(w.jsxs)("div",{className:"text-inline text-center",children:[Object(w.jsx)("h5",{className:"mb-1",children:3==n.categoryId?"DOSE":"ML"}),at(n.name,"ita new")&&Object(w.jsx)(kd,{product:n,setRealQttCC:s,setRealQtt:u,realQtt:d,realQttCC:i}),at(n.name,"sovax")&&Object(w.jsx)(Id,{setRealQttCC:s,setRealQtt:u,realQtt:d,realQttCC:i,product:n}),0==n.condml&&0==n.qttccpvente&&!at(n.name,"sovax")&&!at(n.name,"ita new")&&Object(w.jsx)(Bd,{setRealQttCC:s,setRealQtt:u,realQtt:d,realQttCC:i,product:n}),0!==n.condml&&0!==n.qttccpvente&&Object(w.jsx)(_d,{product:n})]}),Object(w.jsx)("div",{className:"ml-2",children:x&&Object(w.jsx)("button",{onClick:function(){h&&h(n)},className:"btn btn-danger btn-xs text-right",children:"X"})})]})})},Hd=function(){var e=Object(a.useState)("vente-cva"),t=Object(f.a)(e,2),n=t[0],c=(t[1],Object(a.useState)(1)),r=Object(f.a)(c,2),i=(r[0],r[1],Object(a.useState)(null)),s=Object(f.a)(i,2),o=s[0],l=(s[1],Object(a.useState)(null)),d=Object(f.a)(l,2),u=d[0],b=d[1],m=Object(j.g)(),O=Object(P.useSelector)((function(e){return{frommagasins:e.frommagasins}})).frommagasins,h=Object(P.useDispatch)(),x=Object(P.useSelector)(Jn("emprunters").value),v=(Object(P.useSelector)(Jn("commandes").meta),Object(P.useSelector)(Jn("commandes").value),new Date),p=Object(a.useState)(v),g=Object(f.a)(p,2),y=g[0],N=g[1];Object(a.useEffect)((function(){h(Xn("commandes").fetch()),h(Xn("emprunters").fetch())}),[]);return Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)(lr.a,{children:[Object(w.jsx)(lr.a.Header,{className:" bg-dark py-2 text-white d-flex justify-content-between align-items-center",children:Object(w.jsxs)("div",{style:{width:"60%"},children:["Correction("," ".concat(null===O||void 0===O?void 0:O.length," ").concat((null===O||void 0===O?void 0:O.length)>1?"articles":"article"),")"]})}),Object(w.jsxs)("div",{className:"commande-vente",children:[Object(w.jsx)(lr.a.Body,{style:{padding:2,marginTop:3,marginRight:2,marginLeft:2},children:Object(w.jsxs)("div",{style:{overflowY:"auto",height:"350px",maxHeight:"350px",overflowX:"hidden"},children:[Object(w.jsxs)("div",{class:"form-group",children:[Object(w.jsx)("label",{children:"Date de correction :"}),Object(w.jsx)("div",{children:Object(w.jsx)("input",{type:"date",onChange:function(e){return N(e.target.value)},value:y,className:"form-control"})})]}),"credit-cva"===n&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("label",{children:"Crediteur:"}),Object(w.jsxs)("select",{className:"form-control",onChange:function(e){b(e.target.value)},children:[Object(w.jsx)("option",{value:""}),x.map((function(e){return Object(w.jsx)("option",{value:e.id,children:e.name})}))]})]}),(null===O||void 0===O?void 0:O.length)<=0&&Object(w.jsx)("div",{className:"alert alert-success ",children:Ad.fromMagasin.emptyOrder}),null===O||void 0===O?void 0:O.map((function(e,t){return Object(w.jsx)(Qd,{product:e,basket:O,dispatch:h},"".concat(null===e||void 0===e?void 0:e.id,"_").concat(t))}))]})}),(null===O||void 0===O?void 0:O.length)>0&&Object(w.jsxs)(lr.a.Footer,{className:"d-flex align-items-center justify-content-between",children:[Object(w.jsx)("div",{style:{width:"30%"}}),Object(w.jsx)("div",{style:{width:"70%"},children:O.length>0&&Object(w.jsxs)("div",{className:"d-flex text-right align-items-end justify-content-end",children:[Object(w.jsx)("button",{className:"btn btn-green btn-sm mr-2",disabled:0===O.length,onClick:function(){h(Xn("commandes").createTransaction({id:Math.floor(Date.now()/1e3),contenu:O,commande:O,type:"correction-cva",sorte:"sortie",vaccinateurId:o,status:!0,emprunterId:u,dateCom:null!=y?y:v},"add-to-correction")),h(ds()),m.push(we)},type:"button",children:"Valider l'operation"}),Object(w.jsx)("button",{className:"btn btn-danger btn-sm",onClick:function(){O.forEach((function(e){e.quantityParProduct=0,e.qttByCC=0})),h(ss()),h(ds())},type:"button",children:Object(w.jsx)("span",{children:"Annuler"})})]})})]})]})]})})};function Ud(){var e=Object(P.useSelector)(Jn("products").value),t=Object(P.useSelector)(Jn("products").meta),n=Object(P.useDispatch)(),c=Object(a.useState)(""),r=Object(f.a)(c,2),i=r[0],s=r[1],o=Object(a.useState)(2),l=Object(f.a)(o,2),d=(l[0],l[1],Object(a.useState)(!1)),u=Object(f.a)(d,2),j=u[0],b=u[1],m=(Object(a.useRef)(null),Object(a.useRef)(null),Object(a.useState)([])),O=Object(f.a)(m,2),h=O[0],x=O[1];Object(a.useEffect)((function(){n(Xn("products").fetch())}),[]),Object(a.useEffect)((function(){return 1==j&&(n(Xn("products").fetch()),b(!1)),function(){b(!1)}}),[j]),Object(a.useEffect)((function(){t.isFetching||x(e)}),[t]),Object(a.useEffect)((function(){x(Mr(e,i))}),[i]);return Object(w.jsxs)(Xe,{children:[Object(w.jsx)(Ke,{title:"Correction",children:Object(w.jsx)(We,{title:"Correction"})}),Object(w.jsx)($e,{children:Object(w.jsxs)(fr.a,{children:[Object(w.jsx)(gr.a,{xs:6,children:Object(w.jsxs)(lr.a,{className:"mt-2",children:[Object(w.jsxs)(lr.a.Header,{className:"bg-dark p-2 text-white d-flex text-uppercase justify-content-between align-items-center",children:[Object(w.jsx)("div",{style:{width:"60%"},children:"Produits"}),Object(w.jsx)("div",{children:Object(w.jsx)("button",{className:"btn btn-green btn-sm",onClick:function(){s(""),b(!0)},children:"Mettre \xe0 jour"})})]}),Object(w.jsxs)(lr.a.Body,{children:[Object(w.jsxs)("div",{class:"d-flex justify-content-between align-items-center",children:[Object(w.jsx)("input",{type:"text",onChange:function(e){s(e.target.value)},placeholder:"Nom du produit",className:"form-control mb-2"})," "]}),Object(w.jsx)(pr.a,{children:Object(w.jsxs)("div",{style:{overflowY:"auto",width:"100%",height:"350px",maxHeight:"350px",overflowX:"hidden"},children:[Object(w.jsxs)("div",{class:"d-flex justify-content-start flex-wrap",children:[h.sort((function(e,t){return t.quantityBruteCVA-e.quantityBruteCVA})).map((function(e){return Object(w.jsx)(Td,{product:e})})),0==h.length&&"Aucune enregistrement trouv\xe9"]})," "]})})]})]})}),Object(w.jsx)(gr.a,{xs:6,children:Object(w.jsx)("div",{className:" py-2",children:Object(w.jsx)(Hd,{setRegenerate:b})})})]})})]})}var Yd=function(e){for(var t=0;t<e.length;++t)return e[t].correction>0||e[t].correctionml>0},Kd=function(){var e=Object(P.useSelector)((function(e){return e.searchbydate}));console.log(e);var t=Object(a.useState)([e.deb,e.fin]),n=Object(f.a)(t,2),c=n[0],r=n[1],s=(Object(a.useRef)(null),Object(a.useRef)(null),Object(P.useSelector)(Jn("commandes").value)),o=Object(P.useSelector)(Jn("commandes").meta),l=Object(P.useDispatch)();Object(a.useEffect)((function(){var t,n;l((t=e.deb,n=e.fin,Ln("commandes",{path:"/vente-correction?deb=".concat(t,"&fin=").concat(n),replace:!0})))}),[e.deb,e.fin]),Object(a.useEffect)((function(){null!==c&&c[0]&&l(is(c[0],c[1]))}),[c]);var d=i.a.useMemo((function(){return[{Header:"Date",Cell:function(e){var t;return Object(w.jsx)(w.Fragment,{children:nt(null===(t=e.row.original)||void 0===t?void 0:t.dateCom)})}},{Header:"Produits",Cell:function(e){var t,n,c,r,a,i;return Object(w.jsxs)("div",{style:{width:"350px"},children:[1==(null===(t=e.row.original)||void 0===t?void 0:t.isdeleted)&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("div",{className:"badge badge-danger",children:"Supprim\xe9"}),Object(w.jsxs)("div",{className:"text text-danger",children:["Date de suppression :"," ",nt(null===(n=e.row.original)||void 0===n?void 0:n.deletedat)]})]}),null==(null===(c=e.row.original)||void 0===c?void 0:c.isdeleted)&&Object(w.jsx)("p",{children:Yd(null===(r=e.row.original)||void 0===r?void 0:r.contenu)&&Object(w.jsx)("div",{className:"badge badge-warning",children:"Modifi\xe9"})}),null===(a=e.row.original)||void 0===a||null===(i=a.contenu)||void 0===i?void 0:i.map((function(t){var n,c;return Object(w.jsxs)("tr",{children:[Object(w.jsx)("span",{style:{background:"white",color:1==(null===(n=e.row.original)||void 0===n?void 0:n.isdeleted)?"red":"inherit",padding:2},children:t.name}),Object(w.jsxs)("span",{style:{color:1==(null===(c=e.row.original)||void 0===c?void 0:c.isdeleted)?"red":"inherit"},children:[" ","  "]})]})}))]})}},{Header:"Actions",Cell:function(e){var t;return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(u.b,{to:"/detailcorrection/".concat(null===(t=e.row.original)||void 0===t?void 0:t.id),className:"btn btn-green btn-sm mr-2",children:"D\xe9tails"})})}}]}),[]);return Object(w.jsxs)(Xe,{children:[Object(w.jsx)(Ke,{title:"Historique de correction",children:Object(w.jsx)(We,{title:"Historique de correction"})}),Object(w.jsxs)($e,{children:[Object(w.jsxs)("div",{className:"row",children:[Object(w.jsx)("div",{className:"col-lg-6",children:Object(w.jsxs)("div",{children:[Object(w.jsx)("h3",{className:"text-uppercase",children:"Historique de correction"}),Object(w.jsx)("p",{children:"".concat(nt(e.deb)," ->  ").concat(nt(e.fin))})]})}),Object(w.jsx)("div",{className:"col-lg-6 text-right",children:Object(w.jsx)(kr.a,{locale:"fr-FR",onChange:r,value:c})})," "]}),Object(w.jsx)(mr,{data:s.sort((function(e,t){return t.id-e.id})),meta:o,columns:d})]})]})};var zd=Object(j.j)((function(e){Object(j.h)();var t,n,c=Object(j.i)().id,r=Object(P.useSelector)(Jn("commandes").value),i=Object(P.useDispatch)();return Object(a.useEffect)((function(){i(Xn("commandes").get(c))}),[c]),Object(w.jsxs)(Xe,{children:[Object(w.jsx)(Ke,{title:"Historique de correction",children:Object(w.jsx)(We,{title:"Historique de correction"})}),Object(w.jsx)($e,{children:Object(w.jsxs)("div",{children:[r.length>0&&Object(w.jsx)("div",{className:"d-flex justify-content-between",children:Object(w.jsx)("div",{className:"my-2",children:Object(w.jsxs)("h2",{className:"my-2",children:["Date : ",nt(null===(t=r[0])||void 0===t?void 0:t.dateCom)]})})}),Object(w.jsxs)("table",{className:"table table-bordered",children:[Object(w.jsxs)("tr",{className:"bg-thead",children:[Object(w.jsx)("td",{children:"Nom de l'article"}),Object(w.jsx)("td",{children:"Quantit\xe9"}),Object(w.jsx)("td",{children:"Sous total"})]}),r.length>0&&(null===(n=r[0])||void 0===n?void 0:n.contenu.map((function(e){return Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{style:{width:"40%"},children:e.name}),Object(w.jsxs)(w.Fragment,{children:[0!=e.qttbybrute&&Object(w.jsxs)("div",{className:"d-flex align-items-center py-0",children:[Object(w.jsx)("strong",{className:"text-lowercase",children:"Depot:"}),ct(e.prixVente)," (","x"," ",e.qttbybrute,") "," = ",ct(e.prixVente*e.qttbybrute)]}),Ra(e)&&Object(w.jsx)(w.Fragment,{children:0!=e.qttbylitre&&Object(w.jsxs)("div",{className:"d-flex align-items-center py-0 px-2",children:[Object(w.jsx)("strong",{children:"Litre :"}),ct(e.prixlitre)," (","x"," ",e.qttbylitre,")"," "," = ",ct(e.prixlitre*e.qttbylitre)]})}),0!=e.quantityParProduct&&Object(w.jsxs)("div",{className:"d-flex align-items-center py-0",children:[Object(w.jsxs)("strong",{className:"text-lowercase",children:[e.type,":"]}),ct(e.prixVente)," (","x"," ",e.quantityParProduct,") "," = ",ct(e.prixVente*e.quantityParProduct)]})]}),"FLACON"==e.type&&Object(w.jsx)(w.Fragment,{children:0!=e.qttByCC&&Object(w.jsxs)("div",{className:"d-flex align-items-center  py-0",children:[Object(w.jsx)("strong",{children:"ml:"})," ",ct(e.prixParCC)," ","x"," ",0!=e.qttyspecificmirror?e.qttyspecificmirror+" Dose":e.qttByCC+" ml"," "," = "," ",ct(e.prixParCC*e.qttByCC)]})}),Object(w.jsx)("td",{children:Ra(e)?ct(e.prixqttccvente*e.quantityParProduct*e.qttccpvente+e.prixlitre*e.qttbylitre+e.prixParCC*e.qttByCC):ct(e.prixVente*e.quantityParProduct+e.prixParCC*e.qttByCC)})]})})))]})]})})]})}));function Wd(){return Xr.b().shape({name:Xr.c().required("Le champ est requis")})}var Gd=function(){Object(P.useSelector)(Jn("fournisseurs").value);var e=Object(P.useDispatch)(),t=Object(j.g)();return Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)(Xe,{children:[Object(w.jsx)(Ke,{title:"Ajouter un fournisseur",children:Object(w.jsx)(We,{title:"Ajouter un fournisseur"})}),Object(w.jsx)($e,{children:Object(w.jsx)(ar,{id:"add-form-fournisseur",enableReinitialize:!0,initialValues:{name:""},validations:Wd,onSubmit:function(n,c){var r=n.name;e(Xn("fournisseurs").create({name:r})),t.push(Ae)},render:function(e){e.values;return Object(w.jsx)(ar.Element,{children:Object(w.jsx)("div",{className:"row",children:Object(w.jsx)("div",{className:"col-lg-6",children:Object(w.jsxs)("div",{className:"card",children:[Object(w.jsx)("div",{className:"card-header bg-dark text-white",children:"Information g\xe9n\xe9rale"}),Object(w.jsxs)("div",{className:"card-body",children:[Object(w.jsx)(ar.Field.Input,{name:"name",label:"Nom",placeholder:"Nom"}),Object(w.jsxs)("div",{className:"mt-3",children:[Object(w.jsx)("button",{className:"btn btn-green  btn-sm ",type:"submit",children:"Ajouter"}),Object(w.jsx)("button",{className:"btn btn-danger ml-2  btn-sm ",type:"reset",children:"Annuler"})]})]})]})})})})}})})]})})};var Xd=function(){var e=Object(j.i)().id,t=Object(P.useSelector)(Jn("fournisseurs").value),n=Object(P.useSelector)(Jn("fournisseurs").meta),c=Object(a.useState)({name:""}),r=Object(f.a)(c,2),i=r[0],s=r[1],o=Object(j.g)(),l=Object(P.useDispatch)(),d=Object(a.useState)({}),u=Object(f.a)(d,2);return u[0],u[1],Object(a.useEffect)((function(){l(Xn("fournisseurs").fetch())}),[e]),Object(a.useEffect)((function(){n.isFetching||s(null===t||void 0===t?void 0:t.find((function(t){return t.id==e})))}),[n]),Object(w.jsxs)(Xe,{children:[Object(w.jsx)(Ke,{title:"Editer un fournisseur",children:Object(w.jsx)(We,{title:"Editer un fournisseur"})}),Object(w.jsx)($e,{children:Object(w.jsx)(ar,{id:"add-form-fournisseur",initialValues:{name:i.name},validations:Wd,onSubmit:function(e,t){var n=e.name;l(Xn("fournisseurs").update({id:i.id,name:n})),o.push(Ae)},render:function(e){var t=e.values;return Object(w.jsx)(ar.Element,{children:Object(w.jsx)("div",{className:"row",children:Object(w.jsx)("div",{className:"col-lg-6",children:Object(w.jsxs)("div",{className:"card",children:[Object(w.jsx)("div",{className:"card-header bg-dark text-white",children:"Information g\xe9n\xe9rale"}),Object(w.jsxs)("div",{className:"card-body",children:[Object(w.jsx)(ar.Field.Input,{name:"name",value:null===t||void 0===t?void 0:t.name,label:"Nom",placeholder:"Nom"}),Object(w.jsxs)("div",{className:"mt-3",children:[Object(w.jsx)("button",{className:"btn btn-green  btn-sm ",type:"submit",children:"Editer"}),Object(w.jsx)("button",{className:"btn btn-danger ml-2 btn-sm ",type:"reset",children:"Annuler"})]})]})]})})})})}})})]})};function Jd(){return Xr.b().shape({name:Xr.c().required("Le champ est requis")})}var $d=function(){Object(P.useSelector)(Jn("categories").value);var e=Object(P.useDispatch)(),t=Object(j.g)();return Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)(Xe,{children:[Object(w.jsx)(Ke,{title:"Ajouter un categorie",children:Object(w.jsx)(We,{title:"Ajouter un categorie"})}),Object(w.jsx)($e,{children:Object(w.jsx)(ar,{id:"add-form-categorie",enableReinitialize:!0,initialValues:{name:""},validations:Jd,onSubmit:function(n,c){var r=n.name;e(Xn("categories").create({name:r})),t.push(Pe)},render:function(e){e.values;return Object(w.jsx)(ar.Element,{children:Object(w.jsx)("div",{className:"row",children:Object(w.jsx)("div",{className:"col-lg-6",children:Object(w.jsxs)("div",{className:"card",children:[Object(w.jsx)("div",{className:"card-header bg-dark text-white",children:"Information g\xe9n\xe9rale"}),Object(w.jsxs)("div",{className:"card-body",children:[Object(w.jsx)(ar.Field.Input,{name:"name",label:"Nom",placeholder:"Nom"}),Object(w.jsxs)("div",{className:"mt-3",children:[Object(w.jsx)("button",{className:"btn btn-green  btn-sm ",type:"submit",children:"Ajouter"}),Object(w.jsx)("button",{className:"btn btn-danger ml-2  btn-sm ",type:"reset",children:"Annuler"})]})]})]})})})})}})})]})})};var Zd=function(){var e=Object(j.i)().id,t=Object(P.useSelector)(Jn("categories").value),n=Object(P.useSelector)(Jn("categories").meta),c=Object(a.useState)({name:""}),r=Object(f.a)(c,2),i=r[0],s=r[1],o=Object(j.g)(),l=Object(P.useDispatch)(),d=Object(a.useState)({}),u=Object(f.a)(d,2);return u[0],u[1],Object(a.useEffect)((function(){l(Xn("categories").fetch())}),[e]),Object(a.useEffect)((function(){n.isFetching||s(null===t||void 0===t?void 0:t.find((function(t){return t.id==e})))}),[n]),Object(w.jsxs)(Xe,{children:[Object(w.jsx)(Ke,{title:"Editer un categorie",children:Object(w.jsx)(We,{title:"Editer un categorie"})}),Object(w.jsx)($e,{children:Object(w.jsx)(ar,{id:"add-form-categorie",initialValues:{name:i.name},validations:Jd,onSubmit:function(e,t){var n=e.name;l(Xn("categories").update({id:i.id,name:n})),o.push(Pe)},render:function(e){var t=e.values;return Object(w.jsx)(ar.Element,{children:Object(w.jsx)("div",{className:"row",children:Object(w.jsx)("div",{className:"col-lg-6",children:Object(w.jsxs)("div",{className:"card",children:[Object(w.jsx)("div",{className:"card-header bg-dark text-white",children:"Information g\xe9n\xe9rale"}),Object(w.jsxs)("div",{className:"card-body",children:[Object(w.jsx)(ar.Field.Input,{name:"name",value:null===t||void 0===t?void 0:t.name,label:"Nom",placeholder:"Nom"}),Object(w.jsxs)("div",{className:"mt-3",children:[Object(w.jsx)("button",{className:"btn btn-green  btn-sm ",type:"submit",children:"Editer"}),Object(w.jsx)("button",{className:"btn btn-danger ml-2 btn-sm ",type:"reset",children:"Annuler"})]})]})]})})})})}})})]})};function eu(){return Xr.b().shape({name:Xr.c().required("Le champ est requis")})}var tu=function(){Object(P.useSelector)(Jn("emprunters").value);var e=Object(P.useDispatch)(),t=Object(j.g)();return Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)(Xe,{children:[Object(w.jsx)(Ke,{title:"Ajouter un personne",children:Object(w.jsx)(We,{title:"Ajouter un personne"})}),Object(w.jsx)($e,{children:Object(w.jsx)(ar,{id:"add-form-emprunters",enableReinitialize:!0,initialValues:{name:"",contact:""},validations:eu,onSubmit:function(n,c){var r=n.name,a=n.contact;e(Xn("emprunters").create({name:r,contact:a})),t.goBack()},render:function(e){e.values;return Object(w.jsx)(ar.Element,{children:Object(w.jsx)("div",{className:"row",children:Object(w.jsx)("div",{className:"col-lg-6",children:Object(w.jsxs)("div",{className:"card",children:[Object(w.jsx)("div",{className:"card-header bg-dark text-white",children:"Information g\xe9n\xe9rale"}),Object(w.jsxs)("div",{className:"card-body",children:[Object(w.jsx)(ar.Field.Input,{name:"name",label:"Nom",placeholder:"Nom"}),Object(w.jsx)(ar.Field.Input,{name:"contact",label:"T\xe9l\xe9phone",placeholder:"T\xe9l\xe9phone"}),Object(w.jsxs)("div",{className:"mt-3",children:[Object(w.jsx)("button",{className:"btn btn-green  btn-sm ",type:"submit",children:"Ajouter"}),Object(w.jsx)("button",{className:"btn btn-danger ml-2  btn-sm ",type:"reset",children:"Annuler"})]})]})]})})})})}})})]})})};var nu=function(){var e=Object(j.i)().id,t=Object(P.useSelector)(Jn("emprunters").value),n=Object(P.useSelector)(Jn("emprunters").meta),c=Object(a.useState)({name:"",contact:""}),r=Object(f.a)(c,2),i=r[0],s=r[1],o=Object(j.g)(),l=Object(P.useDispatch)(),d=Object(a.useState)({}),u=Object(f.a)(d,2);return u[0],u[1],Object(a.useEffect)((function(){l(Xn("emprunters").fetch())}),[e]),Object(a.useEffect)((function(){n.isFetching||s(null===t||void 0===t?void 0:t.find((function(t){return t.id==e})))}),[n]),Object(w.jsxs)(Xe,{children:[Object(w.jsx)(Ke,{title:"Editer une personne",children:Object(w.jsx)(We,{title:"Editer une personne"})}),Object(w.jsx)($e,{children:Object(w.jsx)(ar,{id:"add-form-emprunteur",initialValues:{name:null===i||void 0===i?void 0:i.name,contact:null===i||void 0===i?void 0:i.contact},validations:eu,onSubmit:function(e,t){var n=e.name,c=e.contact;l(Xn("emprunters").update({id:i.id,name:n,contact:c})),o.goBack()},render:function(e){var t=e.values;return Object(w.jsx)(ar.Element,{children:Object(w.jsx)("div",{className:"row",children:Object(w.jsx)("div",{className:"col-lg-6",children:Object(w.jsxs)("div",{className:"card",children:[Object(w.jsx)("div",{className:"card-header bg-dark text-white",children:"Information g\xe9n\xe9rale"}),Object(w.jsxs)("div",{className:"card-body",children:[Object(w.jsx)(ar.Field.Input,{name:"name",value:null===t||void 0===t?void 0:t.name,label:"Nom",placeholder:"Nom"}),Object(w.jsx)(ar.Field.Input,{name:"contact",value:null===t||void 0===t?void 0:t.contact,label:"T\xe9l\xe9phone",placeholder:"T\xe9l\xe9phone"}),Object(w.jsxs)("div",{className:"mt-3",children:[Object(w.jsx)("button",{className:"btn btn-green  btn-sm ",type:"submit",children:"Editer"}),Object(w.jsx)("button",{className:"btn btn-danger ml-2 btn-sm ",type:"reset",children:"Annuler"})]})]})]})})})})}})})]})};function cu(){return Xr.b().shape({name:Xr.c().required("Le champ est requis")})}var ru=function(){Object(P.useSelector)(Jn("vaccinateurs").value);var e=Object(P.useDispatch)(),t=Object(j.g)();return Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)(Xe,{children:[Object(w.jsx)(Ke,{title:"Ajouter un vaccinateur",children:Object(w.jsx)(We,{title:"Ajouter un vaccinateur"})}),Object(w.jsx)($e,{children:Object(w.jsx)(ar,{id:"add-form-vaccinateurs",enableReinitialize:!0,initialValues:{name:"",contact:""},validations:cu,onSubmit:function(n,c){var r=n.name,a=n.contact;e(Xn("vaccinateurs").create({name:r,contact:a})),t.goBack()},render:function(e){e.values;return Object(w.jsx)(ar.Element,{children:Object(w.jsx)("div",{className:"row",children:Object(w.jsx)("div",{className:"col-lg-6",children:Object(w.jsxs)("div",{className:"card",children:[Object(w.jsx)("div",{className:"card-header bg-dark text-white",children:"Information g\xe9n\xe9rale"}),Object(w.jsxs)("div",{className:"card-body",children:[Object(w.jsx)(ar.Field.Input,{name:"name",label:"Nom",placeholder:"Nom"}),Object(w.jsx)(ar.Field.Input,{name:"contact",label:"T\xe9l\xe9phone",placeholder:"T\xe9l\xe9phone"}),Object(w.jsxs)("div",{className:"mt-3",children:[Object(w.jsx)("button",{className:"btn btn-green  btn-sm ",type:"submit",children:"Ajouter"}),Object(w.jsx)("button",{className:"btn btn-danger ml-2  btn-sm ",type:"reset",children:"Annuler"})]})]})]})})})})}})})]})})};var au=function(){var e=Object(j.i)().id,t=Object(P.useSelector)(Jn("vaccinateurs").value),n=Object(P.useSelector)(Jn("vaccinateurs").meta),c=Object(a.useState)({name:"",contact:""}),r=Object(f.a)(c,2),i=r[0],s=r[1],o=Object(j.g)(),l=Object(P.useDispatch)(),d=Object(a.useState)({}),u=Object(f.a)(d,2);return u[0],u[1],Object(a.useEffect)((function(){l(Xn("vaccinateurs").fetch())}),[e]),Object(a.useEffect)((function(){n.isFetching||s(null===t||void 0===t?void 0:t.find((function(t){return t.id==e})))}),[n]),Object(w.jsxs)(Xe,{children:[Object(w.jsx)(Ke,{title:"Editer un vaccinateur",children:Object(w.jsx)(We,{title:"Editer un vaccinateur"})}),Object(w.jsx)($e,{children:Object(w.jsx)(ar,{id:"add-form-vaccinateur",initialValues:{name:i.name,contact:i.contact},validations:cu,onSubmit:function(e,t){var n=e.name,c=e.contact;l(Xn("vaccinateurs").update({id:i.id,name:n,contact:c})),o.goBack()},render:function(e){var t=e.values;return Object(w.jsx)(ar.Element,{children:Object(w.jsx)("div",{className:"row",children:Object(w.jsx)("div",{className:"col-lg-6",children:Object(w.jsxs)("div",{className:"card",children:[Object(w.jsx)("div",{className:"card-header bg-dark text-white",children:"Information g\xe9n\xe9rale"}),Object(w.jsxs)("div",{className:"card-body",children:[Object(w.jsx)(ar.Field.Input,{name:"name",value:null===t||void 0===t?void 0:t.name,label:"Nom",placeholder:"Nom"}),Object(w.jsx)(ar.Field.Input,{name:"contact",value:null===t||void 0===t?void 0:t.contact,label:"T\xe9l\xe9phone",placeholder:"T\xe9l\xe9phone"}),Object(w.jsxs)("div",{className:"mt-3",children:[Object(w.jsx)("button",{className:"btn btn-green  btn-sm ",type:"submit",children:"Editer"}),Object(w.jsx)("button",{className:"btn btn-danger ml-2 btn-sm ",type:"reset",children:"Annuler"})]})]})]})})})})}})})]})},iu=function(e){var t,n=e.product,c=Object(P.useSelector)((function(e){return e.frommagasins})),r=Object(P.useDispatch)(),a=gd(c,r),s=a.isItemFromMagasin,o=a.addFromMagasin,l=!!s&&s(n.id),d=i.a.useCallback((function(){return n.quantityBruteCVA>15&&n.quantityBruteCVA<=20?"yellow":n.quantityBruteCVA>10&&n.quantityBruteCVA<=15?"#ffdb4c":n.quantityBruteCVA>5&&n.quantityBruteCVA<=10?" orange":n.quantityBruteCVA>0&&n.quantityBruteCVA<=5?"#c44e14b8":0==n.quantityBruteCVA?"red":"green"}),[n]),u=i.a.useCallback((function(){return n.quantityCCCVA>15&&n.quantityCCCVA<=20?"yellow":n.quantityCCCVA>10&&n.quantityCCCVA<=15?"#ffdb4c":n.quantityCCCVA>5&&n.quantityCCCVA<=10?" orange":n.quantityCCCVA>0&&n.quantityCCCVA<=5?"#c44e14b8":0==n.quantityCCCVA?"red":"green"}),[n]);i.a.useCallback((function(){return Ra(n)?0==n.quantityBruteCVA&&(0==n.quantityCCCVA||null==n.quantityCCCVA)&&0==n.condval:0==n.quantityBruteCVA&&(0==n.quantityCCCVA||null==n.quantityCCCVA)}),[n]);return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(pr.a.Item,{className:"mb-2 mr-3",style:{width:"100%",border:"1px solid gray",background:"whitesmoke",borderLeft:"10px solid ".concat(d())},children:Object(w.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[Object(w.jsxs)("div",{className:" ".concat(n.id?"":"product-loading"),style:{boxShadow:n&&l?"15px 10px 15px rgba(0, 0, 0, .07)":"none"},children:[Object(w.jsx)("div",{style:{width:10,height:4,background:"".concat(u())}}),Object(w.jsxs)("div",{children:[Object(w.jsx)("div",{children:n.name}),Object(w.jsx)("div",{class:"badge badge-primary",children:null===n||void 0===n||null===(t=n.fournisseur)||void 0===t?void 0:t.name}),Object(w.jsx)("br",{})]})," "]}),Object(w.jsx)("div",{children:n.id&&Object(w.jsx)(w.Fragment,{children:Object(w.jsx)("button",{disabled:cl(n),className:"mt-3 ".concat(l?"btn btn-danger btn-sm":"btn btn-green btn-sm"),onClick:function(){o&&o(n)},children:l?"Retirer":"Ajouter"})})})]})})})},su=i.a.memo(iu),ou=function(e){var t=e.product,n=e.setRealQtt,c=(e.maxRealQtt,e.realQtt),r=Object(P.useDispatch)(),a=function(e){r(us(t.id,e))};return Object(w.jsx)("div",{className:"basket-item-control",children:Object(w.jsxs)(Xc.c,{inputMode:"numeric",w:28,bg:"whitesmoke",min:0,value:c,defaultValue:null===t||void 0===t?void 0:t.quantityParProduct,onChange:function(e){""==e?(n(0),a(0)):(n(e),a(e))},children:[Object(w.jsx)(Xc.d,{}),Object(w.jsxs)(Xc.e,{children:[Object(w.jsx)(Xc.b,{}),Object(w.jsx)(Xc.a,{})]})]})})},lu=function(e){var t=e.product,n=e.setRealQttCC,c=(e.setRealQtt,e.setMaxRealQttCC,e.maxRealQttCC,e.realQtt,e.realQttCC),r=Object(P.useDispatch)(),i=(Object(a.useRef)(),Object(P.useSelector)((function(e){return{frommagasins:e.frommagasins}})).frommagasins,function(e){r(bs(t.id,e))});return Object(w.jsx)("div",{className:"basket-item-control",children:Object(w.jsxs)(Xc.c,{inputMode:"numeric",w:28,bg:"whitesmoke",onChange:function(e){""==e?(i(0),n(0)):(n(1*e),i(1*e))},min:0,value:c,defaultValue:null===t||void 0===t?void 0:t.qttByCC,children:[Object(w.jsx)(Xc.d,{}),Object(w.jsxs)(Xc.e,{children:[Object(w.jsx)(Xc.b,{}),Object(w.jsx)(Xc.a,{})]})]})})},du=function(e){var t=e.product,n=e.setRealQttLitre,c=e.realQttLitre,r=e.maxRealQttByLitre,a=Object(P.useDispatch)(),i=function(e){a(js(t.id,e))};return Object(w.jsx)("div",{className:"basket-item-control",children:Object(w.jsxs)(Xc.c,{inputMode:"numeric",w:28,step:1,bg:"whitesmoke",min:0,value:c,defaultValue:0,onChange:function(e){""==e?(n(0),i(0)):(n(Number(e)),i(Number(e)))},max:r,children:[Object(w.jsx)(Xc.d,{}),Object(w.jsxs)(Xc.e,{children:[Object(w.jsx)(Xc.b,{}),Object(w.jsx)(Xc.a,{})]})]})})},uu=function(e){var t=e.product,n=Object(a.useState)(null===t||void 0===t?void 0:t.qttByCC),c=Object(f.a)(n,2),r=c[0],i=c[1],s=Object(a.useState)(null===t||void 0===t?void 0:t.quantityParProduct),o=Object(f.a)(s,2),l=o[0],d=o[1],u=Object(a.useState)(0),j=Object(f.a)(u,2),b=j[0],m=j[1],O=Object(a.useState)(2e3),h=Object(f.a)(O,2),x=h[0],v=h[1],p=Object(a.useState)(2e3),g=Object(f.a)(p,2),y=g[0],N=g[1],C=Object(a.useState)(2e3),S=Object(f.a)(C,2),q=S[0],E=S[1],A=Object(P.useSelector)((function(e){return e.frommagasins})),D=Object(P.useDispatch)(),V=gd(A,D),F=V.isItemFromMagasin,R=V.addFromMagasin;Object(a.useEffect)((function(){var e=function(e,t,n,c){var r=!1;if($o(c)){r=!0;var a=e,i=t,s=n,o=c.condval,l=c.quantityCCCVA,d=c.quantityBruteCVA,u=c.condsize,j=c.doseDefault,b=c.condml,m=!0;if(s>0&&0==a&&0==i&&s>d&&(m=!1,o=a,l=i),0==s&&a>0&&0==i){var O=0;Number(a)>Number(u)&&(O=Math.floor(Number(a)/Number(u)),o-(Number(a)-Number(u)*O)<0&&(O+=1)),d-O<0&&(m=!1,d=s,l=i)}if(0==s&&0==a&&i>0&&l-i<0){var h=0,x=0;Number(i)>Number(j)&&(h=Math.floor(Number(i)/Number(j)),l-(Number(i)-Number(j)*h)<0&&(h+=1)),Number(h)>Number(u)&&(x=Math.floor(Number(h)/Number(u)),o-(Number(h)-Number(u)*h)<0&&(x+=1)),d-x<0&&(m=!1,d=s,o=a)}if(0==s&&a>0&&i>0){var v=0,p=0;Number(i)>Number(b)?(v=Math.floor(Number(i)/Number(b)),l-(Number(i)-Number(b)*v)<0&&(v+=1)):l-Number(i)<0&&(v=1);var f=Number(a)+v;f>Number(u)?(p=Math.floor(f/Number(u)),o-(f-Number(u)*p)<0&&(p+=1)):o-f<0&&(p=1),d-p<0&&(m=!1,d=s,o=a)}if(s>0&&a>0&&0==i){var g=0;Number(a)>Number(u)?(g=Math.floor(Number(a)/Number(u)),o-(Number(a)-Number(u)*g+a)<0&&(g+=1)):o-Number(a)<0&&(g=1),d-(g+s)<0&&(m=!1,d=s,o=a)}if(s>0&&0==a&&i>0){var y=0,N=0;Number(i)>Number(b)?(y=Math.floor(Number(i)/Number(b)),l-(Number(i)-Number(b)*y)<0&&(y+=1)):l-Number(i)<0&&(y=1),Number(y)>Number(u)?(N=Math.floor(Number(y)/Number(u)),o-(Number(y)-Number(u)*N)<0&&(N+=1)):o-y<0&&(N=1),d-(N+s)<0&&(m=!1,o=a)}if(s>0&&a>0&&i>0){var C=0,S=0;Number(i)>Number(b)?(C=Math.floor(Number(i)/Number(b)),l-(Number(i)-Number(b)*C)<0&&(C+=1)):l-Number(i)<0&&(C=1);var q=Number(C)+Number(a);q>Number(u)?(S=Math.floor(q/Number(u)),o-(q-Number(u)*S)<0&&(S+=1)):o-q<0&&(S=1),d-(S+s)<0&&(m=!1)}return{normalQtt:o,normalQttCC:l,normalQttLitre:d,isSpecific:r,isValid:m}}var w=e,E=t,A=c.quantityBruteCVA,D=c.quantityCCCVA,P=c.doseDefault,V=c.quantityBruteCVA;r=!1;var F=!0;if(0==w&&E>0){var R=0,T=0;Number(E)>Number(P)?(R=Math.floor(Number(E)/Number(P)),T=Number(E)-Number(P)*R,console.log(T),D-T<0&&(R+=1)):D-Number(E)<0&&(R=1),E>D&&A-R<0&&(F=!1,A=w)}if(w>0&&0==E&&w>A&&(F=!1,D=E),w>0&&E>0){var M,B=0;Number(E)>Number(P)?(M=Math.floor(Number(E)/Number(P)),B=Number(E)-Number(P)*M,console.log(B),D-B<0&&(M+=1)):D-Number(E)<0&&(M=1),Number(A)-(Number(M)+Number(w))<0&&(F=!1),w>A&&(F=!1,D=E)}return{normalQtt:A,normalQttCC:D,normalQttLitre:V,isValid:F,isSpecific:r}}(l,r,b,t),n=e.normalQtt,c=e.normalQttCC,a=e.normalQttLitre,s=e.isSpecific;e.isValid||(alert("stock insuffisant :("),s?(m(a),E(a),d(n),v(n),i(c),N(c)):(d(n),v(n),i(c),N(c)))}),[l,r,b]);var T=!!F&&F(t.id);return Object(w.jsx)("div",{children:Object(w.jsxs)("div",{className:"d-flex justify-content-between align-items-center border   mb-2 p-2",children:[Object(w.jsxs)("div",{style:{width:"45%"},children:[Object(w.jsx)("p",{className:"text-blue",children:t.name}),$o(t)?Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("p",{className:"text-lowercase",children:Object(w.jsx)("strong",{children:0!=t.qttbylitre&&Object(w.jsx)("span",{style:{marginRight:"30px"},children:ct(t.prixlitre)+" x "+t.qttbylitre+" Litre(s)"})})}),Object(w.jsx)("p",{className:"text-lowercase",children:Object(w.jsx)("strong",{children:0!=t.quantityParProduct&&Object(w.jsx)("span",{style:{marginRight:"30px"},children:ct(t.prixqttccvente*t.qttccpvente)+" x "+t.quantityParProduct+" "+t.type})})})]}):Object(w.jsx)("p",{className:"text-lowercase",children:Object(w.jsx)("strong",{children:0!=t.quantityParProduct&&Object(w.jsx)("span",{style:{marginRight:"30px"},children:ct(t.prixVente)+" x "+t.quantityParProduct+" "+t.type})})}),Object(w.jsx)("p",{className:"text-lowercase",children:Object(w.jsx)("strong",{children:0!=t.qttByCC&&Object(w.jsx)("span",{style:{marginRight:"30px"},children:ct(t.prixParCC)+" x "+t.qttByCC+" ML"})})})]}),0!==t.condml&&0!==t.qttccpvente&&Object(w.jsxs)("div",{className:"text-inline text-center mr-3",children:[Object(w.jsx)("h5",{className:"mb-1 text-uppercase",children:"Litre"}),Object(w.jsx)(du,{product:t,setRealQttLitre:m,realQttLitre:b,maxRealQttByLitre:q})," "]}),Object(w.jsxs)("div",{className:"text-inline text-center mr-2",children:[Object(w.jsx)("h5",{className:"mb-1",children:t.type}),Object(w.jsx)(ou,{product:t,setRealQtt:d,setMaxRealQtt:v,maxRealQtt:x,realQtt:l})]}),"FLACON"===t.type&&Object(w.jsxs)("div",{className:"text-inline text-center",children:[Object(w.jsx)("h5",{className:"mb-1",children:3==t.categoryId?"DOSE":"ML"}),at(t.name,"ita new")&&Object(w.jsx)(ed,{product:t,setRealQttCC:i,realQttCC:r}),at(t.name,"sovax")&&Object(w.jsx)(nd,{setRealQttCC:i,realQttCC:r,product:t}),0==t.condml&&0==t.qttccpvente&&!at(t.name,"sovax")&&!at(t.name,"ita new")&&Object(w.jsx)(lu,{setRealQttCC:i,realQttCC:r,maxRealQttCC:y,product:t}),0!==t.condml&&0!==t.qttccpvente&&Object(w.jsx)(td,{product:t,setRealQttCC:i,realQttCC:r,maxRealQttCC:y})]}),Object(w.jsx)("div",{className:"ml-2",children:T&&Object(w.jsx)("button",{onClick:function(){R&&R(t)},className:"btn btn-danger btn-xs text-right",children:"X"})})]})})},ju=function(e){return e&&0!==(null===e||void 0===e?void 0:e.length)?e.reduce((function(e,t){return e+t}),0):0},bu=function(){var e=Object(a.useState)("vente-cva"),t=Object(f.a)(e,2),n=t[0],c=t[1],r=Object(a.useState)(null),i=Object(f.a)(r,2),s=i[0],o=(i[1],Object(a.useState)(null)),l=Object(f.a)(o,2),d=l[0],b=l[1],m=Object(j.g)(),O=Object(P.useSelector)((function(e){return{frommagasins:e.frommagasins}})).frommagasins,h=Object(P.useDispatch)(),x=Object(P.useSelector)(Jn("emprunters").value),v=Object(a.useState)(!1),p=Object(f.a)(v,2),g=(p[0],p[1],new Date),y=Object(a.useState)(g),N=Object(f.a)(y,2),C=N[0],S=N[1];Object(a.useEffect)((function(){h(Xn("emprunters").fetch())}),[]);return Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)(lr.a,{children:[Object(w.jsxs)(lr.a.Header,{className:" bg-dark py-2 text-white d-flex justify-content-between align-items-center",children:[Object(w.jsxs)("div",{style:{width:"60%"},children:["BON DE SORTIE ("," ".concat(null===O||void 0===O?void 0:O.length," ").concat((null===O||void 0===O?void 0:O.length)>1?"articles":"article"),")"]}),Object(w.jsx)("div",{style:{width:"40%"},className:"text-right",children:Object(w.jsxs)("select",{className:"form-control input-sm",onChange:function(e){c(e.target.value)},children:[Object(w.jsx)("option",{value:"vente-cva",selected:!0,children:"Comptant"}),Object(w.jsx)("option",{value:"credit-cva",children:"Credit"})]})})]}),Object(w.jsxs)("div",{className:"commande-vente",children:[Object(w.jsxs)(lr.a.Body,{style:{padding:2,marginTop:3,marginRight:2,marginLeft:2},children:[Object(w.jsxs)("div",{className:"d-flex justify-content-end",children:[Object(w.jsx)(u.b,{className:"btn btn-danger mb-2 mr-2 btn-sm",to:"/historique/vente/vendeur/credit-cva",children:"CREDITS"}),Object(w.jsx)(u.b,{className:"btn btn-primary mb-2 btn-sm text-uppercase",to:"/historique/vente/vendeur/vente-cva",children:"Voir l'historique de vente"})]}),Object(w.jsxs)("div",{style:{overflowY:"auto",height:"350px",maxHeight:"350px",overflowX:"hidden"},children:[Object(w.jsxs)("div",{class:"form-group",children:[Object(w.jsx)("label",{children:"Date de sortie :"}),Object(w.jsx)("div",{children:Object(w.jsx)("input",{type:"date",onChange:function(e){return S(e.target.value)},value:C,className:"form-control"})})]}),"credit-cva"===n&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("label",{children:"Crediteur:"}),Object(w.jsxs)("select",{className:"form-control",onChange:function(e){b(e.target.value)},children:[Object(w.jsx)("option",{value:""}),x.map((function(e){return Object(w.jsx)("option",{value:e.id,children:e.name})}))]})]}),(null===O||void 0===O?void 0:O.length)<=0&&Object(w.jsx)("div",{className:"alert alert-success ",children:Ad.fromMagasin.emptyOrder}),null===O||void 0===O?void 0:O.map((function(e,t){return Object(w.jsx)(uu,{product:e,basket:O,dispatch:h},"".concat(null===e||void 0===e?void 0:e.id,"_").concat(t))}))]})]}),(null===O||void 0===O?void 0:O.length)>0&&Object(w.jsxs)(lr.a.Footer,{className:"d-flex align-items-center justify-content-between",children:[Object(w.jsx)("div",{style:{width:"40%"},children:Object(w.jsx)("h2",{className:"p-2 text-uppercase bg-primary",children:Object(w.jsxs)("strong",{"data-test-id":"total-price-orders",children:["Total:",ct(ju(O.map((function(e){return Ra(e)?e.prixqttccvente*e.quantityParProduct*e.qttccpvente+e.prixlitre*e.qttbylitre:e.prixVente*e.quantityParProduct})))+ju(O.map((function(e){return e.prixParCC*e.qttByCC}))))]})})}),Object(w.jsx)("div",{style:{width:"60%"},children:O.length>0&&Object(w.jsxs)("div",{className:"d-flex text-right align-items-end justify-content-end",children:[Object(w.jsx)("button",{className:"btn btn-green btn-sm mr-2",disabled:0===O.length,onClick:function(){rl(O)?alert("commande non-conforme,veuillez verifier!!"):(O.forEach((function(e){!function(e){if(id(e)){var t=e.quantityParProduct,n=e.qttByCC,c=e.qttbylitre,r=e.condval,a=e.quantityCCCVA,i=e.condsize,s=(e.doseDefault,e.condml);if(c>0&&0==t&&0==n&&(e.quantityBruteCVA-=c),0==c&&t>0&&0==n){var o=0,l=0;if(Number(t)>=Number(i))if(o=Math.floor(Number(t)/Number(i)),r-(l=Number(t)-Number(i)*o)<0){var d=Number(l)-Number(r);e.condval=Number(i)-Number(d),o+=1}else e.condval=r-l;else if(e.condval-Number(t)<0){var u=Number(t)-Number(e.condval),j=Number(i)-Number(u);e.condval=j,o+=1}else e.condval-=Number(t);e.quantityBruteCVA-=o}if(0==c&&0==t&&n>0){var b=0,m=0,O=0,h=0;if(Number(n)>=Number(s))if(b=Math.floor(Number(n)/Number(s)),a-(h=Number(n)-Number(s)*b)<0){var x=Number(h)-Number(a);e.quantityCCCVA=Number(s)-Number(x),b+=1}else e.quantityCCCVA=a-h;else if(Number(n)>=e.quantityCCCVA){b+=1;var v=Number(n)-e.quantityCCCVA;e.quantityCCCVA=Number(s)-v}else e.quantityCCCVA-=Number(n);if(Number(b)>=Number(i))if(m=Math.floor(Number(b)/Number(i)),r-(O=Number(b)-Number(i)*O)<0){var p=Number(O)-Number(r);e.condval=Number(i)-Number(p),m+=1}else e.condval=r-O;else if(e.condval-Number(b)<0){var f=Number(b)-Number(e.condval),g=Number(i)-Number(f);e.condval=g,m+=1}else e.condval-=Number(b);e.quantityBruteCVA-=m}if(0==c&&t>0&&n>0){var y=0,N=0,C=0,S=0;if(Number(n)>=Number(s))if(y=Math.floor(Number(n)/Number(s)),a-(S=Number(n)-Number(s)*y)<0){var q=Number(S)-Number(a);e.quantityCCCVA=Number(s)-Number(q),y+=1}else e.quantityCCCVA=Number(a)-S;else if(Number(n)>=e.quantityCCCVA){y+=1;var w=Number(n)-e.quantityCCCVA;e.quantityCCCVA=Number(s)-w}else e.quantityCCCVA-=Number(n);var E=Number(t)+y;if(E>=Number(i))if(N=Math.floor(E/Number(i)),r-(C=E-Number(i)*y)<0){var A=Number(C)-Number(r);e.condval=Number(i)-Number(A),N+=1}else e.condval=r-C;else if(e.condval-Number(E)<0){var D=Number(E)-Number(e.condval),P=Number(i)-Number(D);e.condval=P,N+=1}else e.condval-=Number(E);e.quantityBruteCVA-=N}if(c>0&&t>0&&0==n){var V=0,F=0;if(Number(t)>=Number(i))if(V=Math.floor(Number(t)/Number(i)),r-(F=Number(t)-Number(i)*V)<0){var R=Number(F)-Number(r);e.condval=Number(i)-Number(R),V+=1}else e.condval=r-F;else if(e.condval-Number(t)<0){var T=Number(t)-Number(e.condval),M=Number(i)-Number(T);e.condval=M,V+=1}else e.condval-=Number(t);e.quantityBruteCVA-=V+c}if(c>0&&0==t&&n>0){var B=0,k=0,_=0,I=0;if(Number(n)>=Number(s))if(B=Math.floor(Number(n)/Number(s)),a-(I=Number(n)-Number(s)*B)<0){var L=Number(I)-Number(a);e.quantityCCCVA=Number(s)-Number(L),B+=1}else e.quantityCCCVA=a-I;else if(Number(n)>=e.quantityCCCVA){B+=1;var Q=Number(n)-e.quantityCCCVA;e.quantityCCCVA=Number(s)-Q}else e.quantityCCCVA-=Number(n);if(Number(B)>=Number(i))if(k=Math.floor(Number(B)/Number(i)),r-(_=Number(B)-Number(i)*k)<0){var H=Number(_)-Number(r);e.condval=Number(i)-Number(H),k+=1}else e.condval=r-I;else if(e.condval-Number(B)<0){var U=Number(B)-Number(e.condval),Y=Number(i)-Number(U);e.condval=Y,k+=1}else e.condval-=Number(B);e.quantityBruteCVA-=k+c}if(c>0&&t>0&&n>0){var K=0,z=0,W=0,G=0;if(Number(n)>=Number(s))if(K=Math.floor(Number(n)/Number(s)),a-(G=Number(n)-Number(s)*K)<0){var X=Number(G)-Number(a);e.quantityCCCVA=Number(s)-Number(X),K+=1}else e.quantityCCCVA=a-G;else if(Number(n)>=e.quantityCCCVA){K+=1;var J=Number(n)-e.quantityCCCVA;e.quantityCCCVA=Number(s)-J}else e.quantityCCCVA-=Number(n);var $=Number(K)+Number(t);if($>=Number(i))if(z=Math.floor($/Number(i)),r-(W=$-Number(i)*z)<0){var Z=Number(W)-Number(r);e.condval=Number(i)-Number(Z),z+=1}else e.condval=r-G;else if(e.condval-Number($)<0){var ee=Number($)-Number(e.condval),te=Number(i)-Number(ee);e.condval=te,z+=1}else e.condval-=Number($);e.quantityBruteCVA-=z+c}}else{var ne=e.quantityParProduct,ce=e.qttByCC,re=(e.quantityBruteCVA,e.quantityCCCVA),ae=e.doseDefault;if(0==ne&&ce>0){var ie=0,se=0;if(Number(ce)>=Number(ae))if(ie=Math.floor(Number(ce)/Number(ae)),re-(se=Number(ce)-Number(ae)*ie)<0){var oe=Number(se)-Number(re);e.quantityCCCVA=Number(ae)-Number(oe),ie+=1}else e.quantityCCCVA=Number(re)-se;else if(e.quantityCCCVA-Number(ce)<0){var le=Number(ce)-Number(e.quantityCCCVA);e.quantityCCCVA=Number(ae)-Number(le),ie+=1}else e.quantityCCCVA-=Number(ce);console.log(ie),e.quantityBruteCVA-=ie}if(ne>0&&0==ce&&(e.quantityBruteCVA-=ne),ne>0&&ce>0){var de=0,ue=0;if(Number(ce)>=Number(ae))if(de=Math.floor(Number(ce)/Number(ae)),re-(ue=Number(ce)-Number(ae)*de)<0){var je=Number(ue)-Number(re);e.quantityCCCVA=Number(ae)-Number(je),de+=1}else e.quantityCCCVA=Number(re)-ue;else if(e.quantityCCCVA-Number(ce)<0){var be=Number(ce)-Number(e.quantityCCCVA);e.quantityCCCVA=Number(ae)-Number(be),de+=1}else e.quantityCCCVA-=Number(ce);var me=de+Number(ne);e.quantityBruteCVA-=me}}}(e)})),h(Xn("commandes").createTransaction({id:Math.floor(Date.now()/1e3),contenu:O,type:n,sorte:"sortie",vaccinateurId:s,status:"vente-cva"===n,emprunterId:d,dateCom:null!=C?C:g},"add-from-magasin")),h(ds()),m.push("/historique/vente/vendeur/vente-cva"))},type:"button",children:"Valider l'operation"}),Object(w.jsx)("button",{className:"btn btn-danger btn-sm",onClick:function(){O.forEach((function(e){e.quantityParProduct=0,e.qttByCC=0})),h(ss()),h(ds())},type:"button",children:Object(w.jsx)("span",{children:"Annuler"})})]})})]})]})]})})},mu=new Date;function Ou(){var e=Object(a.useState)({hours:mu.getHours(),minutes:mu.getMinutes(),seconds:mu.getSeconds()}),t=Object(f.a)(e,2),n=t[0],c=t[1];return Object(a.useEffect)((function(){var e=setInterval((function(){var e=new Date;c({hours:e.getHours()<10?"0"+e.getHours():e.getHours(),minutes:e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes(),seconds:e.getSeconds()<10?"0"+e.getSeconds():e.getSeconds()})}),1e3);return function(){return clearInterval(e)}}),[]),Object(w.jsxs)("div",{className:"bg-dark py-1 px-4 text-center",children:[Object(w.jsxs)("h1",{style:{fontSize:"20px"},children:[n.hours," : ",n.minutes," : ",n.seconds]}),Object(w.jsx)("h4",{className:"bg-thead p-1",children:nt(mu)})]})}He.reactFastCompare;var hu=function(){var e=Object(P.useSelector)(Jn("products").value),t=Object(P.useSelector)(Jn("products").meta),n=Object(P.useDispatch)(),c=Object(a.useState)(""),r=Object(f.a)(c,2),i=r[0],s=r[1],o=Object(a.useState)(2),l=Object(f.a)(o,2),d=(l[0],l[1],Object(a.useState)(!1)),u=Object(f.a)(d,2),j=u[0],b=u[1],m=(Object(a.useRef)(null),Object(a.useRef)(null),Object(a.useState)([])),O=Object(f.a)(m,2),h=O[0],x=O[1];Object(a.useEffect)((function(){n(Xn("products").fetch())}),[]),Object(a.useEffect)((function(){return 1==j&&(n(Xn("products").fetch()),b(!1)),function(){b(!1)}}),[j]),Object(a.useEffect)((function(){t.isFetching||x(e.filter((function(e){return!cl(e)})))}),[t]),Object(a.useEffect)((function(){x(Mr(e.filter((function(e){return!cl(e)})),i))}),[i]);return Object(w.jsxs)(w.Fragment,{children:[" ",Object(w.jsxs)(Xe,{children:[Object(w.jsx)(Ke,{title:"Vente du magasin",children:Object(w.jsx)(We,{title:"Vente du magasin"})}),Object(w.jsx)($e,{children:Object(w.jsxs)(fr.a,{children:[Object(w.jsx)(gr.a,{xs:6,children:Object(w.jsxs)(lr.a,{className:"mt-2",children:[Object(w.jsxs)(lr.a.Header,{className:"bg-dark p-2 text-white d-flex text-uppercase justify-content-between align-items-center",children:[Object(w.jsx)("div",{style:{width:"60%"},children:"Produits"}),Object(w.jsx)("div",{children:Object(w.jsx)("button",{className:"btn btn-green btn-sm",onClick:function(){b(!0)},children:"Mettre \xe0 jour"})})]}),Object(w.jsxs)(lr.a.Body,{children:[Object(w.jsxs)("div",{class:"d-flex justify-content-between align-items-center",children:[Object(w.jsx)("input",{type:"text",onChange:function(e){s(e.target.value)},placeholder:"Nom du produit",className:"form-control mb-2"})," "]}),Object(w.jsx)(pr.a,{children:Object(w.jsxs)("div",{style:{overflowY:"auto",width:"100%",height:"350px",maxHeight:"350px",overflowX:"hidden"},children:[Object(w.jsxs)("div",{class:"d-flex justify-content-start flex-wrap",children:[h.sort((function(e,t){return t.quantityBruteCVA-e.quantityBruteCVA})).map((function(e){return Object(w.jsx)(su,{product:e})})),0==h.length&&"Aucune enregistrement trouv\xe9"]})," "]})})]})]})}),Object(w.jsx)(gr.a,{xs:6,children:Object(w.jsx)("div",{className:" py-2",children:Object(w.jsx)(bu,{setRegenerate:b})})})]})})]})]})},xu=function(){return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(hu,{})})};function vu(){return Xr.b().shape({prices:Xr.a().of(Xr.b().shape({}))})}var pu=function(){var e=Object(ic.e)(),t=e.values;e.setValues;return Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)("table",{className:"table table-bordered",children:[Object(w.jsx)("thead",{className:" bg-thead",children:Object(w.jsxs)("tr",{children:[Object(w.jsx)("th",{children:"Date debut"}),Object(w.jsx)("th",{children:"Date fin"}),Object(w.jsx)("th",{style:{width:"60%"},children:"Prix"}),Object(w.jsx)("th",{children:"Actions"})]})}),Object(w.jsxs)("tbody",{children:[0==(null===t||void 0===t?void 0:t.prices.length)&&Object(w.jsx)("tr",{children:Object(w.jsx)("td",{colspan:4,className:"text-center",children:"Aucun prix ajout\xe9"})}),Object(w.jsx)(ic.b,{name:"prices",render:function(e){var n;return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("tr",{children:Object(w.jsx)("td",{colspan:4,children:Object(w.jsx)("button",{className:"bg-primary py-1 px-2",onClick:function(){return e.push("")},children:"Ajouter plus"})})}),(null===t||void 0===t?void 0:t.prices)&&(null===t||void 0===t||null===(n=t.prices)||void 0===n?void 0:n.map((function(t,n){return Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:Object(w.jsx)(ar.Field.Date,{placeholder:"date de debut.",name:"prices.".concat(n,".deb")})}),Object(w.jsx)("td",{children:Object(w.jsx)(ar.Field.Date,{placeholder:"date de debut.",name:"prices.".concat(n,".fin")})}),Object(w.jsxs)("td",{className:"d-flex flex-row justify-content-between",children:[Object(w.jsx)("div",{className:"mr-2",children:Object(w.jsx)(ar.Field.Input,{placeholder:"Prix du litre",name:"prices.".concat(n,".prixlitre")})}),Object(w.jsx)("div",{className:"mr-2",children:Object(w.jsx)(ar.Field.Input,{placeholder:"prix par quantit\xe9",name:"prices.".concat(n,".montant")})}),Object(w.jsx)(ar.Field.Input,{placeholder:"prix par cc",name:"prices.".concat(n,".prixparcc")})]}),Object(w.jsx)("td",{className:"text-center",children:Object(w.jsx)("button",{className:"btn btn-danger btn-sm",onClick:function(){return e.remove(n)},children:"Retirer"})})]})})))]})}})]})]})})};function fu(){var e,t,n=Object(j.i)().id,c=Object(P.useDispatch)(),r=Object(a.useState)("vente-magasin"),s=Object(f.a)(r,2),o=(s[0],s[1],Object(P.useSelector)(Jn("products").value)),l=Object(P.useSelector)(Jn("commandes").meta),d=Object(a.useState)([]),u=Object(f.a)(d,2);u[0],u[1];Object(a.useEffect)((function(){c(Xn("products").get(n))}),[]);var b=Object(a.useCallback)((function(e){c(Xn("commandes").createTransaction(Object(dt.a)(Object(dt.a)({},e),{},{id:n}),"get-commande-bw"))}),[]),m=i.a.useMemo((function(){return[{Header:"Date D\xe9but",accessor:"deb"},{Header:"Date Fin",accessor:"fin"},{Header:"Informations",Cell:function(e){var t;return Object(w.jsxs)("table",{className:"table text-center",children:[Object(w.jsx)("thead",{children:Object(w.jsxs)("tr",{children:[Object(w.jsx)("th",{children:"Date"}),Object(w.jsx)("th",{children:"Ancien prix du litre"}),Object(w.jsx)("th",{children:"Nouvel prix du litre "}),Object(w.jsx)("th",{children:"Ancien prix en quantit\xe9"}),Object(w.jsx)("th",{children:"Nouvel prix en quantit\xe9"}),Object(w.jsx)("th",{children:"Ancien prix en ML"}),Object(w.jsx)("th",{children:"Nouvel prix en ML"})]})}),Object(w.jsx)("tbody",{children:null===(t=e.row.original)||void 0===t?void 0:t.data.map((function(e,t){return Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:nt(e.createdAt)}),Object(w.jsx)("td",{children:"no"!=e.lastPriceLitre?ct(""!=e.lastPriceLitre?e.lastPriceLitre:0):""}),Object(w.jsx)("td",{children:"no"!=e.newPriceLitre?ct(e.newPriceLitre):""}),Object(w.jsx)("td",{children:ct(e.lastPrice)}),Object(w.jsx)("td",{children:ct(e.newPrice)}),Object(w.jsx)("td",{children:"no"!=e.lastPriceCC?ct(e.lastPriceCC):""}),Object(w.jsx)("td",{children:"no"!=e.newPriceCC?ct(e.newPriceCC):""})]},t)}))})]})}}]}),[]);return Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)(Xe,{children:[Object(w.jsx)(Ke,{title:"Rectification de prix",children:Object(w.jsx)(We,{title:"Rectification de prix"})}),Object(w.jsxs)($e,{children:[Object(w.jsxs)("div",{className:"d-flex flex-row justify-content-between",children:[Object(w.jsx)("h2",{className:"mb-2",style:{fontSize:20},children:null===(e=o[0])||void 0===e?void 0:e.name}),Object(w.jsx)("div",{})]}),Object(w.jsx)(ar,{enableReinitialize:!0,initialValues:{type:"vente-magasin",prices:[]},validations:vu,onSubmit:b,render:function(e){e.values;return Object(w.jsxs)(ar.Element,{children:[Object(w.jsx)("div",{style:{width:"30%"},children:Object(w.jsx)(ar.Field.Select,{name:"type",label:"Type de sortie",emptyValue:!1,valueKey:"name",disabled:!1,defaultValue:1,options:[{id:1,name:"Vente du Magasin"},{id:2,name:"Facture"}]})}),Object(w.jsx)(pu,{}),Object(w.jsxs)("div",{className:"mt-3",children:[Object(w.jsx)("button",{className:"btn btn-green  btn-sm ",type:"submit",children:"Appliquer les changements"}),Object(w.jsx)("button",{className:"btn btn-danger ml-2  btn-sm ",type:"reset",children:"Annuler"})]})]})}}),Object(w.jsx)("h2",{className:"my-3",children:"Recapitulatif des changements"}),Object(w.jsx)(mr,{filter:!1,data:null===l||void 0===l||null===(t=l.data)||void 0===t?void 0:t.recap,meta:l,columns:m})]})]})})}var gu=function(){var e=Object(P.useSelector)(Jn("products").value),t=Object(P.useSelector)(Jn("products").meta),n=Object(P.useDispatch)();Object(a.useEffect)((function(){n(Xn("products").fetch())}),[]);var c=i.a.useMemo((function(){return[{Header:"Nom de l'article",accessor:"name"},{Header:"Fournisseur",Cell:function(e){var t,n;return Object(w.jsx)("div",{children:Object(w.jsx)("h3",{className:"badge badge-primary",children:null===(t=e.row.original)||void 0===t||null===(n=t.fournisseur)||void 0===n?void 0:n.name})})}},{Header:"Quantit\xe9",accessor:"quantityBruteCVA"},{Header:"Conditionnement (ML)",accessor:"condval"},{Header:"Reste en ML",accessor:"quantityCC",Cell:function(e){var t,n;return Object(w.jsx)("div",{children:null==(null===(t=e.row.original)||void 0===t?void 0:t.quantityCCCVA)?0:null===(n=e.row.original)||void 0===n?void 0:n.quantityCCCVA})}}]}));return Object(w.jsxs)(Fr.a,{children:[Object(w.jsx)(Xo,{}),Object(w.jsx)("div",{className:"row",children:Object(w.jsx)("div",{className:"col-lg-6 text-right"})}),Object(w.jsx)(mr,{data:e,meta:t,columns:c})]})};var yu=function(e){for(var t=0;t<e.length;++t)return e[t].correction>0||e[t].correctionml>0},Nu=function(){var e=Qe()().isoWeekday(1).startOf("week"),t=Qe()().endOf("week"),n=Object(a.useState)(e),c=Object(f.a)(n,2),r=c[0],s=c[1],o=Object(a.useState)(t),l=Object(f.a)(o,2),d=l[0],u=l[1],j=(Object(a.useRef)(null),Object(a.useRef)(null),Object(P.useSelector)(Jn("commandes").value)),b=Object(P.useSelector)(Jn("commandes").meta),m=Object(a.useState)([e,t]),O=Object(f.a)(m,2),h=O[0],x=O[1],v=Object(P.useDispatch)();Object(a.useEffect)((function(){v(function(e,t,n){return Ln("commandes",{path:"/operation-vente-cva?deb=".concat(e,"&fin=").concat(t),replace:!0})}(r,d))}),[r,d]),Object(a.useEffect)((function(){null!==h?(h[0]&&s(h[0]),h[1]&&u(h[1])):(s(e),u(t))}),[h]);var p,g=function(e){return e&&0!==(null===e||void 0===e?void 0:e.length)?e.reduce((function(e,t){return e+t}),0):0},y=function(e){return g(null===e||void 0===e?void 0:e.map((function(e){return Wi(e)?e.prixqttccvente*e.quantityParProduct*e.qttccpvente+e.prixVente*e.qttbylitre:e.prixVente*e.quantityParProduct})))+g(null===e||void 0===e?void 0:e.map((function(e){return e.prixParCC*e.qttByCC})))},N=i.a.useMemo((function(){return[{Header:"Date",Cell:function(e){var t;return Object(w.jsx)(w.Fragment,{children:nt(null===(t=e.row.original)||void 0===t?void 0:t.dateCom)})}},{Header:"Produits",Cell:function(e){var t,n,c,r,a,i;return Object(w.jsxs)("div",{style:{width:"350px"},children:[1==(null===(t=e.row.original)||void 0===t?void 0:t.isdeleted)&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("div",{className:"badge badge-danger",children:"Supprim\xe9"}),Object(w.jsxs)("div",{className:"text text-danger",children:["Date de suppression :"," ",nt(null===(n=e.row.original)||void 0===n?void 0:n.deletedat)]})]}),null==(null===(c=e.row.original)||void 0===c?void 0:c.isdeleted)&&Object(w.jsx)("p",{children:yu(null===(r=e.row.original)||void 0===r?void 0:r.contenu)&&Object(w.jsx)("div",{className:"badge badge-warning",children:"Modifi\xe9"})}),null===(a=e.row.original)||void 0===a||null===(i=a.contenu)||void 0===i?void 0:i.map((function(t){var n,c;return Object(w.jsxs)("span",{children:[Object(w.jsx)("span",{style:{background:"white",color:1==(null===(n=e.row.original)||void 0===n?void 0:n.isdeleted)?"red":"inherit",padding:2},children:t.name}),Object(w.jsxs)("span",{style:{color:1==(null===(c=e.row.original)||void 0===c?void 0:c.isdeleted)?"red":"inherit"},children:[" "," || "]})]})}))]})}},{Header:"Total",Cell:function(e){var t;return Object(w.jsx)("div",{children:ct(y(null===(t=e.row.original)||void 0===t?void 0:t.contenu))})}}]}),[]);return Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)(Xe,{children:[Object(w.jsx)(Ke,{title:"Operations sur les commandes",children:Object(w.jsx)(We,{title:"Operations sur les commandes"})}),Object(w.jsxs)($e,{children:[Object(w.jsxs)("div",{className:"row my-2",children:[Object(w.jsx)("div",{className:"col-lg-8",children:Object(w.jsxs)("div",{children:[r&&d&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("h2",{children:"Operations sur les commandes"}),Object(w.jsxs)("span",{children:["Du: ",nt(r)," Au ",nt(d)]})]})," "]})}),Object(w.jsx)("div",{className:"col-lg-4 text-right",children:Object(w.jsx)("div",{children:Object(w.jsx)(et.a,{locale:"fr-FR",onChange:x,value:h})})})]}),Object(w.jsx)(mr,{filter:!1,data:(p=j,p.filter((function(e){return e.deletedat!=Qe()("2021-01-01")}))),meta:b,columns:N})]})]})})};var Cu,Su=function(){var e=Object(P.useDispatch)();return Object(b.a)(),e(function(){var e=Object(Q.a)(L.a.mark((function e(t,n){var c,r,a,i,s;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Z();case 3:r=e.sent,a=r.version,i=r.desc,s=r.history,c={version:a,desc:i,history:s},e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),c={version:"0.0.0",desc:null,history:[]};case 13:c.status="0.0.0"==c.version?M:$(_,c.version)<0?k:F,n().version.ignoreVersion!=c.version&&c.status,t(ee(c));case 16:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,n){return e.apply(this,arguments)}}()),Object(w.jsx)(u.a,{children:Object(w.jsxs)(j.d,{children:[Object(w.jsx)(vl,{path:"/",exact:!0,component:cc}),Object(w.jsx)(vl,{path:ae,component:Bl}),Object(w.jsx)(vl,{path:re,component:Ql}),Object(w.jsx)(vl,{path:ce,component:Ul}),Object(w.jsx)(wo,{path:"/vendeur",component:Fd}),Object(w.jsx)(wo,{path:"/stock-cva",component:gu}),Object(w.jsx)(wo,{path:"/detailvendeur/:id",component:jl}),Object(w.jsx)(wo,{path:"/vendeur-commande/:id",component:Xl}),Object(w.jsx)(wo,{path:"/historique/vente/vendeur/:type",component:Jo}),Object(w.jsx)(vl,{path:"/vendre/in/admin",component:xu}),Object(w.jsx)(vl,{path:"/detailvendeuradmin/:id",component:ml}),Object(w.jsx)(vl,{path:"/vendeur-admin-commande/:id",component:jd}),Object(w.jsx)(vl,{path:Be,component:sl}),Object(w.jsx)(vl,{path:"/changer/prix/:id",component:fu}),Object(w.jsx)(vl,{path:"/approv",component:ac}),Object(w.jsx)(vl,{path:oe,component:Gr}),Object(w.jsx)(vl,{path:"/para/suppl",component:Wr}),Object(w.jsx)(vl,{path:se,component:oa}),Object(w.jsx)(vl,{path:"/bon-commande-depot",component:Vl}),Object(w.jsx)(vl,{path:"/product/edit/:id",component:aa}),Object(w.jsx)(vl,{path:ie,component:ca}),Object(w.jsx)(vl,{path:"/journal",component:zr}),Object(w.jsx)(vl,{path:le,component:ua}),Object(w.jsx)(vl,{path:de,component:Ir}),Object(w.jsx)(vl,{path:be,component:ni}),Object(w.jsx)(vl,{path:ue,component:Lr}),Object(w.jsx)(vl,{path:je,component:Kr}),Object(w.jsx)(vl,{path:ve,component:Vl}),Object(w.jsx)(vl,{path:me,component:da}),Object(w.jsx)(vl,{path:Oe,component:la}),Object(w.jsx)(vl,{path:xe,component:ci}),Object(w.jsx)(vl,{path:"/editer/commande/:id",component:ts}),Object(w.jsx)(vl,{path:he,component:ba}),Object(w.jsx)(vl,{path:"/detail/:id",component:Hr}),Object(w.jsx)(vl,{path:"/depot/detail/:id",exact:!0,component:Yr}),Object(w.jsx)(vl,{path:"/product/detail/:id",component:ra}),Object(w.jsx)(vl,{path:"/b/sortie",component:vr}),Object(w.jsx)(vl,{path:"/add/prod",component:ir}),Object(w.jsx)(vl,{path:pe,component:Ga}),Object(w.jsx)(vl,{path:"/editer/facture/:id",exact:!0,component:wl}),Object(w.jsx)(vl,{path:fe,component:xr}),Object(w.jsx)(vl,{path:"/approvis/detail/:id",exact:!0,component:dr}),Object(w.jsx)(j.b,{path:ge,component:fo}),Object(w.jsx)(j.b,{path:ye,component:Co}),Object(w.jsx)(vl,{path:Ne,component:Qo}),Object(w.jsx)(vl,{path:"/depot/to/magasin/edit/:id",component:fd}),Object(w.jsx)(vl,{path:Ce,component:Yo}),Object(w.jsx)(vl,{path:"/depot/to/magasin/detail/:id",component:zl}),Object(w.jsx)(vl,{path:qe,component:ol}),Object(w.jsx)(vl,{path:Se,component:dl}),Object(w.jsx)(vl,{path:"/magasin/detail/vente/:id",component:Gl}),Object(w.jsx)(vl,{path:we,component:Ud}),Object(w.jsx)(vl,{path:Ee,component:Kd}),Object(w.jsx)(vl,{path:"/detailcorrection/:id",component:zd}),Object(w.jsx)(vl,{path:Ae,component:Za}),Object(w.jsx)(vl,{path:De,component:Gd}),Object(w.jsx)(vl,{path:"/fournisseurs/edit/:id",component:Xd}),Object(w.jsx)(vl,{path:Pe,component:$a}),Object(w.jsx)(vl,{path:Ve,component:$d}),Object(w.jsx)(vl,{path:"/categories/edit/:id",component:Zd}),Object(w.jsx)(vl,{path:Fe,component:ti}),Object(w.jsx)(vl,{path:Re,component:tu}),Object(w.jsx)(vl,{path:"/emprunters/edit/:id",component:nu}),Object(w.jsx)(vl,{path:Te,component:ei}),Object(w.jsx)(vl,{path:"/opcommandes",component:Nu}),Object(w.jsx)(vl,{path:Me,component:ru}),Object(w.jsx)(vl,{path:"/vaccinateurs/edit/:id",component:au}),Object(w.jsx)(vl,{path:"/price/change/:id",component:Oo})]})})},qu=(c(1232),c(635)),wu=Gn("products",{key:"id"}),Eu=JSON.parse(localStorage.getItem("user")),Au=Eu?{isLoggedIn:!0,user:Eu}:{isLoggedIn:!1,user:null},Du=Gn("commandes"),Pu=Gn("fournisseurs"),Vu=Gn("emprunters"),Fu=Gn("vaccinateurs"),Ru=Gn("categories"),Tu=Gn("approvis"),Mu=Gn("parametres"),Bu={shipping:{},payment:{type:"",name:"",cardnumber:"",expiry:"",ccv:""}},ku=Gn("sortiedepots"),_u=(Gn("commund"),Object(Yn.b)({searchbydate:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{deb:Qe()().isoWeekday(1).startOf("week"),fin:Qe()().endOf("week")},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case rs:return t.payload;case as:return{deb:Qe()().isoWeekday(1).startOf("week"),fin:Qe()().endOf("week")};default:return e}},count:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{counter:0},t=arguments.length>1?arguments[1]:void 0;return"ADD"===t.type?Object(dt.a)(Object(dt.a)({},e),{},{counter:e.counter+1}):e},auth:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Au,c=arguments.length>1?arguments[1]:void 0,r=c.type,a=c.payload;switch(r){case H:return Object(dt.a)(Object(dt.a)({},n),{},{isLoggedIn:!0,user:null===(e=a.user)||void 0===e?void 0:e.user,success:a.success,error:null});case U:return Object(dt.a)(Object(dt.a)({},n),{},{isLoggedIn:!1,user:null,success:null,error:a.error});case Y:return Object(dt.a)(Object(dt.a)({},n),{},{isLoggedIn:!0,user:null===(t=a.user)||void 0===t?void 0:t.user,success:a.success,error:null});case K:return Object(dt.a)(Object(dt.a)({},n),{},{isLoggedIn:!1,user:null,token:null,success:null,error:a.error});case z:return Object(dt.a)(Object(dt.a)({},n),{},{isLoggedIn:!1,user:null,token:null});default:return n}},products:wu,realproducts:wu,categories:Ru,fournisseurs:Pu,emprunters:Vu,vaccinateurs:Fu,commandes:Du,commandesclone:Du,commund:Du,basket:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case yr:return t.payload;case Nr:return e.some((function(e){return e.id===t.payload.id}))?e:[t.payload].concat(Object(Ie.a)(e));case Cr:return e.filter((function(e){return e.id!==t.payload}));case Sr:return[];case qr:return e.map((function(e){return e.id==t.payload.id&&(e.quantityParProduct+=1),e.id==t.payload.id&&e.doseRestantEnMg>=1e3*e.doseDefault?e.doseRestantEnMg+=1e3*e.doseDefault:e.doseRestantEnMg=e.doseRestantEnMg,e}));case Er:return e.map((function(e){return e.id==t.payload.id&&(e.qttByCC+=1),e.id==t.payload.id&&e.doseRestantEnMg>=1e3*e.doseDefault?e.doseRestantEnMg+=1e3:e.doseRestantEnMg=e.doseRestantEnMg,e}));case wr:return e.map((function(e){return e.id==t.payload.id&&(e.quantityParProduct-=1),e.id==t.payload.id&&e.doseRestantEnMg>=1e3*e.doseDefault?e.doseRestantEnMg-=1e3*e.doseDefault:e.doseRestantEnMg=e.doseRestantEnMg,e}));case Ar:return e.map((function(e){return e.id==t.payload.id&&(e.qttByCC-=1),e.id==t.payload.id&&e.doseRestantEnMg>=e.doseDefault?e.doseRestantEnMg-=1e3:e.doseRestantEnMg=e.doseRestantEnMg,e}));default:return e}},approvisionnements:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case xa:return t.payload;case va:return e.some((function(e){return e.id===t.payload.id}))?e:[t.payload].concat(Object(Ie.a)(e));case pa:return e.filter((function(e){return e.id!==t.payload}));case fa:return[];case ga:return e.map((function(e){return e.id==t.payload.id&&(e.quantityParProduct+=1),e}));case Na:return e.map((function(e){return e.id==t.payload.id&&(e.quantityParProduct=Number(t.payload.qtt)),e}));case ya:return e.map((function(e){return e.id==t.payload.id&&(e.quantityParProduct-=1),e}));case Ca:return e.map((function(e){return e.id===t.payload.id&&(e.quantityParProduct=t.payload.value),e}));case Sa:return e.map((function(e){return e.id===t.payload.id&&(e.remise=t.payload.value),e}));case qa:return e.map((function(e){return e.id===t.payload.id&&(e.remisePerProduct=t.payload.value),e}));default:return e}},approvis:Tu,fromdepots:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case si:return t.payload;case oi:return e.some((function(e){return e.id===t.payload.id}))?e:[t.payload].concat(Object(Ie.a)(e));case li:return e.filter((function(e){return e.id!==t.payload}));case di:return[];case ui:return e.map((function(e){return e.id===t.payload.id&&(e.quantityParProductDepot=Number(t.payload.qtt)),e}));case ji:case hi:return e.map((function(e){return e.id==t.payload.id&&(e.qttByCCDepot=Number(t.payload.value)),e}));case bi:return e.map((function(e){return e.id===t.payload.id&&(e.quantityParProductDepot=Number(t.payload.value)),e}));case mi:return e.map((function(e){return e.id===t.payload.id&&(e.qttyspecificmirrordepot=Number(t.payload.value),e.qttByCCDepot=1*t.payload.value/2),e}));case Oi:return e.map((function(e){return e.id===t.payload.id&&(e.qttyspecificmirrordepot=Number(t.payload.value),e.qttByCCDepot=1*t.payload.value*2),e}));case xi:return e.map((function(e){return e.id===t.payload.id&&(e.qttByCCDepot-=t.payload.qttccpventedepot),e}));default:return e}},stock:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=(t.type,t.payload);switch(t.type){case W:return Object(dt.a)(Object(dt.a)({},e),t.payload);case G:return n;default:return e}},checkout:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Bu,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Dr:return Object(dt.a)(Object(dt.a)({},e),{},{shipping:t.payload});case Pr:return Object(dt.a)(Object(dt.a)({},e),{},{payment:t.payload});case Vr:return Bu;default:return e}},parametres:Mu,tomagasins:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Eo:return t.payload;case Ao:return e.some((function(e){return e.id===t.payload.id}))?e:[t.payload].concat(Object(Ie.a)(e));case Do:return e.filter((function(e){return e.id!==t.payload}));case Po:return[];case Vo:return e.map((function(e){return e.id===t.payload.id&&(e.quantityParProduct+=1),e}));case Vo:return e.map((function(e){return e.id===t.payload.id&&(e.quantityParProduct=Number(t.payload.qtt)),e}));case Fo:return e.map((function(e){return e.id===t.payload.id&&(e.quantityParProduct-=1),e}));case Ro:return e.map((function(e){return e.id===t.payload.id&&(e.quantityParProduct=t.payload.value),e}));default:return e}},frommagasins:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case fi:return t.payload;case gi:return e.some((function(e){return e.id===t.payload.id}))?e:[t.payload].concat(Object(Ie.a)(e));case yi:return e.filter((function(e){return e.id!==t.payload}));case Ni:return[];case Ci:return e.map((function(e){return e.id===t.payload.id&&(e.quantityParProduct=Number(t.payload.qtt)),e}));case Vi:return e.map((function(e){return e.id==t.payload.id&&(e.qttbybrute=Number(t.payload.value)),e}));case Si:case Ai:return e.map((function(e){return e.id==t.payload.id&&(e.qttByCC=Number(t.payload.value)),e}));case qi:return e.map((function(e){return e.id===t.payload.id&&(e.quantityParProduct=Number(t.payload.value)),e}));case Pi:return e.map((function(e){return e.id===t.payload.id&&(e.qttbylitre=Number(t.payload.value)),e}));case wi:return e.map((function(e){return e.id===t.payload.id&&(e.qttyspecificmirror=Number(t.payload.value),e.qttByCC=1*t.payload.value),e}));case Ei:return e.map((function(e){return e.id===t.payload.id&&(e.qttyspecificmirror=Number(t.payload.value),e.qttByCC=1*t.payload.value*2),e}));case Di:return e.map((function(e){return e.id===t.payload.id&&(e.qttByCC-=t.payload.qttccpvente),e}));default:return e}},sortiedepots:ku,version:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{status:V,downloadProgress:{total:0,current:0},showModal:!1,version:null,desc:"",history:[],ignoreVersion:null},t=arguments.length>1?arguments[1]:void 0,n=t.type,c=t.payload;switch(n){case X:return Object(dt.a)(Object(dt.a)({},e),c);case J:return Object(dt.a)(Object(dt.a)({},e),{},{ignoreVersion:c});default:return e}}})),Iu=c(1301),Lu=Iu.persistStore,Qu=(0,Iu.persistReducer)({key:"root",whitelist:["auth","profile","basket","approvisionnement","searchbydate","version"],storage:c(1233).default},_u),Hu=Object(Yn.c)(Qu,(Cu=[qu.a],Yn.a.apply(void 0,Object(Ie.a)(Cu)))),Uu=Lu(Hu);c(636),new Date;var Yu=c(637),Ku=c(1355),zu=(c(1236),c(1237),c(1238),c(1239),c(1240),c(1298),c(69)),Wu=c(1352),Gu=c(638),Xu=function(e){var t=e.version,n=e.desc;return Object(w.jsxs)("div",{style:{marginBottom:10},children:[Object(w.jsxs)("h4",{children:["v",t]}),Object(w.jsx)("p",{children:n})]})};var Ju=function(){var e=Object(P.useSelector)((function(e){return e.version})),t=Object(P.useDispatch)(),n=Object(a.useState)({text:"Ignore",show:!0,disabled:!1}),c=Object(f.a)(n,2),r=c[0],i=c[1],s=Object(a.useState)("Close"),o=Object(f.a)(s,2),l=(o[0],o[1]),d=Object(a.useState)({text:"Confirmer",show:!0,disabled:!1}),u=Object(f.a)(d,2),j=u[0],b=u[1],m=Object(a.useState)(""),O=Object(f.a)(m,2),h=O[0],x=O[1],v=Object(a.useState)(!1),p=Object(f.a)(v,2),g=(p[0],p[1],Object(a.useState)("")),y=Object(f.a)(g,2),N=(y[0],y[1]),C=Object(Gu.a)(),S=(C.size,C.elapsed,C.percentage),q=C.download,E=C.cancel,A=(C.error,C.isInProgress),D=Object(a.useMemo)((function(){if(!e.history)return[];var t,n=[],c=Object(zu.a)(e.history);try{for(c.s();!(t=c.n()).done;){var r=t.value;$(_,r.version)<0&&n.push(r)}}catch(a){c.e(a)}finally{c.f()}return n}),[e]),F=function(){t(ee({showModal:!1}))},I=function(){var n=Object(Q.a)(L.a.mark((function n(){return L.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:t(ee({status:R,downloadProgress:{total:0,current:0}})),"https://upload.wikimedia.org/wikipedia/commons/4/4d/%D0%93%D0%BE%D0%B2%D0%B5%D1%80%D0%BB%D0%B0_%D1%96_%D0%9F%D0%B5%D1%82%D1%80%D0%BE%D1%81_%D0%B2_%D0%BF%D1%80%D0%BE%D0%BC%D1%96%D0%BD%D1%8F%D1%85_%D0%B2%D1%80%D0%B0%D0%BD%D1%96%D1%88%D0%BD%D1%8C%D0%BE%D0%B3%D0%BE_%D1%81%D0%BE%D0%BD%D1%86%D1%8F.jpg",q("https://upload.wikimedia.org/wikipedia/commons/4/4d/%D0%93%D0%BE%D0%B2%D0%B5%D1%80%D0%BB%D0%B0_%D1%96_%D0%9F%D0%B5%D1%82%D1%80%D0%BE%D1%81_%D0%B2_%D0%BF%D1%80%D0%BE%D0%BC%D1%96%D0%BD%D1%8F%D1%85_%D0%B2%D1%80%D0%B0%D0%BD%D1%96%D1%88%D0%BD%D1%8C%D0%BE%D0%B3%D0%BE_%D1%81%D0%BE%D0%BD%D1%86%D1%8F.jpg","lgbva-v".concat(e.version,".exe"));case 3:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();return Object(a.useEffect)((function(){switch(e.status){case k:x("\ud83c\udf1f Nouvelle version trouv\xe9e \ud83c\udf1f"),N(""),i({text:"Ignorer",show:!0,disabled:!1}),b({text:"Mettre \xe0 jour",show:!0,disabled:!1}),l("Fermer");break;case R:x("\ud83c\udf1f Nouvelle version trouv\xe9e \ud83c\udf1f"),N("Telechargement en cours ..."),r.show&&i({text:"Ignorer",show:!1,disabled:!0}),j.disabled||b({text:"Installer",show:!0,disabled:!0}),l("Background download");break;case T:x("\ud83d\ude80 Program update \ud83d\ude80"),N(""),r.show&&i({text:"Ignorer",show:!1,disabled:!0}),b({text:"Installer",show:!0,disabled:!1}),l("Fermer");break;case V:x("\u23f3 Checking for updates \u23f3"),N(""),i({text:"Ignorer",show:!1,disabled:!0}),b({text:"Mettre \xe0 jour",show:!1,disabled:!0}),l("Fermer");break;case B:x("\u274c Download failed \u274c"),N("The download of the installation package failed. You can try again or go to the project address to manually download the new version update."),i({text:"Ignore",show:!0,disabled:!1}),b({text:"Retry",show:!0,disabled:!1}),l("Fermer");break;case M:x("\u2753 Failed to get the latest version information \u2753"),N("Failed to obtain the latest version information, it is recommended to manually go to the project address to check if there is a new version"),i({text:"Ignore",show:!1,disabled:!0}),b({text:"Project Homepage",show:!0,disabled:!1}),l("Fermer");break;default:x("\ud83c\udf89 The current version is already the latest \ud83c\udf8a"),N(""),i({text:"Ignorer",show:!1,disabled:!0}),b({text:"Mettre \xe0 jour",show:!1,disabled:!0}),l("Fermer")}}),[e]),Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)(Wu.a,{size:"sm","aria-labelledby":"contained-modal-title-vcenter",centered:!0,show:e.showModal,children:[Object(w.jsxs)(Wu.a.Body,{style:{position:"relative"},children:[Object(w.jsx)("div",{style:{position:"absolute",top:3,right:8},children:Object(w.jsx)("button",{onClick:F,className:"btn btn-xs",children:"x"})}),Object(w.jsx)("h3",{className:"pb-2",children:h}),Object(w.jsxs)("h5",{className:"pb-1",children:["Nouvelle version: ",e.version]}),Object(w.jsxs)("h5",{className:"pb-1",children:["Version actuelle: ",_]}),e.desc?Object(w.jsxs)("div",{children:[Object(w.jsx)("h5",{children:"Description du mis \xe0 jour : "}),Object(w.jsx)("div",{className:"bg-light",style:{paddingLeft:10,marginTop:5,paddingTop:3,paddingBottom:3},children:Object(w.jsx)("p",{children:e.desc})})]}):null,D.length?Object(w.jsxs)("div",{children:[Object(w.jsx)("h5",{children:"History version: "}),Object(w.jsx)("div",{children:D.map((function(e,t){return Object(w.jsx)(Xu,{version:e.version,desc:e.desc},t)}))})]}):null,e.status==R&&Object(w.jsxs)("div",{className:"d-flex flex-row justify-content-between",children:[Object(w.jsx)("progress",{id:"file",value:S,max:"100",style:{width:"100vh"}}),Object(w.jsx)("button",{style:{marginLeft:10},onClick:function(){return E()},children:"\u274c"})]})]}),Object(w.jsx)(Wu.a.Footer,{children:Object(w.jsxs)("div",{children:[r.show?Object(w.jsx)("button",{className:"btn btn-default mx-2 btn-sm",disabled:r.disabled,onClick:function(){F()},children:Object(w.jsx)("h5",{children:r.text})}):null,j.show?Object(w.jsx)("button",{className:"btn btn-primary btn-sm",disabled:j.disabled,onClick:function(){switch(e.status){case k:case B:I();break;case T:F()}},children:Object(w.jsx)("h5",{children:A?"T\xe9lechargement en cours  ...":j.text})}):null]})})]})})},$u=c(1350),Zu=Object($u.a)({fontSizes:{lg:"18px"},fonts:{heading:"Montserrat",body:"Montserrat"},styles:{global:function(e){return{"html, body":{fontSize:"sm",lineHeight:"tall"}}}},components:{Button:{baseStyle:{fontWeight:"bold"},sizes:{xl:{h:"56px",fontSize:"sm",px:"13px"}},variants:{"with-shadow":{bg:"#2c5282"},solid:function(e){return{bg:(e.colorMode,"#2c5282")}}}}}}),ej=c(162);o.a.render(Object(ej.jsx)(Ku.a,{theme:Zu,children:Object(ej.jsxs)(P.Provider,{store:Hu,children:[Object(ej.jsx)(Ju,{}),Object(ej.jsx)(En.a,{position:"top-right",autoClose:5e3,limit:2,hideProgressBar:!1,newestOnTop:!0,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"dark"}),Object(ej.jsx)(Yu.a,{loading:null,persistor:Uu,children:Object(ej.jsx)(l.a,{authType:"localstorage",authName:"_auth_veto",children:Object(ej.jsx)(Su,{})})})]})}),document.getElementById("root")),d()},653:function(e,t,n){},901:function(e,t,n){},950:function(e,t,n){}},[[1299,1,2]]]);
//# sourceMappingURL=main.95c118b4.chunk.js.map